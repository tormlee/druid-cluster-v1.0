"use strict";var _this=this;var tslib_1=require("tslib");var nike_hercules_1=require("@implydata/nike-hercules");var views_1=require("../../views");var router=nike_hercules_1.HerculesServer.makeRouter();router.get("/",function(e,r,s){return tslib_1.__awaiter(_this,void 0,void 0,function(){var s,t,i,n,a,u,l,c,o,d,v,m;return tslib_1.__generator(this,function(_){switch(_.label){case 0:s=e.requestId,t=e.user,i=e.version,n=e.clusterActions,a=e.sideDrawerItems,u=e.simplePivot,l=e.hasSubscription,c=e.clusterStore,o=e.appTitle;d=null;if(e.licenseManager){if(e.licenseManager.isExpired()){d="expired"}else if(e.licenseManager.isWelcomeNeeded()){d="welcome";e.licenseManager.welcomeShown()}}_.label=1;case 1:_.trys.push([1,3,,4]);return[4,c.getAll()];case 2:v=_.sent();return[3,4];case 3:m=_.sent();r.status(500).json({error:"Could not get clusters: "+m.message});return[2];case 4:r.send(views_1.launcherLayout({title:o,version:i,sideDrawerItems:a,user:t,clusterIdsAndNames:(v||[]).map(function(e){return{name:e.name,id:e.clusterId}}),simplePivot:u,hasSubscription:l,specialRun:d}));return[2]}})})});module.exports=router;