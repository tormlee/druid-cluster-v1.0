"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var beltful_1=require("@implydata/beltful");var little_pictures_1=require("@implydata/little-pictures");var React=require("react");var svg_icon_1=require("../svg-icon/svg-icon");var ResizeHandle=function(e){tslib_1.__extends(t,e);function t(){var t=e.call(this)||this;t.state={};t.onGlobalMouseUp=t.onGlobalMouseUp.bind(t);t.onGlobalMouseMove=t.onGlobalMouseMove.bind(t);return t}t.prototype.componentWillMount=function(){this.setState({startValue:this.props.initialValue,currentValue:this.props.initialValue})};t.prototype.isHorizontal=function(){var e=this.props.side;return e==="left"||e==="right"};t.prototype.onMouseDown=function(e){window.addEventListener("mouseup",this.onGlobalMouseUp);window.addEventListener("mousemove",this.onGlobalMouseMove);var t;if(this.isHorizontal()){t=beltful_1.EventUtils.getXFromEvent(e)}else{t=beltful_1.EventUtils.getYFromEvent(e)}this.setState({anchor:t});e.preventDefault()};t.prototype.onGlobalMouseMove=function(e){var t=this;var o=this.props,i=o.side,s=o.mode;var n=this.state,r=n.startValue,a=n.anchor;var l=this.isHorizontal()?beltful_1.EventUtils.getXFromEvent(e)-a:beltful_1.EventUtils.getYFromEvent(e)-a;if(["left","top"].indexOf(i)>-1)l=-l;if(s==="percentage"){var u=this._div.parentElement.getBoundingClientRect().height;l=l*100/u}var p=this.constrainValue(r-l);this.setState({currentValue:p},function(){if(!!t.props.onResize)t.props.onResize(p)})};t.prototype.onGlobalMouseUp=function(e){var t=this;window.removeEventListener("mouseup",this.onGlobalMouseUp);window.removeEventListener("mousemove",this.onGlobalMouseMove);var o=this.state.currentValue;this.setState({startValue:o},function(){if(!!t.props.onResizeEnd)t.props.onResizeEnd(o)})};t.prototype.constrainValue=function(e){var t=this.props,o=t.min,i=t.max;return beltful_1.NumberUtils.clamp(e,this.props.min,this.props.max)};t.prototype.render=function(){var e=this;var t=this.props,o=t.side,i=t.mode;var s=this.state.currentValue;var n={};n[o]=s+(i==="percentage"?"%":"px");var r="resize-handle "+o;return React.createElement("div",{className:r,ref:function(t){return e._div=t},style:n,onMouseDown:this.onMouseDown.bind(this)},React.createElement(svg_icon_1.SvgIcon,{className:o,svg:this.isHorizontal()?little_pictures_1.DRAG_HANDLE_VERTICAL:little_pictures_1.DRAG_HANDLE_HORIZONTAL}))};t.defaultProps={mode:"absolute"};return t}(React.Component);exports.ResizeHandle=ResizeHandle;