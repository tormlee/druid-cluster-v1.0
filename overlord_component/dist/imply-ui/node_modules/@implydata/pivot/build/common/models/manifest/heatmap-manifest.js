"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var immutable_class_1=require("immutable-class");var split_combine_1=require("../split-combine/split-combine");var splits_1=require("../splits/splits");var base_manifest_1=require("./base-manifest");var HeatmapManifest=function(e){tslib_1.__extends(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.name="heatmap";t.title="Heatmap";return t}t.prototype.canHandleSplitDimensions=function(e,t,i,n){if(t.length===2)return base_manifest_1.Resolve.proceedWithDimensions();var s=e.slice(0,2);var a=function(e){return split_combine_1.SplitCombine.fromDimensionAndFilterAndMeasure(e,i,n)};if(s.length!==2){return base_manifest_1.Resolve.rejectDimensions("Not enough dimensions in this data cube for a Heatmap",[])}if(!t.length){return base_manifest_1.Resolve.rejectDimensions("The Heatmap requires two splits",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("splitting on "+s.map(function(e){return e.title}).join(", "),new splits_1.Splits(s.map(a)))])}else if(t.length===1){var r=t[0];var l=e.find(function(e){return!e.equals(r)});if(!l)throw new Error;return base_manifest_1.Resolve.rejectDimensions("The Heatmap requires two splits",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("adding a split on "+l.title,new splits_1.Splits([a(r),a(l)]))])}else{return base_manifest_1.Resolve.rejectDimensions("Too many splits on the Heatmap",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("removing all but the first two splits",new splits_1.Splits(s.map(a)))])}};t.prototype.getEffectiveSplits=function(e,t,i){var n=false;var s=e.splitCombines.map(function(e){if(!e.sortAction){n=true;e=e.changeSortAction(split_combine_1.SplitCombine.calculateSortOn(immutable_class_1.NamedArray.findByName(t,e.dimension),i))}if(!e.limitAction){n=true;e=e.changeLimit(25)}return e});return n?new splits_1.Splits(s):e};t.prototype.getSuitability=function(e,t,i,n){var s=t.splitCombines.filter(function(t){return t.getDimension(e).isContinuous()}).length;return new base_manifest_1.Suitability(3+(s>1?6:0))};return t}(base_manifest_1.Manifest);exports.HeatmapManifest=HeatmapManifest;exports.HEATMAP_MANIFEST=new HeatmapManifest;