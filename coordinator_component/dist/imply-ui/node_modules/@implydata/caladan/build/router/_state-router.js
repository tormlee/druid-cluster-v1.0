"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var React=require("react");var _router_core_1=require("./_router-core");var _base_router_1=require("./_base-router");var _route_1=require("./_route");(function(t){var e=t.pushState;t.pushState=function(r){var o=e.apply(t,arguments);window.dispatchEvent(new Event("pushstate"));return o}})(window.history);var StateRouter=function(t){tslib_1.__extends(e,t);function e(){var e=t!==null&&t.apply(this,arguments)||this;e.events=["popstate","pushstate"];return e}e.stub=function(){var t;var r=function(e,r,o){t=o;window.dispatchEvent(new window.Event("pushstate"))};e.push=window.history.pushState;e.replace=window.history.replaceState;e.get_path=e.getPath;window.history.pushState=r;window.history.replaceState=r;e.getPath=function(){return t}};e.restore=function(){window.history.pushState=e.push;window.history.replaceState=e.replace;e.getPath=e.get_path};e.noop=function(t,r,o){if(r===void 0){r=""}if(o===void 0){o="router"}return React.createElement(e,{key:o,rootFragment:r},React.createElement(_route_1.Route,{fragment:":$noop"},t))};e.getPath=function(){return"/"+window.location.pathname.replace(/^\//,"").replace(/\/$/,"")};e.prototype.getCurrentPath=function(){return e.getPath()};e.prototype.removeRootFragment=function(t){var e=this.props.rootFragment;return t.replace(new RegExp("^/*"+(e||""),"gi"),"")};e.prototype.sanitizePath=function(t){var e=(this.props.rootFragment||"").replace(/^\/*/,"").replace(/\/*$/,"");var r=this.parsePath(t);if(!e){return"/"+r.join(_router_core_1.RouterCore.FRAGMENTS_JOINER)}return"/"+e+"/"+r.join(_router_core_1.RouterCore.FRAGMENTS_JOINER)};e.prototype.replacePath=function(t){t=t.replace(/\/+/g,"/");window.history.replaceState(undefined,undefined,t);this.onPathChange(t)};return e}(_base_router_1.BaseRouter);exports.StateRouter=StateRouter;