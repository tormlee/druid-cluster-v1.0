"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var beltful_1=require("@implydata/beltful");var classNames=require("classnames");var React=require("react");var RTG=require("react-transition-group");var CSSTransition=RTG.CSSTransition,TransitionGroup=RTG.TransitionGroup;var ReactDOM=require("react-dom");var gate_keeper_1=require("../gate-keeper/gate-keeper");var global_event_listener_1=require("../global-event-listener/global-event-listener");var svg_icon_1=require("../svg-icon/svg-icon");var NOOP=function(){return null};var SideDrawer=function(e){tslib_1.__extends(r,e);function r(){return e.call(this)||this}r.separator=function(){return{label:"",isSeparator:true}};r.prototype.globalMouseDownListener=function(e){var r=ReactDOM.findDOMNode(this);var t=e.target;if(beltful_1.DOMUtils.isInside(t,r))return;this.props.onClose()};r.prototype.renderSeparator=function(e){return React.createElement("div",{className:"separator",key:e})};r.prototype.onItemClick=function(e,r){var t=this.props,a=t.onClose,n=t.onSelfClick;var i=e.onClick||NOOP;if(e.disabled){a();return}if(e.selected){if(n)n(e);a();return}if(e.needsGateKeeping){if(r.altKey||r.ctrlKey||r.metaKey)return;var s=gate_keeper_1.GateKeeper.checkAndCall(function(){var t=i();if(t===false){r.preventDefault()}else{if(e.href)window.open(e.href,"_self");if(e.hash)window.location.hash=e.hash}});if(s)r.preventDefault();a()}else{var o=i();if(o===false){r.preventDefault()}a()}};r.prototype.isSideDrawerItem=function(e){return e.props===undefined};r.prototype.renderItem=function(e,r){if(!this.isSideDrawerItem(e))return React.cloneElement(e,{key:r});if(e.isSeparator)return this.renderSeparator(r);var t=e.selected,a=e.label,n=e.href,i=e.hash,s=e.svgIcon,o=e.color;if(n&&i)throw new Error("An item cannot have both an href and a hash");return React.createElement("a",{className:classNames("side-drawer-item",{selected:t,disabled:e.disabled}),key:r,title:a,href:t?null:n||i,onClick:this.onItemClick.bind(this,e),style:{color:t?"#fff":o,background:t?o:null}},s?React.createElement("span",{className:"icon"},React.createElement(svg_icon_1.SvgIcon,{svg:s,style:{fill:t?"#fff":o}})):null,a)};r.prototype.renderNavLogo=function(){var e=this.props,r=e.onClose,t=e.navLogo;return React.createElement("div",{className:"nav-logo",onClick:r},React.createElement("div",{className:"logo"},React.createElement(svg_icon_1.SvgIcon,{svg:t})))};r.prototype.renderDrawer=function(){var e=this.props,r=e.onClose,t=e.items,a=e.className;return React.createElement("div",{className:classNames("side-drawer",a)},React.createElement(global_event_listener_1.GlobalEventListener,{mouseDown:this.globalMouseDownListener.bind(this),escape:this.props.onClose.bind(this)}),this.renderNavLogo(),React.createElement("div",{className:"side-drawer-items"},t.map(this.renderItem,this)))};r.prototype.render=function(){var e=this.props,r=e.open,t=e.className;return React.createElement(TransitionGroup,{className:"side-drawer-container"},r?React.createElement(CSSTransition,{classNames:"side-drawer",timeout:{enter:500,exit:300}},this.renderDrawer()):null)};return r}(React.Component);exports.SideDrawer=SideDrawer;