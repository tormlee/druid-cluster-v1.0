"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var beltful_1=require("@implydata/beltful");var classNames=require("classnames");var React=require("react");var notifier_1=require("../notifier/notifier");var DEFAULT_DURATION=6;var NotificationCard=function(e){tslib_1.__extends(t,e);function t(){var t=e.call(this)||this;t.state={appearing:false,disappearing:false,hovered:false,timerExpired:false};return t}t.prototype.componentDidMount=function(){var e=this;this.setState({appearing:true},function(){e.timeoutID=window.setTimeout(e.appear.bind(e),10)})};t.prototype.componentWillReceiveProps=function(e){if(e.model&&e.model.discarded){this.disappear()}};t.prototype.appear=function(){var e=this;var t=this.props.model,i=t.title,a=t.message,r=t.duration,o=t.muted;var n=beltful_1.NumberUtils.clamp(r,-1,10);if(n===-1){this.setState({appearing:false});return}if(o){this.setState({appearing:false})}else{this.setState({appearing:false},function(){e.timeoutID=window.setTimeout(e.onDisappearTimerEnd.bind(e),(n?n:DEFAULT_DURATION)*1e3)})}};t.prototype.onDisappearTimerEnd=function(){if(this.state.hovered){this.setState({timerExpired:true});return}this.disappear()};t.prototype.disappear=function(){var e=this;if(this.timeoutID!==undefined)window.clearTimeout(this.timeoutID);this.setState({disappearing:true},function(){e.timeoutID=window.setTimeout(e.removeMe.bind(e,e.props.model),200)})};t.prototype.removeMe=function(e){if(this.timeoutID!==undefined)window.clearTimeout(this.timeoutID);notifier_1.Notifier.removeNotification(e)};t.prototype.componentWillUnmount=function(){if(this.timeoutID!==undefined)window.clearTimeout(this.timeoutID)};t.prototype.onMouseOver=function(){this.setState({hovered:true})};t.prototype.onMouseLeave=function(){this.setState({hovered:false});if(this.state.timerExpired){this.disappear()}};t.prototype.render=function(){var e=this;var t=this.state,i=t.appearing,a=t.disappearing;var r=this.props,o=r.model,n=r.top;if(!o)return null;var s=o.title,p=o.message,u=o.priority,l=o.action,d=o.muted;if(i||a)n=-100;var c="rows-"+[s,p,l].filter(Boolean).length;var m=function(){l&&l.callback();e.disappear()};return React.createElement("div",{style:{top:n},onClick:m,onMouseOver:this.onMouseOver.bind(this),onMouseLeave:this.onMouseLeave.bind(this),className:classNames("notification-card "+u+" "+c,{appearing:i,disappearing:a,muted:d})},React.createElement("div",{className:"title",title:s},s),p?React.createElement("div",{className:"message",title:p},p):null,l?React.createElement("div",{className:"action"},React.createElement("span",null,l.label)):null)};return t}(React.Component);exports.NotificationCard=NotificationCard;