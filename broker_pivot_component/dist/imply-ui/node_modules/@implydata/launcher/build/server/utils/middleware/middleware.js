"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var nike_hercules_1=require("@implydata/nike-hercules");function makeGuardForUserManagement(){var e=this;return function(r,t,s){return tslib_1.__awaiter(e,void 0,void 0,function(){var e,n,a;return tslib_1.__generator(this,function(u){switch(u.label){case 0:e=r.user;if(!r.rolesStore)return[3,2];return[4,r.rolesStore.getAll()];case 1:a=u.sent();return[3,3];case 2:a=null;u.label=3;case 3:n=a;if(!e){t.status(403).send({error:"no user"});return[2]}else if(!e.can("manage-users",n)){nike_hercules_1.LOGGER.error("No access to users");t.redirect("/");return[2]}s();return[2]}})})}}exports.makeGuardForUserManagement=makeGuardForUserManagement;