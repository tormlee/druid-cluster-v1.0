"use strict";var _this=this;Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var es7Shim=require("es7-shim");es7Shim.shim();var debugModule=require("debug");var http=require("http");var utils_1=require("../common/utils/utils/utils");var config_1=require("./config");var wrapper_app_1=require("./wrapper-app");var debug=debugModule("manager:www");config_1.getConfig().then(function(e){return tslib_1.__awaiter(_this,void 0,void 0,function(){var r,t,i,s,o;return tslib_1.__generator(this,function(n){r=e.serverConfig,t=e.version,i=e.clarityConfig,s=e.initialSettings;o=http.createServer(wrapper_app_1.makeWrapperServer({version:t,serverConfig:r,clarityConfig:i,sideDrawerItems:utils_1.SIDE_DRAWER_ITEMS,logoutHref:"/logout",homeHref:"/"}));o.on("error",function(e){if(e.syscall!=="listen"){throw e}switch(e.code){case"EACCES":console.error("Port "+r.getPort()+" requires elevated privileges");process.exit(1);break;case"EADDRINUSE":console.error("Port "+r.getPort()+" is already in use");process.exit(1);break;default:throw e}});o.on("listening",function(){var e=o.address();console.log("Launcher is listening on address "+e.address+" port "+e.port);debug("Launcher is listening on address "+e.address+" port "+e.port)});o.listen(r.getPort(),r.getServerHost());return[2]})})});