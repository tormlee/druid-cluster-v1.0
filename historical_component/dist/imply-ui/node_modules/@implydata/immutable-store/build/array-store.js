"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var base_store_1=require("./base-store");var ArrayStore=function(_super){tslib_1.__extends(ArrayStore,_super);function ArrayStore(options){if(options===void 0){options={}}var _this=_super.call(this,options)||this;_this.array=options.initArray||[];return _this}ArrayStore.prototype.size=function(){return Promise.resolve(this.array.length)};ArrayStore.prototype.get=function(key){var keyFn=this.keyFn;return Promise.resolve(this.array.find(function(d){return keyFn(d)===key})||null)};ArrayStore.prototype.getAll=function(){return Promise.resolve(this.array.slice())};ArrayStore.prototype.deleteByKey=function(key){this.ensureWritable();var keyFn=this.keyFn;this.array=this.array.filter(function(d){return keyFn(d)!==key});return Promise.resolve(null)};ArrayStore.prototype.addOrUpdate=function(thing){this.ensureWritable();var keyFn=this.keyFn;var key=keyFn(thing);var added=false;this.array=this.array.map(function(d){if(keyFn(d)===key){added=true;return thing}else{return d}});if(!added){this.array.push(thing);if(this.maxEntries){var toTrim=Math.max(0,this.array.length-this.maxEntries);if(toTrim){this.array=this.array.slice(toTrim)}}}return Promise.resolve(null)};return ArrayStore}(base_store_1.ImmutableStore);exports.ArrayStore=ArrayStore;