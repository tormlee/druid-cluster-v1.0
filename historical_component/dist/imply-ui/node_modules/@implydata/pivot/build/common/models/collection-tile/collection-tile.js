"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var beltful_1=require("@implydata/beltful");var immutable_class_1=require("immutable-class");var essence_1=require("../essence/essence");var CollectionTile=function(e){tslib_1.__extends(t,e);function t(t){var a=e.call(this,t)||this;a.title=a.title||beltful_1.StringUtils.makeTitle(name);return a}t.isCollectionTile=function(e){return e instanceof t};t.fromEssence=function(e,a){return new t({name:e,title:a.getTitle(),description:"",essence:a,type:t.TYPE_VISUALIZATION})};t.generateBlank=function(e){return new t({name:e,title:"New tile",description:"",essence:undefined,type:t.TYPE_BLANK})};t.fromJS=function(e,a){if(a===void 0){a={}}var i=a.dataCubes,l=a.visualizations;var n;if(e.essence){var s=e.essence;var u=null;if(i){var r=s.dataCube||e.dataCube;u=immutable_class_1.NamedArray.findByName(i,r)}if(!s.dataCube&&e.dataCube){s.dataCube=e.dataCube}n=essence_1.Essence.fromJS(s,{actualDataCube:u,visualizations:l})}return new t({name:e.name,title:e.title,description:e.description,position:e.position?beltful_1.Stage.fromJS(e.position):null,group:e.group,essence:n,titleHidden:e.titleHidden,type:e.type||(n?t.TYPE_VISUALIZATION:t.TYPE_BLANK)})};t.prototype.isReady=function(){return this.isBlank()||Boolean(this.essence.actualDataCube)};t.prototype.getDataCube=function(){return this.essence?this.essence.actualDataCube:null};t.prototype.makeDuplicate=function(e){var a=this.valueOf();a.name=e;delete a.position;return new t(a)};t.prototype.isBlank=function(){return this.type===t.TYPE_BLANK};t.prototype.isVisualization=function(){return this.type===t.TYPE_VISUALIZATION};t.TYPE_VISUALIZATION="visualization";t.TYPE_BLANK="blank";t.PROPERTIES=[{name:"name",validate:beltful_1.StringUtils.verifyUrlSafeName},{name:"title",defaultValue:null},{name:"titleHidden",defaultValue:false},{name:"description",defaultValue:null},{name:"position",immutableClass:beltful_1.Stage,defaultValue:null},{name:"group",defaultValue:null},{name:"essence",immutableClass:essence_1.Essence,defaultValue:null},{name:"type",possibleValues:[t.TYPE_BLANK,t.TYPE_VISUALIZATION],defaultValue:t.TYPE_BLANK}];return t}(immutable_class_1.BaseImmutable);exports.CollectionTile=CollectionTile;immutable_class_1.BaseImmutable.finalize(CollectionTile);