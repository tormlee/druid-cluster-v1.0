"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=require("tslib");var beltful_1=require("@implydata/beltful");var little_pictures_1=require("@implydata/little-pictures");var classNames=require("classnames");var React=require("react");var body_portal_1=require("../body-portal/body-portal");var global_event_listener_1=require("../global-event-listener/global-event-listener");var golden_center_1=require("../golden-center/golden-center");var svg_icon_1=require("../svg-icon/svg-icon");var Modal=function(e){tslib_1.__extends(t,e);function t(){var t=e.call(this)||this;t.state={id:null};return t}t.prototype.componentWillMount=function(){var e=this.props.id;this.setState({id:e||"modal-"+t.counter++})};t.prototype.getChildByID=function(e,t){if(!e)return null;var r=e.length;for(var n=0;n<r;n++){var a=e[n];if(a.getAttribute&&a.getAttribute("id")===t)return a;if(a.childNodes){var o=this.getChildByID(a.childNodes,t);if(o)return o}}return null};t.prototype.onEscape=function(){var e=this.props,t=e.onClose,r=e.mandatory;if(!r&&t)t()};t.prototype.onEnter=function(e){if(this.props.onEnter)this.props.onEnter(e)};t.prototype.onMouseDown=function(e){var t=this.props,r=t.onClose,n=t.mandatory,a=t.deaf;if(!r||n||a)return;var o=this.state.id;var i=document.getElementById(o);if(!i)return;var l=e.target;if(beltful_1.DOMUtils.isInside(l,i))return;r()};t.prototype.renderXButton=function(){var e=this.props.onClose;if(!e)return null;return React.createElement("div",{className:"close",onClick:e},React.createElement(svg_icon_1.SvgIcon,{svg:little_pictures_1.FULL_REMOVE}))};t.prototype.render=function(){var e=this.props,t=e.className,r=e.title,n=e.children,a=e.deaf;var o=this.state.id;var i=null;if(typeof r==="string"){i=React.createElement("div",{className:"modal-title"},React.createElement("div",{className:"text"},r),this.renderXButton())}return React.createElement(body_portal_1.BodyPortal,{fullSize:true},React.createElement("div",{className:classNames("modal",t,{deaf:a})},React.createElement(global_event_listener_1.GlobalEventListener,{enter:this.onEnter.bind(this),escape:this.onEscape.bind(this),mouseDown:this.onMouseDown.bind(this)}),React.createElement("div",{className:"backdrop"}),React.createElement(golden_center_1.GoldenCenter,null,React.createElement("div",{className:"modal-window",id:o},i,n))))};t.counter=0;return t}(React.Component);exports.Modal=Modal;