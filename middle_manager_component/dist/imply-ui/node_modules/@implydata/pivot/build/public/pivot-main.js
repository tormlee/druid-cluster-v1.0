webpackJsonp([0],[,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.STRINGS={add:"Add",addAttributes:"Add attributes",addFromDataCube:"Add from data cube",addNewUser:"Add new user",addToAlbum:"Add to album",addToExisting:"Add to existing",addToDashboard:"Add to dashboard",addToNewAlbum:"Add to new album",addToNewDashboard:"Add to new dashboard",alsoUseAsUserId:"Also use as user ID",any:"any",arrangeTiles:"Arrange tiles",attribute:"Attribute",autoFillDimensionsAndMeasures:"Auto-fill dimensions and measures",autoUpdate:"Auto update",cancel:"Cancel",close:"Close",clusters:"Clusters",configureCluster:"configure cluster",configureDataCube:"configure data cube",connectCluster:"Connect new cluster",connectNewCluster:"Connect new cluster",contains:"Contains",saveAsFixedTimeRange:"Save as fixed time range",copySpecificUrl:"Copy URL - fixed time",copyLink:"Copy link",copyUrl:"Copy URL",copyValue:"Copy value",createColumn:"New column",createNewDashboard:"Create new dashboard",createNewDataCube:"Create new data cube",createDataCubesFromCluster:"Create data cubes from cluster?",current:"Current",create:"Create",createDimension:"New dimension",createMeasure:"New measure",cubes:"cubes",custom:"Custom",day:"Day",days:"Days",dashboards:"Dashboards",dashboardOptions:"Dashboard options",dataCubes:"Data cubes",delete:"Delete",deleteDashboard:"Delete this dashboard",deleteDashboardTile:"Delete this tile",dimensions:"Dimensions",dimension:"Dimension",dontSave:"Don't save",download:"Download",dragToReorder:"Drag tiles to reorder",duplicate:"Duplicate",duplicateDataCube:"Duplicate this data cube",duplicateCollectionTile:"Duplicate this tile",edit:"Edit",editColumn:"Edit column",editCluster:"Edit cluster",editDataCube:"Edit data cube",editDimension:"Edit dimension",editMeasure:"Edit measure",editThisCube:"Edit this cube",editTitleAndDesc:"Edit title and description",editUser:"Edit User",editVisualization:"Edit visualization",emptyCollectionTile:"No visualization has been selected",enableCache:"Enable cache",end:"End",exclude:"Exclude",explore:"Explore",export:"Export",exportToCSV:"Export to CSV",favorites:"Favorites",filter:"Filter",filters:"Filters",fixed:"Fixed",generalSettings:"General settings",goToUrl:"Go to URL",granularity:"Granularity",hour:"Hour",hours:"Hours",imply:"Imply",implyPlatform:"Imply Platform",include:"Include",infoAndFeedback:"Info & feedback",instead:"instead",intersection:"Intersection",invitationLink:"Invitation Link",invite:"Invite",last5Minutes:"Last 5 minutes",lastDay:"Last Day",lastHour:"Last Hour",lastWeek:"Last Week",latest:"Latest",latestData:"Latest data",limit:"Limit",loadingSettings:"Loading settings...",loginToPivot:"Login to Pivot",loggingIn:"Logging in...",logout:"Logout",measures:"Measures",measure:"Measure",specialColumns:"Special columns",metrics:"Metrics",monitorQueries:"Monitor queries",month:"Month",newAlbum:"New album",newDashboard:"New dashboard",newDataCube:"New data cube",next:"Next",no:"No",noDashboards:"You don't have any dashboards.",none:"None",noIllCreateThem:"No, I'll create them myself",noClusters:"There are no clusters connected",noDataCubes:"There are no data cubes",noDescription:"No description",noFilter:"No filter",noTilesInThisAlbum:"There are no tiles in this album",noTilesInThisDashboard:"There are no tiles in this dashboard",ok:"OK",orAddASpecificAttribute:"Or add a specific attribute",orViewSuggestedAttributes:"Or view suggested attributes",orConnectToACluster:"Or connect to a cluster",orReadFromAFile:"Or read from a file",orSelectAKnownColumn:"Or select a known column",orTypeInACustomName:"Or type in a custom name",openIn:"Open in",pin:"Pin",pivot:"Pivot",passwordReset:"Password reset",pinboard:"Pinboard",pinboardPlaceholder:"Click or drag dimensions to pin them",previous:"Previous",quarter:"Quarter",queryError:"Query error",quicklyAddSomeUsing:"Quickly add some using",reset:"Reset",regex:"Regex",removeAttribute:"Remove attribute",relative:"Relative",save:"Save",saveDuplicate:"Save duplicate",saveChanges:"Save changes",segmentRawData:"Segment raw data",select:"Select",settings:"Settings",sortBy:"Sort by",split:"Split",splitDelimiter:"by",start:"Start",stayHere:"Stay here",stringSearch:"String search",subsplit:"Split",subsetFilter:"Subset filter",suggestion:"suggestion",suggestions:"suggestions",switchToSingleSelectionMode:"Single selection",switchToMultiSelectionMode:"Multiple selection",timezone:"Timezone",try:"Try",thereAreNoSuggestionsAtTheMoment:"There are no suggestions at the moment",undo:"Click here to undo",unsavedChangesTitle:"You have unsaved changes",unsavedChangesMessage:"You have unsaved changes. Would you like to save them?",unsplitable:"Un-splittable",users:"Users",viewRawData:"View raw data",week:"Week",wouldYouLikeToCreateCubes:"Would you like to create data cubes from them?",year:"Year",yes:"Yes"}},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);tslib_1.__exportStar(__webpack_require__(476),exports);tslib_1.__exportStar(__webpack_require__(108),exports);tslib_1.__exportStar(__webpack_require__(176),exports);tslib_1.__exportStar(__webpack_require__(107),exports);tslib_1.__exportStar(__webpack_require__(177),exports);tslib_1.__exportStar(__webpack_require__(389),exports);tslib_1.__exportStar(__webpack_require__(75),exports);tslib_1.__exportStar(__webpack_require__(53),exports);tslib_1.__exportStar(__webpack_require__(477),exports);tslib_1.__exportStar(__webpack_require__(51),exports);tslib_1.__exportStar(__webpack_require__(36),exports);tslib_1.__exportStar(__webpack_require__(117),exports);tslib_1.__exportStar(__webpack_require__(390),exports);tslib_1.__exportStar(__webpack_require__(187),exports);tslib_1.__exportStar(__webpack_require__(188),exports);tslib_1.__exportStar(__webpack_require__(478),exports);tslib_1.__exportStar(__webpack_require__(116),exports);tslib_1.__exportStar(__webpack_require__(67),exports);tslib_1.__exportStar(__webpack_require__(391),exports);tslib_1.__exportStar(__webpack_require__(392),exports);tslib_1.__exportStar(__webpack_require__(393),exports);tslib_1.__exportStar(__webpack_require__(394),exports);tslib_1.__exportStar(__webpack_require__(395),exports);tslib_1.__exportStar(__webpack_require__(396),exports);tslib_1.__exportStar(__webpack_require__(397),exports);tslib_1.__exportStar(__webpack_require__(479),exports);tslib_1.__exportStar(__webpack_require__(70),exports);tslib_1.__exportStar(__webpack_require__(385),exports);tslib_1.__exportStar(__webpack_require__(398),exports);tslib_1.__exportStar(__webpack_require__(399),exports);tslib_1.__exportStar(__webpack_require__(480),exports);tslib_1.__exportStar(__webpack_require__(400),exports);tslib_1.__exportStar(__webpack_require__(401),exports);tslib_1.__exportStar(__webpack_require__(402),exports);tslib_1.__exportStar(__webpack_require__(482),exports);tslib_1.__exportStar(__webpack_require__(185),exports);tslib_1.__exportStar(__webpack_require__(483),exports);tslib_1.__exportStar(__webpack_require__(484),exports);tslib_1.__exportStar(__webpack_require__(403),exports);tslib_1.__exportStar(__webpack_require__(404),exports)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CORE_ITEM_WIDTH=200;exports.CORE_ITEM_GAP=8;exports.PIN_TITLE_HEIGHT=36;exports.PIN_ITEM_HEIGHT=25;exports.PIN_PADDING_BOTTOM=12;exports.VIS_H_PADDING=10;exports.OVERFLOW_WIDTH=40;exports.SPLIT="SPLIT";exports.MAX_SEARCH_LENGTH=300;exports.SEARCH_WAIT=900},,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var splits_1=__webpack_require__(36);var Suitability=function(){function Suitability(score,cantHandleCombine){this.score=score;if(cantHandleCombine)this.cantHandleCombine=cantHandleCombine}Suitability.MAX=new Suitability(10);return Suitability}();exports.Suitability=Suitability;var SplitSuggestion=function(){function SplitSuggestion(){}SplitSuggestion.fromTitleAndSplits=function(description,splits){return{description:description,adjustment:{splits:splits}}};SplitSuggestion.fromTitleAndSplit=function(description,split){return SplitSuggestion.fromTitleAndSplits(description,splits_1.Splits.fromSplitCombine(split))};return SplitSuggestion}();exports.SplitSuggestion=SplitSuggestion;var Resolve=function(){function Resolve(state,message,resolutions){if(resolutions===void 0){resolutions=null}this.state=state;this.message=message;this.resolutions=resolutions}Resolve.rejectDimensions=function(message,resolutions){return new Resolve(Resolve.CANT_HANDLE_DIMENSION,message,resolutions)};Resolve.rejectCombines=function(message,resolutions){return new Resolve(Resolve.CANT_HANDLE_COMBINE,message,resolutions)};Resolve.proceedWithDimensions=function(){return new Resolve(Resolve.PROCEED_WITH_DIMENSIONS)};Resolve.prototype.toString=function(){return""+this.state};Resolve.prototype.valueOf=function(){return this.state};Resolve.prototype.proceedWithDimensions=function(){return this.state===Resolve.PROCEED_WITH_DIMENSIONS};Resolve.prototype.rejectedDimensions=function(){return this.state===Resolve.CANT_HANDLE_DIMENSION};Resolve.prototype.rejectedCombines=function(){return this.state===Resolve.CANT_HANDLE_COMBINE};Resolve.CANT_HANDLE_DIMENSION=-2;Resolve.PROCEED_WITH_DIMENSIONS=0;Resolve.CANT_HANDLE_COMBINE=-1;return Resolve}();exports.Resolve=Resolve;var Manifest=function(){function Manifest(){this.supportsMultipleMeasureMode=false}Manifest.isTotals=function(manifestName){return manifestName==="totals"};Manifest.prototype.summon=function(dimensions,splits,filter,measure,colors){return null};Manifest.prototype.getEffectiveSplits=function(splits,dimensions,sortMeasureName){return splits};Manifest.prototype.getEffectiveColors=function(splits,colors){return null};return Manifest}();exports.Manifest=Manifest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function findParentWithClass(child,className){while(child){if(child.classList.contains(className))return child;child=child.parentNode}return null}exports.findParentWithClass=findParentWithClass;function transformStyle(x,y){var xStr=String(x);var yStr=String(y);if(xStr!=="0")xStr+="px";if(yStr!=="0")yStr+="px";var transform="translate("+xStr+","+yStr+")";return{transform:transform,WebkitTransform:transform,MsTransform:transform}}exports.transformStyle=transformStyle;function roundToHalfInteger(n){return Math.round(n-.5)+.5}exports.roundToHalfInteger=roundToHalfInteger},,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ajax_1=__webpack_require__(69);var plywood_1=__webpack_require__(14);var currentlyFetchingCancels={};function getSplitsDescription(ex){var splits=[];ex.forEach(function(ex){if(ex instanceof plywood_1.SplitExpression){splits.push(ex.firstSplitExpression().toString())}});return splits.join(";")}var QueryRunner=function(){function QueryRunner(){}QueryRunner.getMonitorState=function(){return Boolean(QueryRunner.trackedQueries)};QueryRunner.setMonitorState=function(status){if(status){if(!QueryRunner.trackedQueries)QueryRunner.trackedQueries=[]}else{if(QueryRunner.trackedQueries)QueryRunner.trackedQueries=null}};QueryRunner.fetch=function(id,dataCubeName,instance,expression,timezone,skipCache){if(skipCache===void 0){skipCache=false}if(currentlyFetchingCancels[id]){currentlyFetchingCancels[id]();delete currentlyFetchingCancels[id]}var data={dataCube:dataCubeName,expression:expression.toJS(),timezone:timezone};if(instance){data.instance=instance}if(QueryRunner.hasQueryCache&&(!QueryRunner.cacheEnabled||skipCache)){data.skipCache=true}var startTime;if(QueryRunner.trackedQueries){data.monitor=true;startTime=Date.now()}var queryPromise=ajax_1.Ajax.query({method:"POST",url:QueryRunner.PLYWOOD_URL+"?by="+getSplitsDescription(expression),data:data}).then(function(res){delete currentlyFetchingCancels[id];if(!res.result)throw new Error("Got back empty result");if(Array.isArray(res.rawQueries)&&QueryRunner.trackedQueries){QueryRunner.trackedQueries.push({successful:true,queries:res.rawQueries,taken:Date.now()-startTime})}return plywood_1.Dataset.fromJS(res.result)},function(e){delete currentlyFetchingCancels[id];var jsonError=e.jsonError;if(jsonError&&Array.isArray(jsonError.rawQueries)&&QueryRunner.trackedQueries){QueryRunner.trackedQueries.push({successful:false,queries:jsonError.rawQueries,taken:Date.now()-startTime})}throw e});var cancelFunction;var cancelPromise=new Promise(function(resolve,reject){cancelFunction=function(){var err=new Error("canceled");err.canceled=true;reject(err)}});currentlyFetchingCancels[id]=cancelFunction;return Promise.race([queryPromise,cancelPromise])};QueryRunner.registerEssence=function(essence){ajax_1.Ajax.query({method:"POST",url:QueryRunner.REGISTER_URL,data:{essence:essence}}).catch(function(e){console.log("e",e)})};QueryRunner.PLYWOOD_URL="$mount/plywood";QueryRunner.REGISTER_URL="$mount/mkurl/register";QueryRunner.hasQueryCache=false;QueryRunner.cacheEnabled=true;QueryRunner.trackedQueries=null;return QueryRunner}();exports.QueryRunner=QueryRunner},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x){return function constant(){return x}}},,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);tslib_1.__exportStar(__webpack_require__(473),exports);tslib_1.__exportStar(__webpack_require__(386),exports);tslib_1.__exportStar(__webpack_require__(387),exports);tslib_1.__exportStar(__webpack_require__(475),exports)},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);tslib_1.__exportStar(__webpack_require__(575),exports);tslib_1.__exportStar(__webpack_require__(576),exports);tslib_1.__exportStar(__webpack_require__(577),exports);tslib_1.__exportStar(__webpack_require__(578),exports);tslib_1.__exportStar(__webpack_require__(579),exports);tslib_1.__exportStar(__webpack_require__(182),exports)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var classNames=__webpack_require__(4);var React=__webpack_require__(1);__webpack_require__(512);var HighlightString=function(_super){tslib_1.__extends(HighlightString,_super);function HighlightString(){return _super.call(this)||this}HighlightString.prototype.highlightInString=function(){var _a=this.props,text=_a.text,highlight=_a.highlight;if(!highlight)return text;var startIndex=null;var highlightString=null;if(typeof highlight==="string"){var strLower=text.toLowerCase();startIndex=strLower.indexOf(highlight.toLowerCase());if(startIndex===-1)return text;highlightString=highlight.toLowerCase()}else{var match=text.match(highlight);if(!match)return text;highlightString=match[0];startIndex=match.index}var endIndex=startIndex+highlightString.length;return[React.createElement("span",{className:"pre",key:"pre"},text.substring(0,startIndex)),React.createElement("span",{className:"bold",key:"bold"},text.substring(startIndex,endIndex)),React.createElement("span",{className:"post",key:"post"},text.substring(endIndex))]};HighlightString.prototype.render=function(){var className=this.props.className;return React.createElement("span",{className:classNames("highlight-string",className)},this.highlightInString())};return HighlightString}(React.Component);exports.HighlightString=HighlightString},,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var chronoshift_1=__webpack_require__(23);var hasOwnProperty=__webpack_require__(29);var moment=__webpack_require__(71);var FORMAT_ISOISH="YYYY-MM-DD[T]HH:mm:ss";var FORMAT_WITH_YEAR="MMM D, YYYY";var FORMAT_WITHOUT_YEAR="MMM D";function formatTimeOfDay(d){return d.minutes()?d.format("h:mma"):d.format("ha")}function isCurrentYear(year,timezone){var nowWallTime=moment.tz(new Date,timezone.toString());return nowWallTime.year()===year}var DisplayYear;(function(DisplayYear){DisplayYear[DisplayYear["ALWAYS"]=0]="ALWAYS";DisplayYear[DisplayYear["NEVER"]=1]="NEVER";DisplayYear[DisplayYear["IF_DIFF"]=2]="IF_DIFF"})(DisplayYear=exports.DisplayYear||(exports.DisplayYear={}));function getEndWallTimeInclusive(exclusiveEnd,timezone){return moment.tz(exclusiveToInclusiveEnd(exclusiveEnd),timezone.toString())}exports.getEndWallTimeInclusive=getEndWallTimeInclusive;function exclusiveToInclusiveEnd(exclusiveEnd){return new Date(exclusiveEnd.valueOf()-1)}exports.exclusiveToInclusiveEnd=exclusiveToInclusiveEnd;function formatTimeRange(timeRange,timezone,displayYear){var start=timeRange.start,end=timeRange.end;var startWallTime=moment.tz(start,timezone.toString());var endWallTime=moment.tz(end,timezone.toString());var endWallTimeInclusive=getEndWallTimeInclusive(end,timezone);var showingYear=true;var formatted;if(startWallTime.year()!==endWallTimeInclusive.year()){formatted=[startWallTime.format(FORMAT_WITH_YEAR),endWallTimeInclusive.format(FORMAT_WITH_YEAR)].join(" - ")}else{showingYear=displayYear===DisplayYear.ALWAYS||displayYear===DisplayYear.IF_DIFF&&!isCurrentYear(endWallTimeInclusive.year(),timezone);var fmt=showingYear?FORMAT_WITH_YEAR:FORMAT_WITHOUT_YEAR;if(startWallTime.month()!==endWallTimeInclusive.month()||startWallTime.date()!==endWallTimeInclusive.date()){formatted=[startWallTime.format(FORMAT_WITHOUT_YEAR),endWallTimeInclusive.format(fmt)].join(" - ")}else{formatted=startWallTime.format(fmt)}}if(startWallTime.hours()||startWallTime.minutes()||endWallTime.hours()||endWallTime.minutes()){formatted+=showingYear?" ":", ";var startTimeStr=formatTimeOfDay(startWallTime).toLowerCase();var endTimeStr=formatTimeOfDay(endWallTime).toLowerCase();if(startTimeStr===endTimeStr){formatted+=startTimeStr}else{if(startTimeStr.substr(-2)===endTimeStr.substr(-2)){startTimeStr=startTimeStr.substr(0,startTimeStr.length-2)}formatted+=[startTimeStr,endTimeStr].join("-")}}return formatted}exports.formatTimeRange=formatTimeRange;function monthToWeeks(firstDayOfMonth,timezone){var weeks=[];var firstDayNextMonth=chronoshift_1.month.shift(firstDayOfMonth,timezone,1);var week=[];var currentPointer=chronoshift_1.day.floor(firstDayOfMonth,timezone);while(currentPointer<firstDayNextMonth){var wallTime=moment.tz(currentPointer,timezone.toString());if(wallTime.day()===moment.localeData().firstDayOfWeek()&&week.length>0){weeks.push(week);week=[]}week.push(currentPointer);currentPointer=chronoshift_1.day.shift(currentPointer,timezone,1)}if(week.length>0)weeks.push(week);return weeks}exports.monthToWeeks=monthToWeeks;function prependDays(timezone,weekPrependTo,countPrepend){for(var i=0;i<countPrepend;i++){var firstDate=weekPrependTo[0];var shiftedDate=chronoshift_1.day.shift(firstDate,timezone,-1);weekPrependTo.unshift(shiftedDate)}return weekPrependTo}exports.prependDays=prependDays;function appendDays(timezone,weekAppendTo,countAppend){for(var i=0;i<countAppend;i++){var lastDate=weekAppendTo[weekAppendTo.length-1];var shiftedDate=chronoshift_1.day.shift(lastDate,timezone,1);weekAppendTo.push(shiftedDate)}return weekAppendTo}exports.appendDays=appendDays;function shiftOneDay(floored,timezone){return chronoshift_1.day.shift(floored,timezone,1)}exports.shiftOneDay=shiftOneDay;function datesEqual(d1,d2){if(!Boolean(d1)===Boolean(d2))return false;if(d1===d2)return true;return d1.valueOf()===d2.valueOf()}exports.datesEqual=datesEqual;function getWallTimeDay(date,timezone){return moment.tz(date,timezone.toString()).date()}exports.getWallTimeDay=getWallTimeDay;function getWallTimeMonthWithYear(date,timezone){return moment.tz(date,timezone.toString()).format("MMMM YYYY")}exports.getWallTimeMonthWithYear=getWallTimeMonthWithYear;function wallTimeInclusiveEndEqual(d1,d2,timezone){if(!Boolean(d1)===Boolean(d2))return false;if(d1===d2)return true;var d1InclusiveEnd=getEndWallTimeInclusive(d1,timezone);var d2InclusiveEnd=getEndWallTimeInclusive(d2,timezone);return d1InclusiveEnd.valueOf()===d2InclusiveEnd.valueOf()}exports.wallTimeInclusiveEndEqual=wallTimeInclusiveEndEqual;function getWallTimeString(date,timezone,includeTime,delimiter){var wallTimeISOString=moment.tz(date,timezone.toString()).format(FORMAT_ISOISH);if(includeTime){return wallTimeISOString.replace("T",delimiter||", ")}return wallTimeISOString.replace(/:\d\d/,"").split("T")[0]}exports.getWallTimeString=getWallTimeString;function formatTimeBasedOnGranularity(range,granularity,timezone){var wallTimeStart=moment.tz(range.start,timezone.toString());var granularityString=granularity.toJS();var unit=granularityString.substring(granularityString.length-1);switch(unit){case"S":return wallTimeStart.format("MMM D, hh:mm:ss");case"M":var prefix=granularityString.substring(0,2);return prefix==="PT"?wallTimeStart.format("MMM D, h:mma"):wallTimeStart.format("MMM, YYYY");case"H":return wallTimeStart.format("MMM D YYYY, ha");case"D":return wallTimeStart.format("MMM D, YYYY");case"W":return""+formatTimeRange(range,timezone,DisplayYear.ALWAYS);default:return wallTimeStart.format(FORMAT_ISOISH)}}exports.formatTimeBasedOnGranularity=formatTimeBasedOnGranularity;function isBoundaryTick(object){return object&&hasOwnProperty(object,"boundary")}exports.isBoundaryTick=isBoundaryTick;function formatAxisBasedOnRange(date,range,timezone){var time=moment.tz(date,timezone.toString());var length=range.end.valueOf()-range.start.valueOf();if(length<6*chronoshift_1.hour.canonicalLength){if(time.minute()===0)return time.format("hA");return time.format("hh:mm")}else if(length<3*chronoshift_1.day.canonicalLength){if(time.hour()===0)return{value:time.format("hA"),boundary:time.format("MMM DD")};return time.format("hA")}else if(length<6*chronoshift_1.day.canonicalLength){if(time.hour()===0)return time.format("MMM DD");return time.format("hh:mm")}else if(length<20*chronoshift_1.day.canonicalLength){if(time.date()===0)return{value:time.format("ddd DD"),boundary:time.format("MMMM")};return time.format("ddd DD")}else if(length<95*chronoshift_1.day.canonicalLength){return time.format("MMM DD")}else if(length<2*chronoshift_1.year.canonicalLength){if(time.month()===0)return{value:time.format("MMMM"),boundary:time.format("YYYY")};return time.format("MMM")}return time.format("MMM YYYY")}exports.formatAxisBasedOnRange=formatAxisBasedOnRange;function formatGranularity(granularity){return granularity.replace(/^PT?/,"")}exports.formatGranularity=formatGranularity},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DragManager=function(){function DragManager(){}DragManager.init=function(){document.addEventListener("dragend",function(){DragManager.dragOrigin=null;DragManager.dragDimension=null;DragManager.dragSplit=null},false)};DragManager.getDragOrigin=function(){return DragManager.dragOrigin};DragManager.setDragDimension=function(dimension,origin){DragManager.dragDimension=dimension;DragManager.dragOrigin=origin};DragManager.getDragDimension=function(){return DragManager.dragDimension};DragManager.setDragSplit=function(split,origin){DragManager.dragSplit=split;DragManager.dragOrigin=origin};DragManager.getDragSplit=function(){return DragManager.dragSplit};DragManager.dragOrigin=null;DragManager.dragDimension=null;DragManager.dragSplit=null;return DragManager}();exports.DragManager=DragManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);var strings_1=__webpack_require__(17);__webpack_require__(503);var QueryError=function(_super){tslib_1.__extends(QueryError,_super);function QueryError(){return _super.call(this)||this}QueryError.prototype.render=function(){var error=this.props.error;return React.createElement("div",{className:"query-error"},React.createElement("div",{className:"whiteout"}),React.createElement("div",{className:"error-container"},React.createElement("div",{className:"error"},strings_1.STRINGS.queryError),React.createElement("div",{className:"message"},error.message)))};return QueryError}(React.Component);exports.QueryError=QueryError},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__src_path__=__webpack_require__(548);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__src_path__["a"]})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return abs});__webpack_require__.d(__webpack_exports__,"d",function(){return atan2});__webpack_require__.d(__webpack_exports__,"e",function(){return cos});__webpack_require__.d(__webpack_exports__,"h",function(){return max});__webpack_require__.d(__webpack_exports__,"i",function(){return min});__webpack_require__.d(__webpack_exports__,"k",function(){return sin});__webpack_require__.d(__webpack_exports__,"l",function(){return sqrt});__webpack_require__.d(__webpack_exports__,"f",function(){return epsilon});__webpack_require__.d(__webpack_exports__,"j",function(){return pi});__webpack_require__.d(__webpack_exports__,"g",function(){return halfPi});__webpack_require__.d(__webpack_exports__,"m",function(){return tau});__webpack_exports__["b"]=acos;__webpack_exports__["c"]=asin;var abs=Math.abs;var atan2=Math.atan2;var cos=Math.cos;var max=Math.max;var min=Math.min;var sin=Math.sin;var sqrt=Math.sqrt;var epsilon=1e-12;var pi=Math.PI;var halfPi=pi/2;var tau=2*pi;function acos(x){return x>1?0:x<-1?pi:Math.acos(x)}function asin(x){return x>=1?halfPi:x<=-1?-halfPi:Math.asin(x)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(series,order){if(!((n=series.length)>1))return;for(var i=1,j,s0,s1=series[order[0]],n,m=s1.length;i<n;++i){s0=s1,s1=series[order[i]];for(j=0;j<m;++j){s1[j][1]+=s1[j][0]=isNaN(s0[j][1])?s0[j][0]:s0[j][1]}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(series){var n=series.length,o=new Array(n);while(--n>=0)o[n]=n;return o}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var Theme=function(_super){tslib_1.__extends(Theme,_super);function Theme(parameters){return _super.call(this,parameters)||this}Theme.addToPalette=function(name,theme){Theme.palette[name]=theme;Theme.themes.push(name)};Theme.isTheme=function(candidate){return candidate instanceof Theme};Theme.toNameOrJS=function(theme){if(typeof theme==="string")return theme;return theme.toJS()};Theme.fromNameOrJS=function(theme){if(typeof theme==="string")return theme;return Theme.fromJS(theme)};Theme.fromJS=function(parameters){if(!parameters||typeof parameters==="string")return parameters;return new Theme(immutable_class_1.BaseImmutable.jsToValue(Theme.PROPERTIES,parameters))};Theme.getEffectiveTheme=function(theme,defaultTheme){if(defaultTheme===void 0){defaultTheme=Theme.DEFAULT}if(!theme)return defaultTheme;if(typeof theme==="string")return Theme.palette[theme]||defaultTheme;return theme};Theme.DEFAULT_NAME="imply";Theme.palette={};Theme.themes=[Theme.DEFAULT_NAME];Theme.PROPERTIES=[{name:"mainColor",defaultValue:"#30a4e6"},{name:"pillColor",defaultValue:"#d1eedc"},{name:"backgroundColor",defaultValue:"#e4e4e4"}];return Theme}(immutable_class_1.BaseImmutable);exports.Theme=Theme;immutable_class_1.BaseImmutable.finalize(Theme);Theme.DEFAULT=new Theme({});Theme.addToPalette("green",new Theme({mainColor:"#3db76b",pillColor:"#d1eedc",backgroundColor:"#e0e7e2"}));Theme.addToPalette("racing-green",new Theme({mainColor:"#117051",pillColor:"#c6ddd5",backgroundColor:"#dfe6e3"}));Theme.addToPalette("pink",new Theme({mainColor:"#d95dac",pillColor:"#f6d8eb",backgroundColor:"#efe9ec"}));Theme.addToPalette("lilach",new Theme({mainColor:"#a178d8",pillColor:"#e8dff6",backgroundColor:"#e8e6ea"}));Theme.addToPalette("turquoise",new Theme({mainColor:"#0ab4bb",pillColor:"#c4edef",backgroundColor:"#dee5e7"}));Theme.addToPalette("tangerine",new Theme({mainColor:"#dc7514",pillColor:"#f7e9b1",backgroundColor:"#e9e4de"}));Theme.addToPalette("earth",new Theme({mainColor:"#8c6d5c",pillColor:"#d1e5ec",backgroundColor:"#e4dfdc"}));Theme.addToPalette("teal",new Theme({mainColor:"#3c90af",pillColor:"#d1e5ec",backgroundColor:"#dce1e3"}));Theme.addToPalette("red",new Theme({mainColor:"#d04747",pillColor:"#f4d3d3",backgroundColor:"#e8e1e1"}));Theme.addToPalette("dark",new Theme({mainColor:"#404040",pillColor:"#c6d9e3",backgroundColor:"#E4E4E4"}));Theme.addToPalette("night",new Theme({mainColor:"#3f3d81",pillColor:"#d1d1e1",backgroundColor:"#e1e1e5"}))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var immutable_class_1=__webpack_require__(7);var numeral=__webpack_require__(388);var plywood_1=__webpack_require__(14);function formatFnFactory(format){return function(n){if(isNaN(n)||!isFinite(n))return"-";return numeral(n).format(format)}}var Measure=function(_super){tslib_1.__extends(Measure,_super);function Measure(parameters){var _this=_super.call(this,parameters)||this;_this.title=_this.title||beltful_1.StringUtils.makeTitle(_this.name);_this.expression=plywood_1.Expression.parse(_this.formula);_this.formatFn=formatFnFactory(_this.getFormat());_this.companionExpression=_this.companion?plywood_1.Expression.parse(_this.companion):null;return _this}Measure.isMeasure=function(candidate){return candidate instanceof Measure};Measure.getMeasure=function(measures,measureName){if(!measureName)return null;return immutable_class_1.NamedArray.findByNameCI(measures,measureName)};Measure.measuresFromAttribute=function(attribute){var name=attribute.name,type=attribute.type,nativeType=attribute.nativeType,maker=attribute.maker;var $main=plywood_1.$("main");var ref=plywood_1.$(name);if(name==="count"||maker&&maker.op==="count"){return[new Measure({name:beltful_1.StringUtils.makeUrlSafeName(name),title:beltful_1.StringUtils.makeTitle(name),formula:$main.sum(ref).toString()})]}else if(nativeType==="hyperUnique"||nativeType==="thetaSketch"){return[new Measure({name:beltful_1.StringUtils.makeUrlSafeName("cd_"+name),title:beltful_1.StringUtils.makeTitle(name)+(nativeType==="thetaSketch"?" Unique":""),formula:$main.countDistinct(ref).toString()})]}else if(nativeType==="approximateHistogram"){return[new Measure({name:beltful_1.StringUtils.makeUrlSafeName(name+"_p98"),title:beltful_1.StringUtils.makeTitle(name)+" 98th %tile",formula:$main.quantile(ref,.98).toString()})]}else if(type==="NUMBER"){var expression=$main.sum(ref);var agg="sum";if(maker){agg=maker.op;switch(maker.op){case"min":expression=$main.min(ref);break;case"max":expression=$main.max(ref);break}}return[new Measure({name:beltful_1.StringUtils.makeUrlSafeName(agg+"_"+name),title:agg==="sum"?beltful_1.StringUtils.makeTitle(name):null,formula:expression.toString()})]}else{return[]}};Measure.fromJS=function(parameters){if(!parameters.formula){var parameterExpression=parameters.expression;parameters.formula=typeof parameterExpression==="string"?parameterExpression:plywood_1.$("main").sum(plywood_1.$(parameters.name)).toString()}return new Measure(immutable_class_1.BaseImmutable.jsToValue(Measure.PROPERTIES,parameters))};Measure.prototype.toApplyAction=function(nestLevel){var _a=this,name=_a.name,expression=_a.expression,transform=_a.transform;var hiddenName="_"+name;var ex;switch(transform){case"percent-of-parent":ex=plywood_1.Expression._.apply(hiddenName,expression);if(nestLevel>0){ex=ex.apply(name,plywood_1.$(hiddenName).divide(plywood_1.$(hiddenName,1)).multiply(100))}else{}break;case"percent-of-root":ex=plywood_1.Expression._.apply(hiddenName,expression);if(nestLevel>0){ex=ex.apply(name,plywood_1.$(hiddenName).divide(plywood_1.$(hiddenName,nestLevel)).multiply(100))}else{ex=ex.apply(name,100)}break;default:ex=plywood_1.Expression._.apply(name,expression);var companionExpression=this.companionExpression;if(companionExpression){ex=ex.apply(this.getCompanionName(),companionExpression)}break}return ex};Measure.prototype.toInvisibleRootApplyAction=function(){if(this.getTransform()==="none")return null;var _a=this,name=_a.name,expression=_a.expression;var hiddenName="_"+name;return plywood_1.Expression._.apply(hiddenName,expression)};Measure.prototype.formatDatum=function(datum){return datum?this.formatFn(datum[this.name]):null};Measure.prototype.formatCompanion=function(datum){var cn=this.getCompanionName();return datum&&cn?this.formatFn(datum[cn]):null};Measure.prototype.formatDatumWithCompanion=function(datum){var fd=this.formatDatum(datum);if(!fd)return null;var cp=this.formatCompanion(datum);return fd+(cp?" ("+cp+")":"")};Measure.prototype.getCompanionName=function(){return this.companion?this.name+"_c":null};Measure.prototype.getTitleWithUnits=function(){if(this.units){return this.title+" ("+this.units+")"}else{return this.title}};Measure.prototype.usesAttribute=function(attributeName){return this.expression.some(function(ex,index,depth,nestDiff){if(nestDiff>0&&ex instanceof plywood_1.RefExpression){return ex.name===attributeName}else{return null}})};Measure.prototype.guessName=function(){return this.formula.replace(/main/g,"").replace(/\W/g,"").substr(0,7)||"met"};Measure.prototype.guessTitle=function(){return beltful_1.StringUtils.makeTitle(this.name)};Measure.TRANSFORM_VALUES=["none","percent-of-parent","percent-of-root"];Measure.DEFAULT_TRANSFORM="none";Measure.DEFAULT_FORMAT="0,0.0 a";Measure.INTEGER_FORMAT="0,0 a";Measure.PROPERTIES=[{name:"name",validate:beltful_1.StringUtils.verifyUrlSafeName},{name:"title",defaultValue:null},{name:"group",defaultValue:null},{name:"units",defaultValue:null},{name:"formula"},{name:"transform",defaultValue:Measure.DEFAULT_TRANSFORM,possibleValues:Measure.TRANSFORM_VALUES},{name:"format",defaultValue:Measure.DEFAULT_FORMAT},{name:"companion",defaultValue:null}];return Measure}(immutable_class_1.BaseImmutable);exports.Measure=Measure;immutable_class_1.BaseImmutable.finalize(Measure);Measure.SIMPLE_COUNT=new Measure({name:"default_count",title:"Default Count",formula:"$main.count()"})},function(module,__webpack_exports__,__webpack_require__){"use strict";function Linear(context){this._context=context}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(x,y){x=+x,y=+y;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:this._context.lineTo(x,y);break}}};__webpack_exports__["a"]=function(context){return new Linear(context)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(){}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["c"]=point;__webpack_exports__["a"]=Basis;function point(that,x,y){that._context.bezierCurveTo((2*that._x0+that._x1)/3,(2*that._y0+that._y1)/3,(that._x0+2*that._x1)/3,(that._y0+2*that._y1)/3,(that._x0+4*that._x1+x)/6,(that._y0+4*that._y1+y)/6)}function Basis(context){this._context=context}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){switch(this._point){case 3:point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(x,y){x=+x,y=+y;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3;this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point(this,x,y);break}this._x0=this._x1,this._x1=x;this._y0=this._y1,this._y1=y}};__webpack_exports__["b"]=function(context){return new Basis(context)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["c"]=point;__webpack_exports__["a"]=Cardinal;function point(that,x,y){that._context.bezierCurveTo(that._x1+that._k*(that._x2-that._x0),that._y1+that._k*(that._y2-that._y0),that._x2+that._k*(that._x1-x),that._y2+that._k*(that._y1-y),that._x2,that._y2)}function Cardinal(context,tension){this._context=context;this._k=(1-tension)/6}Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point(this,this._x1,this._y1);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(x,y){x=+x,y=+y;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;this._x1=x,this._y1=y;break;case 2:this._point=3;default:point(this,x,y);break}this._x0=this._x1,this._x1=this._x2,this._x2=x;this._y0=this._y1,this._y1=this._y2,this._y2=y}};__webpack_exports__["b"]=function custom(tension){function cardinal(context){return new Cardinal(context,tension)}cardinal.tension=function(tension){return custom(+tension)};return cardinal}(0)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var beltful_1=__webpack_require__(8);function setProperty(instance,path,newValue){var bits=path.split(".");var lastObject=newValue;var currentObject;var getLastObject=function(){var o=instance;for(var i=0;i<bits.length;i++){o=o[bits[i]]}return o};while(bits.length){var bit=bits.pop();currentObject=getLastObject();if(currentObject.change instanceof Function){lastObject=currentObject.change(bit,lastObject)}else{var message="Can't find `change()` method on "+currentObject.constructor.name;console.error(message);throw new Error(message)}}return lastObject}exports.setProperty=setProperty;function getProperty(instance,path){var value=instance;var bits=path.split(".");var bit;while(bit=bits.shift()){if(!value)return null;var specializedGetterName="get"+beltful_1.StringUtils.firstUp(bit);var specializedGetter=value[specializedGetterName];value=specializedGetter?specializedGetter.call(value):value.get?value.get(bit):value[bit]}return value}exports.getProperty=getProperty;function getLabel(name,labels){var bits=name.split(".");var label=labels[bits.shift()];while(bits.length&&label){label=label[bits.shift()]}return label||{label:"",description:""}}exports.getLabel=getLabel},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var tile_header_1=__webpack_require__(433);__webpack_require__(592);var SearchableTile=function(_super){tslib_1.__extends(SearchableTile,_super);function SearchableTile(){var _this=_super.call(this)||this;_this.state={actionsMenuOpenOn:null};_this.globalMouseDownListener=_this.globalMouseDownListener.bind(_this);_this.onEscape=_this.onEscape.bind(_this);return _this}SearchableTile.prototype.componentDidMount=function(){this.mounted=true;this.setState({actionsMenuAlignOn:ReactDOM.findDOMNode(this.refs["header"])});window.addEventListener("mousedown",this.globalMouseDownListener)};SearchableTile.prototype.componentWillUnmount=function(){this.mounted=false;window.removeEventListener("mousedown",this.globalMouseDownListener)};SearchableTile.prototype.globalMouseDownListener=function(e){var _a=this.props,searchText=_a.searchText,toggleChangeFn=_a.toggleChangeFn;if(searchText!=="")return;var target=e.target;var searchBoxElement=ReactDOM.findDOMNode(this.refs["search-box"]);if(!searchBoxElement||beltful_1.DOMUtils.isInside(target,searchBoxElement))return;var headerRef=this.refs["header"];if(!headerRef)return;var searchButtonElement=ReactDOM.findDOMNode(headerRef.refs["search"]);if(!searchButtonElement||beltful_1.DOMUtils.isInside(target,searchButtonElement))return;toggleChangeFn()};SearchableTile.prototype.onEscape=function(e){var _a=this.props,toggleChangeFn=_a.toggleChangeFn,showSearch=_a.showSearch;if(!showSearch)return;toggleChangeFn()};SearchableTile.prototype.onActionsMenuClose=function(){var actionsMenuOpenOn=this.state.actionsMenuOpenOn;if(!actionsMenuOpenOn)return;this.setState({actionsMenuOpenOn:null})};SearchableTile.prototype.onActionsMenuClick=function(e){var actionsMenuOpenOn=this.state.actionsMenuOpenOn;if(actionsMenuOpenOn)return this.onActionsMenuClose();this.setState({actionsMenuOpenOn:e.target})};SearchableTile.prototype.onSelectGranularity=function(action){this.onActionsMenuClose();action.onClick()};SearchableTile.prototype.renderGranularityElements=function(){var _this=this;var actions=this.props.actions;return actions.map(function(action,i){return React.createElement("li",{className:classNames({selected:action.selected}),key:i,onClick:_this.onSelectGranularity.bind(_this,action)},action.label||action.toString())})};SearchableTile.prototype.renderActionsMenu=function(){var _a=this.state,actionsMenuOpenOn=_a.actionsMenuOpenOn,actionsMenuAlignOn=_a.actionsMenuAlignOn;var stage=beltful_1.Stage.fromSize(180,200);return React.createElement(caladan_1.BubbleMenu,{align:"end",className:"dimension-tile-actions",direction:"down",stage:stage,onClose:this.onActionsMenuClose.bind(this),openOn:actionsMenuOpenOn,alignOn:actionsMenuAlignOn},React.createElement("ul",{className:"bubble-list"},this.renderGranularityElements()))};SearchableTile.prototype.render=function(){var _a=this.props,className=_a.className,style=_a.style,icons=_a.icons,title=_a.title,onSearchChange=_a.onSearchChange,showSearch=_a.showSearch,searchText=_a.searchText,children=_a.children,onDragStart=_a.onDragStart,actions=_a.actions;var actionsMenuOpenOn=this.state.actionsMenuOpenOn;var tileIcons=icons;if(actions&&actions.length>0){tileIcons=[{name:"more",ref:"more",onClick:this.onActionsMenuClick.bind(this),svg:little_pictures_1.FULL_MORE,active:Boolean(actionsMenuOpenOn)}].concat(icons)}var qualifiedClassName="searchable-tile "+className;var header=React.createElement(tile_header_1.TileHeader,{title:title,ref:"header",icons:tileIcons,onDragStart:onDragStart});var searchBar=null;if(showSearch){searchBar=React.createElement("div",{className:"search-box",ref:"search-box"},React.createElement(caladan_1.ClearableInput,{placeholder:"Search",focusOnMount:true,value:searchText,onChange:onSearchChange.bind(this)}))}qualifiedClassName=classNames(qualifiedClassName,showSearch?"has-search":"no-search");return React.createElement("div",{className:qualifiedClassName,style:style},React.createElement(caladan_1.GlobalEventListener,{escape:this.onEscape.bind(this)}),header,searchBar,actionsMenuOpenOn?this.renderActionsMenu():null,children)};return SearchableTile}(React.Component);exports.SearchableTile=SearchableTile},,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var chronoshift_1=__webpack_require__(23);var numeral=__webpack_require__(388);var plywood_1=__webpack_require__(14);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var time_1=__webpack_require__(109);var scales={a:{"":1,k:1e3,m:1e6,b:1e9,t:1e12},b:{B:1,KB:1e3,MB:1e6,GB:1e9,TB:1e12,PB:1e15,EB:1e18,ZB:1e21,YB:1e24},ib:{B:1,KiB:1024,MiB:1024*1024,GiB:1024*1024*1024,TiB:1024*1024*1024*1024,PiB:1024*1024*1024*1024*1024,EiB:1024*1024*1024*1024*1024*1024,ZiB:1024*1024*1024*1024*1024*1024*1024,YiB:1024*1024*1024*1024*1024*1024*1024*1024}};function getMiddleNumber(values){var filteredAbsData=[];for(var _i=0,values_1=values;_i<values_1.length;_i++){var v=values_1[_i];if(v===0||isNaN(v)||!isFinite(v))continue;filteredAbsData.push(Math.abs(v))}var n=filteredAbsData.length;if(n){filteredAbsData.sort(function(a,b){return b-a});return filteredAbsData[Math.ceil((n-1)/2)]}else{return 0}}exports.getMiddleNumber=getMiddleNumber;function formatterFromData(values,format){var match=format.match(/^(\S*)( ?)(a|b|ib)$/);if(match){var numberFormat_1=match[1];var space=match[2];var formatType=match[3];var middle=getMiddleNumber(values);var formatMiddle=numeral(middle).format("0 "+formatType);var unit=formatMiddle.split(" ")[1]||"";var scale_1=scales[formatType][unit];var append_1=unit?space+unit:"";return function(n){if(isNaN(n)||!isFinite(n))return"-";return numeral(n/scale_1).format(numberFormat_1)+append_1}}else{return function(n){if(isNaN(n)||!isFinite(n))return"-";return numeral(n).format(format)}}}exports.formatterFromData=formatterFromData;function formatNumberRange(value){var s=value.start!=null?String(value.start):strings_1.STRINGS.any;var e=value.end!=null?String(value.end):strings_1.STRINGS.any;return s+" to "+e}exports.formatNumberRange=formatNumberRange;function formatValue(value,timezone,displayYear){if(plywood_1.NumberRange.isNumberRange(value)){return formatNumberRange(value)}else if(plywood_1.TimeRange.isTimeRange(value)){return time_1.formatTimeRange(value,timezone,displayYear)}else{return""+value}}exports.formatValue=formatValue;function formatFilterClause(dimension,clause,timezone,verbose){var _a=this.getFormattedClause(dimension,clause,timezone,verbose),title=_a.title,values=_a.values;return title?title+" "+values:values}exports.formatFilterClause=formatFilterClause;function getFormattedClause(dimension,clause,timezone,verbose){var dimType=dimension.getType();var values;var clauseSet=clause.getLiteralSet();function getClauseLabel(){var dimTitle=dimension.title;if(dimType==="TIME"&&!verbose)return"";var delimiter=["regex","contains"].includes(clause.getAction())?" ~":":";if(clauseSet&&clauseSet.elements.length>1&&!verbose)return""+dimTitle;return""+dimTitle+delimiter}switch(dimType){case"NULL":case"BOOLEAN":case"NUMBER":case"STRING":case"SET/BOOLEAN":case"SET/NUMBER":case"SET/STRING":var action=clause.getAction();if(action==="overlap"){if(verbose){values=clauseSet.toString()}else{var setElements=clauseSet.elements;if(setElements.length>1){values="("+setElements.length+")"}else{values=formatValue(setElements[0])}}}else if(action==="match"){values="/"+clause.search+"/"}else if(action===models_1.Filter.CONTAINS){values='"'+clause.search+'"'}break;case"TIME":if(clause.dynamic){values=getLabelForRelativeSelection(clause.dynamic)}else{var selection=clause.values;var elements=selection.elements;if(elements.length===1){var timeRange=elements[0];if(timeRange instanceof plywood_1.TimeRange){values=time_1.formatTimeRange(timeRange,timezone,time_1.DisplayYear.IF_DIFF)}else{values=clauseSet.toString()}}else{values=elements.length+" time ranges"}}break;default:throw new Error("unknown type "+dimType)}return{title:getClauseLabel(),values:values}}exports.getFormattedClause=getFormattedClause;function getLabelForRelativeSelection(expression){var op=expression.getHeadOperand();if(!(expression instanceof plywood_1.TimeRangeExpression)&&!(expression instanceof plywood_1.TimeBucketExpression)){return expression.toString()}var duration=expression.duration;var durationStr=expression instanceof plywood_1.TimeRangeExpression?expression.getQualifiedDurationDescription():duration.getDescription(false);if(duration.equals(chronoshift_1.Duration.fromJS("P3M")))durationStr=strings_1.STRINGS.quarter;var isNegativeRange=expression instanceof plywood_1.TimeRangeExpression&&expression.step<0;var refIsNow=op.equals(models_1.FilterClause.$now);if(op.equals(models_1.FilterClause.$maxTime)&&isNegativeRange){return strings_1.STRINGS.latest+" "+durationStr}else if(refIsNow&&isNegativeRange){return strings_1.STRINGS.previous+" "+durationStr}else if(refIsNow&&expression instanceof plywood_1.TimeBucketExpression){return strings_1.STRINGS.current+" "+durationStr}return expression.toString()}exports.getLabelForRelativeSelection=getLabelForRelativeSelection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var AccessList=function(_super){tslib_1.__extends(AccessList,_super);function AccessList(parameters){var _this=_super.call(this,parameters)||this;if(_this.access==="specific"&&!_this.users)_this.users=[];return _this}AccessList.isAccessList=function(candidate){return candidate instanceof AccessList};AccessList.onlyFor=function(userName){return new AccessList({access:"single",users:[userName]})};AccessList.fromJS=function(parameters){return new AccessList(immutable_class_1.BaseImmutable.jsToValue(AccessList.PROPERTIES,parameters))};AccessList.prototype.hasAccess=function(user){var _a=this,access=_a.access,users=_a.users;if(user.isSuperAdmin())return true;if(access==="all")return true;return users.includes(user.name)};AccessList.prototype.isOnly=function(userName){return this.isSingle()&&this.users[0]===userName};AccessList.prototype.isAll=function(){return this.access==="all"};AccessList.prototype.isSingle=function(){return this.access==="single"};AccessList.prototype.isSpecific=function(){return this.access==="specific"};AccessList.prototype.changeUsers=function(users){var value=this.valueOf();value.users=users;return new AccessList(value)};AccessList.prototype.toggle=function(userName){var users=this.users;if(!this.isSpecific())throw new Error("Cannot toggle an user in "+this.access+" mode");if(users.includes(userName)){return this.changeUsers(users.filter(function(u){return u!==userName}))}else{return this.changeUsers(users.concat([userName]))}};AccessList.ACCESS_VALUES=["all","specific","single"];AccessList.PROPERTIES=[{name:"access",possibleValues:AccessList.ACCESS_VALUES},{name:"users",type:immutable_class_1.PropertyType.ARRAY}];return AccessList}(immutable_class_1.BaseImmutable);exports.AccessList=AccessList;immutable_class_1.BaseImmutable.finalize(AccessList);AccessList.ALL=new AccessList({access:"all"})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var chronoshift_1=__webpack_require__(23);var hasOwnProperty=__webpack_require__(29);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var dimension_1=__webpack_require__(107);var filter_clause_1=__webpack_require__(75);var filter_1=__webpack_require__(53);var measure_1=__webpack_require__(177);var splits_1=__webpack_require__(36);var instances_1=__webpack_require__(389);var theme_1=__webpack_require__(176);var access_list_1=__webpack_require__(187);var general_1=__webpack_require__(43);function formatTimeDiff(diff){diff=Math.round(Math.abs(diff)/1e3);if(diff<60)return"less than 1 minute";diff=Math.floor(diff/60);if(diff===1)return"1 minute";if(diff<60)return diff+" minutes";diff=Math.floor(diff/60);if(diff===1)return"1 hour";if(diff<=24)return diff+" hours";diff=Math.floor(diff/24);return diff+" days"}function checkUnique(dimensions,measures,dataCubeName){var seenDimensions={};var seenMeasures={};if(dimensions){dimensions.forEach(function(d){var dimensionName=d.name.toLowerCase();if(seenDimensions[dimensionName]){throw new Error("duplicate dimension name '"+d.name+"' found in data cube: '"+dataCubeName+"'")}seenDimensions[dimensionName]=d})}if(measures){measures.forEach(function(m){var measureName=m.name.toLowerCase();if(seenMeasures[measureName]){throw new Error("duplicate measure name '"+m.name+"' found in data cube: '"+dataCubeName+"'")}if(seenDimensions[measureName]){throw new Error("name '"+m.name+"' found in both dimensions and measures in data cube: '"+dataCubeName+"'")}seenMeasures[measureName]=m})}}var INTERESTING_NATIVE_TYPE={__time:true,approximateHistogram:true,hyperUnique:true,thetaSketch:true};function measuresFromLongForm(longForm){var metricColumn=longForm.metricColumn,measures=longForm.measures,possibleAggregates=longForm.possibleAggregates;var myPossibleAggregates={};for(var agg in possibleAggregates){if(!hasOwnProperty(possibleAggregates,agg))continue;myPossibleAggregates[agg]=plywood_1.Expression.fromJSLoose(possibleAggregates[agg])}return measures.map(function(measure){if(hasOwnProperty(measure,"name")){return measure_1.Measure.fromJS(measure)}var title=measure.title;if(!title){throw new Error("must have title in longForm value")}var value=measure.value;var aggregate=measure.aggregate;if(!aggregate){throw new Error("must have aggregates in longForm value")}var myExpression=myPossibleAggregates[aggregate];if(!myExpression)throw new Error("can not find aggregate "+aggregate+" for value "+value);var name=beltful_1.StringUtils.makeUrlSafeName(aggregate+"_"+value);return new measure_1.Measure({name:name,title:title,units:measure.units,formula:myExpression.substitute(function(ex){if(ex instanceof plywood_1.RefExpression&&ex.name==="filtered"){return plywood_1.$("main").filter(plywood_1.$(metricColumn).is(plywood_1.r(value)))}return null}).toString()})})}function filterFromLongForm(longForm){var metricColumn=longForm.metricColumn,measures=longForm.measures;var values=[];for(var _i=0,measures_1=measures;_i<measures_1.length;_i++){var measure=measures_1[_i];if(hasOwnProperty(measure,"aggregate"))values.push(measure.value)}return plywood_1.$(metricColumn).in(values).simplify()}var DataCube=function(_super){tslib_1.__extends(DataCube,_super);function DataCube(parameters){var _this=_super.call(this,parameters)||this;var _a=_this,name=_a.name,dimensions=_a.dimensions,measures=_a.measures;if(typeof name!=="string")throw new Error("Data cube must have a name");if(!_this.source)_this.source=name;_this.subsetExpression=parameters.subsetFormula?plywood_1.Expression.fromJSLoose(parameters.subsetFormula):plywood_1.Expression.TRUE;checkUnique(dimensions,measures,name);return _this}DataCube.isDataCube=function(candidate){return candidate instanceof DataCube};DataCube.getPossibleTimeDimension=function(dimensions){for(var _i=0,dimensions_1=dimensions;_i<dimensions_1.length;_i++){var dimension=dimensions_1[_i];if(dimension.expression.equals(plywood_1.$("__time")))return dimension.name}for(var _a=0,dimensions_2=dimensions;_a<dimensions_2.length;_a++){var dimension=dimensions_2[_a];if(dimension.type==="TIME")return dimension.name}return DataCube.NO_SPECIAL_TIME_DIMENSION};DataCube.putSpecialTimeOnTop=function(attributes){var specialAttr=immutable_class_1.NamedArray.findByName(attributes,"__time");if(!specialAttr)return attributes;return[specialAttr].concat(attributes.filter(function(a){return a.name!=="__time"}))};DataCube.suggestDimensions=function(attributes){return DataCube.putSpecialTimeOnTop(attributes).map(function(attribute){if(attribute.name==="count"||attribute.unsplitable)return null;var name=attribute.name,type=attribute.type;return new dimension_1.Dimension({name:beltful_1.StringUtils.makeUrlSafeName(name),type:type||"STRING",formula:plywood_1.$(name).toString()})}).filter(Boolean)};DataCube.suggestMeasures=function(attributes){if(!attributes)return[];var measures=[];var countFound=false;for(var _i=0,attributes_1=attributes;_i<attributes_1.length;_i++){var attribute=attributes_1[_i];var newMeasures=measure_1.Measure.measuresFromAttribute(attribute);newMeasures.forEach(function(newMeasure){if(newMeasure.name==="count"||newMeasure.name==="sum_count"){countFound=true;measures.unshift(newMeasure)}else{measures.push(newMeasure)}})}if(!countFound){measures.unshift(new measure_1.Measure({name:"count",title:"Number of Events",formula:"$main.count()"}))}return measures};DataCube.fromClusterAndSource=function(name,cluster,source){return DataCube.fromJS({name:name,title:beltful_1.StringUtils.makeTitle(source),clusterName:cluster.name,source:source})};DataCube.fromJS=function(parameters){var clusterName=parameters.clusterName||parameters.engine;var refreshTimeWith=parameters.refreshTimeWith;var options=parameters.options;var unprocessedDimensionsJSs=parameters.dimensions||[];var actuallyAttributes=unprocessedDimensionsJSs.filter(function(d){return d.unsplitable}).map(function(d){var attributeJS={name:d.name,type:"NUMBER",maker:d.maker,unsplitable:true};if(d.special){attributeJS.special=d.special;attributeJS.type="NULL"}return plywood_1.AttributeInfo.fromJS(attributeJS)});var dimensions=unprocessedDimensionsJSs.filter(function(d){return!d.unsplitable}).map(function(d){return dimension_1.Dimension.fromJS(d)});var measures=(parameters.measures||[]).map(function(m){return measure_1.Measure.fromJS(m)});var attributeJSs=parameters.attributes||actuallyAttributes;attributeJSs.forEach(function(attributeJS){if(attributeJS.type==="STRING"&&attributeJS.unsplitable&&!attributeJS.nativeType){attributeJS.type=attributeJS.special?"NULL":"NUMBER"}});var attributes=plywood_1.AttributeInfo.fromJSs(attributeJSs);var attributeOverrides=parameters.attributeOverrides||(parameters.options||{}).attributeOverrides;if(attributeOverrides){attributes=plywood_1.AttributeInfo.override(attributes,plywood_1.AttributeInfo.fromJSs(attributeOverrides));if((parameters.options||{}).attributeOverrides){delete parameters.options["attributeOverrides"]}}var specialTimeDimension=parameters.specialTimeDimension||parameters.specialTimeAttribute||parameters.realTimeAttribute||parameters.primaryTimeAttribute;if(!specialTimeDimension&&parameters.timeAttribute&&parameters.timeAttribute!=="__time"){specialTimeDimension=parameters.timeAttribute;if(!options)options={};options.druidTimeAttributeName=specialTimeDimension}if(!specialTimeDimension){var firstDimension=dimensions[0];if(firstDimension&&firstDimension.name==="__time"&&firstDimension.type!=="TIME"){dimensions[0]=firstDimension.changeType("TIME")}specialTimeDimension=DataCube.getPossibleTimeDimension(dimensions)}if(!refreshTimeWith&&parameters.refreshRule){refreshTimeWith=parameters.refreshRule.rule==="query"?"query":"predefined";if(parameters.refreshRule.time){if(!options)options={};options.fixedMaxTime=parameters.refreshRule.time}}var enforceTimeFilter=parameters.enforceTimeFilter;if(typeof enforceTimeFilter==="undefined"){enforceTimeFilter=specialTimeDimension!==DataCube.NO_SPECIAL_TIME_DIMENSION}var subsetFormula=parameters.subsetFormula||parameters.subsetFilter;var longForm=parameters.longForm;if(longForm){measures=measures.concat(measuresFromLongForm(longForm));if(longForm.addSubsetFilter){var subsetExpression=subsetFormula?plywood_1.Expression.fromJSLoose(parameters.subsetFormula):plywood_1.Expression.TRUE;subsetFormula=JSON.stringify(subsetExpression.and(filterFromLongForm(longForm)).simplify())}}var value={name:parameters.name,title:parameters.title,description:parameters.description,clusterName:clusterName,source:parameters.source,group:parameters.group,theme:parameters.theme,subsetFormula:subsetFormula,rollup:parameters.rollup,options:options,readAccess:parameters.readAccess?access_list_1.AccessList.fromJS(parameters.readAccess):null,modifyAccess:parameters.modifyAccess?access_list_1.AccessList.fromJS(parameters.modifyAccess):null,attributes:attributes,dimensions:dimensions,measures:measures,instances:parameters.instances?instances_1.Instances.fromJS(parameters.instances):null,specialTimeDimension:specialTimeDimension,enforceTimeFilter:enforceTimeFilter,defaultTimezone:parameters.defaultTimezone?chronoshift_1.Timezone.fromJS(parameters.defaultTimezone):null,defaultFilter:parameters.defaultFilter?filter_1.Filter.fromJS(parameters.defaultFilter):null,defaultSplits:parameters.defaultSplits?splits_1.Splits.fromJS(parameters.defaultSplits):null,defaultDuration:parameters.defaultDuration?chronoshift_1.Duration.fromJS(parameters.defaultDuration):null,defaultSortMeasure:parameters.defaultSortMeasure,defaultSelectedMeasures:parameters.defaultSelectedMeasures,defaultPinnedDimensions:parameters.defaultPinnedDimensions,defaultRefreshRate:parameters.defaultRefreshRate?chronoshift_1.Duration.fromJS(parameters.defaultRefreshRate):null,refreshTimeWith:refreshTimeWith};return new DataCube(value)};DataCube.prototype.toExternal=function(cluster,instance,requester){if(this.clusterName==="native")throw new Error("there is no external on a native data cube");var options=this.getOptions();var clusterType=cluster.type;var subsetFilter=this.subsetExpression;if(this.instances){subsetFilter=subsetFilter.and(this.instances.getFilterFor(instance))}var attributesAndDerivedAttributes=this.getEffectiveAttributesAndDerivedAttributes();var externalValue={engine:clusterType,suppress:true,source:this.source,version:cluster.version,customAggregations:options.customAggregations,customTransforms:options.customTransforms,attributes:attributesAndDerivedAttributes.attributes,derivedAttributes:attributesAndDerivedAttributes.derivedAttributes,filter:subsetFilter};if(requester){externalValue.requester=requester}if(clusterType==="druid"||clusterType==="druidsql"){externalValue.rollup=this.rollup;externalValue.introspectionStrategy=cluster.getIntrospectionStrategy();externalValue.allowSelectQueries=true;externalValue.allowEternity=!this.hasMandatoryTimeFilter();externalValue.exactResultsOnly=Boolean(options.exactResultsOnly);if(options.druidTimeAttributeName){externalValue.timeAttribute=options.druidTimeAttributeName}var externalContext=options.druidContext||{};externalContext["timeout"]=cluster.getTimeout();if(options.priority)externalContext["priority"]=options.priority;externalValue.context=externalContext}return plywood_1.External.fromValue(externalValue)};DataCube.prototype.validateFilterFormula=function(formula){var formulaExpr=plywood_1.Expression.parse(formula);if(formulaExpr instanceof plywood_1.LiteralExpression){if(formulaExpr.type==="BOOLEAN")return true;throw new Error("must be a boolean")}return true};DataCube.prototype.validateMeasureFormula=function(formula){var measureExpression=plywood_1.Expression.parse(formula);if(!measureExpression.getFreeReferences().includes("main")){throw new Error("Measure formula must contain a $main reference")}return true};DataCube.prototype.getClusterType=function(clusterTypes){var clusterName=this.clusterName;if(clusterName==="native")return"native";if(!clusterTypes)return null;return clusterTypes[clusterName]||null};DataCube.prototype.getMaxTimeQuery=function(){if(this.getRefreshTimeWith()!=="query")return null;var specialTimeDimension=this.getSpecialTimeDimensionObject();if(!specialTimeDimension)return null;return plywood_1.$("main").max(specialTimeDimension.expression)};DataCube.prototype.getMaxTime=function(timekeeper){var name=this.name;var refreshTimeWith=this.getRefreshTimeWith();if(refreshTimeWith==="query"){return timekeeper.getTime(name)}else{return new Date(this.getOptions().fixedMaxTime||timekeeper.now())}};DataCube.prototype.updatedText=function(timekeeper,timezone){var refreshTimeWith=this.getRefreshTimeWith();if(refreshTimeWith==="query"){var maxTime=this.getMaxTime(timekeeper);if(maxTime){return"Updated "+formatTimeDiff(timekeeper.now().valueOf()-maxTime.valueOf().valueOf())+" ago"}else{return null}}else{var fixedMaxTime=this.getOptions().fixedMaxTime;if(fixedMaxTime){return"Fixed to "+beltful_1.DateUtils.getWallTimeString(new Date(fixedMaxTime),timezone,true)}else{return"Updated ~1 second ago"}}};DataCube.prototype.getSuggestedDimensions=function(attributes){return this.filterDimensions(DataCube.suggestDimensions(attributes))};DataCube.prototype.getSpecialTimeDimensionObject=function(){var specialTimeDimension=this.specialTimeDimension;if(specialTimeDimension===DataCube.NO_SPECIAL_TIME_DIMENSION)return null;var possibleTimeDimension=immutable_class_1.NamedArray.findByName(this.dimensions,specialTimeDimension);if(!possibleTimeDimension||possibleTimeDimension.type!=="TIME")return null;return possibleTimeDimension};DataCube.prototype.isSpecialTimeDimension=function(dimension){var specialTimeDimension=this.getSpecialTimeDimensionObject();if(!dimension||!specialTimeDimension)return false;return specialTimeDimension.name===dimension};DataCube.prototype.isMandatoryTimeFilter=function(dimension){return this.enforceTimeFilter&&this.isSpecialTimeDimension(dimension)};DataCube.prototype.hasMandatoryTimeFilter=function(){return this.enforceTimeFilter&&Boolean(this.getSpecialTimeDimensionObject())};DataCube.prototype.getMeasures=function(){if(this.measures.length)return this.measures;return[measure_1.Measure.SIMPLE_COUNT]};DataCube.prototype.getMeasure=function(measureName){return measure_1.Measure.getMeasure(this.getMeasures(),measureName)};DataCube.prototype.getMeasureByExpression=function(expression){return immutable_class_1.SimpleArray.find(this.getMeasures(),function(m){return m.expression.equals(expression)})};DataCube.prototype.getSuggestedMeasures=function(attributes){return this.filterMeasures(DataCube.suggestMeasures(attributes))};DataCube.prototype.filterMeasures=function(measuresToFilter){var _this=this;return measuresToFilter.filter(function(measure){if(immutable_class_1.NamedArray.findByName(_this.measures,measure.name))return false;if(immutable_class_1.NamedArray.findByName(_this.dimensions,measure.name))return false;var measureExpression=measure.expression;if(immutable_class_1.SimpleArray.find(_this.measures,function(m){return m.expression.equals(measureExpression)}))return false;return true})};DataCube.prototype.removeDimension=function(dimensionName){var value=this.valueOf();value.dimensions=immutable_class_1.NamedArray.deleteByName(value.dimensions,dimensionName);value.measures=value.measures.filter(function(measure){return!measure.usesAttribute(dimensionName)});return new DataCube(value)};DataCube.prototype.removeMeasure=function(measure){var index=this.measures.indexOf(measure);if(index===-1){throw new Error("Unknown measure: "+measure.toString())}var newMeasures=immutable_class_1.SimpleArray.deleteIndex(this.measures,index);return this.changeMeasures(newMeasures)};DataCube.prototype.filterDimensions=function(dimensionsToFilter){var _a=this,dimensions=_a.dimensions,measures=_a.measures;return dimensionsToFilter.filter(function(dimension){if(immutable_class_1.NamedArray.findByName(dimensions,dimension.name))return false;if(immutable_class_1.NamedArray.findByName(measures,dimension.name))return false;return true})};DataCube.prototype.getEffectiveAttributes=function(){return this.getEffectiveAttributesAndDerivedAttributes().attributes};DataCube.prototype.getEffectiveAttributesAndDerivedAttributes=function(){var attributes=this.attributes.slice();var seenAttributes={};var derivedAttributes={};attributes.forEach(function(a){return seenAttributes[a.name]=true});function addAttribute(attribute){if(seenAttributes[attribute.name])return;attributes.push(attribute);seenAttributes[attribute.name]=true}function addExpression(expression,skipMain){expression.forEach(function(ex){if(ex instanceof plywood_1.RefExpression){if(skipMain&&ex.name==="main")return;addAttribute(plywood_1.AttributeInfo.fromJS({name:ex.name,type:ex.type||"NULL"}))}})}this.dimensions.forEach(function(dimension){return addExpression(dimension.expression)});this.measures.forEach(function(measure){return addExpression(measure.expression,true)});addExpression(this.subsetExpression);if(this.instances)addExpression(this.instances.expression);return{attributes:attributes,derivedAttributes:derivedAttributes}};DataCube.prototype.changeDimension=function(dimension){return this.changeDimensions(immutable_class_1.NamedArray.overrideByName(this.dimensions,dimension))};DataCube.prototype.fillAllFromAttributes=function(attributes){var interestingAttributes=attributes.filter(function(attribute){return INTERESTING_NATIVE_TYPE[attribute.nativeType]});return this.appendAttributes(interestingAttributes).appendDimensions(this.getSuggestedDimensions(attributes)).appendMeasures(this.getSuggestedMeasures(attributes)).adoptSpecialTimeDimensionIfPossible()};DataCube.prototype.addMandatoryFiltersIfNeeded=function(filter){var specialTimeDimension=this.getSpecialTimeDimensionObject();if(this.enforceTimeFilter&&specialTimeDimension&&!filter.filteredOn(specialTimeDimension.name)){filter=filter.setDynamic(specialTimeDimension.name,plywood_1.$(filter_clause_1.FilterClause.MAX_TIME_REF_NAME).timeRange(this.getDefaultDuration(),-1))}return filter};DataCube.prototype.getDefaultSortMeasure=function(){var defaultSortMeasure=this.defaultSortMeasure;if(defaultSortMeasure){return(this.getMeasure(defaultSortMeasure)||this.getMeasures()[0]).name}return this.getMeasures()[0].name};DataCube.prototype.getDefaultSelectedMeasures=function(){var defaultSelectedMeasures=this.defaultSelectedMeasures;return defaultSelectedMeasures.length?defaultSelectedMeasures:this.measures.slice(0,4).map(function(m){return m.name})};DataCube.prototype.makeDuplicate=function(newName,newOwner){return this.changeMany({name:newName,title:this.title+" (copy)",modifyAccess:access_list_1.AccessList.onlyFor(newOwner.name)})};DataCube.prototype.adoptSpecialTimeDimensionIfPossible=function(){var specialTimeDimension=this.getSpecialTimeDimensionObject();if(specialTimeDimension)return this;var possibleTimeDimension=DataCube.getPossibleTimeDimension(this.dimensions);if(possibleTimeDimension===DataCube.NO_SPECIAL_TIME_DIMENSION)return this;var newDataCube=this.changeSpecialTimeDimension(possibleTimeDimension);if(possibleTimeDimension==="__time"){newDataCube=newDataCube.changeEnforceTimeFilter(true)}return newDataCube};DataCube.prototype.appendAttributes=function(attributes){return this.changeAttributes(plywood_1.AttributeInfo.override(this.attributes,attributes))};DataCube.prototype.appendMeasures=function(measures){return this.changeMeasures(this.measures.concat(measures))};DataCube.prototype.appendDimensions=function(dimensions){return this.changeDimensions(this.dimensions.concat(dimensions))};DataCube.prototype.sameGroup=function(otherDataCube){return Boolean(this.group&&this.group===otherDataCube.group)};DataCube.prototype.guessTitle=function(){if(!this.source)return this.title;var parts=this.source.split(/[\/\\]/);var candidate=parts[parts.length-1];return beltful_1.StringUtils.makeTitle(candidate)};DataCube.prototype.getLatitudeLongitudeDimensions=function(){var dimensions=this.dimensions;var latitude=immutable_class_1.NamedArray.findByName(dimensions,DataCube.LATITUDE_NAME);var longitude=immutable_class_1.NamedArray.findByName(dimensions,DataCube.LONGITUDE_NAME);return latitude&&longitude?{latitude:latitude,longitude:longitude}:null};DataCube.prototype.straightenDimensionName=function(dimension){var dimensions=this.dimensions;dimension=dimension.changeName(beltful_1.StringUtils.generateAvailableName({prefix:dimension.guessName(),minTokens:3,isAvailable:function(name){return!immutable_class_1.NamedArray.findByName(dimensions,name)},separator:"-"}));if(dimension.title==="New dimension")dimension=dimension.changeTitle(dimension.guessTitle());return dimension};DataCube.prototype.straightenMeasureName=function(measure){var _this=this;measure=measure.changeName(beltful_1.StringUtils.generateAvailableName({prefix:measure.guessName(),minTokens:3,isAvailable:function(name){return!_this.getMeasure(name)},allowRawPrefix:false,separator:"-"}));if(measure.title==="New measure")measure=measure.changeTitle(measure.guessTitle());return measure};DataCube.prototype.getSummaries=function(){return[this.source,general_1.pluralIfNeeded(this.dimensions.length,"dimension"),general_1.pluralIfNeeded(this.measures.length,"measure")]};DataCube.prototype.getDefaultInstance=function(){var instances=this.instances;return instances?instances.getDefaultValue():null};DataCube.prototype.initAccess=function(user){return this.changeMany({readAccess:access_list_1.AccessList.ALL,modifyAccess:access_list_1.AccessList.fromJS({access:"single",users:[user.name]})})};DataCube.prototype.refreshNeeded=function(timekeeper){if(!this.getMaxTimeQuery())return false;var since=new Date(Date.now()-this.getDefaultRefreshRate().getCanonicalLength());return!timekeeper.hasUpdatedSince(this.name,since)};DataCube.DEFAULT_DEFAULT_TIMEZONE=chronoshift_1.Timezone.UTC;DataCube.DEFAULT_DEFAULT_FILTER=filter_1.Filter.EMPTY;DataCube.DEFAULT_DEFAULT_SPLITS=splits_1.Splits.EMPTY;DataCube.DEFAULT_DEFAULT_DURATION=chronoshift_1.Duration.fromJS("P1D");DataCube.DEFAULT_REFRESH_TIME_WITH="query";DataCube.REFRESH_TIME_WITH_VALUES=["query","predefined"];DataCube.DEFAULT_DEFAULT_REFRESH_RATE=chronoshift_1.Duration.fromJS("PT5M");DataCube.NO_SPECIAL_TIME_DIMENSION="!NONE";DataCube.LATITUDE_NAME="lat";DataCube.LONGITUDE_NAME="lon";DataCube.PROPERTIES=[{name:"name",validate:beltful_1.StringUtils.verifyUrlSafeName},{name:"title",defaultValue:null},{name:"description",defaultValue:""},{name:"clusterName",defaultValue:null},{name:"source",defaultValue:null},{name:"group",defaultValue:null},{name:"theme",defaultValue:theme_1.Theme.DEFAULT_NAME},{name:"subsetFormula",defaultValue:null},{name:"rollup",defaultValue:false},{name:"complete",defaultValue:false},{name:"options",defaultValue:{},equal:function(a,b){return JSON.stringify(a)===JSON.stringify(b)}},{name:"readAccess",immutableClass:access_list_1.AccessList,defaultValue:access_list_1.AccessList.ALL},{name:"modifyAccess",immutableClass:access_list_1.AccessList,defaultValue:access_list_1.AccessList.ALL},{name:"attributes",immutableClassArray:plywood_1.AttributeInfo,type:immutable_class_1.PropertyType.ARRAY},{name:"dimensions",immutableClassArray:dimension_1.Dimension,type:immutable_class_1.PropertyType.ARRAY},{name:"measures",immutableClassArray:measure_1.Measure,type:immutable_class_1.PropertyType.ARRAY},{name:"instances",defaultValue:null,immutableClass:instances_1.Instances},{name:"specialTimeDimension"},{name:"enforceTimeFilter"},{name:"defaultTimezone",immutableClass:chronoshift_1.Timezone,defaultValue:DataCube.DEFAULT_DEFAULT_TIMEZONE},{name:"defaultFilter",immutableClass:filter_1.Filter,defaultValue:DataCube.DEFAULT_DEFAULT_FILTER},{name:"defaultSplits",immutableClass:splits_1.Splits,defaultValue:DataCube.DEFAULT_DEFAULT_SPLITS},{name:"defaultDuration",immutableClass:chronoshift_1.Duration,defaultValue:DataCube.DEFAULT_DEFAULT_DURATION},{name:"defaultSortMeasure",defaultValue:null},{name:"defaultSelectedMeasures",type:immutable_class_1.PropertyType.ARRAY},{name:"defaultPinnedDimensions",type:immutable_class_1.PropertyType.ARRAY},{name:"defaultRefreshRate",defaultValue:DataCube.DEFAULT_DEFAULT_REFRESH_RATE},{name:"refreshTimeWith",possibleValues:DataCube.REFRESH_TIME_WITH_VALUES,defaultValue:DataCube.DEFAULT_REFRESH_TIME_WITH}];return DataCube}(immutable_class_1.BaseImmutable);exports.DataCube=DataCube;immutable_class_1.BaseImmutable.finalize(DataCube)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var React=__webpack_require__(1);var constants_1=__webpack_require__(52);__webpack_require__(499);var FancyDragIndicator=function(_super){tslib_1.__extends(FancyDragIndicator,_super);function FancyDragIndicator(){return _super.call(this)||this}FancyDragIndicator.prototype.render=function(){var _a=this.props,dragPosition=_a.dragPosition,style=_a.style;if(!dragPosition)return null;var sectionWidth=constants_1.CORE_ITEM_WIDTH+constants_1.CORE_ITEM_GAP;var ghostArrowLeft;var dragGhostElement=null;if(dragPosition.isInsert()){ghostArrowLeft=dragPosition.insert*sectionWidth-constants_1.CORE_ITEM_GAP/2}else{ghostArrowLeft=dragPosition.replace*sectionWidth+constants_1.CORE_ITEM_WIDTH/2;var left=dragPosition.replace*sectionWidth;dragGhostElement=React.createElement("div",{className:"drag-ghost-element",style:{left:left}})}return React.createElement("div",{className:"fancy-drag-indicator",style:style},dragGhostElement,React.createElement(caladan_1.SvgIcon,{className:"drag-ghost-arrow",svg:little_pictures_1.DRAG_ARROW,style:{left:ghostArrowLeft}}))};return FancyDragIndicator}(React.Component);exports.FancyDragIndicator=FancyDragIndicator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);__webpack_require__(501);var FILTER_OPTIONS=[{label:strings_1.STRINGS.include,value:models_1.Filter.INCLUDE,svg:Icons.FILTER_INCLUDE,checkType:"check"},{label:strings_1.STRINGS.exclude,value:models_1.Filter.EXCLUDE,svg:Icons.FILTER_EXCLUDE,checkType:"cross"},{label:strings_1.STRINGS.contains,value:models_1.Filter.CONTAINS,svg:Icons.FILTER_CONTAINS},{label:strings_1.STRINGS.regex,value:models_1.Filter.REGEX,svg:Icons.FILTER_REGEX}];var FilterOptionsDropdown=function(_super){tslib_1.__extends(FilterOptionsDropdown,_super);function FilterOptionsDropdown(){return _super.call(this)||this}FilterOptionsDropdown.getFilterOptions=function(){var filterTypes=[];for(var _i=0;_i<arguments.length;_i++){filterTypes[_i]=arguments[_i]}return FILTER_OPTIONS.filter(function(option){return filterTypes.includes(option.value)})};FilterOptionsDropdown.prototype.onSelectOption=function(option){this.props.onSelectOption(option.value)};FilterOptionsDropdown.prototype.renderFilterOption=function(option){return React.createElement("span",{className:"filter-option"},React.createElement(caladan_1.SvgIcon,{className:"icon",svg:option.svg}),React.createElement("span",{className:"option-label"},option.label))};FilterOptionsDropdown.prototype.render=function(){var _a=this.props,selectedOption=_a.selectedOption,onSelectOption=_a.onSelectOption,filterOptions=_a.filterOptions;var FilterDropdown=caladan_1.Dropdown.specialize();var options=filterOptions||FILTER_OPTIONS;var selectedItem=options.filter(function(o){return o.value===selectedOption})[0]||options[0];return React.createElement("div",{className:"filter-options-dropdown"},React.createElement(FilterDropdown,{menuClassName:"filter-options",items:options,selectedItem:selectedItem,equal:function(a,b){return a.value===b.value},keyItem:function(d){return d.value},renderItem:this.renderFilterOption.bind(this),renderSelectedItem:function(d){return React.createElement(caladan_1.SvgIcon,{className:"icon",svg:d.svg})},onSelect:this.onSelectOption.bind(this)}))};return FilterOptionsDropdown}(React.Component);exports.FilterOptionsDropdown=FilterOptionsDropdown},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var React=__webpack_require__(1);__webpack_require__(535);var DimensionPickerMenu=function(_super){tslib_1.__extends(DimensionPickerMenu,_super);function DimensionPickerMenu(){var _this=_super.call(this)||this;_this.state={};return _this}DimensionPickerMenu.prototype.render=function(){var _a=this.props,dimensions=_a.dimensions,onSelect=_a.onSelect,openOn=_a.openOn,onClose=_a.onClose;return React.createElement(caladan_1.BubbleMenu,{className:"dimension-picker-menu",direction:"down",stage:beltful_1.Stage.fromSize(200,400),openOn:openOn,onClose:onClose},React.createElement("ul",{className:"bubble-list"},dimensions.map(function(d){return React.createElement("div",{className:classNames("item dimension","type-"+d.kind),key:d.name,onClick:function(){return onSelect(d)}},React.createElement("div",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:d.getIcon()})),React.createElement("div",{className:"item-title"},d.title))})))};return DimensionPickerMenu}(React.Component);exports.DimensionPickerMenu=DimensionPickerMenu},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_path__=__webpack_require__(112);var __WEBPACK_IMPORTED_MODULE_1__constant__=__webpack_require__(74);var __WEBPACK_IMPORTED_MODULE_2__curve_linear__=__webpack_require__(178);var __WEBPACK_IMPORTED_MODULE_3__point__=__webpack_require__(193);__webpack_exports__["a"]=function(){var x=__WEBPACK_IMPORTED_MODULE_3__point__["a"],y=__WEBPACK_IMPORTED_MODULE_3__point__["b"],defined=Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(true),context=null,curve=__WEBPACK_IMPORTED_MODULE_2__curve_linear__["a"],output=null;function line(data){var i,n=data.length,d,defined0=false,buffer;if(context==null)output=curve(buffer=Object(__WEBPACK_IMPORTED_MODULE_0_d3_path__["a"])());for(i=0;i<=n;++i){if(!(i<n&&defined(d=data[i],i,data))===defined0){if(defined0=!defined0)output.lineStart();else output.lineEnd()}if(defined0)output.point(+x(d,i,data),+y(d,i,data))}if(buffer)return output=null,buffer+""||null}line.x=function(_){return arguments.length?(x=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),line):x};line.y=function(_){return arguments.length?(y=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),line):y};line.defined=function(_){return arguments.length?(defined=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(!!_),line):defined};line.curve=function(_){return arguments.length?(curve=_,context!=null&&(output=curve(context)),line):curve};line.context=function(_){return arguments.length?(_==null?context=output=null:output=curve(context=_),line):context};return line}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=x;__webpack_exports__["b"]=y;function x(p){return p[0]}function y(p){return p[1]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=point;var __WEBPACK_IMPORTED_MODULE_0__math__=__webpack_require__(113);var __WEBPACK_IMPORTED_MODULE_1__cardinal__=__webpack_require__(181);function point(that,x,y){var x1=that._x1,y1=that._y1,x2=that._x2,y2=that._y2;if(that._l01_a>__WEBPACK_IMPORTED_MODULE_0__math__["f"]){var a=2*that._l01_2a+3*that._l01_a*that._l12_a+that._l12_2a,n=3*that._l01_a*(that._l01_a+that._l12_a);x1=(x1*a-that._x0*that._l12_2a+that._x2*that._l01_2a)/n;y1=(y1*a-that._y0*that._l12_2a+that._y2*that._l01_2a)/n}if(that._l23_a>__WEBPACK_IMPORTED_MODULE_0__math__["f"]){var b=2*that._l23_2a+3*that._l23_a*that._l12_a+that._l12_2a,m=3*that._l23_a*(that._l23_a+that._l12_a);x2=(x2*b+that._x1*that._l23_2a-x*that._l12_2a)/m;y2=(y2*b+that._y1*that._l23_2a-y*that._l12_2a)/m}that._context.bezierCurveTo(x1,y1,x2,y2,that._x2,that._y2)}function CatmullRom(context,alpha){this._context=context;this._alpha=alpha}CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(x,y){x=+x,y=+y;if(this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3;default:point(this,x,y);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=x;this._y0=this._y1,this._y1=this._y2,this._y2=y}};__webpack_exports__["a"]=function custom(alpha){function catmullRom(context){return alpha?new CatmullRom(context,alpha):new __WEBPACK_IMPORTED_MODULE_1__cardinal__["a"](context,0)}catmullRom.alpha=function(alpha){return custom(+alpha)};return catmullRom}(.5)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=sum;var __WEBPACK_IMPORTED_MODULE_0__none__=__webpack_require__(115);__webpack_exports__["a"]=function(series){var sums=series.map(sum);return Object(__WEBPACK_IMPORTED_MODULE_0__none__["a"])(series).sort(function(a,b){return sums[a]-sums[b]})};function sum(series){var s=0,i=-1,n=series.length,v;while(++i<n)if(v=+series[i][1])s+=v;return s}},function(module,__webpack_exports__,__webpack_require__){"use strict";function objectConverter(columns){return new Function("d","return {"+columns.map(function(name,i){return JSON.stringify(name)+": d["+i+"]"}).join(",")+"}")}function customConverter(columns,f){var object=objectConverter(columns);return function(row,i){return f(object(row),i,columns)}}function inferColumns(rows){var columnSet=Object.create(null),columns=[];rows.forEach(function(row){for(var column in row){if(!(column in columnSet)){columns.push(columnSet[column]=column)}}});return columns}__webpack_exports__["a"]=function(delimiter){var reFormat=new RegExp('["'+delimiter+"\n\r]"),delimiterCode=delimiter.charCodeAt(0);function parse(text,f){var convert,columns,rows=parseRows(text,function(row,i){if(convert)return convert(row,i-1);columns=row,convert=f?customConverter(row,f):objectConverter(row)});rows.columns=columns;return rows}function parseRows(text,f){var EOL={},EOF={},rows=[],N=text.length,I=0,n=0,t,eol;function token(){if(I>=N)return EOF;if(eol)return eol=false,EOL;var j=I,c;if(text.charCodeAt(j)===34){var i=j;while(i++<N){if(text.charCodeAt(i)===34){if(text.charCodeAt(i+1)!==34)break;++i}}I=i+2;c=text.charCodeAt(i+1);if(c===13){eol=true;if(text.charCodeAt(i+2)===10)++I}else if(c===10){eol=true}return text.slice(j+1,i).replace(/""/g,'"')}while(I<N){var k=1;c=text.charCodeAt(I++);if(c===10)eol=true;else if(c===13){eol=true;if(text.charCodeAt(I)===10)++I,++k}else if(c!==delimiterCode)continue;return text.slice(j,I-k)}return text.slice(j)}while((t=token())!==EOF){var a=[];while(t!==EOL&&t!==EOF){a.push(t);t=token()}if(f&&(a=f(a,n++))==null)continue;rows.push(a)}return rows}function format(rows,columns){if(columns==null)columns=inferColumns(rows);return[columns.map(formatValue).join(delimiter)].concat(rows.map(function(row){return columns.map(function(column){return formatValue(row[column])}).join(delimiter)})).join("\n")}function formatRows(rows){return rows.map(formatRow).join("\n")}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return text==null?"":reFormat.test(text+="")?'"'+text.replace(/\"/g,'""')+'"':text}return{parse:parse,parseRows:parseRows,format:format,formatRows:formatRows}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var React=__webpack_require__(1);var strings_1=__webpack_require__(17);__webpack_require__(618);var SegmentActionButtons=function(_super){tslib_1.__extends(SegmentActionButtons,_super);function SegmentActionButtons(){var _this=_super.call(this)||this;_this.state={mainLabel:strings_1.STRINGS.select};return _this}SegmentActionButtons.prototype.onAltDown=function(){var _a=this.props,clicker=_a.clicker,dimensions=_a.dimensions,disableExclusion=_a.disableExclusion;if(disableExclusion===true)return;if(!dimensions||dimensions.some(function(d){return d.isContinuous()}))return;var hasChanged=clicker.invertHighlight();if(hasChanged){this.setState({mainLabel:strings_1.STRINGS.exclude})}};SegmentActionButtons.prototype.onAltUp=function(){var _a=this.props,clicker=_a.clicker,dimensions=_a.dimensions,disableExclusion=_a.disableExclusion;if(disableExclusion===true)return;if(!dimensions||dimensions.some(function(d){return d.isContinuous()}))return;clicker.invertHighlight();this.setState({mainLabel:strings_1.STRINGS.select})};SegmentActionButtons.prototype.onExclude=function(){var _a=this.props,onClose=_a.onClose,clicker=_a.clicker;clicker.acceptInvertedHighlight();if(onClose)onClose()};SegmentActionButtons.prototype.onSelect=function(){var _a=this.props,onClose=_a.onClose,clicker=_a.clicker;clicker.acceptHighlight();if(onClose)onClose()};SegmentActionButtons.prototype.onCancel=function(){var _a=this.props,onClose=_a.onClose,clicker=_a.clicker;clicker.dropHighlight();if(onClose)onClose()};SegmentActionButtons.prototype.getUrl=function(){var _a=this.props,segmentLabel=_a.segmentLabel,dimensions=_a.dimensions;if(!dimensions||dimensions.length>1||!dimensions[0]||!dimensions[0].url)return null;return dimensions[0].url.replace(/%s/g,segmentLabel)};SegmentActionButtons.prototype.openRawDataModal=function(){var openRawDataModal=this.props.openRawDataModal;if(!openRawDataModal)return;openRawDataModal()};SegmentActionButtons.prototype.getActItems=function(){var dimensions=this.props.dimensions;if(!dimensions)return null;var d1=dimensions[0];var a=window._actions_;if(!a)return null;var b=a[d1.title]||a[d1.name]||a["_"];if(!Array.isArray(b))return null;return b.map(function(x){return typeof x==="string"?{label:x,onClick:function(){return alert("Action taken")}}:x})};SegmentActionButtons.prototype.getMoreMenuItems=function(){var _this=this;var _a=this.props,segmentLabel=_a.segmentLabel,dimensions=_a.dimensions,disableExclusion=_a.disableExclusion,openRawDataModal=_a.openRawDataModal,selectionMode=_a.selectionMode,toggleSelectionMode=_a.toggleSelectionMode;var items=[{label:strings_1.STRINGS.copyValue,className:"clipboard",additionalProps:{"data-clipboard-text":segmentLabel}}];if(openRawDataModal){items.push({label:strings_1.STRINGS.viewRawData,onClick:function(){return _this.openRawDataModal()}})}var url=this.getUrl();if(url){items.push({label:strings_1.STRINGS.goToUrl,href:url})}if(!disableExclusion&&dimensions&&!dimensions.some(function(d){return d.isContinuous()})){items.push({label:strings_1.STRINGS.exclude,onClick:function(){return _this.onExclude()}})}if(toggleSelectionMode){items.push({label:selectionMode==="multi"?strings_1.STRINGS.switchToSingleSelectionMode:strings_1.STRINGS.switchToMultiSelectionMode,onClick:toggleSelectionMode})}return items};SegmentActionButtons.prototype.render=function(){var _this=this;var disableMoreMenu=this.props.disableMoreMenu;var mainLabel=this.state.mainLabel;var actItems=this.getActItems();return React.createElement("div",{className:"segment-action-buttons"},React.createElement(caladan_1.GlobalEventListener,{altDown:function(){return _this.onAltDown()},altUp:function(){return _this.onAltUp()}}),React.createElement(caladan_1.Button,{type:"primary",className:"mini main",onClick:function(){return _this.onSelect()},title:mainLabel}),actItems?React.createElement(caladan_1.BubbleButton,{type:"secondary",className:"mini act",onClick:function(){return null},title:window.actionLabel||"Act",items:this.getActItems()}):null,React.createElement(caladan_1.Button,{type:"secondary",className:"mini",onClick:function(){return _this.onCancel()},title:strings_1.STRINGS.cancel}),disableMoreMenu?null:React.createElement(caladan_1.BubbleButton,{type:"secondary",className:"mini",stage:beltful_1.Stage.fromSize(160,160),svg:little_pictures_1.FULL_MORE_MINI,items:this.getMoreMenuItems()}))};return SegmentActionButtons}(React.Component);exports.SegmentActionButtons=SegmentActionButtons},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var immutable_class_1=__webpack_require__(7);var essence_1=__webpack_require__(70);var CollectionTile=function(_super){tslib_1.__extends(CollectionTile,_super);function CollectionTile(parameters){var _this=_super.call(this,parameters)||this;_this.title=_this.title||beltful_1.StringUtils.makeTitle(name);return _this}CollectionTile.isCollectionTile=function(candidate){return candidate instanceof CollectionTile};CollectionTile.fromEssence=function(name,essence){return new CollectionTile({name:name,title:essence.getTitle(),description:"",essence:essence,type:CollectionTile.TYPE_VISUALIZATION})};CollectionTile.generateBlank=function(name){return new CollectionTile({name:name,title:"New tile",description:"",essence:undefined,type:CollectionTile.TYPE_BLANK})};CollectionTile.fromJS=function(parameters,context){if(context===void 0){context={}}var dataCubes=context.dataCubes,visualizations=context.visualizations;var essence;if(parameters.essence){var essenceJS=parameters.essence;var dataCube=null;if(dataCubes){var dataCubeName=essenceJS.dataCube||parameters.dataCube;dataCube=immutable_class_1.NamedArray.findByName(dataCubes,dataCubeName)}if(!essenceJS.dataCube&&parameters.dataCube){essenceJS.dataCube=parameters.dataCube}essence=essence_1.Essence.fromJS(essenceJS,{actualDataCube:dataCube,visualizations:visualizations})}return new CollectionTile({name:parameters.name,title:parameters.title,description:parameters.description,position:parameters.position?beltful_1.Stage.fromJS(parameters.position):null,group:parameters.group,essence:essence,titleHidden:parameters.titleHidden,type:parameters.type||(essence?CollectionTile.TYPE_VISUALIZATION:CollectionTile.TYPE_BLANK)})};CollectionTile.prototype.isReady=function(){return this.isBlank()||Boolean(this.essence.actualDataCube)};CollectionTile.prototype.getDataCube=function(){return this.essence?this.essence.actualDataCube:null};CollectionTile.prototype.makeDuplicate=function(newName){var v=this.valueOf();v.name=newName;delete v.position;return new CollectionTile(v)};CollectionTile.prototype.isBlank=function(){return this.type===CollectionTile.TYPE_BLANK};CollectionTile.prototype.isVisualization=function(){return this.type===CollectionTile.TYPE_VISUALIZATION};CollectionTile.TYPE_VISUALIZATION="visualization";CollectionTile.TYPE_BLANK="blank";CollectionTile.PROPERTIES=[{name:"name",validate:beltful_1.StringUtils.verifyUrlSafeName},{name:"title",defaultValue:null},{name:"titleHidden",defaultValue:false},{name:"description",defaultValue:null},{name:"position",immutableClass:beltful_1.Stage,defaultValue:null},{name:"group",defaultValue:null},{name:"essence",immutableClass:essence_1.Essence,defaultValue:null},{name:"type",possibleValues:[CollectionTile.TYPE_BLANK,CollectionTile.TYPE_VISUALIZATION],defaultValue:CollectionTile.TYPE_BLANK}];return CollectionTile}(immutable_class_1.BaseImmutable);exports.CollectionTile=CollectionTile;immutable_class_1.BaseImmutable.finalize(CollectionTile)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var permission_1=__webpack_require__(387);var Role=function(_super){tslib_1.__extends(Role,_super);function Role(parameters){return _super.call(this,parameters)||this}Role.isRole=function(candidate){return candidate instanceof Role};Role.fromJS=function(parameters){return new Role(immutable_class_1.BaseImmutable.jsToValue(Role.PROPERTIES,parameters))};Role.prototype.isSuperAdmin=function(){return this.name===Role.SUPER_ADMIN_NAME};Role.prototype.getNewPermission=function(possiblePermissions){var firstDeduped=possiblePermissions?possiblePermissions[0]:null;return new permission_1.Permission({name:firstDeduped?firstDeduped.name:"",value:""})};Role.prototype.updatePermission=function(permission){var permissions=this.getPermissions();return this.changePermissions(immutable_class_1.NamedArray.overrideByName(permissions,permission))};Role.prototype.can=function(permission){return this.getPermissions().some(function(p){return p.name===permission&&p.value==="*"})};Role.PROPERTIES=[{name:"name"},{name:"title",defaultValue:null},{name:"permissions",immutableClassArray:permission_1.Permission,defaultValue:[]}];Role.SUPER_ADMIN_NAME="super-admin";Role.SUPER_ADMIN=new Role({name:Role.SUPER_ADMIN_NAME,title:"super-admin",permissions:[permission_1.Permission.MANAGE_USERS]});Role.USER=new Role({name:"user",title:"user",permissions:[]});return Role}(immutable_class_1.BaseImmutable);exports.Role=Role;immutable_class_1.BaseImmutable.finalize(Role)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var Permission=function(_super){tslib_1.__extends(Permission,_super);function Permission(parameters){return _super.call(this,parameters)||this}Permission.isPermission=function(candidate){return candidate instanceof Permission};Permission.fromJS=function(parameters){return new Permission(immutable_class_1.BaseImmutable.jsToValue(Permission.PROPERTIES,parameters))};Permission.PROPERTIES=[{name:"name"},{name:"value"}];return Permission}(immutable_class_1.BaseImmutable);exports.Permission=Permission;immutable_class_1.BaseImmutable.finalize(Permission);Permission.VIEW_CLUSTER=new Permission({name:"view-cluster",value:"*"});Permission.VIEW_DATA_SOURCE=new Permission({name:"view-data-source",value:"*"});Permission.VIEW_PIVOT=new Permission({name:"view-pivot",value:"*"});Permission.MANAGE_USERS=new Permission({name:"manage-users",value:"*"});Permission.EDIT_CLUSTERS=new Permission({name:"edit-clusters",value:"*"});Permission.VIEW_SQL=new Permission({name:"view-sql",value:"*"})},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof module==="object"&&module.exports){module.exports=factory()}else{global.numeral=factory()}})(this,function(){var numeral,_,VERSION="2.0.6",formats={},locales={},defaults={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:true},options={currentLocale:defaults.currentLocale,zeroFormat:defaults.zeroFormat,nullFormat:defaults.nullFormat,defaultFormat:defaults.defaultFormat,scalePercentBy100:defaults.scalePercentBy100};function Numeral(input,number){this._input=input;this._value=number}numeral=function(input){var value,kind,unformatFunction,regexp;if(numeral.isNumeral(input)){value=input.value()}else if(input===0||typeof input==="undefined"){value=0}else if(input===null||_.isNaN(input)){value=null}else if(typeof input==="string"){if(options.zeroFormat&&input===options.zeroFormat){value=0}else if(options.nullFormat&&input===options.nullFormat||!input.replace(/[^0-9]+/g,"").length){value=null}else{for(kind in formats){regexp=typeof formats[kind].regexps.unformat==="function"?formats[kind].regexps.unformat():formats[kind].regexps.unformat;if(regexp&&input.match(regexp)){unformatFunction=formats[kind].unformat;break}}unformatFunction=unformatFunction||numeral._.stringToNumber;value=unformatFunction(input)}}else{value=Number(input)||null}return new Numeral(input,value)};numeral.version=VERSION;numeral.isNumeral=function(obj){return obj instanceof Numeral};numeral._=_={numberToFormat:function(value,format,roundingFunction){var locale=locales[numeral.options.currentLocale],negP=false,optDec=false,leadingCount=0,abbr="",trillion=1e12,billion=1e9,million=1e6,thousand=1e3,decimal="",neg=false,abbrForce,abs,min,max,power,int,precision,signed,thousands,output;value=value||0;abs=Math.abs(value);if(numeral._.includes(format,"(")){negP=true;format=format.replace(/[\(|\)]/g,"")}else if(numeral._.includes(format,"+")||numeral._.includes(format,"-")){signed=numeral._.includes(format,"+")?format.indexOf("+"):value<0?format.indexOf("-"):-1;format=format.replace(/[\+|\-]/g,"")}if(numeral._.includes(format,"a")){abbrForce=format.match(/a(k|m|b|t)?/);abbrForce=abbrForce?abbrForce[1]:false;if(numeral._.includes(format," a")){abbr=" "}format=format.replace(new RegExp(abbr+"a[kmbt]?"),"");if(abs>=trillion&&!abbrForce||abbrForce==="t"){abbr+=locale.abbreviations.trillion;value=value/trillion}else if(abs<trillion&&abs>=billion&&!abbrForce||abbrForce==="b"){abbr+=locale.abbreviations.billion;value=value/billion}else if(abs<billion&&abs>=million&&!abbrForce||abbrForce==="m"){abbr+=locale.abbreviations.million;value=value/million}else if(abs<million&&abs>=thousand&&!abbrForce||abbrForce==="k"){abbr+=locale.abbreviations.thousand;value=value/thousand}}if(numeral._.includes(format,"[.]")){optDec=true;format=format.replace("[.]",".")}int=value.toString().split(".")[0];precision=format.split(".")[1];thousands=format.indexOf(",");leadingCount=(format.split(".")[0].split(",")[0].match(/0/g)||[]).length;if(precision){if(numeral._.includes(precision,"[")){precision=precision.replace("]","");precision=precision.split("[");decimal=numeral._.toFixed(value,precision[0].length+precision[1].length,roundingFunction,precision[1].length)}else{decimal=numeral._.toFixed(value,precision.length,roundingFunction)}int=decimal.split(".")[0];if(numeral._.includes(decimal,".")){decimal=locale.delimiters.decimal+decimal.split(".")[1]}else{decimal=""}if(optDec&&Number(decimal.slice(1))===0){decimal=""}}else{int=numeral._.toFixed(value,0,roundingFunction)}if(abbr&&!abbrForce&&Number(int)>=1e3&&abbr!==locale.abbreviations.trillion){int=String(Number(int)/1e3);switch(abbr){case locale.abbreviations.thousand:abbr=locale.abbreviations.million;break;case locale.abbreviations.million:abbr=locale.abbreviations.billion;break;case locale.abbreviations.billion:abbr=locale.abbreviations.trillion;break}}if(numeral._.includes(int,"-")){int=int.slice(1);neg=true}if(int.length<leadingCount){for(var i=leadingCount-int.length;i>0;i--){int="0"+int}}if(thousands>-1){int=int.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+locale.delimiters.thousands)}if(format.indexOf(".")===0){int=""}output=int+decimal+(abbr?abbr:"");if(negP){output=(negP&&neg?"(":"")+output+(negP&&neg?")":"")}else{if(signed>=0){output=signed===0?(neg?"-":"+")+output:output+(neg?"-":"+")}else if(neg){output="-"+output}}return output},stringToNumber:function(string){var locale=locales[options.currentLocale],stringOriginal=string,abbreviations={thousand:3,million:6,billion:9,trillion:12},abbreviation,value,i,regexp;if(options.zeroFormat&&string===options.zeroFormat){value=0}else if(options.nullFormat&&string===options.nullFormat||!string.replace(/[^0-9]+/g,"").length){value=null}else{value=1;if(locale.delimiters.decimal!=="."){string=string.replace(/\./g,"").replace(locale.delimiters.decimal,".")}for(abbreviation in abbreviations){regexp=new RegExp("[^a-zA-Z]"+locale.abbreviations[abbreviation]+"(?:\\)|(\\"+locale.currency.symbol+")?(?:\\))?)?$");if(stringOriginal.match(regexp)){value*=Math.pow(10,abbreviations[abbreviation]);break}}value*=(string.split("-").length+Math.min(string.split("(").length-1,string.split(")").length-1))%2?1:-1;string=string.replace(/[^0-9\.]+/g,"");value*=Number(string)}return value},isNaN:function(value){return typeof value==="number"&&isNaN(value)},includes:function(string,search){return string.indexOf(search)!==-1},insert:function(string,subString,start){return string.slice(0,start)+subString+string.slice(start)},reduce:function(array,callback){if(this===null){throw new TypeError("Array.prototype.reduce called on null or undefined")}if(typeof callback!=="function"){throw new TypeError(callback+" is not a function")}var t=Object(array),len=t.length>>>0,k=0,value;if(arguments.length===3){value=arguments[2]}else{while(k<len&&!(k in t)){k++}if(k>=len){throw new TypeError("Reduce of empty array with no initial value")}value=t[k++]}for(;k<len;k++){if(k in t){value=callback(value,t[k],k,t)}}return value},multiplier:function(x){var parts=x.toString().split(".");return parts.length<2?1:Math.pow(10,parts[1].length)},correctionFactor:function(){var args=Array.prototype.slice.call(arguments);return args.reduce(function(accum,next){var mn=_.multiplier(next);return accum>mn?accum:mn},1)},toFixed:function(value,maxDecimals,roundingFunction,optionals){var splitValue=value.toString().split("."),minDecimals=maxDecimals-(optionals||0),boundedPrecision,optionalsRegExp,power,output;if(splitValue.length===2){boundedPrecision=Math.min(Math.max(splitValue[1].length,minDecimals),maxDecimals)}else{boundedPrecision=minDecimals}power=Math.pow(10,boundedPrecision);output=(roundingFunction(value+"e+"+boundedPrecision)/power).toFixed(boundedPrecision);if(optionals>maxDecimals-boundedPrecision){optionalsRegExp=new RegExp("\\.?0{1,"+(optionals-(maxDecimals-boundedPrecision))+"}$");output=output.replace(optionalsRegExp,"")}return output}};numeral.options=options;numeral.formats=formats;numeral.locales=locales;numeral.locale=function(key){if(key){options.currentLocale=key.toLowerCase()}return options.currentLocale};numeral.localeData=function(key){if(!key){return locales[options.currentLocale]}key=key.toLowerCase();if(!locales[key]){throw new Error("Unknown locale : "+key)}return locales[key]};numeral.reset=function(){for(var property in defaults){options[property]=defaults[property]}};numeral.zeroFormat=function(format){options.zeroFormat=typeof format==="string"?format:null};numeral.nullFormat=function(format){options.nullFormat=typeof format==="string"?format:null};numeral.defaultFormat=function(format){options.defaultFormat=typeof format==="string"?format:"0.0"};numeral.register=function(type,name,format){name=name.toLowerCase();if(this[type+"s"][name]){throw new TypeError(name+" "+type+" already registered.")}this[type+"s"][name]=format;return format};numeral.validate=function(val,culture){var _decimalSep,_thousandSep,_currSymbol,_valArray,_abbrObj,_thousandRegEx,localeData,temp;if(typeof val!=="string"){val+="";if(console.warn){console.warn("Numeral.js: Value is not string. It has been co-erced to: ",val)}}val=val.trim();if(!!val.match(/^\d+$/)){return true}if(val===""){return false}try{localeData=numeral.localeData(culture)}catch(e){localeData=numeral.localeData(numeral.locale())}_currSymbol=localeData.currency.symbol;_abbrObj=localeData.abbreviations;_decimalSep=localeData.delimiters.decimal;if(localeData.delimiters.thousands==="."){_thousandSep="\\."}else{_thousandSep=localeData.delimiters.thousands}temp=val.match(/^[^\d]+/);if(temp!==null){val=val.substr(1);if(temp[0]!==_currSymbol){return false}}temp=val.match(/[^\d]+$/);if(temp!==null){val=val.slice(0,-1);if(temp[0]!==_abbrObj.thousand&&temp[0]!==_abbrObj.million&&temp[0]!==_abbrObj.billion&&temp[0]!==_abbrObj.trillion){return false}}_thousandRegEx=new RegExp(_thousandSep+"{2}");if(!val.match(/[^\d.,]/g)){_valArray=val.split(_decimalSep);if(_valArray.length>2){return false}else{if(_valArray.length<2){return!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx)}else{if(_valArray[0].length===1){return!!_valArray[0].match(/^\d+$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/)}else{return!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/)}}}}return false};numeral.fn=Numeral.prototype={clone:function(){return numeral(this)},format:function(inputString,roundingFunction){var value=this._value,format=inputString||options.defaultFormat,kind,output,formatFunction;roundingFunction=roundingFunction||Math.round;if(value===0&&options.zeroFormat!==null){output=options.zeroFormat}else if(value===null&&options.nullFormat!==null){output=options.nullFormat}else{for(kind in formats){if(format.match(formats[kind].regexps.format)){formatFunction=formats[kind].format;break}}formatFunction=formatFunction||numeral._.numberToFormat;output=formatFunction(value,format,roundingFunction)}return output},value:function(){return this._value},input:function(){return this._input},set:function(value){this._value=Number(value);return this},add:function(value){var corrFactor=_.correctionFactor.call(null,this._value,value);function cback(accum,curr,currI,O){return accum+Math.round(corrFactor*curr)}this._value=_.reduce([this._value,value],cback,0)/corrFactor;return this},subtract:function(value){var corrFactor=_.correctionFactor.call(null,this._value,value);function cback(accum,curr,currI,O){return accum-Math.round(corrFactor*curr)}this._value=_.reduce([value],cback,Math.round(this._value*corrFactor))/corrFactor;return this},multiply:function(value){function cback(accum,curr,currI,O){var corrFactor=_.correctionFactor(accum,curr);return Math.round(accum*corrFactor)*Math.round(curr*corrFactor)/Math.round(corrFactor*corrFactor)}this._value=_.reduce([this._value,value],cback,1);return this},divide:function(value){function cback(accum,curr,currI,O){var corrFactor=_.correctionFactor(accum,curr);return Math.round(accum*corrFactor)/Math.round(curr*corrFactor)}this._value=_.reduce([this._value,value],cback);return this},difference:function(value){return Math.abs(numeral(this._value).subtract(value).value())}};numeral.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(number){var b=number%10;return~~(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th"},currency:{symbol:"$"}});(function(){numeral.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(value,format,roundingFunction){var space=numeral._.includes(format," BPS")?" ":"",output;value=value*1e4;format=format.replace(/\s?BPS/,"");output=numeral._.numberToFormat(value,format,roundingFunction);if(numeral._.includes(output,")")){output=output.split("");output.splice(-1,0,space+"BPS");output=output.join("")}else{output=output+space+"BPS"}return output},unformat:function(string){return+(numeral._.stringToNumber(string)*1e-4).toFixed(15)}})})();(function(){var decimal={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},binary={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]};var allSuffixes=decimal.suffixes.concat(binary.suffixes.filter(function(item){return decimal.suffixes.indexOf(item)<0}));var unformatRegex=allSuffixes.join("|");unformatRegex="("+unformatRegex.replace("B","B(?!PS)")+")";numeral.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(unformatRegex)},format:function(value,format,roundingFunction){var output,bytes=numeral._.includes(format,"ib")?binary:decimal,suffix=numeral._.includes(format," b")||numeral._.includes(format," ib")?" ":"",power,min,max;format=format.replace(/\s?i?b/,"");for(power=0;power<=bytes.suffixes.length;power++){min=Math.pow(bytes.base,power);max=Math.pow(bytes.base,power+1);if(value===null||value===0||value>=min&&value<max){suffix+=bytes.suffixes[power];if(min>0){value=value/min}break}}output=numeral._.numberToFormat(value,format,roundingFunction);return output+suffix},unformat:function(string){var value=numeral._.stringToNumber(string),power,bytesMultiplier;if(value){for(power=decimal.suffixes.length-1;power>=0;power--){if(numeral._.includes(string,decimal.suffixes[power])){bytesMultiplier=Math.pow(decimal.base,power);break}if(numeral._.includes(string,binary.suffixes[power])){bytesMultiplier=Math.pow(binary.base,power);break}}value*=bytesMultiplier||1}return value}})})();(function(){numeral.register("format","currency",{regexps:{format:/(\$)/},format:function(value,format,roundingFunction){var locale=numeral.locales[numeral.options.currentLocale],symbols={before:format.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:format.match(/([\+|\-|\)|\s|\$]*)$/)[0]},output,symbol,i;format=format.replace(/\s?\$\s?/,"");output=numeral._.numberToFormat(value,format,roundingFunction);if(value>=0){symbols.before=symbols.before.replace(/[\-\(]/,"");symbols.after=symbols.after.replace(/[\-\)]/,"")}else if(value<0&&(!numeral._.includes(symbols.before,"-")&&!numeral._.includes(symbols.before,"("))){symbols.before="-"+symbols.before}for(i=0;i<symbols.before.length;i++){symbol=symbols.before[i];switch(symbol){case"$":output=numeral._.insert(output,locale.currency.symbol,i);break;case" ":output=numeral._.insert(output," ",i+locale.currency.symbol.length-1);break}}for(i=symbols.after.length-1;i>=0;i--){symbol=symbols.after[i];switch(symbol){case"$":output=i===symbols.after.length-1?output+locale.currency.symbol:numeral._.insert(output,locale.currency.symbol,-(symbols.after.length-(1+i)));break;case" ":output=i===symbols.after.length-1?output+" ":numeral._.insert(output," ",-(symbols.after.length-(1+i)+locale.currency.symbol.length-1));break}}return output}})})();(function(){numeral.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(value,format,roundingFunction){var output,exponential=typeof value==="number"&&!numeral._.isNaN(value)?value.toExponential():"0e+0",parts=exponential.split("e");format=format.replace(/e[\+|\-]{1}0/,"");output=numeral._.numberToFormat(Number(parts[0]),format,roundingFunction);return output+"e"+parts[1]},unformat:function(string){var parts=numeral._.includes(string,"e+")?string.split("e+"):string.split("e-"),value=Number(parts[0]),power=Number(parts[1]);power=numeral._.includes(string,"e-")?power*=-1:power;function cback(accum,curr,currI,O){var corrFactor=numeral._.correctionFactor(accum,curr),num=accum*corrFactor*(curr*corrFactor)/(corrFactor*corrFactor);return num}return numeral._.reduce([value,Math.pow(10,power)],cback,1)}})})();(function(){numeral.register("format","ordinal",{regexps:{format:/(o)/},format:function(value,format,roundingFunction){var locale=numeral.locales[numeral.options.currentLocale],output,ordinal=numeral._.includes(format," o")?" ":"";format=format.replace(/\s?o/,"");ordinal+=locale.ordinal(value);output=numeral._.numberToFormat(value,format,roundingFunction);return output+ordinal}})})();(function(){numeral.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(value,format,roundingFunction){var space=numeral._.includes(format," %")?" ":"",output;if(numeral.options.scalePercentBy100){value=value*100}format=format.replace(/\s?\%/,"");output=numeral._.numberToFormat(value,format,roundingFunction);if(numeral._.includes(output,")")){output=output.split("");output.splice(-1,0,space+"%");output=output.join("")}else{output=output+space+"%"}return output},unformat:function(string){var number=numeral._.stringToNumber(string);if(numeral.options.scalePercentBy100){return number*.01}return number}})})();(function(){numeral.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(value,format,roundingFunction){var hours=Math.floor(value/60/60),minutes=Math.floor((value-hours*60*60)/60),seconds=Math.round(value-hours*60*60-minutes*60);return hours+":"+(minutes<10?"0"+minutes:minutes)+":"+(seconds<10?"0"+seconds:seconds)},unformat:function(string){var timeArray=string.split(":"),seconds=0;if(timeArray.length===3){seconds=seconds+Number(timeArray[0])*60*60;seconds=seconds+Number(timeArray[1])*60;seconds=seconds+Number(timeArray[2])}else if(timeArray.length===2){seconds=seconds+Number(timeArray[0])*60;seconds=seconds+Number(timeArray[1])}return Number(seconds)}})})();return numeral})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var Instances=function(_super){tslib_1.__extends(Instances,_super);function Instances(parameters){var _this=_super.call(this,parameters)||this;_this.expression=plywood_1.Expression.parse(_this.dimensionFormula);return _this}Instances.isInstances=function(candidate){return candidate instanceof Instances};Instances.fromJS=function(parameters){return new Instances(immutable_class_1.BaseImmutable.jsToValue(Instances.PROPERTIES,parameters))};Instances.prototype.getDefaultValue=function(){var values=this.values;return values[0]};Instances.prototype.getFilterFor=function(instance){var _a=this,expression=_a.expression,values=_a.values;if(!values.includes(instance))throw new Error("not one of the values");return expression.is(plywood_1.r(instance))};Instances.PROPERTIES=[{name:"dimensionFormula"},{name:"values",type:immutable_class_1.PropertyType.ARRAY}];return Instances}(immutable_class_1.BaseImmutable);exports.Instances=Instances;immutable_class_1.BaseImmutable.finalize(Instances)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var immutable_class_1=__webpack_require__(7);function ensureNotNative(name){if(name==="native"){throw new Error("can not be 'native'")}}var Cluster=function(_super){tslib_1.__extends(Cluster,_super);function Cluster(parameters){var _this=_super.call(this,parameters)||this;if(!_this.title)_this.title=_this.name;switch(_this.type){case"druid":_this.database=null;_this.user=null;_this.password=null;break;case"mysql":case"postgres":_this.introspectionStrategy=null;_this.decorator=null;_this.decoratorOptions=null;_this.socksHost=null;_this.socksUsername=null;_this.socksPassword=null;break}if(_this.ca&&_this.protocol!=="tls"){_this.ca=null}return _this}Cluster.isCluster=function(candidate){return candidate instanceof Cluster};Cluster.fromJS=function(parameters){if(!parameters.host&&(parameters.druidHost||parameters.brokerHost)){parameters.host=parameters.druidHost||parameters.brokerHost}if(typeof parameters.timeout==="string"){parameters.timeout=parseInt(parameters.timeout,10)}return new Cluster(immutable_class_1.BaseImmutable.jsToValue(Cluster.PROPERTIES,parameters))};Cluster.prototype.toClientCluster=function(){return new Cluster({name:this.name,type:this.type})};Cluster.prototype.guessTitle=function(){return"My "+this.type+" cluster"};Cluster.TYPE_VALUES=["druid","druidsql","mysql","postgres"];Cluster.DEFAULT_TIMEOUT=4e4;Cluster.DEFAULT_PROTOCOL="plain";Cluster.PROTOCOL_VALUES=["plain","tls-loose","tls"];Cluster.DEFAULT_INTROSPECTION_STRATEGY="segment-metadata-fallback";Cluster.PROPERTIES=[{name:"name",validate:[beltful_1.StringUtils.verifyUrlSafeName,ensureNotNative]},{name:"type",possibleValues:Cluster.TYPE_VALUES},{name:"host",defaultValue:null},{name:"title",defaultValue:""},{name:"version",defaultValue:null},{name:"timeout",defaultValue:Cluster.DEFAULT_TIMEOUT},{name:"protocol",defaultValue:Cluster.DEFAULT_PROTOCOL,possibleValues:Cluster.PROTOCOL_VALUES},{name:"ca",defaultValue:null},{name:"introspectionStrategy",defaultValue:Cluster.DEFAULT_INTROSPECTION_STRATEGY},{name:"decorator",defaultValue:null},{name:"decoratorOptions",defaultValue:null,equal:immutable_class_1.generalLookupsEqual},{name:"socksHost",defaultValue:null},{name:"socksUsername",defaultValue:null},{name:"socksPassword",defaultValue:null},{name:"database",defaultValue:null},{name:"user",defaultValue:null},{name:"password",defaultValue:null}];return Cluster}(immutable_class_1.BaseImmutable);exports.Cluster=Cluster;immutable_class_1.BaseImmutable.finalize(Cluster)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var colors_1=__webpack_require__(116);var split_combine_1=__webpack_require__(51);var splits_1=__webpack_require__(36);var base_manifest_1=__webpack_require__(67);var LineChartManifest=function(_super){tslib_1.__extends(LineChartManifest,_super);function LineChartManifest(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="line-chart";_this.title="Line Chart";_this.supportsMultipleMeasureMode=true;return _this}LineChartManifest.prototype.ensureSplitOrder=function(splits,primarySplitCandidate,colorSplit,dimensions){if(splits.toArray().every(function(s){return s.isBucketed()})){var timeSplits=splits.splitCombines.filter(function(s){return s.getDimension(dimensions).getKind()==="time"});var primaryTimeSplit=null;if(timeSplits.length>=1)primaryTimeSplit=timeSplits[0];if(primaryTimeSplit&&primarySplitCandidate!==primaryTimeSplit){return{primarySplit:primaryTimeSplit,colorSplit:primarySplitCandidate}}}return{primarySplit:primarySplitCandidate,colorSplit:colorSplit}};LineChartManifest.prototype.summonBucketableSplit=function(split,dimensions,filter){var isSortedOnSelf=split.isSortOnSelfAscending();var limitAction=split.limitAction,bucketAction=split.bucketAction;if(isSortedOnSelf&&!limitAction&&bucketAction)return split;var dimension=split.dimension;if(!bucketAction)split=split.addBucketGivenFilter(filter,dimensions);if(!isSortedOnSelf)split=split.changeSortAction(plywood_1.Expression._.sort(plywood_1.$(dimension),plywood_1.SortExpression.ASCENDING));if(limitAction)split=split.changeLimitAction(null);return split};LineChartManifest.prototype.summon=function(dimensions,splits,filter,measure,colors){var _this=this;var bucketable=splits.splitCombines.find(function(s){return s.isBucketable(dimensions)});var makeSplitsAdjustment=function(splits){return{splits:new splits_1.Splits(splits)}};var summonSplit=function(s){return _this.summonBucketableSplit(s,dimensions,filter)};if(splits.length()===1&&bucketable){return makeSplitsAdjustment([summonSplit(bucketable)])}else if(splits.isBucketedFollowedByUnbucketed()){var bucketedSplit=splits.get(0);var otherSplit=splits.get(1);var _a=this.ensureSplitOrder(splits,bucketedSplit,otherSplit,dimensions),primarySplit=_a.primarySplit,colorSplit=_a.colorSplit;return makeSplitsAdjustment([colorSplit,summonSplit(primarySplit)])}else if(splits.length()===2&&bucketable){var colorSplit=splits.splitCombines.filter(function(s){return!s.equals(bucketable)})[0];if(colorSplit.isBucketable(dimensions))return null;return makeSplitsAdjustment([colorSplit,summonSplit(bucketable)])}return null};LineChartManifest.prototype.canHandleSplitDimensions=function(dimensions,splitDimensions,filter,measure){var bucketableDimensions=dimensions.filter(function(d){return d.isBucketable()});var splitMaker=function(d){return split_combine_1.SplitCombine.fromDimensionAndFilterAndMeasure(d,filter,measure)};if(!splitDimensions.some(function(d){return d.isBucketable()})){return base_manifest_1.Resolve.rejectDimensions("The Line chart requires at least one bucketed split",bucketableDimensions.map(function(someDimension){return base_manifest_1.SplitSuggestion.fromTitleAndSplit("Add a split on "+someDimension.title,splitMaker(someDimension))}))}else if(!splitDimensions.length){return base_manifest_1.Resolve.rejectDimensions("The Line Chart requires at least one bucketed split",bucketableDimensions.map(function(someDimension){return base_manifest_1.SplitSuggestion.fromTitleAndSplit("Add a split on "+someDimension.title,splitMaker(someDimension))}))}else if(splitDimensions.length>2&&bucketableDimensions.length){return base_manifest_1.Resolve.rejectDimensions("Too many splits on the line chart",[base_manifest_1.SplitSuggestion.fromTitleAndSplit("Remove all but the first bucketed split",splitMaker(splitDimensions[0]))])}else{return base_manifest_1.Resolve.proceedWithDimensions()}};LineChartManifest.prototype.getSuitability=function(dimensions,splits,colors,current){var willNeedAdjust=false;var score=splits.splitCombines.some(function(s){return s.getDimension(dimensions).getKind()==="time"})?9:5;var continuousSplit=null;if(splits.length()===1){continuousSplit=splits.first();if(colors)willNeedAdjust=true}else{var colorSplit=splits.first();continuousSplit=splits.get(1);if(!colors||colors.dimension!==colorSplit.dimension||!colorSplit.limitAction){willNeedAdjust=true}}if(current)score=10;if(continuousSplit.limitAction){var r=base_manifest_1.Resolve.rejectCombines("The line chart cannot handle a limit",["table","bar-chart"]);return new base_manifest_1.Suitability(0,r)}if(!continuousSplit.isSortOnSelfAscending()){var r=base_manifest_1.Resolve.rejectCombines("The line chart cannot handle this sort",["table"]);return new base_manifest_1.Suitability(0,r)}if(!continuousSplit.isBucketed()){var r=base_manifest_1.Resolve.rejectCombines("The line chart must have a bucketed second split",["table"]);return new base_manifest_1.Suitability(0,r)}return new base_manifest_1.Suitability(willNeedAdjust?score-1:score)};LineChartManifest.prototype.getEffectiveSplits=function(splits,dimensions,sortMeasureName){var changed=false;var adjustedSplitCombines=splits.splitCombines.map(function(s,i){if(!s.sortAction){changed=true;s=s.changeSortAction(split_combine_1.SplitCombine.calculateSortOn(immutable_class_1.NamedArray.findByName(dimensions,s.dimension),sortMeasureName))}if(!s.limitAction&&splits.length()===2&&i===0){changed=true;s=s.changeLimit(5)}return s});return changed?new splits_1.Splits(adjustedSplitCombines):splits};LineChartManifest.prototype.getEffectiveColors=function(splits,colors){if(splits.length()===0||splits.length()===1){colors=null}else{var colorSplit=splits.first();var colorSplitDimension=colorSplit.dimension;if(!colors||colors.dimension!==colorSplitDimension){colors=colors_1.Colors.fromLimit(colorSplitDimension,5)}}return colors};return LineChartManifest}(base_manifest_1.Manifest);exports.LineChartManifest=LineChartManifest;exports.LINE_CHART_MANIFEST=new LineChartManifest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var split_combine_1=__webpack_require__(51);var splits_1=__webpack_require__(36);var base_manifest_1=__webpack_require__(67);var BarChartManifest=function(_super){tslib_1.__extends(BarChartManifest,_super);function BarChartManifest(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="bar-chart";_this.title="Bar Chart";_this.supportsMultipleMeasureMode=true;return _this}BarChartManifest.prototype.canHandleSplitDimensions=function(dimensions,splitDimensions,filter,measure){var getByKind=function(k){var matches=dimensions.filter(function(d){return d.kind===k}).slice(0,2);return matches.length?matches:null};var someDimensions=getByKind("number")||getByKind("boolean")||getByKind("string")||[];var splitMaker=function(d){return split_combine_1.SplitCombine.fromDimensionAndFilterAndMeasure(d,filter,measure)};if(!splitDimensions.length){return base_manifest_1.Resolve.rejectDimensions("The Bar Chart requires at least one split",someDimensions.map(function(someDimension){return base_manifest_1.SplitSuggestion.fromTitleAndSplit("Add a split on "+someDimension.title,splitMaker(someDimension))}))}else if(splitDimensions.length>2){return base_manifest_1.Resolve.rejectDimensions("Too many splits on the bar chart",[base_manifest_1.SplitSuggestion.fromTitleAndSplit("Remove all but the first split",splitMaker(splitDimensions[0]))])}else{return base_manifest_1.Resolve.proceedWithDimensions()}};BarChartManifest.prototype.getSuitability=function(dimensions,splits,colors,current){var score=current?10:4;if(splits.length()===1&&immutable_class_1.NamedArray.findByName(dimensions,splits.first().dimension).getKind()==="number")score=10;if(splits.splitCombines.some(function(s){return!s.limitAction})){score=score-1}return new base_manifest_1.Suitability(score)};BarChartManifest.prototype.getEffectiveSplits=function(splits,dimensions,sortMeasureName){var changed=false;var adjustedSplitCombines=splits.splitCombines.map(function(s){if(!s.sortAction){changed=true;s=s.changeSortAction(split_combine_1.SplitCombine.calculateSortOn(immutable_class_1.NamedArray.findByName(dimensions,s.dimension),sortMeasureName))}if(!s.limitAction){changed=true;s=s.changeLimit(25)}return s});return changed?new splits_1.Splits(adjustedSplitCombines):splits};return BarChartManifest}(base_manifest_1.Manifest);exports.BarChartManifest=BarChartManifest;exports.BAR_CHART_MANIFEST=new BarChartManifest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var splits_1=__webpack_require__(36);var base_manifest_1=__webpack_require__(67);var TotalsManifest=function(_super){tslib_1.__extends(TotalsManifest,_super);function TotalsManifest(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="totals";_this.title="Totals";_this.supportsMultipleMeasureMode=true;return _this}TotalsManifest.prototype.summon=function(dimensions,splits,filter,measure,colors){return splits.length()?{splits:splits_1.Splits.EMPTY}:null};TotalsManifest.prototype.canHandleSplitDimensions=function(dimensions){return base_manifest_1.Resolve.proceedWithDimensions()};TotalsManifest.prototype.getSuitability=function(dimensions,splits,colors,current){return!splits.length()?base_manifest_1.Suitability.MAX:new base_manifest_1.Suitability(0)};return TotalsManifest}(base_manifest_1.Manifest);exports.TotalsManifest=TotalsManifest;exports.TOTALS_MANIFEST=new TotalsManifest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var split_combine_1=__webpack_require__(51);var splits_1=__webpack_require__(36);var base_manifest_1=__webpack_require__(67);var TableManifest=function(_super){tslib_1.__extends(TableManifest,_super);function TableManifest(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="table";_this.title="Table";_this.supportsMultipleMeasureMode=true;return _this}TableManifest.prototype.canHandleSplitDimensions=function(dimensions,splitDimensions,filter,measure){if(!splitDimensions.length){var someDimensions=dimensions.filter(function(d){return d.getKind()==="string"}).slice(0,2);var splitMaker_1=function(d){return split_combine_1.SplitCombine.fromDimensionAndFilterAndMeasure(d,filter,measure)};return base_manifest_1.Resolve.rejectDimensions("The Table requires at least one split",someDimensions.map(function(someDimension){return base_manifest_1.SplitSuggestion.fromTitleAndSplit("Add a split on "+someDimension.title,splitMaker_1(someDimension))}))}return base_manifest_1.Resolve.proceedWithDimensions()};TableManifest.prototype.getSuitability=function(dimensions,splits,colors,current){var autoChanged=splits.splitCombines.some(function(s){return!s.limitAction});var score=4;if(!autoChanged){score+=2}if(current){score+=1}return new base_manifest_1.Suitability(score)};TableManifest.prototype.getEffectiveSplits=function(splits,dimensions,sortMeasureName){var changed=false;var adjustedSplitCombines=splits.splitCombines.map(function(s,i){if(!s.sortAction){changed=true;s=s.changeSortAction(split_combine_1.SplitCombine.calculateSortOn(immutable_class_1.NamedArray.findByName(dimensions,s.dimension),sortMeasureName))}if(!s.limitAction){changed=true;s=s.changeLimit(i?5:50)}return s});return changed?new splits_1.Splits(adjustedSplitCombines):splits};return TableManifest}(base_manifest_1.Manifest);exports.TableManifest=TableManifest;exports.TABLE_MANIFEST=new TableManifest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var split_combine_1=__webpack_require__(51);var splits_1=__webpack_require__(36);var base_manifest_1=__webpack_require__(67);var GridManifest=function(_super){tslib_1.__extends(GridManifest,_super);function GridManifest(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="grid";_this.title="Grid";return _this}GridManifest.prototype.canHandleSplitDimensions=function(dimensions,splitDimensions,filter,measure){if(splitDimensions.length===2)return base_manifest_1.Resolve.proceedWithDimensions();var someDimensions=dimensions.slice(0,2);var splitMaker=function(d){return split_combine_1.SplitCombine.fromDimensionAndFilterAndMeasure(d,filter,measure)};if(someDimensions.length!==2){return base_manifest_1.Resolve.rejectDimensions("Not enough dimensions in this data cube for a Grid",[])}if(!splitDimensions.length){return base_manifest_1.Resolve.rejectDimensions("The Grid requires two splits",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("splitting on "+someDimensions.map(function(d){return d.title}).join(", "),new splits_1.Splits(someDimensions.map(splitMaker)))])}else if(splitDimensions.length===1){var splitDim_1=splitDimensions[0];var additionalDimension=dimensions.find(function(d){return!d.equals(splitDim_1)});if(!additionalDimension)throw new Error;return base_manifest_1.Resolve.rejectDimensions("The Grid requires two splits",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("adding a split on "+additionalDimension.title,new splits_1.Splits([splitMaker(splitDim_1),splitMaker(additionalDimension)]))])}else{return base_manifest_1.Resolve.rejectDimensions("Too many splits on the Grid",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("removing all but the first two splits",new splits_1.Splits(someDimensions.map(splitMaker)))])}};GridManifest.prototype.getEffectiveSplits=function(splits,dimensions,sortMeasureName){var changed=false;var adjustedSplitCombines=splits.splitCombines.map(function(s){if(!s.sortAction){changed=true;s=s.changeSortAction(split_combine_1.SplitCombine.calculateSortOn(immutable_class_1.NamedArray.findByName(dimensions,s.dimension),sortMeasureName))}if(!s.limitAction){changed=true;s=s.changeLimit(25)}return s});return changed?new splits_1.Splits(adjustedSplitCombines):splits};GridManifest.prototype.getSuitability=function(dimensions,splits,colors,current){var numContSplits=splits.splitCombines.filter(function(s){return s.getDimension(dimensions).isContinuous()}).length;return new base_manifest_1.Suitability(3+(numContSplits>1?6:0))};return GridManifest}(base_manifest_1.Manifest);exports.GridManifest=GridManifest;exports.GRID_MANIFEST=new GridManifest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var split_combine_1=__webpack_require__(51);var splits_1=__webpack_require__(36);var base_manifest_1=__webpack_require__(67);var HeatmapManifest=function(_super){tslib_1.__extends(HeatmapManifest,_super);function HeatmapManifest(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="heatmap";_this.title="Heatmap";return _this}HeatmapManifest.prototype.canHandleSplitDimensions=function(dimensions,splitDimensions,filter,measure){if(splitDimensions.length===2)return base_manifest_1.Resolve.proceedWithDimensions();var someDimensions=dimensions.slice(0,2);var splitMaker=function(d){return split_combine_1.SplitCombine.fromDimensionAndFilterAndMeasure(d,filter,measure)};if(someDimensions.length!==2){return base_manifest_1.Resolve.rejectDimensions("Not enough dimensions in this data cube for a Heatmap",[])}if(!splitDimensions.length){return base_manifest_1.Resolve.rejectDimensions("The Heatmap requires two splits",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("splitting on "+someDimensions.map(function(d){return d.title}).join(", "),new splits_1.Splits(someDimensions.map(splitMaker)))])}else if(splitDimensions.length===1){var splitDim_1=splitDimensions[0];var additionalDimension=dimensions.find(function(d){return!d.equals(splitDim_1)});if(!additionalDimension)throw new Error;return base_manifest_1.Resolve.rejectDimensions("The Heatmap requires two splits",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("adding a split on "+additionalDimension.title,new splits_1.Splits([splitMaker(splitDim_1),splitMaker(additionalDimension)]))])}else{return base_manifest_1.Resolve.rejectDimensions("Too many splits on the Heatmap",[base_manifest_1.SplitSuggestion.fromTitleAndSplits("removing all but the first two splits",new splits_1.Splits(someDimensions.map(splitMaker)))])}};HeatmapManifest.prototype.getEffectiveSplits=function(splits,dimensions,sortMeasureName){var changed=false;var adjustedSplitCombines=splits.splitCombines.map(function(s){if(!s.sortAction){changed=true;s=s.changeSortAction(split_combine_1.SplitCombine.calculateSortOn(immutable_class_1.NamedArray.findByName(dimensions,s.dimension),sortMeasureName))}if(!s.limitAction){changed=true;s=s.changeLimit(25)}return s});return changed?new splits_1.Splits(adjustedSplitCombines):splits};HeatmapManifest.prototype.getSuitability=function(dimensions,splits,colors,current){var numContSplits=splits.splitCombines.filter(function(s){return s.getDimension(dimensions).isContinuous()}).length;return new base_manifest_1.Suitability(3+(numContSplits>1?6:0))};return HeatmapManifest}(base_manifest_1.Manifest);exports.HeatmapManifest=HeatmapManifest;exports.HEATMAP_MANIFEST=new HeatmapManifest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var split_combine_1=__webpack_require__(51);var base_manifest_1=__webpack_require__(67);var GeoManifest=function(_super){tslib_1.__extends(GeoManifest,_super);function GeoManifest(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="geo";_this.title="Geo";return _this}GeoManifest.prototype.canHandleSplitDimensions=function(dimensions,splitDimensions,filter,measure){if(splitDimensions.length&&splitDimensions.every(function(d){return d.geo})){return base_manifest_1.Resolve.proceedWithDimensions()}var geoDimensions=dimensions.filter(function(d){return d.isGeo()});if(geoDimensions.length){return base_manifest_1.Resolve.rejectDimensions("The Geo visualization requires one geo split",geoDimensions.map(function(d){return base_manifest_1.SplitSuggestion.fromTitleAndSplit("Split on "+d.title,split_combine_1.SplitCombine.fromDimensionAndFilterAndMeasure(d,filter,measure))}))}else{return base_manifest_1.Resolve.rejectDimensions("The Geo visualization needs a geo split.",[])}};GeoManifest.prototype.getSuitability=function(dimensions,splits,colors,current){var autoChanged=splits.splitCombines.some(function(s){return!s.sortAction});return autoChanged?new base_manifest_1.Suitability(8):new base_manifest_1.Suitability(10)};return GeoManifest}(base_manifest_1.Manifest);exports.GeoManifest=GeoManifest;exports.GEO_MANIFEST=new GeoManifest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var immutable_class_1=__webpack_require__(7);var collection_tile_1=__webpack_require__(385);var filter_1=__webpack_require__(53);var theme_1=__webpack_require__(176);var access_list_1=__webpack_require__(187);var general_1=__webpack_require__(43);var Collection=function(_super){tslib_1.__extends(Collection,_super);function Collection(parameters){var _this=_super.call(this,parameters)||this;_this.tiles=Collection.fitTiles(_this.tiles)||[];return _this}Collection.isCollection=function(candidate){return candidate instanceof Collection};Collection.fitTiles=function(tiles){var existingStages=tiles.map(function(tile){return tile.position}).filter(Boolean);var possibleColumns=Collection.DEFAULT_TILE_SIZE.width+1;var pos=0;function getStageForPos(){return Collection.DEFAULT_TILE_SIZE.changeXY(pos%possibleColumns,Math.floor(pos/possibleColumns))}function findNextPosition(){var s=getStageForPos();while(existingStages.some(function(es){return es.overlapsWith(s)})){pos++;s=getStageForPos()}existingStages.push(s);return s}return tiles.map(function(tile){return tile.position?tile:tile.changePosition(findNextPosition())})};Collection.fromJS=function(parameters,context){if(context===void 0){context={}}if(!parameters.name)throw new Error("Collection must have a name");var tiles=parameters.tiles||parameters.items||parameters.linkItems||[];return new Collection({title:parameters.title,name:parameters.name,description:parameters.description,theme:parameters.theme,readAccess:parameters.readAccess?access_list_1.AccessList.fromJS(parameters.readAccess):null,modifyAccess:parameters.modifyAccess?access_list_1.AccessList.fromJS(parameters.modifyAccess):null,shareTimezone:parameters.shareTimezone,enforceTimeFilter:parameters.enforceTimeFilter,tiles:tiles.map(function(tile){return collection_tile_1.CollectionTile.fromJS(tile,context)})})};Collection.prototype.isReady=function(){return this.tiles.every(function(tile){return tile.isReady()})};Collection.prototype.getDefaultTile=function(){return this.tiles[0]};Collection.prototype.isNameAvailable=function(name){return!this.getCollectionTile(name)};Collection.prototype.dependsOnDataCube=function(dataCubeName){return this.tiles.some(function(tile){return tile.essence.dataCube===dataCubeName})};Collection.prototype.getCommonDataCube=function(){var _a=this,tiles=_a.tiles,enforceTimeFilter=_a.enforceTimeFilter,theme=_a.theme;tiles=tiles.filter(function(t){return t.isVisualization()&&t.getDataCube()});if(!tiles.length)return null;var firstDataCube=tiles[0].getDataCube().changeEnforceTimeFilter(Boolean(enforceTimeFilter)).changeTheme(theme);var dimensions=[];var seenDimensions={};var seenDataCubes={};for(var _i=0,tiles_1=tiles;_i<tiles_1.length;_i++){var tile=tiles_1[_i];var tileDataCube=tile.getDataCube();if(seenDataCubes[tileDataCube.name])continue;seenDataCubes[tileDataCube.name]=true;var tileDataCubeDimensions=tileDataCube.dimensions;for(var _b=0,tileDataCubeDimensions_1=tileDataCubeDimensions;_b<tileDataCubeDimensions_1.length;_b++){var dimension=tileDataCubeDimensions_1[_b];if(!seenDimensions[dimension.name]){dimensions.push(dimension);seenDimensions[dimension.name]=true}}}return firstDataCube.changeDimensions(dimensions)};Collection.prototype.getDeltaSourceFilter=function(){var _a=this,tiles=_a.tiles,enforceTimeFilter=_a.enforceTimeFilter;tiles=tiles.filter(function(t){return t.isVisualization()&&t.getDataCube()});if(enforceTimeFilter||!tiles.length)return null;return tiles[0].getDataCube().addMandatoryFiltersIfNeeded(filter_1.Filter.EMPTY)};Collection.prototype.makeDuplicate=function(newName,newOwner){return this.changeMany({name:newName,title:this.title+" (copy)",modifyAccess:access_list_1.AccessList.onlyFor(newOwner.name)})};Collection.prototype.getCollectionTile=function(name){return immutable_class_1.NamedArray.findByName(this.tiles,name)};Collection.prototype.getSummaries=function(){var tiles=this.tiles;if(!tiles.length)return["Empty dashboard"];var dataCubes=tiles.filter(function(t){return t.isVisualization()}).map(function(t){return t.essence.dataCube}).filter(function(v,i,a){return a.indexOf(v)===i});var n=dataCubes.length;return[n===1&&tiles[0].essence.actualDataCube?tiles[0].essence.actualDataCube.title:general_1.pluralIfNeeded(n,"data cube"),general_1.pluralIfNeeded(tiles.length,"visualization")]};Collection.prototype.addOrUpdateTile=function(tile){return this.changeTiles(immutable_class_1.NamedArray.overrideByName(this.tiles,tile))};Collection.prototype.deleteTile=function(tileName){return this.changeTiles(immutable_class_1.NamedArray.deleteByName(this.tiles,tileName))};Collection.prototype.duplicateTile=function(name){var _this=this;var tile=this.getCollectionTile(name);var newName=beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!_this.getCollectionTile(name)}});return this.addOrUpdateTile(tile.makeDuplicate(newName))};Collection.prototype.constrainTilesToDataCubes=function(dataCubes){return this.changeTiles(this.tiles.filter(function(tile){return!tile.essence||immutable_class_1.NamedArray.containsByName(dataCubes,tile.essence.dataCube)}))};Collection.prototype.getEffectiveTheme=function(defaultTheme){return theme_1.Theme.getEffectiveTheme(this.theme||defaultTheme)};Collection.prototype.getAvailableName=function(){var _this=this;return beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!_this.getCollectionTile(name)}})};Collection.prototype.initAccess=function(user){return this.changeMany({readAccess:access_list_1.AccessList.ALL,modifyAccess:access_list_1.AccessList.fromJS({access:"single",users:[user.name]})})};Collection.DEFAULT_TILE_SIZE=beltful_1.Stage.fromSize(8,5);Collection.PROPERTIES=[{name:"name",validate:beltful_1.StringUtils.verifyUrlSafeName},{name:"title",defaultValue:null},{name:"description",defaultValue:null},{name:"theme",defaultValue:theme_1.Theme.DEFAULT_NAME},{name:"readAccess",immutableClass:access_list_1.AccessList,defaultValue:access_list_1.AccessList.ALL},{name:"modifyAccess",immutableClass:access_list_1.AccessList,defaultValue:access_list_1.AccessList.ALL},{name:"verticalUnits",defaultValue:null},{name:"shareTimezone",defaultValue:false},{name:"enforceTimeFilter",defaultValue:false},{name:"tiles",immutableClassArray:collection_tile_1.CollectionTile}];return Collection}(immutable_class_1.BaseImmutable);exports.Collection=Collection;immutable_class_1.BaseImmutable.finalize(Collection)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var chronoshift_1=__webpack_require__(23);var immutable_class_1=__webpack_require__(7);var lz_string_1=__webpack_require__(184);var beltful_1=__webpack_require__(8);var filter_1=__webpack_require__(53);var highlight_1=__webpack_require__(117);var essence_1=__webpack_require__(70);var splits_1=__webpack_require__(36);var check;var CollectionEssence=function(){function CollectionEssence(parameters){var actualCollection=parameters.actualCollection,commonDataCube=parameters.commonDataCube,collection=parameters.collection,instance=parameters.instance,timezone=parameters.timezone,filter=parameters.filter,highlight=parameters.highlight,highlightOwner=parameters.highlightOwner;this.actualCollection=actualCollection;this.commonDataCube=commonDataCube;if(commonDataCube){filter=commonDataCube.addMandatoryFiltersIfNeeded(filter)}this.collection=collection;this.instance=instance;this.timezone=timezone;this.filter=filter;this.highlight=highlight;this.highlightOwner=highlightOwner}CollectionEssence.isCollectionEssence=function(candidate){return candidate instanceof CollectionEssence};CollectionEssence.fromFullHash=function(hash,context){if(context===void 0){context={}}var actualCollection=context.actualCollection,collections=context.collections;try{var collectionEssenceJS=JSON.parse(lz_string_1.decompressFromBase64(beltful_1.StringUtils.untidyB64(hash)));var context_1={};if(!actualCollection&&collections){var actualCollection_1=immutable_class_1.NamedArray.findByName(collections,collectionEssenceJS.collection);if(!actualCollection_1)return null;context_1.actualCollection=actualCollection_1}return CollectionEssence.fromJS(collectionEssenceJS,context_1)}catch(e){return null}};CollectionEssence.fromCollection=function(collection){var commonDataCube=collection.getCommonDataCube();return new CollectionEssence({actualCollection:collection,commonDataCube:commonDataCube,collection:collection.name,instance:commonDataCube?commonDataCube.getDefaultInstance():null,timezone:commonDataCube?commonDataCube.getDefaultTimezone():chronoshift_1.Timezone.UTC,filter:commonDataCube?commonDataCube.getDefaultFilter():filter_1.Filter.EMPTY,highlight:null,highlightOwner:null})};CollectionEssence.fromJS=function(parameters,context){if(context===void 0){context={}}var collections=context.collections,actualCollection=context.actualCollection;var collection=parameters.collection;var timezone=parameters.timezone?chronoshift_1.Timezone.fromJS(parameters.timezone):null;var filter=parameters.filter?filter_1.Filter.fromJS(parameters.filter):filter_1.Filter.EMPTY;var highlight=parameters.highlight?highlight_1.Highlight.fromJS(parameters.highlight):null;var highlightOwner=parameters.highlightOwner;if(!actualCollection&&collections){actualCollection=immutable_class_1.NamedArray.findByName(collections,parameters.collection)}var commonDataCube=null;if(actualCollection){if(collection!==actualCollection.name)throw new Error("data cube '"+collection+"' and actual data cube name "+actualCollection.name);commonDataCube=actualCollection.getCommonDataCube();if(commonDataCube){filter=filter.constrainToDimensions(commonDataCube.dimensions);if(highlight){highlight=highlight.constrainToDimensions(commonDataCube.dimensions)}}}else{if(!parameters.collection)throw new Error("must have collection or actual collection")}return new CollectionEssence({actualCollection:actualCollection,commonDataCube:commonDataCube,collection:collection,instance:parameters.instance,timezone:timezone,filter:filter,highlight:highlight,highlightOwner:highlightOwner})};CollectionEssence.prototype.valueOf=function(){return{actualCollection:this.actualCollection,commonDataCube:this.commonDataCube,collection:this.collection,instance:this.instance,timezone:this.timezone,filter:this.filter,highlight:this.highlight,highlightOwner:this.highlightOwner}};CollectionEssence.prototype.toJS=function(){var js={collection:this.collection,timezone:this.timezone.toJS(),filter:this.filter.toJS()};if(this.instance)js.instance=this.instance;if(this.highlight){js.highlight=this.highlight.toJS();js.highlightOwner=this.highlightOwner}return js};CollectionEssence.prototype.toJSON=function(){return this.toJS()};CollectionEssence.prototype.toString=function(){return"[CollectionEssence]"};CollectionEssence.prototype.equals=function(other){return CollectionEssence.isCollectionEssence(other)&&this.collection===other.collection&&this.instance===other.instance&&this.timezone.equals(other.timezone)&&this.filter.equals(other.filter)&&immutable_class_1.immutableEqual(this.highlight,other.highlight)&&this.highlightOwner===other.highlightOwner};CollectionEssence.prototype.getEssence=function(visualizations){var _a=this,commonDataCube=_a.commonDataCube,instance=_a.instance,timezone=_a.timezone,filter=_a.filter,highlight=_a.highlight;if(!commonDataCube)return null;return new essence_1.Essence({actualDataCube:commonDataCube,visualizations:visualizations,defaultMeasureModes:{},dataCube:commonDataCube.name,instance:instance,visualization:null,timezone:timezone,filter:filter,splits:splits_1.Splits.EMPTY,singleMeasure:commonDataCube.getDefaultSortMeasure(),selectedMeasures:commonDataCube.getDefaultSelectedMeasures(),pinnedDimensions:[],colors:null,pinnedSort:null,highlight:highlight})};CollectionEssence.prototype.getHash=function(){return beltful_1.StringUtils.objectHashHex18(this.toJS())};CollectionEssence.prototype.toFullHash=function(){return beltful_1.StringUtils.tidyB64(lz_string_1.compressToBase64(JSON.stringify(this)))};CollectionEssence.prototype.ensureActualCollection=function(){var actualCollection=this.actualCollection;if(!actualCollection)throw new Error("must have actual collection");return actualCollection};CollectionEssence.prototype.changeInstance=function(instance){var value=this.valueOf();value.instance=instance;return new CollectionEssence(value)};CollectionEssence.prototype.changeFilter=function(filter,removeHighlight){if(removeHighlight===void 0){removeHighlight=false}var value=this.valueOf();value.filter=filter;if(removeHighlight){value.highlight=null}return new CollectionEssence(value)};CollectionEssence.prototype.addToFilter=function(delta,removeHighlight){if(removeHighlight===void 0){removeHighlight=false}return this.changeFilter(this.filter.applyDelta(delta),removeHighlight)};CollectionEssence.prototype.changeTimezone=function(newTimezone){var timezone=this.timezone;if(timezone===newTimezone)return this;var value=this.valueOf();value.timezone=newTimezone;return new CollectionEssence(value)};CollectionEssence.prototype.acceptHighlight=function(){var highlight=this.highlight;if(!highlight)return this;return this.addToFilter(highlight.delta,true)};CollectionEssence.prototype.changeHighlightFor=function(newHighlightOwner,newHighlight){var _a=this,highlight=_a.highlight,highlightOwner=_a.highlightOwner;var value;if(highlight&&highlightOwner!==newHighlightOwner){value=this.addToFilter(highlight.delta).valueOf()}else{value=this.valueOf()}value.highlight=newHighlight;value.highlightOwner=newHighlightOwner;return new CollectionEssence(value)};CollectionEssence.prototype.dropHighlight=function(){var value=this.valueOf();value.highlight=null;return new CollectionEssence(value)};CollectionEssence.prototype.canInvertHighlight=function(){var highlight=this.highlight;if(!highlight)return false;if(immutable_class_1.NamedArray.findByName(this.commonDataCube.dimensions,highlight.delta.clauses[0].dimension).isContinuous())return false;return true};CollectionEssence.prototype.invertHighlight=function(){var _a=this,highlight=_a.highlight,highlightOwner=_a.highlightOwner;return this.changeHighlightFor(highlightOwner,highlight.invert())};CollectionEssence.prototype.getTileEssence=function(collectionTile){if(!collectionTile.isVisualization()||!collectionTile.getDataCube())return null;var _a=this,filter=_a.filter,highlight=_a.highlight,highlightOwner=_a.highlightOwner,instance=_a.instance,timezone=_a.timezone;var effectiveEssence=collectionTile.essence.addToFilter(filter).changeHighlight(highlight);if(highlight&&highlightOwner!==collectionTile.name){effectiveEssence=effectiveEssence.acceptHighlight()}if(instance){effectiveEssence=effectiveEssence.changeInstance(instance)}if(timezone){effectiveEssence=effectiveEssence.changeTimezone(timezone)}return effectiveEssence};CollectionEssence.prototype.hasSpecialTimeDimension=function(){var actualCollection=this.ensureActualCollection();return actualCollection.tiles.some(function(tile){var dataCube=tile.getDataCube();return Boolean(dataCube&&dataCube.getSpecialTimeDimensionObject())})};CollectionEssence.prototype.updatedText=function(timekeeper){var actualCollection=this.ensureActualCollection();var tiles=actualCollection.tiles;for(var _i=0,tiles_1=tiles;_i<tiles_1.length;_i++){var tile=tiles_1[_i];var dataCube=tile.getDataCube();if(!dataCube||!dataCube.getSpecialTimeDimensionObject())continue;return dataCube.updatedText(timekeeper,this.timezone||chronoshift_1.Timezone.UTC)}return null};return CollectionEssence}();exports.CollectionEssence=CollectionEssence;check=CollectionEssence},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var SettingsVersion=function(_super){tslib_1.__extends(SettingsVersion,_super);function SettingsVersion(parameters){return _super.call(this,parameters)||this}SettingsVersion.isSettingsVersion=function(candidate){return candidate instanceof SettingsVersion};SettingsVersion.fromJS=function(parameters){return new SettingsVersion(immutable_class_1.BaseImmutable.jsToValue(SettingsVersion.PROPERTIES,parameters))};SettingsVersion.current=function(){return new SettingsVersion({time:new Date})};SettingsVersion.prototype.getMs=function(){return this.time.valueOf()};SettingsVersion.PROPERTIES=[{name:"time",type:immutable_class_1.PropertyType.DATE}];return SettingsVersion}(immutable_class_1.BaseImmutable);exports.SettingsVersion=SettingsVersion;immutable_class_1.BaseImmutable.finalize(SettingsVersion)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var chronoshift_1=__webpack_require__(23);var immutable_class_1=__webpack_require__(7);var owasp=__webpack_require__(481);var external_view_1=__webpack_require__(402);var theme_1=__webpack_require__(176);var Customization=function(_super){tslib_1.__extends(Customization,_super);function Customization(parameters){return _super.call(this,parameters)||this}Customization.isCustomization=function(candidate){return candidate instanceof Customization};Customization.fromJS=function(parameters){if(!parameters.theme&&parameters.headerBackground){parameters.theme=theme_1.Theme.DEFAULT.changeMainColor(parameters.headerBackground)}if(!parameters.menuLogoSvg&&parameters.customLogoSvg){parameters.menuLogoSvg=parameters.customLogoSvg}return new Customization(immutable_class_1.BaseImmutable.jsToValue(Customization.PROPERTIES,parameters))};Customization.prototype.getTitleWithVersion=function(version){return this.getTitle().replace(/%v/g,version)};Customization.prototype.getIssueWithPass=function(pass){var myOpts=Object.assign({},Customization.DEFAULT_PASS_RULE_OPTIONS,this.getPassRuleOptions());owasp.config(myOpts);var result=owasp.test(pass);if(result.requiredTestErrors.length){return result.requiredTestErrors[0]}return null};Customization.prototype.getEffectiveTheme=function(){return theme_1.Theme.getEffectiveTheme(this.theme)};Customization.prototype.getPreferredTheme=function(preferredTheme){var myEffectiveTheme=this.getEffectiveTheme();if(this.individualThemes==="disable")return myEffectiveTheme;return theme_1.Theme.getEffectiveTheme(preferredTheme,myEffectiveTheme)};Customization.prototype.renameFilterOrSplit=function(){var _a=this,renameFilterTo=_a.renameFilterTo,renameSplitTo=_a.renameSplitTo;return Boolean(renameFilterTo||renameSplitTo)};Customization.SETTINGS_MODE_NORMAL="normal";Customization.SETTINGS_MODE_SUPPRESSED="suppressed";Customization.DEFAULT_TITLE="Pivot (%v)";Customization.DEFAULT_TIMEZONES=[new chronoshift_1.Timezone("America/Juneau"),new chronoshift_1.Timezone("America/Los_Angeles"),new chronoshift_1.Timezone("America/Yellowknife"),new chronoshift_1.Timezone("America/Phoenix"),new chronoshift_1.Timezone("America/Denver"),new chronoshift_1.Timezone("America/Mexico_City"),new chronoshift_1.Timezone("America/Chicago"),new chronoshift_1.Timezone("America/New_York"),new chronoshift_1.Timezone("America/Argentina/Buenos_Aires"),chronoshift_1.Timezone.UTC,new chronoshift_1.Timezone("Asia/Jerusalem"),new chronoshift_1.Timezone("Europe/Paris"),new chronoshift_1.Timezone("Asia/Kathmandu"),new chronoshift_1.Timezone("Asia/Hong_Kong"),new chronoshift_1.Timezone("Asia/Seoul"),new chronoshift_1.Timezone("Pacific/Guam")];Customization.DEFAULT_PASS_RULE_OPTIONS={allowPassphrases:true,maxLength:128,minLength:8,minPhraseLength:20,minOptionalTestsToPass:4};Customization.PROPERTIES=[{name:"title",defaultValue:Customization.DEFAULT_TITLE},{name:"theme",defaultValue:null,immutableClass:{fromJS:theme_1.Theme.fromNameOrJS},toJS:theme_1.Theme.toNameOrJS},{name:"homeLogoSvg",defaultValue:null},{name:"menuLogoSvg",defaultValue:null},{name:"externalViews",defaultValue:[],immutableClassArray:external_view_1.ExternalView},{name:"timezones",defaultValue:Customization.DEFAULT_TIMEZONES,immutableClassArray:chronoshift_1.Timezone},{name:"logoutHref",defaultValue:null},{name:"launcherHref",defaultValue:null},{name:"linkViewMode",defaultValue:false},{name:"singleClusterMode",defaultValue:false},{name:"passRuleOptions",defaultValue:Customization.DEFAULT_PASS_RULE_OPTIONS,equal:function(a,b){return JSON.stringify(a)===JSON.stringify(b)}},{name:"settingsMode",defaultValue:Customization.SETTINGS_MODE_NORMAL},{name:"clientMonitor",defaultValue:"allow"},{name:"renameFilterTo",defaultValue:null},{name:"renameSplitTo",defaultValue:null},{name:"rawDataLimit",defaultValue:100},{name:"splitLimits",defaultValue:null,type:immutable_class_1.PropertyType.ARRAY},{name:"individualThemes",defaultValue:"allow"}];return Customization}(immutable_class_1.BaseImmutable);exports.Customization=Customization;immutable_class_1.BaseImmutable.finalize(Customization);Customization.BLANK=Customization.fromJS({})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var check;var ExternalView=function(){function ExternalView(parameters){var title=parameters.title,linkGenerator=parameters.linkGenerator;if(!title)throw new Error("External view must have title");if(typeof linkGenerator!=="string")throw new Error("Must provide link generator function");this.title=title;this.linkGenerator=linkGenerator;var linkGeneratorFnRaw=null;try{linkGeneratorFnRaw=new Function("dataCube","dataSource","timezone","filter","splits",linkGenerator)}catch(e){throw new Error("Error constructing link generator function: "+e.message)}this.linkGeneratorFn=function(dataCube,timezone,filter,splits){try{return linkGeneratorFnRaw(dataCube,dataCube,timezone,filter,splits)}catch(e){console.warn("Error with custom link generating function '"+title+"': "+e.message+" ["+linkGenerator+"]");return null}};this.sameWindow=Boolean(parameters.sameWindow)}ExternalView.isExternalView=function(candidate){return candidate instanceof ExternalView};ExternalView.fromJS=function(parameters){var value=parameters;return new ExternalView({title:value.title,linkGenerator:value.linkGenerator,linkGeneratorFn:value.linkGeneratorFn,sameWindow:value.sameWindow})};ExternalView.prototype.toJS=function(){var js={title:this.title,linkGenerator:this.linkGenerator};if(this.sameWindow===true)js.sameWindow=true;return js};ExternalView.prototype.valueOf=function(){var value={title:this.title,linkGenerator:this.linkGenerator};if(this.sameWindow===true)value.sameWindow=true;return value};ExternalView.prototype.toJSON=function(){return this.toJS()};ExternalView.prototype.equals=function(other){return ExternalView.isExternalView(other)&&this.title===other.title&&this.linkGenerator===other.linkGenerator&&this.sameWindow===other.sameWindow};ExternalView.prototype.toString=function(){return this.title+": "+this.linkGenerator};return ExternalView}();exports.ExternalView=ExternalView;check=ExternalView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var MeasureFilter=function(_super){tslib_1.__extends(MeasureFilter,_super);function MeasureFilter(params){if(params===void 0){params={}}return _super.call(this,params)||this}MeasureFilter.fromJS=function(params){return new MeasureFilter(immutable_class_1.BaseImmutable.jsToValue(MeasureFilter.PROPERTIES,params))};MeasureFilter.fromExpression=function(filter){if(!filter)return null;var isNegated=false;if(filter.op==="not"){filter=filter.operand;isNegated=true}var operator;if(["is","isnt"].includes(filter.op)){operator=isNegated?"!=":"=="}return new MeasureFilter({column:filter.operand.name,operator:operator,value:filter.expression.value})};MeasureFilter.prototype.isSimpleFilter=function(){return!!this.column&&!!this.operator&&typeof this.value==="string"};MeasureFilter.prototype.toString=function(){return"$"+this.column+" "+this.operator+" '"+(this.value||"")+"'"};MeasureFilter.OPERATORS=[{label:"is",value:"=="},{label:"is not",value:"!="}];MeasureFilter.PROPERTIES=[{name:"column",defaultValue:"count"},{name:"operator",defaultValue:MeasureFilter.OPERATORS[0].value,possibleValues:MeasureFilter.OPERATORS.map(function(o){return o.value})},{name:"value",defaultValue:""}];return MeasureFilter}(immutable_class_1.BaseImmutable);exports.MeasureFilter=MeasureFilter;immutable_class_1.BaseImmutable.finalize(MeasureFilter)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var cluster_1=__webpack_require__(390);var data_cube_1=__webpack_require__(188);var measure_1=__webpack_require__(177);var ATTRIBUTE={name:{label:"Name",description:"Must correspond exactly to the name of the column in the source."},type:{label:"Type",description:"The attribute's type"},nativeType:{label:"Native Type",description:"The native type of this attribute in the underlying storage. In Druid this could be a 'sketch' column like hyperUnique, thetaSketch, and approxHistogram"},unsplittable:{label:"Un-splittable",description:"An column is unsplitable (a.k.a. a metric in Druid terms) if it is already partially aggregated due to rollup.\n      In such cases splitting or filtering on this column is nonsensical"},isPrimary:{label:"Is Primary",description:"Is this time attribute the primary one that must always be filtered on (conventionally called '__time' in Druid)"}};var DIMENSION={title:{label:"Name",description:"The display name for this dimension."},type:{label:"Type",description:"The dimension's type"},geoEncoding:{label:"Geo Encoding",description:"The dimension's encoding, in case it is a geo dimension. Can be either\n    <code>ISO 3166-1 Alpha-2</code>, <code>ISO 3166-1 Alpha-3</code>, <code>UN M49</code>."},formula:{label:"Formula",description:'The <a href="http://plywood.imply.io/expressions" target="_blank">\n      Plywood expression</a> for this dimension. By default it is <code>$name</code> where <em>name</em> is\n      the name of the dimension. You can create derived dimensions by using\n      non-trivial formulas.'},column:{label:"Column",description:"The column for this dimension."},url:{label:"URL",description:"A url associated with the dimension, with optional token '%s' that\n    is replaced by the dimension value to generate a link specific to each value."},granularities:{label:"Granularities",description:"A set of exactly 5 granularities that you want to be available for bucketing."},bucketingStrategy:{label:"Possible Bucketing",description:"Specify if this dimension should be bucketed and if the bucketing should be applied by default."}};DIMENSION["comboType"]=DIMENSION["type"];DIMENSION["name"]=DIMENSION["title"];var COLLECTION={title:{label:"Title",description:"The display name for this collection. Can be anything and is safe\n    to change at any time."},description:{label:"Description",description:"The description of the collection (shown the home view)."},theme:{label:"Color theme",description:"The color theme for the header and background of this data cube"},readAccess:{label:"Can view",description:""},modifyAccess:{label:"Can edit",description:""},enforceTimeFilter:{label:"Enforce time filter",description:"Ensure that every query is filtered on the primary time dimension."+"This should be used if time unbounded queries are likely to be slow due to the volume and tearing of data."}};var COLLECTION_ITEM={title:{label:"Name",description:"The display name for this item."},description:{label:"Description",description:"The description of the collection item (shown in both the\n    overview and the detailed view."}};var MEASURE={title:{label:"Name",description:"The display name for this measure."},units:{label:"Units",description:"The optional units for this measure. Units will be shown after the title."},formula:{label:"Formula",description:'The <a href="http://plywood.imply.io/expressions" target="_blank">\n      Plywood expression</a> for this measure. By default it is\n      <code>$main.sum($name)</code> where <em>name</em> is the name of the measure.'},transform:{label:"Transform",description:"Have the measure transformed in within the UI.\n      You can represent the measure as a percent of the parent split or as a percent of the global total."},format:{label:"Format",description:'The <a href="http://numeraljs.com/" target="_blank">\n      Numeral.js</a> expression for formatting values of this measure. By default it is\n      <code>'+measure_1.Measure.DEFAULT_FORMAT+"</code>."}};var CLUSTER={title:{label:"Name",description:"The name of the Cluster."},type:{label:"Type",description:"The database type of the cluster"},host:{label:"Host",description:"The host (hostname:port) of the cluster. In the Druid case this must be the broker."},version:{label:"Version (optional)",description:"The explicit version to use for this cluster.\n      This should be defined if for some reason the version was incorrectly determined through introspection."},timeout:{label:"Timeout (ms)",description:"The timeout to set on the queries. Default is <code>"+cluster_1.Cluster.DEFAULT_TIMEOUT+"</code>"},protocol:{label:"Protocol",description:"The protocol to use for the connection.\n    Can be Plaintext, TLS, or loose TLS (that will not check the certificate)"},ca:{label:"Certificate authority",description:"An optional trusted certificate of the certificate authority if using self-signed certificates.\n    Should be a PEM formatted text"},introspectionStrategy:{label:"Introspection strategy",description:"The introspection strategy for the Druid external."},decorator:{label:"Request decorator",description:"The request decorator module to load."},decoratorOptions:{label:"Request decorator options",description:"The options to pe passed to the request decorator."},database:{label:"Database",description:"The database to which to connect to."},user:{label:"User",description:"The user to connect as. This user needs no permissions other than SELECT."},password:{label:"Password",description:"The password to use with the provided user."},socksHost:{label:"Socks Host",description:"An optional Socks5 proxy host to route confections through."},socksUsername:{label:"Socks Username",description:"The user for the Socks proxy, leave blank for unauthenticated access."},socksPassword:{label:"Socks Password",description:"The password for proxy authentication."}};var CUSTOMIZATION={title:{label:"Title",description:"What will appear as the tab's title in your browser. Use <code>%v</code> as a placeholder for Pivot's version."},timezones:{label:"Timezones",description:"You can customize the timezones that appear in the header bar\n      dropdown by providing an array of timezone strings."},clientMonitor:{label:"Client query monitoring",description:"Allow Pivot users to access the monitoring dialog to see the raw\n      queries being made for their requests."},individualThemes:{label:"Individual themes",description:"Allow Pivot users to apply individual themes to data cubes and dashboards"}};var DATA_CUBE={title:{label:"Name",description:"The user visible name that will be used to describe this data cube."},description:{label:"Description",description:"The description of the data cube shown in the homepage."},clusterName:{label:"Cluster",description:"The cluster that the data cube belongs to (or <code>native</code>\n      if this is a file based data cube)"},source:{label:"Source",description:"The data source, table, or filename of the data for this data cube."},subsetFormula:{label:"Subset filter formula",description:"A row level filter that is applied to the data cube."+"This filter is never shown in the cube view and effectively constrains the data cube to only the events that match this filter."},specialTimeDimension:{label:"Primary time dimension",description:"The time dimension that corresponds to when the data point was actually added."+"This is used for checking the freshness of data and also potentially enforcing a time filter."},enforceTimeFilter:{label:"Enforce time filter",description:"Ensure that every query is filtered on the primary time dimension."+"This should be used if time unbounded queries are likely to be slow due to the volume and tearing of data."},defaultPinnedDimensions:{label:"Default pinned dimensions",description:"The names of the dimensions (in order) that will appear pinned by default on the right panel. By default this is empty."},defaultSelectedMeasures:{label:"Default selected measures",description:"A comma separated list of names of the measures that will be selected by default. Default: first four measures."},instances:{label:"Instances",description:"The possible instances for this data cube"},theme:{label:"Color theme",description:"The color theme for the header and background of this data cube"},defaultTimezone:{label:"Default timezone",description:'Expressed as an\n      <a href="https://en.wikipedia.org/wiki/Tz_database" target="_blank">\n      Olsen Timezone</a>, that will be selected when the user first opens this\n      data cube. Default: \'<code>'+data_cube_1.DataCube.DEFAULT_DEFAULT_TIMEZONE+"</code>'."},defaultFilter:{label:"Default Filter",description:"The default filter that will be applied to this data cube.\n      If a special time dimension is set, this will default to that dimension.\n      Otherwise, it will default to empty. "},defaultSplits:{label:"Default Splits",description:"The names of the dimensions (in order) that will be split on. By default this is empty."},defaultDuration:{label:"Default duration",description:'The time period, expressed as an\n      <a href="https://en.wikipedia.org/wiki/ISO_8601#Durations" target="_blank">\n      ISO 8601 Duration</a>, that will be shown when the user first opens this data cube.'},defaultSortMeasure:{label:"Default sort measure",description:"The name of the measure that will be used for default sorting.\n      It is commonly set to the measure that represents the count of events.\n      Default: the first measure."},defaultRefreshRate:{label:"Default refresh rate",description:'The default rate expressed as an\n      <a href="https://en.wikipedia.org/wiki/ISO_8601#Durations" target="_blank">\n      ISO 8601 Duration</a> with which this data cube will refresh'},refreshTimeWith:{label:"Refresh time",description:"Indicates how the data cube will calculate the latest time.\n    Defaults to 'Query', which means it will query the data to learn about the latest data ingested.\n    Can also be set to predefined in which case latest 'now' time will always be assumed.\n    An alternative 'fixed' time can also defined as the 'fixedMaxTime' property in the options."},options:{label:"Cube options (as JSON)",description:'General <a href="http://pivot.imply.io/app-settings" target="_blank">\n      data cube options</a>.'},readAccess:{label:"Can view",description:""},modifyAccess:{label:"Can edit",description:""}};var USER={name:{label:"User Id"},email:{label:"Email"},role:{label:"User role",description:"Super admins have access to editing clusters and data cubes. Users can only create collections."},firstName:{label:"First Name"},lastName:{label:"Last Name"},pass:{label:"Password"}};exports.SIMPLE_MEASURE_FORMULA={filter:{label:"Filter",description:"The filter for this formula (optional)"},aggregation:{label:"Aggregation",description:"The aggregation for this formula"},column:{label:"Column",description:"The column for this formula (only when the aggregation is not <code>count</code>)"},"filter.column":{label:"Column",description:""},"filter.operator":{label:"Operator",description:""},"filter.value":{label:"Value",description:""}};exports.LABELS={ATTRIBUTE:ATTRIBUTE,DIMENSION:DIMENSION,COLLECTION:COLLECTION,COLLECTION_ITEM:COLLECTION_ITEM,MEASURE:MEASURE,CLUSTER:CLUSTER,CUSTOMIZATION:CUSTOMIZATION,DATA_CUBE:DATA_CUBE,USER:USER,SIMPLE_MEASURE_FORMULA:exports.SIMPLE_MEASURE_FORMULA}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var constants_1=__webpack_require__(52);exports.SECTION_WIDTH=constants_1.CORE_ITEM_WIDTH+constants_1.CORE_ITEM_GAP;exports.OVERFLOW_SECTION_WIDTH=constants_1.OVERFLOW_WIDTH+constants_1.CORE_ITEM_GAP;function getMaxItems(maxWidth,itemsLength){var initialMax=Math.floor((maxWidth-constants_1.OVERFLOW_WIDTH)/exports.SECTION_WIDTH);if(initialMax<itemsLength){var widthPlusOverflow=initialMax*exports.SECTION_WIDTH+exports.OVERFLOW_SECTION_WIDTH;var maxItems=null;if(maxWidth<widthPlusOverflow){maxItems=initialMax-1}else if(itemsLength-initialMax===1){maxItems=Math.floor(maxWidth/exports.SECTION_WIDTH)}else{maxItems=initialMax}return maxItems}else{return initialMax}}exports.getMaxItems=getMaxItems},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);var number_filter_menu_1=__webpack_require__(407);var string_filter_menu_1=__webpack_require__(410);var time_filter_menu_1=__webpack_require__(411);__webpack_require__(531);var FilterMenu=function(_super){tslib_1.__extends(FilterMenu,_super);function FilterMenu(){return _super.call(this)||this}FilterMenu.prototype.render=function(){var _a=this.props,clicker=_a.clicker,essence=_a.essence,deltaSourceFilter=_a.deltaSourceFilter,timekeeper=_a.timekeeper,changePosition=_a.changePosition,openOn=_a.openOn,dimension=_a.dimension,onClose=_a.onClose,insideId=_a.insideId;if(!dimension)return null;var kind=dimension.getKind();if(kind==="time"){return React.createElement(time_filter_menu_1.TimeFilterMenu,{essence:essence,timekeeper:timekeeper,clicker:clicker,dimension:dimension,onClose:onClose,openOn:openOn,insideId:insideId})}else if(kind==="number"&&dimension.getBucketingStrategy()!=="neverBucket"){return React.createElement(number_filter_menu_1.NumberFilterMenu,{essence:essence,deltaSourceFilter:deltaSourceFilter,timekeeper:timekeeper,clicker:clicker,dimension:dimension,onClose:onClose,openOn:openOn,insideId:insideId})}else{return React.createElement(string_filter_menu_1.StringFilterMenu,{essence:essence,deltaSourceFilter:deltaSourceFilter,timekeeper:timekeeper,clicker:clicker,dimension:dimension,changePosition:changePosition,onClose:onClose,openOn:openOn,insideId:insideId})}};return FilterMenu}(React.Component);exports.FilterMenu=FilterMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var filter_options_dropdown_1=__webpack_require__(190);var number_range_picker_1=__webpack_require__(408);__webpack_require__(509);function numberOrAnyToString(start){if(start===number_range_picker_1.ANY_VALUE)return strings_1.STRINGS.any;return""+start}function stringToNumberOrAny(startInput){var parse=parseFloat(startInput);return isNaN(parse)?number_range_picker_1.ANY_VALUE:parse}var MENU_WIDTH=250;var filterOptions=filter_options_dropdown_1.FilterOptionsDropdown.getFilterOptions(models_1.Filter.INCLUDE,models_1.Filter.EXCLUDE);var NumberFilterMenu=function(_super){tslib_1.__extends(NumberFilterMenu,_super);function NumberFilterMenu(){var _this=_super.call(this)||this;_this.state={leftOffset:null,rightBound:null,start:null,startInput:"",end:null,endInput:""};return _this}NumberFilterMenu.prototype.componentWillMount=function(){var _a=this.props,essence=_a.essence,dimension=_a.dimension;var filter=essence.getEffectiveFilter();var valueSet=filter.getLiteralSet(dimension.name);var hasFilter=valueSet&&valueSet.elements.length!==0;var start=null;var end=null;if(hasFilter){if(valueSet.setType==="NUMBER_RANGE"){var range=valueSet.elements[0];start=range.start;end=range.end}else if(valueSet.setType==="NUMBER"){var number=valueSet.elements[0];start=number;end=number}}this.setState({startInput:numberOrAnyToString(start),endInput:numberOrAnyToString(end),start:start,end:end,filterMode:filter.getModeFor(dimension.name)||models_1.Filter.INCLUDE})};NumberFilterMenu.prototype.constructFilter=function(){var _a=this.props,essence=_a.essence,dimension=_a.dimension;var _b=this.state,start=_b.start,end=_b.end,filterMode=_b.filterMode;var filter=essence.getEffectiveFilter();var validFilter=false;if(start!==null&&end!==null){validFilter=start<=end}else{validFilter=!isNaN(start)&&!isNaN(end)&&(start!==null||end!==null)}if(validFilter){var bounds=start===end?"[]":"[)";var newSet=plywood_1.Set.fromJS({setType:"NUMBER_RANGE",elements:[plywood_1.NumberRange.fromJS({start:start,end:end,bounds:bounds})]});var clause=new models_1.FilterClause({dimension:dimension.name,values:newSet,exclude:filterMode===models_1.Filter.EXCLUDE});return filter.setClause(clause)}else{return null}};NumberFilterMenu.prototype.onOkClick=function(){if(!this.actionEnabled())return;var _a=this.props,clicker=_a.clicker,onClose=_a.onClose;clicker.changeFilter(this.constructFilter());onClose()};NumberFilterMenu.prototype.onCancelClick=function(){var onClose=this.props.onClose;onClose()};NumberFilterMenu.prototype.onRangeInputStartChange=function(e){var startInput=e.target.value;this.setState({startInput:startInput,start:stringToNumberOrAny(startInput)})};NumberFilterMenu.prototype.onRangeInputEndChange=function(e){var endInput=e.target.value;this.setState({endInput:endInput,end:stringToNumberOrAny(endInput)})};NumberFilterMenu.prototype.onRangeStartChange=function(newStart){this.setState({startInput:numberOrAnyToString(newStart),start:newStart})};NumberFilterMenu.prototype.onRangeEndChange=function(newEnd){this.setState({endInput:numberOrAnyToString(newEnd),end:newEnd})};NumberFilterMenu.prototype.onSelectFilterOption=function(filterMode){this.setState({filterMode:filterMode})};NumberFilterMenu.prototype.actionEnabled=function(){var essence=this.props.essence;return!essence.getEffectiveFilter().equals(this.constructFilter())&&Boolean(this.constructFilter())};NumberFilterMenu.prototype.render=function(){var _a=this.props,essence=_a.essence,deltaSourceFilter=_a.deltaSourceFilter,timekeeper=_a.timekeeper,dimension=_a.dimension,onClose=_a.onClose,openOn=_a.openOn,insideId=_a.insideId;var _b=this.state,endInput=_b.endInput,startInput=_b.startInput,end=_b.end,start=_b.start,filterMode=_b.filterMode;var menuSize=beltful_1.Stage.fromSize(MENU_WIDTH,410);return React.createElement(caladan_1.BubbleMenu,{className:"filter-menu number-filter-menu",direction:"down",stage:menuSize,openOn:openOn,onClose:onClose,insideId:insideId},React.createElement("div",{className:"side-by-side"},React.createElement("div",{className:"group"},React.createElement("label",{className:"input-top-label"},"Type"),React.createElement(filter_options_dropdown_1.FilterOptionsDropdown,{selectedOption:filterMode,onSelectOption:this.onSelectFilterOption.bind(this),filterOptions:filterOptions})),React.createElement("div",{className:"group"},React.createElement("label",{className:"input-top-label"},"Min"),React.createElement("input",{value:startInput,onChange:this.onRangeInputStartChange.bind(this)})),React.createElement("div",{className:"group"},React.createElement("label",{className:"input-top-label"},"Max"),React.createElement("input",{value:endInput,onChange:this.onRangeInputEndChange.bind(this)}))),React.createElement(number_range_picker_1.NumberRangePicker,{onRangeEndChange:this.onRangeEndChange.bind(this),onRangeStartChange:this.onRangeStartChange.bind(this),start:start,end:end,dimension:dimension,essence:essence,deltaSourceFilter:deltaSourceFilter,timekeeper:timekeeper,exclude:filterMode===models_1.Filter.EXCLUDE}),React.createElement("div",{className:"ok-cancel-bar"},React.createElement(caladan_1.Button,{type:"secondary",title:strings_1.STRINGS.cancel,onClick:this.onCancelClick.bind(this)}),React.createElement(caladan_1.Button,{type:"primary",title:strings_1.STRINGS.ok,onClick:this.onOkClick.bind(this),disabled:!this.actionEnabled()})))};return NumberFilterMenu}(React.Component);exports.NumberFilterMenu=NumberFilterMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var chronoshift_1=__webpack_require__(23);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var general_1=__webpack_require__(43);var query_runner_1=__webpack_require__(73);var loader_1=__webpack_require__(106);var query_error_1=__webpack_require__(111);var range_handle_1=__webpack_require__(409);__webpack_require__(507);exports.ANY_VALUE=null;var NUB_SIZE=16;var GRANULARITY_IN_BAR=300;function addNubSize(value){return value+NUB_SIZE}function subtractNubSize(value){return value&&value>NUB_SIZE?value-NUB_SIZE:0}function getNumberOfDigitsToShow(n){var totalDigits=general_1.getNumberOfWholeDigits(n/GRANULARITY_IN_BAR);return totalDigits>3?Math.min(totalDigits,4):3}function getAdjustedStartHalf(start){return start+NUB_SIZE/2}var NumberRangePicker=function(_super){tslib_1.__extends(NumberRangePicker,_super);function NumberRangePicker(){var _this=_super.call(this)||this;_this.state={min:null,max:null,step:null,loading:false,error:null};return _this}NumberRangePicker.prototype.fetchData=function(essence,deltaSourceFilter,timekeeper,dimension,rightBound){var _this=this;if(deltaSourceFilter){essence=essence.changeFilter(deltaSourceFilter.applyDelta(essence.getEffectiveFilter()))}var dimensions=essence.getDimensions();var filterExpression=essence.getSpecificFilterWithHighlight(timekeeper,dimension).toExpression(dimensions);var $main=plywood_1.$("main");var dimEx=dimension.expression;var query=plywood_1.ply().apply("main",$main.filter(filterExpression)).apply("Min",$main.min(dimEx)).apply("Max",$main.max(dimEx));this.setState({loading:true});query_runner_1.QueryRunner.fetch("number-range-picker",essence.dataCube,essence.instance,query,chronoshift_1.Timezone.UTC).then(function(dataset){if(!_this.mounted)return;var newState={loading:false};if(dataset.data.length){var min=dataset.data[0]["Min"];var max=dataset.data[0]["Max"];var step=max&&min&&isFinite(max)&&isFinite(min)?(max-min)/rightBound:1;newState.min=min;newState.max=max;newState.step=step||1}_this.setState(newState)},function(error){if(error.canceled)return;if(!_this.mounted)return;_this.setState({loading:false,error:error})})};NumberRangePicker.prototype.componentDidMount=function(){this.mounted=true;var node=ReactDOM.findDOMNode(this.refs["number-range-picker"]);var rect=node.getBoundingClientRect();var _a=this.props,essence=_a.essence,deltaSourceFilter=_a.deltaSourceFilter,timekeeper=_a.timekeeper,dimension=_a.dimension;var leftOffset=rect.left;var rightBound=rect.width;this.setState({leftOffset:leftOffset,rightBound:rightBound});this.fetchData(essence,deltaSourceFilter,timekeeper,dimension,rightBound)};NumberRangePicker.prototype.componentWillUnmount=function(){this.mounted=false};NumberRangePicker.prototype.relativePositionToValue=function(position,type){var _a=this.state,step=_a.step,min=_a.min,max=_a.max,rightBound=_a.rightBound;if(position<=addNubSize(0)&&type==="start")return exports.ANY_VALUE;if(position>=rightBound&&type==="end")return exports.ANY_VALUE;var range=max-min!==0?max-min:Math.abs(max);return general_1.toSignificantDigits(position*step,getNumberOfDigitsToShow(range))};NumberRangePicker.prototype.valueToRelativePosition=function(value){var step=this.state.step;return value/step};NumberRangePicker.prototype.onBarClick=function(positionStart,positionEnd,e){var leftOffset=this.state.leftOffset;var clickPadding=5;var absoluteX=beltful_1.EventUtils.getXFromEvent(e);var relativeX=absoluteX-leftOffset;if(relativeX<NUB_SIZE/2)return this.updateStart(leftOffset);var startNubPosition=addNubSize(positionStart)+clickPadding;var endNubPosition=subtractNubSize(positionEnd)+clickPadding;var isBeforeStart=relativeX<positionStart;var isAfterEnd=relativeX>positionEnd+NUB_SIZE;var inBetween=relativeX<positionEnd&&relativeX>startNubPosition;if(isBeforeStart){this.updateStart(absoluteX-NUB_SIZE)}else if(isAfterEnd){this.updateEnd(absoluteX)}else if(inBetween){var distanceFromEnd=endNubPosition-relativeX;var distanceFromStart=relativeX-startNubPosition;if(distanceFromEnd<distanceFromStart){this.updateEnd(endNubPosition+leftOffset-distanceFromEnd)}else{this.updateStart(startNubPosition+leftOffset+distanceFromStart-NUB_SIZE)}return}};NumberRangePicker.prototype.updateStart=function(absolutePosition){var onRangeStartChange=this.props.onRangeStartChange;var leftOffset=this.state.leftOffset;var relativePosition=absolutePosition-leftOffset;var newValue=this.relativePositionToValue(addNubSize(relativePosition),"start");onRangeStartChange(newValue)};NumberRangePicker.prototype.updateEnd=function(absolutePosition){var onRangeEndChange=this.props.onRangeEndChange;var leftOffset=this.state.leftOffset;var relativePosition=absolutePosition-leftOffset;var newValue=this.relativePositionToValue(relativePosition,"end");onRangeEndChange(newValue)};NumberRangePicker.prototype.render=function(){var _a=this.props,start=_a.start,end=_a.end,exclude=_a.exclude;var _b=this.state,min=_b.min,max=_b.max,loading=_b.loading,error=_b.error,step=_b.step,rightBound=_b.rightBound,leftOffset=_b.leftOffset;var content=null;if(rightBound&&step&&isFinite(max)&&isFinite(min)){var relativeStart=start===exports.ANY_VALUE?0:subtractNubSize(this.valueToRelativePosition(start));var relativeEnd=end===exports.ANY_VALUE?rightBound:this.valueToRelativePosition(end);var adjustedRightBound=subtractNubSize(rightBound);var positionEnd=beltful_1.NumberUtils.clamp(relativeEnd,addNubSize(relativeStart),adjustedRightBound);var positionStart=start?beltful_1.NumberUtils.clamp(relativeStart,0,subtractNubSize(positionEnd)):0;var rangeBarSelected={left:getAdjustedStartHalf(positionStart),width:positionEnd-positionStart};var absoluteRightBound=leftOffset+rightBound;content=React.createElement("div",{className:"range-slider",onMouseDown:this.onBarClick.bind(this,positionStart,positionEnd)},React.createElement("div",{className:"range-bar full"}),React.createElement("div",{className:"range-bar selected",style:rangeBarSelected}),React.createElement(range_handle_1.RangeHandle,{positionLeft:positionStart,onChange:this.updateStart.bind(this),isAny:start===exports.ANY_VALUE,isBeyondMin:start!==exports.ANY_VALUE&&start<min,leftBound:leftOffset,rightBound:leftOffset+subtractNubSize(positionEnd),offset:leftOffset}),React.createElement(range_handle_1.RangeHandle,{positionLeft:positionEnd,onChange:this.updateEnd.bind(this),isAny:end===exports.ANY_VALUE,isBeyondMax:end!==exports.ANY_VALUE&&max<end,leftBound:leftOffset+addNubSize(positionStart),rightBound:absoluteRightBound,offset:leftOffset}))}return React.createElement("div",{className:classNames("number-range-picker",{inverted:exclude}),ref:"number-range-picker"},content,loading?React.createElement(loader_1.Loader,null):null,error?React.createElement(query_error_1.QueryError,{error:error}):null)};return NumberRangePicker}(React.Component);exports.NumberRangePicker=NumberRangePicker},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var classNames=__webpack_require__(4);var React=__webpack_require__(1);__webpack_require__(505);var RangeHandle=function(_super){tslib_1.__extends(RangeHandle,_super);function RangeHandle(){var _this=_super.call(this)||this;_this.state={anchor:null};_this.onGlobalMouseUp=_this.onGlobalMouseUp.bind(_this);_this.onGlobalMouseMove=_this.onGlobalMouseMove.bind(_this);return _this}RangeHandle.prototype.onGlobalMouseMove=function(event){var _a=this.props,onChange=_a.onChange,leftBound=_a.leftBound,rightBound=_a.rightBound;var anchor=this.state.anchor;var newX=beltful_1.EventUtils.getXFromEvent(event)-anchor;onChange(beltful_1.NumberUtils.clamp(newX,leftBound,rightBound))};RangeHandle.prototype.onMouseDown=function(event){var _a=this.props,offset=_a.offset,positionLeft=_a.positionLeft;var x=beltful_1.EventUtils.getXFromEvent(event);var anchor=x-offset-positionLeft;this.setState({anchor:anchor});event.preventDefault();window.addEventListener("mouseup",this.onGlobalMouseUp);window.addEventListener("mousemove",this.onGlobalMouseMove)};RangeHandle.prototype.onGlobalMouseUp=function(){window.removeEventListener("mouseup",this.onGlobalMouseUp);window.removeEventListener("mousemove",this.onGlobalMouseMove)};RangeHandle.prototype.render=function(){var _a=this.props,positionLeft=_a.positionLeft,isAny=_a.isAny,isBeyondMin=_a.isBeyondMin,isBeyondMax=_a.isBeyondMax;var style={left:positionLeft};return React.createElement("div",{className:classNames("range-handle",{empty:isAny,"beyond min":isBeyondMin,"beyond max":isBeyondMax}),style:style,onMouseDown:this.onMouseDown.bind(this)})};return RangeHandle}(React.Component);exports.RangeHandle=RangeHandle},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var filter_options_dropdown_1=__webpack_require__(190);var preview_string_filter_menu_1=__webpack_require__(511);var selectable_string_filter_menu_1=__webpack_require__(516);__webpack_require__(519);var StringFilterMenu=function(_super){tslib_1.__extends(StringFilterMenu,_super);function StringFilterMenu(){var _this=_super.call(this)||this;_this.state={filterMode:null,searchText:null};return _this}StringFilterMenu.prototype.componentWillMount=function(){var _a=this.props,essence=_a.essence,dimension=_a.dimension;var filter=essence.getEffectiveFilter();var filterMode=filter.getModeFor(dimension.name);if(filterMode&&!this.state.filterMode){var newState={filterMode:filterMode};if(filterMode===models_1.Filter.REGEX||filterMode===models_1.Filter.CONTAINS){newState.searchText=filter.getClauseFor(dimension.name).search}this.setState(newState)}};StringFilterMenu.prototype.onSelectFilterOption=function(filterMode){this.setState({filterMode:filterMode})};StringFilterMenu.prototype.updateSearchText=function(searchText){this.setState({searchText:searchText})};StringFilterMenu.prototype.updateFilter=function(clause){var _a=this.props,essence=_a.essence,dimension=_a.dimension,changePosition=_a.changePosition;var filter=essence.getEffectiveFilter();if(!clause)return filter.remove(dimension.name);if(changePosition){if(changePosition.isInsert()){return filter.insertByIndex(changePosition.insert,clause)}else{return filter.replaceByIndex(changePosition.replace,clause)}}else{return filter.setClause(clause)}};StringFilterMenu.prototype.getFilterOptions=function(){var dimension=this.props.dimension;var dimensionKind=dimension.getKind();var filterOptions=filter_options_dropdown_1.FilterOptionsDropdown.getFilterOptions(models_1.Filter.INCLUDE,models_1.Filter.EXCLUDE);if(dimensionKind!=="boolean")filterOptions=filterOptions.concat(filter_options_dropdown_1.FilterOptionsDropdown.getFilterOptions(models_1.Filter.REGEX,models_1.Filter.CONTAINS));return filterOptions};StringFilterMenu.prototype.renderMenuControls=function(){var _a=this.state,filterMode=_a.filterMode,searchText=_a.searchText;return React.createElement("div",{className:"string-filter-menu-controls"},React.createElement("div",{className:"side-by-side"},React.createElement(filter_options_dropdown_1.FilterOptionsDropdown,{selectedOption:filterMode,onSelectOption:this.onSelectFilterOption.bind(this),filterOptions:this.getFilterOptions()}),React.createElement("div",{className:"search-box"},React.createElement(caladan_1.ClearableInput,{placeholder:filterMode===models_1.Filter.REGEX?"Regex":filterMode===models_1.Filter.CONTAINS?"Contains text":"Search",focusOnMount:true,value:searchText,onChange:this.updateSearchText.bind(this)}))))};StringFilterMenu.prototype.render=function(){var _a=this.props,dimension=_a.dimension,clicker=_a.clicker,essence=_a.essence,deltaSourceFilter=_a.deltaSourceFilter,timekeeper=_a.timekeeper,onClose=_a.onClose,openOn=_a.openOn,insideId=_a.insideId;var _b=this.state,filterMode=_b.filterMode,searchText=_b.searchText;if(!dimension)return null;var menuSize=null;var menuCont=null;if(filterMode===models_1.Filter.REGEX||filterMode===models_1.Filter.CONTAINS){menuSize=beltful_1.Stage.fromSize(350,410);menuCont=React.createElement(preview_string_filter_menu_1.PreviewStringFilterMenu,{dimension:dimension,clicker:clicker,essence:essence,deltaSourceFilter:deltaSourceFilter,timekeeper:timekeeper,onClose:onClose,searchText:searchText,filterMode:filterMode,onClauseChange:this.updateFilter.bind(this)})}else{menuSize=beltful_1.Stage.fromSize(250,410);menuCont=React.createElement(selectable_string_filter_menu_1.SelectableStringFilterMenu,{dimension:dimension,clicker:clicker,essence:essence,deltaSourceFilter:deltaSourceFilter,timekeeper:timekeeper,onClose:onClose,searchText:searchText,filterMode:filterMode,onClauseChange:this.updateFilter.bind(this)})}return React.createElement(caladan_1.BubbleMenu,{className:"filter-menu string-filter-menu",direction:"down",stage:menuSize,openOn:openOn,onClose:onClose,insideId:insideId},this.renderMenuControls(),menuCont)};return StringFilterMenu}(React.Component);exports.StringFilterMenu=StringFilterMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var time_1=__webpack_require__(109);var date_ranges_input_1=__webpack_require__(412);__webpack_require__(529);var MENU_WIDTH=250;var RELATIVE="relative";var FIXED="fixed";var TimeFilterMenu=function(_super){tslib_1.__extends(TimeFilterMenu,_super);function TimeFilterMenu(){var _this=_super.call(this)||this;_this._menuId=beltful_1.DOMUtils.uniqueId("time-filter-menu-");_this.state={tab:null,timeRanges:[],hoveredPreset:null};return _this}TimeFilterMenu.prototype.componentWillMount=function(){this.setState({tab:this.getTabFromProps(),timeRanges:this.getTimeRangesFromProps()})};TimeFilterMenu.prototype.getTimeRangesFromProps=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension;var set=essence.getSpecificFilterWithHighlight(timekeeper).getLiteralSet(dimension.name);return set?set.elements:[]};TimeFilterMenu.prototype.getTabFromProps=function(){var _a=this.props,essence=_a.essence,dimension=_a.dimension;var filter=essence.getEffectiveFilter();var clause=filter.clauseForDimension(dimension.name);if(!clause)return RELATIVE;if(clause.dynamic)return RELATIVE;return FIXED};TimeFilterMenu.prototype.constructSpecificFilter=function(){var _a=this.props,essence=_a.essence,dimension=_a.dimension;var timeRanges=this.state.timeRanges;var filter=essence.getEffectiveFilter().setValues(dimension.name,plywood_1.Set.fromJS(timeRanges).unifyElements());return filter.setClause(filter.clauses[0].change("action",undefined))};TimeFilterMenu.prototype.onPresetClick=function(preset){var _a=this.props,clicker=_a.clicker,onClose=_a.onClose,essence=_a.essence,dimension=_a.dimension;var newFilter=essence.getEffectiveFilter().setDynamic(dimension.name,preset.selection);clicker.changeFilter(newFilter);onClose()};TimeFilterMenu.prototype.onPresetMouseEnter=function(preset){var hoveredPreset=this.state.hoveredPreset;if(hoveredPreset===preset)return;this.setState({hoveredPreset:preset})};TimeFilterMenu.prototype.onPresetMouseLeave=function(preset){var hoveredPreset=this.state.hoveredPreset;if(hoveredPreset!==preset)return;this.setState({hoveredPreset:null})};TimeFilterMenu.prototype.isRelative=function(){return this.state.tab===RELATIVE};TimeFilterMenu.prototype.isFixed=function(){return this.state.tab===FIXED};TimeFilterMenu.prototype.onCancelClick=function(){var onClose=this.props.onClose;onClose()};TimeFilterMenu.prototype.getPreviewText=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;var _b=this.state,timeRanges=_b.timeRanges,hoveredPreset=_b.hoveredPreset;var format=function(range){return time_1.formatTimeRange(range,essence.timezone,time_1.DisplayYear.IF_DIFF)};if(hoveredPreset){return format(essence.evaluateSelection(hoveredPreset.selection,timekeeper))}if(timeRanges.length===1){return format(timeRanges[0])}return"Several ranges selected"};TimeFilterMenu.prototype.isPresetSelected=function(preset){var _a=this.props,essence=_a.essence,dimension=_a.dimension;return preset.selection.equals(essence.getEffectiveFilter().getSelection(dimension.name))};TimeFilterMenu.prototype.renderPresets=function(){var _this=this;var _a=this.props,essence=_a.essence,dimension=_a.dimension;var hoveredPreset=this.state.hoveredPreset;if(!dimension)return null;var presetToButton=function(preset){var selected=_this.isPresetSelected(preset);return React.createElement(caladan_1.Button,{key:preset.name,type:selected?"primary":"secondary",className:classNames("preset",{hover:preset===hoveredPreset,selected:selected}),onClick:_this.onPresetClick.bind(_this,preset),onMouseEnter:_this.onPresetMouseEnter.bind(_this,preset),onMouseLeave:_this.onPresetMouseLeave.bind(_this,preset),title:preset.name})};var maxTimeBasedPresets=React.createElement("div",null,React.createElement("div",{className:"type"},strings_1.STRINGS.latestData),React.createElement("div",{className:"buttons"},models_1.FilterClause.LATEST_PRESETS.map(presetToButton)));return React.createElement("div",{className:"menu-tab"},essence.isSpecialTimeDimension(dimension.name)?maxTimeBasedPresets:null,React.createElement("div",{className:"type"},strings_1.STRINGS.current),React.createElement("div",{className:"buttons"},models_1.FilterClause.CURRENT_PRESETS.map(presetToButton)),React.createElement("div",{className:"type"},strings_1.STRINGS.previous),React.createElement("div",{className:"buttons"},models_1.FilterClause.PREVIOUS_PRESETS.map(presetToButton)),React.createElement("div",{className:"preview"},this.getPreviewText()))};TimeFilterMenu.prototype.duplicateLastRange=function(){var timeRanges=this.state.timeRanges;var lastRange=timeRanges[timeRanges.length-1];this.setState({timeRanges:timeRanges.concat([plywood_1.TimeRange.fromJS(lastRange.toJS())])})};TimeFilterMenu.prototype.onOkClick=function(){var _a=this.props,clicker=_a.clicker,onClose=_a.onClose;if(this.isRelative())return;clicker.changeFilter(this.constructSpecificFilter());onClose()};TimeFilterMenu.prototype.renderSpecific=function(){var _this=this;var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;var _b=this.state,timeRanges=_b.timeRanges,invalid=_b.invalid;var onRangesChange=function(newTimeRanges){window.setTimeout(function(){_this.setState({timeRanges:newTimeRanges,invalid:!newTimeRanges.every(Boolean)})},10)};var okButtonDisabled=false;if(invalid){okButtonDisabled=true}else{var nothingWouldHappen=essence.getEffectiveFilter().equals(this.constructSpecificFilter());var sameNumberOfRanges=this.getTimeRangesFromProps().length===timeRanges.length;okButtonDisabled=nothingWouldHappen&&sameNumberOfRanges}return React.createElement("div",{className:"menu-tab"},React.createElement(date_ranges_input_1.DateRangesInput,{timekeeper:timekeeper,onChange:onRangesChange,essence:essence,ranges:timeRanges}),React.createElement("div",{className:"ok-cancel-bar"},timeRanges.length===1?React.createElement(caladan_1.BubbleButton,{className:"more",type:"secondary",insideId:this._menuId,svg:Icons.FULL_MORE,items:[{label:"Add a time range",onClick:function(){return _this.duplicateLastRange()}}],stage:beltful_1.Stage.fromSize(200,100)}):null,React.createElement(caladan_1.Button,{type:"secondary",onClick:this.onCancelClick.bind(this),title:strings_1.STRINGS.cancel}),React.createElement(caladan_1.Button,{type:"primary",onClick:function(){return _this.onOkClick()},disabled:okButtonDisabled,title:strings_1.STRINGS.ok})))};TimeFilterMenu.prototype.render=function(){var _this=this;var _a=this.props,dimension=_a.dimension,onClose=_a.onClose,openOn=_a.openOn,insideId=_a.insideId;if(!dimension)return null;var menuSize=beltful_1.Stage.fromSize(MENU_WIDTH,410);var buttons=[{title:strings_1.STRINGS.relative,className:"relative",active:this.isRelative(),onClick:function(){return _this.setState({tab:RELATIVE})}},{title:strings_1.STRINGS.fixed,className:"fixed",active:this.isFixed(),onClick:function(){return _this.setState({tab:FIXED})}}];return React.createElement(caladan_1.BubbleMenu,{className:"filter-menu time-filter-menu",direction:"down",stage:menuSize,openOn:openOn,onClose:onClose,insideId:insideId,id:this._menuId},React.createElement(caladan_1.GlobalEventListener,{enter:this.onOkClick.bind(this)}),React.createElement(caladan_1.ButtonGroup,{items:buttons}),this.isRelative()?this.renderPresets():this.renderSpecific())};return TimeFilterMenu}(React.Component);exports.TimeFilterMenu=TimeFilterMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(521);var React=__webpack_require__(1);var plywood_1=__webpack_require__(14);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var date_range_picker_1=__webpack_require__(413);var date_range_input_1=__webpack_require__(414);var DateRangesInput=function(_super){tslib_1.__extends(DateRangesInput,_super);function DateRangesInput(){var _this=_super.call(this)||this;_this.state={};return _this}DateRangesInput.prototype.updateRange=function(range,index){var _a=this.props,ranges=_a.ranges,onChange=_a.onChange;onChange(ranges.map(function(e,i){return i===index?range:e}))};DateRangesInput.prototype.removeRange=function(range,index){var _a=this.props,ranges=_a.ranges,onChange=_a.onChange;onChange(ranges.filter(function(e,i){return i!==index}))};DateRangesInput.prototype.addRange=function(){var _a=this.props,ranges=_a.ranges,onChange=_a.onChange;onChange(ranges.concat([plywood_1.TimeRange.fromJS(ranges[ranges.length-1].toJS())]))};DateRangesInput.prototype.renderRange=function(range,index,essence,removeable){var _this=this;return React.createElement(date_range_input_1.DateRangeInput,{key:index,timezone:essence.timezone,range:range,onRemove:removeable?function(){return _this.removeRange(range,index)}:null,onChange:function(r){return _this.updateRange(r,index)}})};DateRangesInput.prototype.render=function(){var _this=this;var _a=this.props,ranges=_a.ranges,essence=_a.essence,timekeeper=_a.timekeeper;if(!ranges||!essence)return null;return React.createElement("div",{className:"date-ranges-input"},React.createElement("div",{className:"ranges"},ranges.map(function(t,i){return _this.renderRange(t,i,essence,ranges.length>1)})),ranges.length===1?React.createElement(date_range_picker_1.DateRangePicker,{startTime:ranges[0]?ranges[0].start:null,endTime:ranges[0]?ranges[0].end:null,maxTime:timekeeper.getTime(essence.dataCube),timezone:essence.timezone,onSelect:function(range){return _this.updateRange(range,0)}}):React.createElement(caladan_1.Button,{className:"add-button",type:"light-action",title:"Add a time range",svg:little_pictures_1.FULL_ADD,onClick:function(){return _this.addRange()}}))};return DateRangesInput}(React.Component);exports.DateRangesInput=DateRangesInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var chronoshift_1=__webpack_require__(23);var classNames=__webpack_require__(4);var moment=__webpack_require__(71);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var time_1=__webpack_require__(109);__webpack_require__(523);var DateRangePicker=function(_super){tslib_1.__extends(DateRangePicker,_super);function DateRangePicker(){var _this=_super.call(this)||this;_this.state={};return _this}DateRangePicker.prototype.initFromProps=function(props){var startTime=props.startTime,endTime=props.endTime,timezone=props.timezone;if(!startTime||!endTime)return;this.setState({startTime:startTime,endTime:endTime,activeMonthStartDate:chronoshift_1.month.floor(startTime||new Date,timezone)})};DateRangePicker.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};DateRangePicker.prototype.componentWillMount=function(){this.initFromProps(this.props)};DateRangePicker.prototype.navigateToMonth=function(offset){var timezone=this.props.timezone;var activeMonthStartDate=this.state.activeMonthStartDate;var newDate=chronoshift_1.month.shift(activeMonthStartDate,timezone,offset);this.setState({activeMonthStartDate:newDate})};DateRangePicker.prototype.onDayHover=function(date){var pendingSelectedStart=this.state.pendingSelectedStart;var _a=[pendingSelectedStart||date,date].sort(function(a,b){return a.getTime()-b.getTime()}),start=_a[0],end=_a[1];this.setState({previewTimeRange:plywood_1.TimeRange.fromJS({start:start,end:end,bounds:"[]"})})};DateRangePicker.prototype.onCalendarMouseLeave=function(){this.setState({previewTimeRange:null})};DateRangePicker.prototype.selectNewRange=function(start,end){var _a=this.props,onSelect=_a.onSelect,timezone=_a.timezone;if(start>end)_b=[end,start],start=_b[0],end=_b[1];end=this.convertDayToEndBound(end);onSelect(plywood_1.TimeRange.fromJS({start:start,end:end}));this.setState({previewTimeRange:null});var _b};DateRangePicker.prototype.convertDayToEndBound=function(date){var timezone=this.props.timezone;return new Date(chronoshift_1.day.floor(chronoshift_1.day.shift(date,timezone,1),timezone).getTime()-1)};DateRangePicker.prototype.selectDay=function(selection){var pendingSelectedStart=this.state.pendingSelectedStart;if(pendingSelectedStart){this.setState({pendingSelectedStart:null});this.selectNewRange(pendingSelectedStart,selection)}else{this.setState({pendingSelectedStart:selection})}};DateRangePicker.prototype.isEdgeOfSelection=function(candidate,start,end){var timezone=this.props.timezone;var isStart=candidate.getTime()===start.getTime();var isEnd=this.convertDayToEndBound(candidate).getTime()===end.getTime();return isStart||isEnd};DateRangePicker.prototype.renderWeek=function(days,weekIndex){var _this=this;var _a=this.props,maxTime=_a.maxTime,timezone=_a.timezone;var _b=this.state,startTime=_b.startTime,endTime=_b.endTime,activeMonthStartDate=_b.activeMonthStartDate,previewTimeRange=_b.previewTimeRange;var nextMonthStart=chronoshift_1.month.shift(activeMonthStartDate,timezone,1);return React.createElement("div",{className:"week",key:weekIndex},days.map(function(day,column){var className=classNames("day","value",{past:day<activeMonthStartDate,future:day>=nextMonthStart,"beyond-max-range":day>maxTime,selected:startTime<day&&day<endTime,"selected-edge":_this.isEdgeOfSelection(day,startTime,endTime),"about-to-be-selected":previewTimeRange&&previewTimeRange.contains(day)});return React.createElement("div",{className:className,key:column,onClick:_this.selectDay.bind(_this,day),onMouseEnter:function(){return _this.onDayHover(day)}},time_1.getWallTimeDay(day,timezone))}))};DateRangePicker.prototype.renderCalendar=function(){var _this=this;var timezone=this.props.timezone;var activeMonthStartDate=this.state.activeMonthStartDate;var weeks=time_1.monthToWeeks(activeMonthStartDate,timezone);var firstWeek=weeks[0];var lastWeek=weeks[weeks.length-1];weeks[0]=time_1.prependDays(timezone,firstWeek,7-firstWeek.length);weeks[weeks.length-1]=time_1.appendDays(timezone,lastWeek,7-lastWeek.length);return weeks.map(function(week,i){return _this.renderWeek(week,i)})};DateRangePicker.prototype.renderCalendarNav=function(){var _this=this;var timezone=this.props.timezone;var activeMonthStartDate=this.state.activeMonthStartDate;return React.createElement("div",{className:"calendar-nav"},React.createElement("div",{className:"caret left",onClick:function(){return _this.navigateToMonth(-1)}},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.FULL_CARET_LEFT})),time_1.getWallTimeMonthWithYear(activeMonthStartDate,timezone),React.createElement("div",{className:"caret right",onClick:function(){return _this.navigateToMonth(1)}},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.FULL_CARET_RIGHT})))};DateRangePicker.prototype.render=function(){return React.createElement("div",{className:"date-range-picker"},React.createElement("div",{className:"calendar",onMouseLeave:this.onCalendarMouseLeave.bind(this)},this.renderCalendarNav(),React.createElement("div",{className:"week"},moment.weekdaysShort().map(function(day){return React.createElement("div",{className:"day label",key:day},React.createElement("span",{className:"space"}),day)})),this.renderCalendar()))};return DateRangePicker}(React.Component);exports.DateRangePicker=DateRangePicker},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(525);var React=__webpack_require__(1);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var date_input_1=__webpack_require__(415);var DateRangeInput=function(_super){tslib_1.__extends(DateRangeInput,_super);function DateRangeInput(){var _this=_super.call(this)||this;_this.state={};return _this}DateRangeInput.prototype.initFromProps=function(props){if(!props.range)return;this.setState({originalRange:props.range})};DateRangeInput.prototype.componentWillMount=function(){this.initFromProps(this.props)};DateRangeInput.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};DateRangeInput.prototype.updateRange=function(date,what){var _a=this.props,range=_a.range,onChange=_a.onChange,timezone=_a.timezone;var originalRange=this.state.originalRange;if(!date){onChange(null);return}var _range=range?range:originalRange;var otherBound=what==="start"?_range.end:_range.start;if(date.getTime()===otherBound.getTime()){onChange(null);return}var _b=[date,otherBound].sort(function(a,b){return a.getTime()-b.getTime()}),start=_b[0],end=_b[1];onChange(plywood_1.TimeRange.fromJS({start:start,end:end}))};DateRangeInput.prototype.render=function(){var _this=this;var _a=this.props,timezone=_a.timezone,range=_a.range,onRemove=_a.onRemove;var start;var end;if(range){start=range.start;end=range.end}return React.createElement("div",{className:classNames("date-range-input",onRemove?"removable":"non-removable")},React.createElement(date_input_1.DateInput,{type:"start",label:"Start",date:start,timezone:timezone,onChange:function(d){return _this.updateRange(d,"start")}}),React.createElement(date_input_1.DateInput,{type:"end",label:"End",date:end,timezone:timezone,onChange:function(d){return _this.updateRange(d,"end")}}),onRemove?React.createElement(caladan_1.Button,{onClick:onRemove,className:"remove-button",type:"light-action",svg:little_pictures_1.FULL_REMOVE}):null)};return DateRangeInput}(React.Component);exports.DateRangeInput=DateRangeInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var moment=__webpack_require__(71);var classNames=__webpack_require__(4);var React=__webpack_require__(1);__webpack_require__(527);var DateInput=function(_super){tslib_1.__extends(DateInput,_super);function DateInput(){var _this=_super.call(this)||this;_this.state={dateLabel:"",timeLabel:""};return _this}DateInput.prototype.componentDidMount=function(){this.initFromProps(this.props)};DateInput.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};DateInput.prototype.initFromProps=function(props){var date=props.date,timezone=props.timezone;var _a=this.state,dateInvalid=_a.dateInvalid,timeInvalid=_a.timeInvalid;if(!date||dateInvalid||timeInvalid)return;if(isNaN(date.valueOf())){this.setState({dateLabel:"",timeLabel:""});return}var dateForLabel=this.props.type==="end"?(new Date).setTime(date.getTime()+1):date;var m=moment.tz(dateForLabel,timezone.toString());this.setState({dateLabel:m.format("YYYY-MM-DD"),timeLabel:m.format("HH:mm")})};DateInput.prototype.parse=function(dateString,timeString){var timezone=this.props.timezone;return moment.tz(dateString+" "+timeString,"YYYY-MM-DD HH:mm",true,timezone.toString())};DateInput.prototype.onDateChange=function(e){var dateLabel=e.target.value.replace(/[^\d-]/g,"");var m=this.parse(dateLabel,this.state.timeLabel);if(m.isValid()){this.setState({dateInvalid:false,dateLabel:dateLabel});this.dispatchChange(m)}else{this.setState({dateInvalid:true,dateLabel:dateLabel});this.dispatchInvalidity()}};DateInput.prototype.onTimeChange=function(e){var timeLabel=e.target.value.replace(/[^\d:]/g,"");var m=this.parse(this.state.dateLabel,timeLabel);if(m.isValid()){this.setState({timeInvalid:false,timeLabel:timeLabel});this.dispatchChange(m)}else{this.setState({timeInvalid:true,timeLabel:timeLabel});this.dispatchInvalidity()}};DateInput.prototype.dispatchInvalidity=function(){this.props.onChange(null)};DateInput.prototype.dispatchChange=function(_moment){var _a=this.props,onChange=_a.onChange,type=_a.type;if(type==="end")_moment=_moment.subtract(1,"millisecond");onChange(_moment.toDate())};DateInput.prototype.render=function(){var _a=this.props,hide=_a.hide,label=_a.label;var _b=this.state,dateLabel=_b.dateLabel,timeLabel=_b.timeLabel,dateInvalid=_b.dateInvalid,timeInvalid=_b.timeInvalid;return React.createElement("div",{className:"date-input"},label?React.createElement("div",{className:"label"},label):null,React.createElement("input",{placeholder:"YYYY-MM-DD",className:classNames("date-field",{invalid:dateInvalid}),value:hide?"":dateLabel,onChange:this.onDateChange.bind(this)}),React.createElement("input",{placeholder:"HH:MM",className:classNames("time-field",{invalid:timeInvalid}),value:hide?"":timeLabel,onChange:this.onTimeChange.bind(this)}))};return DateInput}(React.Component);exports.DateInput=DateInput},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(533);var React=__webpack_require__(1);var classNames=__webpack_require__(4);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var DimensionPill=function(_super){tslib_1.__extends(DimensionPill,_super);function DimensionPill(){var _this=_super.call(this)||this;_this.state={};return _this}DimensionPill.prototype.renderIcon=function(){var icon=this.props.icon;if(!icon)return null;return React.createElement("div",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:icon}))};DimensionPill.prototype.renderRemoveButton=function(){var onRemove=this.props.onRemove;if(!onRemove)return null;return React.createElement("div",{className:"remove",onClick:onRemove},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.X}))};DimensionPill.prototype.renderItemLabel=function(){var _a=this.props,label=_a.label,values=_a.values;return React.createElement("div",{className:"reading"},label?React.createElement("span",{className:"label"},label):null,values?React.createElement("span",{className:"values"},values):null)};DimensionPill.prototype.render=function(){var _a=this.props,onClick=_a.onClick,onDrag=_a.onDrag,color=_a.color,classes=_a.classes,style=_a.style,icon=_a.icon,children=_a.children;var className=classNames("dimension-pill",{"has-icon":!!icon},classes);return React.createElement("div",{className:className,draggable:!!onDrag,onClick:onClick?function(e){return onClick(e)}:undefined,onDragStart:onDrag?function(e){return onDrag(e.nativeEvent)}:undefined,style:style},React.createElement("div",{className:"background",style:{backgroundColor:color}}),React.createElement("div",{className:"border"}),this.renderIcon(),this.renderItemLabel(),this.renderRemoveButton(),children)};return DimensionPill}(React.Component);exports.DimensionPill=DimensionPill},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Deferred=function(){function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve;_this.reject=reject})}return Deferred}();exports.Deferred=Deferred},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_path__=__webpack_require__(112);var __WEBPACK_IMPORTED_MODULE_1__constant__=__webpack_require__(74);var __WEBPACK_IMPORTED_MODULE_2__curve_linear__=__webpack_require__(178);var __WEBPACK_IMPORTED_MODULE_3__line__=__webpack_require__(192);var __WEBPACK_IMPORTED_MODULE_4__point__=__webpack_require__(193);__webpack_exports__["a"]=function(){var x0=__WEBPACK_IMPORTED_MODULE_4__point__["a"],x1=null,y0=Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(0),y1=__WEBPACK_IMPORTED_MODULE_4__point__["b"],defined=Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(true),context=null,curve=__WEBPACK_IMPORTED_MODULE_2__curve_linear__["a"],output=null;function area(data){var i,j,k,n=data.length,d,defined0=false,buffer,x0z=new Array(n),y0z=new Array(n);if(context==null)output=curve(buffer=Object(__WEBPACK_IMPORTED_MODULE_0_d3_path__["a"])());for(i=0;i<=n;++i){if(!(i<n&&defined(d=data[i],i,data))===defined0){if(defined0=!defined0){j=i;output.areaStart();output.lineStart()}else{output.lineEnd();output.lineStart();for(k=i-1;k>=j;--k){output.point(x0z[k],y0z[k])}output.lineEnd();output.areaEnd()}}if(defined0){x0z[i]=+x0(d,i,data),y0z[i]=+y0(d,i,data);output.point(x1?+x1(d,i,data):x0z[i],y1?+y1(d,i,data):y0z[i])}}if(buffer)return output=null,buffer+""||null}function arealine(){return Object(__WEBPACK_IMPORTED_MODULE_3__line__["a"])().defined(defined).curve(curve).context(context)}area.x=function(_){return arguments.length?(x0=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),x1=null,area):x0};area.x0=function(_){return arguments.length?(x0=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),area):x0};area.x1=function(_){return arguments.length?(x1=_==null?null:typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),area):x1};area.y=function(_){return arguments.length?(y0=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),y1=null,area):y0};area.y0=function(_){return arguments.length?(y0=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),area):y0};area.y1=function(_){return arguments.length?(y1=_==null?null:typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),area):y1};area.lineX0=area.lineY0=function(){return arealine().x(x0).y(y0)};area.lineY1=function(){return arealine().x(x0).y(y1)};area.lineX1=function(){return arealine().x(x1).y(y0)};area.defined=function(_){return arguments.length?(defined=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(!!_),area):defined};area.curve=function(_){return arguments.length?(curve=_,context!=null&&(output=curve(context)),area):curve};area.context=function(_){return arguments.length?(_==null?context=output=null:output=curve(context=_),area):context};return area}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return curveRadialLinear});__webpack_exports__["b"]=curveRadial;var __WEBPACK_IMPORTED_MODULE_0__linear__=__webpack_require__(178);var curveRadialLinear=curveRadial(__WEBPACK_IMPORTED_MODULE_0__linear__["a"]);function Radial(curve){this._curve=curve}Radial.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(a,r){this._curve.point(r*Math.sin(a),r*-Math.cos(a))}};function curveRadial(curve){function radial(context){return new Radial(curve(context))}radial._curve=curve;return radial}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=lineRadial;var __WEBPACK_IMPORTED_MODULE_0__curve_radial__=__webpack_require__(419);var __WEBPACK_IMPORTED_MODULE_1__line__=__webpack_require__(192);function lineRadial(l){var c=l.curve;l.angle=l.x,delete l.x;l.radius=l.y,delete l.y;l.curve=function(_){return arguments.length?c(Object(__WEBPACK_IMPORTED_MODULE_0__curve_radial__["b"])(_)):c()._curve};return l}__webpack_exports__["a"]=function(){return lineRadial(Object(__WEBPACK_IMPORTED_MODULE_1__line__["a"])().curve(__WEBPACK_IMPORTED_MODULE_0__curve_radial__["a"]))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x,y){return[(y=+y)*Math.cos(x-=Math.PI/2),y*Math.sin(x)]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return slice});var slice=Array.prototype.slice},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__math__=__webpack_require__(113);__webpack_exports__["a"]={draw:function(context,size){var r=Math.sqrt(size/__WEBPACK_IMPORTED_MODULE_0__math__["j"]);context.moveTo(r,0);context.arc(0,0,r,0,__WEBPACK_IMPORTED_MODULE_0__math__["m"])}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]={draw:function(context,size){var r=Math.sqrt(size/5)/2;context.moveTo(-3*r,-r);context.lineTo(-r,-r);context.lineTo(-r,-3*r);context.lineTo(r,-3*r);context.lineTo(r,-r);context.lineTo(3*r,-r);context.lineTo(3*r,r);context.lineTo(r,r);context.lineTo(r,3*r);context.lineTo(-r,3*r);context.lineTo(-r,r);context.lineTo(-3*r,r);context.closePath()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var tan30=Math.sqrt(1/3),tan30_2=tan30*2;__webpack_exports__["a"]={draw:function(context,size){var y=Math.sqrt(size/tan30_2),x=y*tan30;context.moveTo(0,-y);context.lineTo(x,0);context.lineTo(0,y);context.lineTo(-x,0);context.closePath()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__math__=__webpack_require__(113);var ka=.8908130915292852,kr=Math.sin(__WEBPACK_IMPORTED_MODULE_0__math__["j"]/10)/Math.sin(7*__WEBPACK_IMPORTED_MODULE_0__math__["j"]/10),kx=Math.sin(__WEBPACK_IMPORTED_MODULE_0__math__["m"]/10)*kr,ky=-Math.cos(__WEBPACK_IMPORTED_MODULE_0__math__["m"]/10)*kr;__webpack_exports__["a"]={draw:function(context,size){var r=Math.sqrt(size*ka),x=kx*r,y=ky*r;context.moveTo(0,-r);context.lineTo(x,y);for(var i=1;i<5;++i){var a=__WEBPACK_IMPORTED_MODULE_0__math__["m"]*i/5,c=Math.cos(a),s=Math.sin(a);context.lineTo(s*r,-c*r);context.lineTo(c*x-s*y,s*x+c*y)}context.closePath()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]={draw:function(context,size){var w=Math.sqrt(size),x=-w/2;context.rect(x,x,w,w)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var sqrt3=Math.sqrt(3);__webpack_exports__["a"]={draw:function(context,size){var y=-Math.sqrt(size/(sqrt3*3));context.moveTo(0,y*2);context.lineTo(-sqrt3*y,-y);context.lineTo(sqrt3*y,-y);context.closePath()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var c=-.5,s=Math.sqrt(3)/2,k=1/Math.sqrt(12),a=(k/2+1)*3;__webpack_exports__["a"]={draw:function(context,size){var r=Math.sqrt(size/a),x0=r/2,y0=r*k,x1=x0,y1=r*k+r,x2=-x1,y2=y1;context.moveTo(x0,y0);context.lineTo(x1,y1);context.lineTo(x2,y2);context.lineTo(c*x0-s*y0,s*x0+c*y0);context.lineTo(c*x1-s*y1,s*x1+c*y1);context.lineTo(c*x2-s*y2,s*x2+c*y2);context.lineTo(c*x0+s*y0,c*y0-s*x0);context.lineTo(c*x1+s*y1,c*y1-s*x1);context.lineTo(c*x2+s*y2,c*y2-s*x2);context.closePath()}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=CardinalClosed;var __WEBPACK_IMPORTED_MODULE_0__noop__=__webpack_require__(179);var __WEBPACK_IMPORTED_MODULE_1__cardinal__=__webpack_require__(181);function CardinalClosed(context,tension){this._context=context;this._k=(1-tension)/6}CardinalClosed.prototype={areaStart:__WEBPACK_IMPORTED_MODULE_0__noop__["a"],areaEnd:__WEBPACK_IMPORTED_MODULE_0__noop__["a"],lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(x,y){x=+x,y=+y;switch(this._point){case 0:this._point=1;this._x3=x,this._y3=y;break;case 1:this._point=2;this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3;this._x5=x,this._y5=y;break;default:Object(__WEBPACK_IMPORTED_MODULE_1__cardinal__["c"])(this,x,y);break}this._x0=this._x1,this._x1=this._x2,this._x2=x;this._y0=this._y1,this._y1=this._y2,this._y2=y}};__webpack_exports__["b"]=function custom(tension){function cardinal(context){return new CardinalClosed(context,tension)}cardinal.tension=function(tension){return custom(+tension)};return cardinal}(0)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=CardinalOpen;var __WEBPACK_IMPORTED_MODULE_0__cardinal__=__webpack_require__(181);function CardinalOpen(context,tension){this._context=context;this._k=(1-tension)/6}CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(x,y){x=+x,y=+y;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Object(__WEBPACK_IMPORTED_MODULE_0__cardinal__["c"])(this,x,y);break}this._x0=this._x1,this._x1=this._x2,this._x2=x;this._y0=this._y1,this._y1=this._y2,this._y2=y}};__webpack_exports__["b"]=function custom(tension){function cardinal(context){return new CardinalOpen(context,tension)}cardinal.tension=function(tension){return custom(+tension)};return cardinal}(0)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var query_runner_1=__webpack_require__(73);var line_loader_1=__webpack_require__(584);__webpack_require__(587);var ACTION_SIZE=60;var PREVIEW_HEIGHT=20;function makePreview(value){if(plywood_1.NumberRange.isNumberRange(value)){return value.start+" - "+value.end}return value+" values"}var DimensionActionsMenu=function(_super){tslib_1.__extends(DimensionActionsMenu,_super);function DimensionActionsMenu(){var _this=_super.call(this)||this;_this.state={loading:false,error:null,preview:null};return _this}DimensionActionsMenu.prototype.fetchData=function(essence,timekeeper,dimension){var _this=this;var dimensions=essence.getDimensions();var dataCube=essence.dataCube;var filterExpression=essence.getSpecificFilterWithHighlight(timekeeper,dimension).toExpression(dimensions);var $main=plywood_1.$("main");var dimEx=dimension.expression;var query=plywood_1.ply().apply("main",$main.filter(filterExpression));var getResult=null;if(dimension.isContinuous()){getResult=function(d){return plywood_1.NumberRange.fromJS({start:d["Min"],end:d["Max"]})};query=query.apply("Min",$main.min(dimEx)).apply("Max",$main.max(dimEx))}else{getResult=function(d){return Math.round(d["Count"])};query=query.apply("Count",$main.countDistinct(dimEx))}this.setState({loading:true});query_runner_1.QueryRunner.fetch("dimension-action-menu",dataCube,essence.instance,query,essence.timezone).then(function(dataset){if(!_this.mounted)return;_this.setState({loading:false,preview:getResult(dataset.data[0]),error:null})},function(error){if(error.canceled)return;if(!_this.mounted)return;_this.setState({loading:false,error:error})})};DimensionActionsMenu.prototype.componentWillMount=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension;if(this.shouldShowPreview()){this.fetchData(essence,timekeeper,dimension)}};DimensionActionsMenu.prototype.componentWillReceiveProps=function(nextProps){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension;var nextEssence=nextProps.essence;var nextTimekeeper=nextProps.timekeeper;var nextDimension=nextProps.dimension;if(essence.differentDataCube(nextEssence)||essence.differentSpecificFilterWithHighlight(nextEssence,timekeeper,nextTimekeeper)||!dimension.equals(nextDimension)){this.fetchData(nextEssence,nextTimekeeper,nextDimension)}};DimensionActionsMenu.prototype.componentDidMount=function(){this.mounted=true};DimensionActionsMenu.prototype.componentWillUnmount=function(){this.mounted=false};DimensionActionsMenu.prototype.onFilter=function(){var _a=this.props,dimension=_a.dimension,triggerFilterMenu=_a.triggerFilterMenu,onClose=_a.onClose;triggerFilterMenu(dimension);onClose()};DimensionActionsMenu.prototype.onSplit=function(){var _a=this.props,clicker=_a.clicker,essence=_a.essence,dimension=_a.dimension,triggerSplitMenu=_a.triggerSplitMenu,onClose=_a.onClose;var filter=essence.getEffectiveFilter();var splits=essence.getConstrainedSplits();if(splits.hasSplitOn(dimension.name)&&splits.length()===1){triggerSplitMenu(dimension)}else{var split=models_1.SplitCombine.fromDimensionAndFilterAndMeasure(dimension,filter,essence.getSortMeasure());clicker.changeSplits(models_1.Splits.fromSplitCombine(split),models_1.VisStrategy.FairGame)}onClose()};DimensionActionsMenu.prototype.onSubsplit=function(){var _a=this.props,clicker=_a.clicker,essence=_a.essence,dimension=_a.dimension,triggerSplitMenu=_a.triggerSplitMenu,onClose=_a.onClose;var filter=essence.getEffectiveFilter();var splits=essence.getConstrainedSplits();if(splits.hasSplitOn(dimension.name)){triggerSplitMenu(dimension)}else{clicker.addSplit(models_1.SplitCombine.fromDimensionAndFilterAndMeasure(dimension,filter,essence.getSortMeasure()))}onClose()};DimensionActionsMenu.prototype.onPin=function(){var _a=this.props,clicker=_a.clicker,dimension=_a.dimension,onClose=_a.onClose;clicker.pin(dimension);onClose()};DimensionActionsMenu.prototype.shouldShowPreview=function(){var dimension=this.props.dimension;return dimension.getKind()!=="time"};DimensionActionsMenu.prototype.renderPreview=function(){var _a=this.state,preview=_a.preview,loading=_a.loading,error=_a.error;if(!this.shouldShowPreview())return null;if(loading)return React.createElement("div",{className:"preview"},React.createElement(line_loader_1.LineLoader,null));var text=error?"query error":makePreview(preview);return React.createElement("div",{className:"preview"},React.createElement("div",{className:"preview-text"},text))};DimensionActionsMenu.prototype.render=function(){var _a=this.props,direction=_a.direction,openOn=_a.openOn,dimension=_a.dimension,onClose=_a.onClose;if(!dimension)return null;var height=ACTION_SIZE*2;if(this.shouldShowPreview())height=height+PREVIEW_HEIGHT;var menuSize=beltful_1.Stage.fromSize(ACTION_SIZE*2,height);return React.createElement(caladan_1.BubbleMenu,{className:"dimension-actions-menu",direction:direction,stage:menuSize,fixedSize:true,openOn:openOn,onClose:onClose},React.createElement("div",{className:"filter action",onClick:this.onFilter.bind(this)},React.createElement(caladan_1.SvgIcon,{svg:Icons.PREVIEW_FILTER}),React.createElement("div",{className:"action-label"},strings_1.STRINGS.filter)),React.createElement("div",{className:"pin action",onClick:this.onPin.bind(this)},React.createElement(caladan_1.SvgIcon,{svg:Icons.PREVIEW_PIN}),React.createElement("div",{className:"action-label"},strings_1.STRINGS.pin)),React.createElement("div",{className:"split action",onClick:this.onSplit.bind(this)},React.createElement(caladan_1.SvgIcon,{svg:Icons.PREVIEW_SPLIT}),React.createElement("div",{className:"action-label"},strings_1.STRINGS.split)),React.createElement("div",{className:"subsplit action",onClick:this.onSubsplit.bind(this)},React.createElement(caladan_1.SvgIcon,{svg:Icons.PREVIEW_SUBSPLIT}),React.createElement("div",{className:"action-label"},strings_1.STRINGS.subsplit)),this.renderPreview())};return DimensionActionsMenu}(React.Component);exports.DimensionActionsMenu=DimensionActionsMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var React=__webpack_require__(1);__webpack_require__(590);var TileHeader=function(_super){tslib_1.__extends(TileHeader,_super);function TileHeader(){return _super.call(this)||this}TileHeader.prototype.renderIcons=function(){var icons=this.props.icons;if(!icons||!icons.length)return null;var iconElements=icons.map(function(icon){return React.createElement("div",{className:classNames("icon",icon.name,{active:icon.active}),key:icon.name,onClick:icon.onClick,ref:icon.ref},React.createElement(caladan_1.SvgIcon,{svg:icon.svg}))});return React.createElement("div",{className:"icons"},iconElements)};TileHeader.prototype.render=function(){var _a=this.props,title=_a.title,onDragStart=_a.onDragStart;return React.createElement("div",{className:"tile-header",draggable:onDragStart?true:null,onDragStart:onDragStart},React.createElement("div",{className:"title"},title),this.renderIcons())};return TileHeader}(React.Component);exports.TileHeader=TileHeader},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var utils_1=__webpack_require__(435);var strings_1=__webpack_require__(17);var constants_1=__webpack_require__(52);var drag_manager_1=__webpack_require__(110);var formatter_1=__webpack_require__(186);var query_runner_1=__webpack_require__(73);var highlight_string_1=__webpack_require__(105);var loader_1=__webpack_require__(106);var query_error_1=__webpack_require__(111);var searchable_tile_1=__webpack_require__(183);__webpack_require__(600);var TOP_N=100;var SEARCH_BOX_HEIGHT=30;var FOLDER_BOX_HEIGHT=30;function getSelectedGranularityProp(essence,timekeeper,dimension){if(!dimension.canAutoBucket())return null;var filter=essence.getEffectiveFilter();var filterSelection=filter.getSelection(dimension.name);var kind=dimension.getKind();if(filterSelection){var range=kind==="time"?essence.evaluateSelection(filterSelection,timekeeper):filterSelection.getLiteralValue().extent();return dimension.getBucketedBy().getRecommendationForRange(range,9,dimension.granularities)}else{return dimension.getBucketedBy().getDefaultGranularity(kind,dimension.granularities)}}var DimensionTile=function(_super){tslib_1.__extends(DimensionTile,_super);function DimensionTile(){var _this=_super.call(this)||this;_this.state={loading:false,dataset:null,error:null,fetchQueued:false,unfolded:true,foldable:false,showSearch:false,selectedGranularity:null,searchText:""};_this.collectTriggerSearch=utils_1.collect(constants_1.SEARCH_WAIT,function(){if(!_this.mounted)return;var _a=_this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension,colors=_a.colors,sortOn=_a.sortOn,colorSplit=_a.colorSplit;var unfolded=_this.state.unfolded;_this.fetchData(essence,timekeeper,dimension,colors,sortOn,colorSplit,_this.getSelectedGranularity(),unfolded)});return _this}DimensionTile.prototype.fetchData=function(essence,timekeeper,dimension,colors,sortOn,colorSplit,selectedGranularity,unfolded){var _this=this;var searchText=this.state.searchText;var dimensions=essence.getDimensions();var filter=essence.getSpecificFilterWithHighlight(timekeeper);if(unfolded&&!essence.isMandatoryTimeFilter(dimension.name)&&!colors){filter=filter.remove(dimension.name)}if(!colors){filter=filter.setExclusionForDimension(dimension,false)}else if(!unfolded&&colors.dimension===dimension.name&&colors.values){filter=filter.setValues(dimension.name,colors.toSet())}if(searchText){filter=filter.setSearch(dimension.name,"contains",searchText)}var $main=plywood_1.$("main");var query=plywood_1.ply().apply("main",$main.filter(filter.toExpression(dimensions)));if(sortOn.measure){var invisibleRootApplyAction=sortOn.measure.toInvisibleRootApplyAction();if(invisibleRootApplyAction)query=query.performAction(invisibleRootApplyAction)}var sortExpression=null;var splitExpression;if(colorSplit){splitExpression=$main.split(colorSplit.toSplitExpression(dimensions),dimension.name);sortExpression=sortOn.getExpression()}else{if(selectedGranularity){splitExpression=$main.split(dimension.expression.performAction(selectedGranularity.expression),dimension.name);sortExpression=plywood_1.$(dimension.name)}else{splitExpression=$main.split(dimension.expression,dimension.name);sortExpression=sortOn.getExpression()}}if(sortOn.measure){splitExpression=splitExpression.performAction(sortOn.measure.toApplyAction(1))}var direction=colorSplit&&colorSplit.sortAction?colorSplit.sortAction.direction:plywood_1.SortExpression.DESCENDING;splitExpression=splitExpression.sort(sortExpression,direction).limit(TOP_N+1);this.setState({loading:true,fetchQueued:false});query_runner_1.QueryRunner.fetch("dimension-tile-"+dimension.name,essence.dataCube,essence.instance,query.apply(constants_1.SPLIT,splitExpression),essence.timezone).then(function(dataset){if(!_this.mounted)return;_this.setState({loading:false,dataset:dataset.data.length?dataset.data[0][constants_1.SPLIT]:dataset,error:null})},function(error){if(error.canceled)return;if(!_this.mounted)return;_this.setState({loading:false,dataset:null,error:error})})};DimensionTile.prototype.getSelectedGranularity=function(){if(this.state.selectedGranularity)return this.state.selectedGranularity;var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension;return getSelectedGranularityProp(essence,timekeeper,dimension)};DimensionTile.prototype.updateFoldability=function(essence,dimension,colors){var unfolded=this.state.unfolded;var foldable;if(colors){foldable=true}else{foldable=essence.getEffectiveFilter().filteredOn(dimension.name);unfolded=true}this.setState({foldable:foldable,unfolded:unfolded});return unfolded};DimensionTile.prototype.componentWillMount=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension,colors=_a.colors,sortOn=_a.sortOn,colorSplit=_a.colorSplit;var unfolded=this.updateFoldability(essence,dimension,colors);this.fetchData(essence,timekeeper,dimension,colors,sortOn,colorSplit,this.getSelectedGranularity(),unfolded)};DimensionTile.prototype.componentWillReceiveProps=function(nextProps){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension,sortOn=_a.sortOn,colorSplit=_a.colorSplit,colors=_a.colors;var nextEssence=nextProps.essence;var nextTimekeeper=nextProps.timekeeper;var nextDimension=nextProps.dimension;var nextColors=nextProps.colors;var nextSortOn=nextProps.sortOn;var nextColorSplit=nextProps.colorSplit;var unfolded=this.updateFoldability(nextEssence,nextDimension,nextColors);var currentSelection=essence.getRealTimeSelection();var nextSelection=nextEssence.getRealTimeSelection();var differentTimeFilterSelection=currentSelection?!currentSelection.equals(nextSelection):Boolean(nextSelection);if(differentTimeFilterSelection){this.setState({dataset:null})}if(essence.differentDataCube(nextEssence)||essence.differentSpecificFilterWithHighlight(nextEssence,timekeeper,nextTimekeeper,unfolded&&!colors?dimension:null)||essence.differentColors(nextEssence)||!dimension.equals(nextDimension)||!sortOn.equals(nextSortOn)||!immutable_class_1.immutableEqual(colorSplit,nextColorSplit)||essence.differentTimezoneMatters(nextEssence)||!essence.timezone.equals(nextEssence.timezone)&&dimension.getKind()==="time"||differentTimeFilterSelection){this.fetchData(nextEssence,nextTimekeeper,nextDimension,nextColors,nextSortOn,nextColorSplit,getSelectedGranularityProp(nextEssence,nextTimekeeper,nextDimension),unfolded)}this.setFilterModeFromProps(nextProps)};DimensionTile.prototype.setFilterModeFromProps=function(props){if(props.colors){this.setState({filterMode:models_1.Filter.INCLUDE})}else{var filterMode=props.essence.getEffectiveFilter().getModeFor(props.dimension.name);if(filterMode)this.setState({filterMode:filterMode})}};DimensionTile.prototype.componentDidMount=function(){this.mounted=true;this.setFilterModeFromProps(this.props)};DimensionTile.prototype.componentWillUnmount=function(){this.mounted=false};DimensionTile.prototype.onRowClick=function(value,e){var _a=this.props,clicker=_a.clicker,essence=_a.essence,dimension=_a.dimension,colors=_a.colors;var _b=this.state,dataset=_b.dataset,filterMode=_b.filterMode;var filter=essence.getEffectiveFilter();if(colors&&colors.dimension===dimension.name){if(colors.limit){if(!dataset)return;var values=dataset.data.slice(0,colors.limit).map(function(d){return d[dimension.name]});colors=models_1.Colors.fromValues(colors.dimension,values)}colors=colors.toggle(value);clicker.changeColors(colors)}else{var name_1=dimension.name;if(e.altKey||e.ctrlKey||e.metaKey){var filteredOnMe=filter.filteredOnValue(name_1,value);var filterSet=filter.getLiteralSet(name_1);var singleFilter=filterSet?filterSet.size()===1:false;if(filteredOnMe&&singleFilter){filter=filter.remove(name_1)}else{filter=filter.remove(name_1).addValue(name_1,value)}}else{filter=filter.toggleValue(name_1,value)}var unfolded=this.state.unfolded;if(!unfolded&&!filter.filteredOn(name_1)){this.setState({unfolded:true})}clicker.changeFilter(filter.setExclusionForDimension(dimension,filterMode===models_1.Filter.EXCLUDE))}};DimensionTile.prototype.changeFilterMode=function(value){var _a=this.props,clicker=_a.clicker,essence=_a.essence,dimension=_a.dimension;this.setState({filterMode:value},function(){var filter=essence.getEffectiveFilter();clicker.changeFilter(filter.setExclusionForDimension(dimension,value===models_1.Filter.EXCLUDE))})};DimensionTile.prototype.getFilterActions=function(){var _this=this;var _a=this.props,essence=_a.essence,dimension=_a.dimension;var filterMode=this.state.filterMode;if(!essence||!dimension)return null;var options=[models_1.Filter.INCLUDE,models_1.Filter.EXCLUDE];return options.map(function(value){return{selected:filterMode===value,onClick:_this.changeFilterMode.bind(_this,value),label:strings_1.STRINGS[value]}})};DimensionTile.prototype.toggleFold=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension,colors=_a.colors,sortOn=_a.sortOn,colorSplit=_a.colorSplit;var unfolded=this.state.unfolded;unfolded=!unfolded;this.setState({unfolded:unfolded});this.fetchData(essence,timekeeper,dimension,colors,sortOn,colorSplit,this.getSelectedGranularity(),unfolded)};DimensionTile.prototype.onDragStart=function(e){var _a=this.props,essence=_a.essence,dimension=_a.dimension,getLongUrl=_a.getLongUrl;var filter=essence.getEffectiveFilter();var essenceWithSplit=essence.addSplit(models_1.SplitCombine.fromDimensionAndFilterAndMeasure(dimension,filter,essence.getSortMeasure()),models_1.VisStrategy.FairGame);var newUrl=getLongUrl(essenceWithSplit);var dataTransfer=e.dataTransfer;dataTransfer.effectAllowed="all";dataTransfer.setData("text/url-list",newUrl);dataTransfer.setData("text/plain",newUrl);drag_manager_1.DragManager.setDragDimension(dimension,"dimension-tile");beltful_1.DOMUtils.setDragGhost(dataTransfer,dimension.title)};DimensionTile.prototype.toggleSearch=function(){var showSearch=this.state.showSearch;this.setState({showSearch:!showSearch});this.onSearchChange("")};DimensionTile.prototype.onSearchChange=function(text){var _a=this.state,searchText=_a.searchText,dataset=_a.dataset,fetchQueued=_a.fetchQueued,loading=_a.loading;var newSearchText=text.substr(0,constants_1.MAX_SEARCH_LENGTH);if(searchText===newSearchText)return;if(newSearchText.includes(searchText)&&!fetchQueued&&!loading&&dataset&&dataset.data.length<TOP_N){this.setState({searchText:newSearchText});return}this.setState({searchText:newSearchText,fetchQueued:true});this.collectTriggerSearch()};DimensionTile.prototype.getTitleHeader=function(){var dimension=this.props.dimension;var selectedGranularity=this.getSelectedGranularity();if(selectedGranularity&&dimension.getKind()==="time"&&selectedGranularity instanceof plywood_1.TimeBucketExpression){return dimension.title+" ("+selectedGranularity.duration.getDescription()+")"}return dimension.title};DimensionTile.prototype.onSelectGranularity=function(selectedGranularity){if(immutable_class_1.immutableEqual(selectedGranularity,this.state.selectedGranularity))return;var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,dimension=_a.dimension,colors=_a.colors,sortOn=_a.sortOn,colorSplit=_a.colorSplit;var unfolded=this.updateFoldability(essence,dimension,colors);this.setState({dataset:null,selectedGranularity:selectedGranularity});this.fetchData(essence,timekeeper,dimension,colors,sortOn,colorSplit,selectedGranularity,unfolded)};DimensionTile.prototype.getGranularityActions=function(){var _this=this;var dimension=this.props.dimension;var selectedGranularity=this.getSelectedGranularity();var granularities=dimension.getGranularities(9);return granularities.map(function(g){var granularityStr=g.toString();return{selected:selectedGranularity.equals(g),onClick:_this.onSelectGranularity.bind(_this,g),label:utils_1.formatGranularity(granularityStr)}})};DimensionTile.prototype.render=function(){var _this=this;var _a=this.props,clicker=_a.clicker,essence=_a.essence,dimension=_a.dimension,sortOn=_a.sortOn,colors=_a.colors,colorSplit=_a.colorSplit,onClose=_a.onClose;var _b=this.state,loading=_b.loading,dataset=_b.dataset,error=_b.error,showSearch=_b.showSearch,unfolded=_b.unfolded,foldable=_b.foldable,fetchQueued=_b.fetchQueued,searchText=_b.searchText,filterMode=_b.filterMode;var filter=essence.getEffectiveFilter();var selectedGranularity=this.getSelectedGranularity();var measure=sortOn.measure;var measureName=measure?measure.name:null;var filterSet=filter.getLiteralSet(dimension.name);var continuous=dimension.isContinuous();var excluded=filterMode===models_1.Filter.EXCLUDE;var maxHeight=constants_1.PIN_TITLE_HEIGHT+(showSearch?SEARCH_BOX_HEIGHT:0);var rows=[];var folder=null;if(dataset){var rowData=dataset.data.slice(0,TOP_N);if(!unfolded){if(filterSet){rowData=rowData.filter(function(d){return filterSet.contains(d[dimension.name])})}if(colors){if(colors.values){var colorsSet_1=colors.toSet();rowData=rowData.filter(function(d){return colorsSet_1.contains(d[dimension.name])})}else{rowData=rowData.slice(0,colors.limit)}}}if(searchText){var searchTextLower_1=searchText.toLowerCase();rowData=rowData.filter(function(d){return String(d[dimension.name]).toLowerCase().includes(searchTextLower_1)})}var formatter_2=measure?formatter_1.formatterFromData(rowData.map(function(d){return d[measureName]}),measure.getFormat()):null;var selected_1;rows=rowData.map(function(d){var segmentValue=d[dimension.name];var segmentValueStr=String(segmentValue);var className="row";var checkbox=null;if(filterSet||colors){if(colors){selected_1=false;className+=" color"}else{selected_1=essence.getEffectiveFilter().filteredOnValue(dimension.name,segmentValue);className+=" "+(selected_1?"selected":"not-selected")}checkbox=React.createElement(caladan_1.Checkbox,{selected:selected_1,type:excluded?"cross":"check",color:colors?colors.getColor(segmentValue):null})}if(segmentValue instanceof plywood_1.TimeRange){segmentValueStr=utils_1.formatTimeBasedOnGranularity(segmentValue,selectedGranularity.expression.duration,essence.timezone)}else if(segmentValue instanceof plywood_1.NumberRange){segmentValueStr=formatter_1.formatNumberRange(segmentValue)}var measureValueElement=null;if(measure){measureValueElement=React.createElement("div",{className:"measure-value"},formatter_2(d[measureName]))}return React.createElement("div",{className:className,key:segmentValueStr,onClick:_this.onRowClick.bind(_this,segmentValue)},React.createElement("div",{className:"segment-value",title:segmentValueStr},checkbox,React.createElement(highlight_string_1.HighlightString,{className:"label",text:segmentValueStr,highlight:searchText})),measureValueElement)});maxHeight+=Math.max(2,rows.length)*constants_1.PIN_ITEM_HEIGHT;if(foldable){folder=React.createElement("div",{className:classNames("folder",unfolded?"folded":"unfolded"),onClick:this.toggleFold.bind(this)},React.createElement(caladan_1.SvgIcon,{svg:Icons.CARET}),unfolded?"Show selection":"Show all");maxHeight+=FOLDER_BOX_HEIGHT}}maxHeight+=constants_1.PIN_PADDING_BOTTOM;var message=null;if(!loading&&dataset&&!fetchQueued&&!rows.length){var text=searchText?'No results for "'+searchText+'"':"No results";message=React.createElement("div",{className:"message"},text)}var className=classNames("dimension-tile",filterMode,folder?"has-folder":"no-folder",colors?"has-colors":"no-colors",{continuous:continuous});var icons=[];if(!dimension.isContinuous()){icons.push({name:"search",ref:"search",onClick:this.toggleSearch.bind(this),svg:Icons.FULL_SEARCH,active:showSearch})}if(onClose!==null){icons.push({name:"close",ref:"close",onClick:onClose,svg:Icons.FULL_REMOVE})}var actions=null;if(!colorSplit){if(dimension.canAutoBucket()){actions=this.getGranularityActions()}else if(!continuous){actions=this.getFilterActions()}}return React.createElement(searchable_tile_1.SearchableTile,{style:{maxHeight:maxHeight},title:this.getTitleHeader(),toggleChangeFn:this.toggleSearch.bind(this),onDragStart:this.onDragStart.bind(this),onSearchChange:this.onSearchChange.bind(this),searchText:searchText,showSearch:showSearch,icons:icons,className:className,actions:actions},React.createElement("div",{className:"rows"},rows,message),folder,error?React.createElement(query_error_1.QueryError,{error:error}):null,loading?React.createElement(loader_1.Loader,null):null)};return DimensionTile}(React.Component);exports.DimensionTile=DimensionTile},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);tslib_1.__exportStar(__webpack_require__(43),exports);tslib_1.__exportStar(__webpack_require__(596),exports);tslib_1.__exportStar(__webpack_require__(109),exports)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var models_1=__webpack_require__(19);__webpack_require__(634);var PinboardMeasureTile=function(_super){tslib_1.__extends(PinboardMeasureTile,_super);function PinboardMeasureTile(){return _super.call(this)||this}PinboardMeasureTile.prototype.render=function(){var _a=this.props,essence=_a.essence,title=_a.title,dimension=_a.dimension,sortOn=_a.sortOn,onSelect=_a.onSelect;if(!sortOn)return null;var sortOns=(dimension?[models_1.SortOn.fromDimension(dimension)]:[]).concat(essence.actualDataCube.getMeasures().map(models_1.SortOn.fromMeasure));var SortOnDropdown=caladan_1.Dropdown.specialize();return React.createElement("div",{className:"pinboard-measure-tile"},React.createElement("div",{className:"title"},title),essence.pinnedDimensions.length?React.createElement(SortOnDropdown,{items:sortOns,selectedItem:sortOn,equal:models_1.SortOn.equal,renderItem:models_1.SortOn.getTitle,keyItem:models_1.SortOn.getName,onSelect:onSelect}):null)};return PinboardMeasureTile}(React.Component);exports.PinboardMeasureTile=PinboardMeasureTile},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var classNames=__webpack_require__(4);var React=__webpack_require__(1);__webpack_require__(639);var Shpitz=function(_super){tslib_1.__extends(Shpitz,_super);function Shpitz(){return _super.call(this)||this}Shpitz.prototype.render=function(){var _a=this.props,direction=_a.direction,style=_a.style;return React.createElement("div",{className:classNames("shpitz",direction),style:style},React.createElement("div",{className:"rectangle"}))};return Shpitz}(React.Component);exports.Shpitz=Shpitz},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var utils_1=__webpack_require__(435);var strings_1=__webpack_require__(17);__webpack_require__(645);var DUMMY_CUSTOM_LIMIT_ACTION=plywood_1.Expression._.limit(5);function formatLimit(limit){if(limit===DUMMY_CUSTOM_LIMIT_ACTION)return strings_1.STRINGS.custom;return limit==null||limit===models_1.SplitCombine.EFFECTIVE_NO_LIMIT?strings_1.STRINGS.none:String(limit.value)}function isGranularityCustom(dimension,split){if(!split.isBucketed())return false;return!dimension.getGranularities(5).find(function(g){return g.equalsExpression(split.bucketAction)})}var SplitMenu=function(_super){tslib_1.__extends(SplitMenu,_super);function SplitMenu(){var _this=_super.call(this)||this;_this.state={split:null,colors:null,invalidGranularityInput:null,showCustomGranularity:false};return _this}SplitMenu.prototype.componentWillMount=function(){var _a=this.props,essence=_a.essence,split=_a.split,dimension=_a.dimension;var colors=essence.getEffectiveColors();var myColors=null;if(colors){var colorDimension=essence.getDimension(colors.dimension);if(colorDimension.name===split.dimension){myColors=colors}}this.setState({split:split,colors:myColors,showCustomGranularity:isGranularityCustom(dimension,split)})};SplitMenu.prototype.onSelectGranularity=function(granularity){var split=this.state.split;var newAction=split.bucketAction&&granularity?models_1.Granularity.fromExpression(split.bucketAction).updateBucketSize(granularity.expression):granularity;this.setState({split:split.changeBucketAction(newAction.expression),showCustomGranularity:false})};SplitMenu.prototype.onSelectSortOn=function(sortOn){var split=this.state.split;var sortAction=split.sortAction;var direction=sortAction?sortAction.direction:plywood_1.SortExpression.DESCENDING;this.setState({split:split.changeSortAction(plywood_1.Expression._.sort(sortOn.getExpression(),direction))})};SplitMenu.prototype.onToggleDirection=function(){var split=this.state.split;var sortAction=split.sortAction;this.setState({split:split.changeSortAction(sortAction.toggleDirection())})};SplitMenu.prototype.onSelectLimit=function(limitAction){var essence=this.props.essence;var split=this.state.split;var colors=essence.getEffectiveColors();if(colors){colors=models_1.Colors.fromLimit(colors.dimension,limitAction.value)}var state={colors:colors};if(!(limitAction===models_1.SplitCombine.EFFECTIVE_NO_LIMIT&&!split.limitAction)){state.split=split.changeLimitAction(limitAction)}this.setState(state)};SplitMenu.prototype.onOkClick=function(){if(!this.actionEnabled())return;var _a=this.props,clicker=_a.clicker,essence=_a.essence,onClose=_a.onClose;var _b=this.state,split=_b.split,colors=_b.colors;clicker.changeSplits(essence.getConstrainedSplits().replace(this.props.split,split),models_1.VisStrategy.UnfairGame,colors);onClose()};SplitMenu.prototype.onMoreClick=function(){this.setState({showCustomGranularity:true})};SplitMenu.prototype.onCancelClick=function(){var onClose=this.props.onClose;onClose()};SplitMenu.prototype.getSortOn=function(){var _a=this.props,essence=_a.essence,dimension=_a.dimension;var split=this.state.split;return models_1.SortOn.fromSortAction(split.sortAction,essence.actualDataCube,dimension)};SplitMenu.prototype.onInputChange=function(fromJS,e){var split=this.state.split;var value=e.target.value;try{var bucketAction=fromJS(value);this.setState({split:split.changeBucketAction(bucketAction),invalidGranularityInput:null})}catch(e){this.setState({invalidGranularityInput:value})}};SplitMenu.prototype.renderCustomGranularityInput=function(kind){var _a=this.state,showCustomGranularity=_a.showCustomGranularity,invalidGranularityInput=_a.invalidGranularityInput,split=_a.split;if(!showCustomGranularity)return null;var timeBucketFromJS=function(duration){return plywood_1.TimeBucketExpression.fromJS({duration:duration})};var numberBucketFromJS=function(v){var size=Math.abs(Number.parseFloat(v));if(isNaN(size))throw new Error("invalid number bucket size");return plywood_1.NumberBucketExpression.fromJS({size:size})};var fromJS=kind==="number"?numberBucketFromJS:timeBucketFromJS;var inputValue;if(invalidGranularityInput!=null){inputValue=invalidGranularityInput}else if(!split.bucketAction){inputValue=""}else{inputValue=models_1.Granularity.fromExpression(split.bucketAction).toString()}return React.createElement("input",{className:classNames({error:!!invalidGranularityInput}),value:inputValue,onChange:this.onInputChange.bind(this,fromJS)})};SplitMenu.prototype.renderGranularityPicker=function(){var _this=this;var _a=this.state,split=_a.split,showCustomGranularity=_a.showCustomGranularity;var dimension=this.props.dimension;var bucketAction=split.bucketAction;var bucketedBy=dimension.bucketedBy;var showNoBuckets=dimension.canHaveNoBucket();var granularities=dimension.getGranularities(5);if(!bucketedBy&&showNoBuckets){granularities=[models_1.Granularity.NONE].concat(granularities.slice(0,granularities.length-1))}var buttons=granularities.map(function(g){var granularityStr=g.toString();return{active:(!g.expression&&!bucketAction||g&&g.equalsExpression(bucketAction))&&!showCustomGranularity,onClick:_this.onSelectGranularity.bind(_this,g),title:utils_1.formatGranularity(granularityStr)}});buttons.push({active:showCustomGranularity,onClick:this.onMoreClick.bind(this),svg:little_pictures_1.FULL_MORE_MINI,className:"more"});return React.createElement(caladan_1.ButtonGroup,{className:"granularity-picker",title:strings_1.STRINGS.granularity,items:buttons})};SplitMenu.prototype.renderSortDropdown=function(){var _this=this;var _a=this.props,essence=_a.essence,dimension=_a.dimension;var sortOns=[models_1.SortOn.fromDimension(dimension)].concat(essence.actualDataCube.getMeasures().map(models_1.SortOn.fromMeasure));var SortOnDropdown=caladan_1.Dropdown.specialize();return React.createElement(SortOnDropdown,{label:strings_1.STRINGS.sortBy,items:sortOns,selectedItem:this.getSortOn(),equal:models_1.SortOn.equal,renderItem:models_1.SortOn.getTitle,keyItem:models_1.SortOn.getName,onSelect:function(s){return _this.onSelectSortOn(s)}})};SplitMenu.prototype.renderSortDirection=function(){var split=this.state.split;var direction=split.getSortAction().direction;return React.createElement("div",{className:"sort-direction"},this.renderSortDropdown(),React.createElement("div",{className:"direction "+direction,onClick:this.onToggleDirection.bind(this)},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.SORT_ARROW})))};SplitMenu.prototype.renderLimitDropdown=function(includeNone){var _this=this;var _a=this.props,displayLimit=_a.displayLimit,customization=_a.customization;var _b=this.state,colors=_b.colors,split=_b.split;var limitActionInflater=function(n){return plywood_1.Expression._.limit(n)};var splitLimits=customization?customization.getSplitLimits():null;splitLimits=splitLimits&&splitLimits.length?splitLimits:[5,10,25,50,100];var items=splitLimits.map(limitActionInflater);var selectedItem=split.limitAction||displayLimit;if(colors){items=[3,5,7,9,10].map(limitActionInflater);selectedItem=colors.values?DUMMY_CUSTOM_LIMIT_ACTION:limitActionInflater(colors.limit)}if(includeNone)items.unshift(models_1.SplitCombine.EFFECTIVE_NO_LIMIT);var LimitDropdown=caladan_1.Dropdown.specialize();return React.createElement(LimitDropdown,{label:strings_1.STRINGS.limit,items:items,selectedItem:selectedItem,renderItem:formatLimit,onSelect:function(l){return _this.onSelectLimit(l)}})};SplitMenu.prototype.renderTimeControls=function(){return React.createElement("div",null,this.renderGranularityPicker(),this.renderCustomGranularityInput("time"),this.renderSortDirection(),this.renderLimitDropdown(true))};SplitMenu.prototype.renderNumberControls=function(){return React.createElement("div",null,this.renderGranularityPicker(),this.renderCustomGranularityInput("number"),this.renderSortDirection(),this.renderLimitDropdown(true))};SplitMenu.prototype.renderStringControls=function(){return React.createElement("div",null,this.renderSortDirection(),this.renderLimitDropdown(false))};SplitMenu.prototype.actionEnabled=function(){var originalSplit=this.props.split;var originalColors=this.props.essence.getEffectiveColors();var newSplit=this.state.split;var newColors=this.state.colors;return!originalSplit.equals(newSplit)||originalColors&&!originalColors.equals(newColors)||this.state.invalidGranularityInput!=null};SplitMenu.prototype.render=function(){var _a=this.props,openOn=_a.openOn,dimension=_a.dimension,onClose=_a.onClose,insideId=_a.insideId;if(!dimension)return null;var kind=dimension.getKind();var isBucketable=dimension.isBucketable();var menuSize=beltful_1.Stage.fromSize(250,240);var menuControls=null;if(kind==="time"&&isBucketable){menuControls=this.renderTimeControls()}else if(kind==="number"&&isBucketable){menuControls=this.renderNumberControls()}else{menuControls=this.renderStringControls()}return React.createElement(caladan_1.BubbleMenu,{className:"split-menu",direction:"down",stage:menuSize,openOn:openOn,onClose:onClose,insideId:insideId},React.createElement(caladan_1.GlobalEventListener,{enter:this.onOkClick.bind(this)}),menuControls,React.createElement("div",{className:"ok-cancel-bar"},React.createElement(caladan_1.Button,{className:"cancel",type:"secondary",onClick:this.onCancelClick.bind(this),title:strings_1.STRINGS.cancel}),React.createElement(caladan_1.Button,{className:"ok",type:"primary",onClick:this.onOkClick.bind(this),disabled:!this.actionEnabled(),title:strings_1.STRINGS.ok})))};return SplitMenu}(React.Component);exports.SplitMenu=SplitMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Icons=__webpack_require__(11);exports.VISUALIZATIONS={"bar-chart":Icons.VIS_BAR_CHART,geo:Icons.VIS_GEO,heatmap:Icons.VIS_HEATMAP,"line-chart":Icons.VIS_LINE_CHART,"scatter-plot":Icons.VIS_SCATTER_PLOT,"stacked-bars":Icons.VIS_STACKED_BARS,table:Icons.VIS_TABLE,grid:Icons.VIS_GRID,totals:Icons.VIS_TOTALS,treemap:Icons.VIS_TREEMAP}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var icons_1=__webpack_require__(439);__webpack_require__(660);var VisSelectorMenu=function(_super){tslib_1.__extends(VisSelectorMenu,_super);function VisSelectorMenu(){return _super.call(this)||this}VisSelectorMenu.prototype.renderVisItem=function(v){var _a=this.props,essence=_a.essence,clicker=_a.clicker,onClose=_a.onClose;var visualization=essence.getVisualizationManifest();return React.createElement("div",{className:classNames("vis-item",v.name===visualization.name?"selected":"not-selected"),key:v.name,onClick:function(){clicker.summonVisualization(v);onClose()}},React.createElement(caladan_1.SvgIcon,{svg:icons_1.VISUALIZATIONS[v.name]}),React.createElement("div",{className:"vis-title"},v.title))};VisSelectorMenu.prototype.render=function(){var _this=this;var _a=this.props,essence=_a.essence,openOn=_a.openOn,onClose=_a.onClose;var visualizations=essence.visualizations;var visItems=null;if(visualizations){visItems=visualizations.map(function(v){return _this.renderVisItem(v)})}return React.createElement(caladan_1.BubbleMenu,{className:"vis-selector-menu",openOn:openOn,direction:"down",align:"end",stage:beltful_1.Stage.fromSize(272,200),onClose:onClose},visItems)};return VisSelectorMenu}(React.Component);exports.VisSelectorMenu=VisSelectorMenu},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);tslib_1.__exportStar(__webpack_require__(664),exports)},,,,,,,,,,,,,,,,,,,,,,,,,function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);tslib_1.__exportStar(__webpack_require__(539),exports);tslib_1.__exportStar(__webpack_require__(542),exports);tslib_1.__exportStar(__webpack_require__(545),exports);tslib_1.__exportStar(__webpack_require__(574),exports);tslib_1.__exportStar(__webpack_require__(415),exports);tslib_1.__exportStar(__webpack_require__(412),exports);tslib_1.__exportStar(__webpack_require__(414),exports);tslib_1.__exportStar(__webpack_require__(413),exports);tslib_1.__exportStar(__webpack_require__(470),exports);tslib_1.__exportStar(__webpack_require__(432),exports);tslib_1.__exportStar(__webpack_require__(589),exports);tslib_1.__exportStar(__webpack_require__(434),exports);tslib_1.__exportStar(__webpack_require__(191),exports);tslib_1.__exportStar(__webpack_require__(602),exports);tslib_1.__exportStar(__webpack_require__(189),exports);tslib_1.__exportStar(__webpack_require__(406),exports);tslib_1.__exportStar(__webpack_require__(190),exports);tslib_1.__exportStar(__webpack_require__(469),exports);tslib_1.__exportStar(__webpack_require__(605),exports);tslib_1.__exportStar(__webpack_require__(608),exports);tslib_1.__exportStar(__webpack_require__(611),exports);tslib_1.__exportStar(__webpack_require__(105),exports);tslib_1.__exportStar(__webpack_require__(614),exports);tslib_1.__exportStar(__webpack_require__(617),exports);tslib_1.__exportStar(__webpack_require__(622),exports);tslib_1.__exportStar(__webpack_require__(625),exports);tslib_1.__exportStar(__webpack_require__(628),exports);tslib_1.__exportStar(__webpack_require__(631),exports);tslib_1.__exportStar(__webpack_require__(407),exports);tslib_1.__exportStar(__webpack_require__(408),exports);tslib_1.__exportStar(__webpack_require__(436),exports);tslib_1.__exportStar(__webpack_require__(636),exports);tslib_1.__exportStar(__webpack_require__(111),exports);tslib_1.__exportStar(__webpack_require__(409),exports);tslib_1.__exportStar(__webpack_require__(183),exports);tslib_1.__exportStar(__webpack_require__(197),exports);tslib_1.__exportStar(__webpack_require__(472),exports);tslib_1.__exportStar(__webpack_require__(467),exports);tslib_1.__exportStar(__webpack_require__(437),exports);tslib_1.__exportStar(__webpack_require__(438),exports);tslib_1.__exportStar(__webpack_require__(647),exports);tslib_1.__exportStar(__webpack_require__(410),exports);tslib_1.__exportStar(__webpack_require__(433),exports);tslib_1.__exportStar(__webpack_require__(411),exports);tslib_1.__exportStar(__webpack_require__(650),exports);tslib_1.__exportStar(__webpack_require__(653),exports);tslib_1.__exportStar(__webpack_require__(656),exports);tslib_1.__exportStar(__webpack_require__(659),exports);tslib_1.__exportStar(__webpack_require__(440),exports)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var chronoshift_1=__webpack_require__(23);var React=__webpack_require__(1);var strings_1=__webpack_require__(17);var query_runner_1=__webpack_require__(73);__webpack_require__(643);var AUTO_REFRESH_LABELS={null:"Off",undefined:"Off",PT5S:"Every 5 seconds",PT15S:"Every 15 seconds",PT1M:"Every minute",PT5M:"Every 5 minutes",PT10M:"Every 10 minutes",PT30M:"Every 30 minutes"};var REFRESH_DURATIONS=[null,chronoshift_1.Duration.fromJS("PT5S"),chronoshift_1.Duration.fromJS("PT15S"),chronoshift_1.Duration.fromJS("PT1M"),chronoshift_1.Duration.fromJS("PT5M"),chronoshift_1.Duration.fromJS("PT10M"),chronoshift_1.Duration.fromJS("PT30M")];var OptionsMenu=function(_super){tslib_1.__extends(OptionsMenu,_super);function OptionsMenu(){return _super.call(this)||this}OptionsMenu.prototype.renderTimezonesDropdown=function(){var _a=this.props,timezone=_a.timezone,customization=_a.customization,onClose=_a.onClose,changeTimezone=_a.changeTimezone;var TimezoneDropdown=caladan_1.Dropdown.specialize();return React.createElement(TimezoneDropdown,{className:"timezone-dropdown",label:strings_1.STRINGS.timezone,selectedItem:timezone,renderItem:function(d){return d.toString().replace(/_/g," ")},items:customization.getTimezones(),onSelect:function(newTimezone){changeTimezone(newTimezone);onClose()}})};OptionsMenu.prototype.renderRefreshControls=function(){var _a=this.props,onRefreshMaxTime=_a.onRefreshMaxTime,autoRefreshRate=_a.autoRefreshRate,setAutoRefreshRate=_a.setAutoRefreshRate;if(!onRefreshMaxTime||!setAutoRefreshRate)return null;var DurationDropdown=caladan_1.Dropdown.specialize();return React.createElement("div",{className:"refresh-controls"},React.createElement(DurationDropdown,{label:strings_1.STRINGS.autoUpdate,items:REFRESH_DURATIONS,selectedItem:autoRefreshRate,renderItem:function(d){return AUTO_REFRESH_LABELS[String(d)]||"Custom "+d},onSelect:setAutoRefreshRate}),React.createElement(caladan_1.Button,{svg:Icons.FULL_REFRESH,type:"secondary",className:"update-now-button",onClick:onRefreshMaxTime}))};OptionsMenu.prototype.render=function(){var _this=this;var _a=this.props,openOn=_a.openOn,onClose=_a.onClose,refreshText=_a.refreshText,openRawDataModal=_a.openRawDataModal,openMonitorModal=_a.openMonitorModal,customization=_a.customization;var extraOptions=[];if(openRawDataModal){extraOptions.push(React.createElement("li",{className:"view-raw-data",key:"view-raw-data",onClick:function(){openRawDataModal();onClose()}},strings_1.STRINGS.viewRawData))}if(openMonitorModal&&customization.getClientMonitor()==="allow"){extraOptions.push(React.createElement("li",{className:"monitor-queries",key:"monitor-queries",onClick:function(){openMonitorModal();onClose()}},strings_1.STRINGS.monitorQueries))}if(query_runner_1.QueryRunner.hasQueryCache){extraOptions.push(React.createElement("li",{key:"enable-cache"},React.createElement(caladan_1.Checkbox,{selected:query_runner_1.QueryRunner.cacheEnabled,label:strings_1.STRINGS.enableCache,onClick:function(){query_runner_1.QueryRunner.cacheEnabled=!query_runner_1.QueryRunner.cacheEnabled;_this.setState({})}})))}return React.createElement(caladan_1.BubbleMenu,{className:"options-menu",direction:"down",stage:beltful_1.Stage.fromSize(240,200),openOn:openOn,onClose:onClose},this.renderTimezonesDropdown(),this.renderRefreshControls(),refreshText?React.createElement("div",{className:"update-info"},refreshText):null,React.createElement("ul",{className:"bubble-list"},extraOptions))};return OptionsMenu}(React.Component);exports.OptionsMenu=OptionsMenu},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;var saveAs=saveAs||function(view){"use strict";if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=new MouseEvent("click");node.dispatchEvent(event)},is_safari=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),webkit_req_fs=view.webkitRequestFileSystem,req_fs=view.requestFileSystem||webkit_req_fs||view.mozRequestFileSystem,throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},force_saveable_type="application/octet-stream",fs_min_size=0,arbitrary_revoke_timeout=1e3*40,revoke=function(file){var revoker=function(){if(typeof file==="string"){get_URL().revokeObjectURL(file)}else{file.remove()}};setTimeout(revoker,arbitrary_revoke_timeout)},dispatch=function(filesaver,event_types,event){event_types=[].concat(event_types);var i=event_types.length;while(i--){var listener=filesaver["on"+event_types[i]];if(typeof listener==="function"){try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}}},auto_bom=function(blob){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)){return new Blob(["\ufeff",blob],{type:blob.type})}return blob},FileSaver=function(blob,name,no_auto_bom){if(!no_auto_bom){blob=auto_bom(blob)}var filesaver=this,type=blob.type,blob_changed=false,object_url,target_view,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))},fs_error=function(){if(target_view&&is_safari&&typeof FileReader!=="undefined"){var reader=new FileReader;reader.onloadend=function(){var base64Data=reader.result;target_view.location.href="data:attachment/file"+base64Data.slice(base64Data.search(/[,;]/));filesaver.readyState=filesaver.DONE;dispatch_all()};reader.readAsDataURL(blob);filesaver.readyState=filesaver.INIT;return}if(blob_changed||!object_url){object_url=get_URL().createObjectURL(blob)}if(target_view){target_view.location.href=object_url}else{var new_tab=view.open(object_url,"_blank");if(new_tab===undefined&&is_safari){view.location.href=object_url}}filesaver.readyState=filesaver.DONE;dispatch_all();revoke(object_url)},abortable=function(func){return function(){if(filesaver.readyState!==filesaver.DONE){return func.apply(this,arguments)}}},create_if_not_found={create:true,exclusive:false},slice;filesaver.readyState=filesaver.INIT;if(!name){name="download"}if(can_use_save_link){object_url=get_URL().createObjectURL(blob);setTimeout(function(){save_link.href=object_url;save_link.download=name;click(save_link);dispatch_all();revoke(object_url);filesaver.readyState=filesaver.DONE});return}if(view.chrome&&type&&type!==force_saveable_type){slice=blob.slice||blob.webkitSlice;blob=slice.call(blob,0,blob.size,force_saveable_type);blob_changed=true}if(webkit_req_fs&&name!=="download"){name+=".download"}if(type===force_saveable_type||webkit_req_fs){target_view=view}if(!req_fs){fs_error();return}fs_min_size+=blob.size;req_fs(view.TEMPORARY,fs_min_size,abortable(function(fs){fs.root.getDirectory("saved",create_if_not_found,abortable(function(dir){var save=function(){dir.getFile(name,create_if_not_found,abortable(function(file){file.createWriter(abortable(function(writer){writer.onwriteend=function(event){target_view.location.href=file.toURL();filesaver.readyState=filesaver.DONE;dispatch(filesaver,"writeend",event);revoke(file)};writer.onerror=function(){var error=writer.error;if(error.code!==error.ABORT_ERR){fs_error()}};"writestart progress write abort".split(" ").forEach(function(event){writer["on"+event]=filesaver["on"+event]});writer.write(blob);filesaver.abort=function(){writer.abort();filesaver.readyState=filesaver.DONE};filesaver.readyState=filesaver.WRITING}),fs_error)}),fs_error)};dir.getFile(name,{create:false},abortable(function(file){file.remove();save()}),abortable(function(ex){if(ex.code===ex.NOT_FOUND_ERR){save()}else{fs_error()}}))}),fs_error)}),fs_error)},FS_proto=FileSaver.prototype,saveAs=function(blob,name,no_auto_bom){return new FileSaver(blob,name,no_auto_bom)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(blob,name,no_auto_bom){if(!no_auto_bom){blob=auto_bom(blob)}return navigator.msSaveOrOpenBlob(blob,name||"download")}}FS_proto.abort=function(){var filesaver=this;filesaver.readyState=filesaver.DONE;dispatch(filesaver,"abort")};FS_proto.readyState=FS_proto.INIT=0;FS_proto.WRITING=1;FS_proto.DONE=2;FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null;return saveAs}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports){module.exports.saveAs=saveAs}else if("function"!=="undefined"&&__webpack_require__(615)!==null&&__webpack_require__(616)!==null){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return saveAs}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var constants_1=__webpack_require__(52);var dom_1=__webpack_require__(68);var drag_manager_1=__webpack_require__(110);var formatter_1=__webpack_require__(186);var pill_tile_1=__webpack_require__(405);var fancy_drag_indicator_1=__webpack_require__(189);var filter_menu_1=__webpack_require__(406);var dimension_pill_1=__webpack_require__(416);var dimension_picker_menu_1=__webpack_require__(191);var deferred_1=__webpack_require__(417);__webpack_require__(537);var FILTER_CLASS_NAME="filter";var ANIMATION_DURATION=400;var FilterTile=function(_super){tslib_1.__extends(FilterTile,_super);function FilterTile(){var _this=_super.call(this)||this;_this.overflowMenuId=beltful_1.DOMUtils.uniqueId("overflow-menu-");_this.state={menuOpenOn:null,menuDimension:null,menuInside:null,overflowMenuOpenOn:null,dragPosition:null,possibleDimension:null,possiblePosition:null};return _this}FilterTile.prototype.componentDidMount=function(){this.calculateSize()};FilterTile.prototype.componentDidUpdate=function(){if(this.dummyDeferred){this.dummyDeferred.resolve(null);this.dummyDeferred=null}};FilterTile.prototype.calculateSize=function(){if(!this.itemsDOM)return;var itemStage=this.state.itemStage;var newItemStage=beltful_1.Stage.fromClientRect(this.itemsDOM.getBoundingClientRect());if(!newItemStage.equals(itemStage)){this.setState({itemStage:newItemStage})}};FilterTile.prototype.getOverflowMenu=function(){return document.getElementById(this.overflowMenuId)};FilterTile.prototype.clickDimension=function(dimension,e){var target=dom_1.findParentWithClass(e.target,FILTER_CLASS_NAME);this.openMenu(dimension,target)};FilterTile.prototype.openMenuOnDimension=function(dimension){var _this=this;var targetRef=this.refs[dimension.name];if(targetRef){var target=ReactDOM.findDOMNode(targetRef);if(!target)return;this.openMenu(dimension,target)}else{var overflowButtonTarget=this.overflowDOM;if(overflowButtonTarget){this.openOverflowMenu(overflowButtonTarget).then(function(){var target=ReactDOM.findDOMNode(_this.refs[dimension.name]);if(!target)return;_this.openMenu(dimension,target)})}}};FilterTile.prototype.openMenu=function(dimension,target){var menuOpenOn=this.state.menuOpenOn;if(menuOpenOn===target){this.closeMenu();return}var overflowMenu=this.getOverflowMenu();var menuInside=null;if(overflowMenu&&beltful_1.DOMUtils.isInside(target,overflowMenu)){menuInside=overflowMenu}this.setState({menuOpenOn:target,menuDimension:dimension,menuInside:menuInside})};FilterTile.prototype.closeMenu=function(){var _a=this.state,menuOpenOn=_a.menuOpenOn,possibleDimension=_a.possibleDimension;if(!menuOpenOn)return;var newState={menuOpenOn:null,menuDimension:null,menuInside:null,possibleDimension:null,possiblePosition:null};if(possibleDimension){newState.overflowMenuOpenOn=null}this.setState(newState)};FilterTile.prototype.openOverflowMenu=function(target){if(!target)return Promise.resolve(null);var overflowMenuOpenOn=this.state.overflowMenuOpenOn;if(overflowMenuOpenOn===target){this.closeOverflowMenu();return Promise.resolve(null)}this.overflowMenuDeferred=new deferred_1.Deferred;this.setState({overflowMenuOpenOn:target});return this.overflowMenuDeferred.promise};FilterTile.prototype.closeOverflowMenu=function(){var overflowMenuOpenOn=this.state.overflowMenuOpenOn;if(!overflowMenuOpenOn)return;this.setState({overflowMenuOpenOn:null})};FilterTile.prototype.removeFilter=function(itemBlank,e){var _a=this.props,essence=_a.essence,clicker=_a.clicker;if(itemBlank.clause){if(itemBlank.source==="from-highlight"){clicker.dropHighlight()}else{clicker.changeFilter(essence.getEffectiveFilter().remove(itemBlank.clause.dimension))}}this.closeMenu();this.closeOverflowMenu();e.stopPropagation()};FilterTile.prototype.dragStart=function(dimension,clause,e){var _a=this.props,essence=_a.essence,getLongUrl=_a.getLongUrl;var dataTransfer=e.dataTransfer;dataTransfer.effectAllowed="all";if(getLongUrl){var newUrl=getLongUrl(essence);dataTransfer.setData("text/url-list",newUrl);dataTransfer.setData("text/plain",newUrl)}drag_manager_1.DragManager.setDragDimension(dimension,"filter-tile");beltful_1.DOMUtils.setDragGhost(dataTransfer,dimension.title);this.closeMenu();this.closeOverflowMenu()};FilterTile.prototype.calculateDragPosition=function(e){var essence=this.props.essence;var numItems=essence.getEffectiveFilter().length();var rect=this.itemsDOM.getBoundingClientRect();var offset=beltful_1.EventUtils.getXFromEvent(e)-rect.left;return models_1.DragPosition.calculateFromOffset(offset,numItems,constants_1.CORE_ITEM_WIDTH,constants_1.CORE_ITEM_GAP)};FilterTile.prototype.canDrop=function(e){return Boolean(drag_manager_1.DragManager.getDragDimension())};FilterTile.prototype.dragEnter=function(e){if(!this.canDrop(e))return;e.preventDefault();var dragPosition=this.calculateDragPosition(e);if(dragPosition.equals(this.state.dragPosition))return;this.setState({dragPosition:dragPosition})};FilterTile.prototype.dragOver=function(e){if(!this.canDrop(e))return;e.dataTransfer.dropEffect="move";e.preventDefault();var dragPosition=this.calculateDragPosition(e);if(dragPosition.equals(this.state.dragPosition))return;this.setState({dragPosition:dragPosition})};FilterTile.prototype.dragLeave=function(e){this.setState({dragPosition:null})};FilterTile.prototype.drop=function(e){var _this=this;if(!this.canDrop(e))return;e.preventDefault();var _a=this.props,clicker=_a.clicker,essence=_a.essence;var filter=essence.getEffectiveFilter();var newState={dragPosition:null};var dimension=drag_manager_1.DragManager.getDragDimension();if(dimension){var dragPosition=this.calculateDragPosition(e);var tryingToReplaceMandatory=false;if(dragPosition.replace!==null){var targetClause=filter.clauses[dragPosition.replace];tryingToReplaceMandatory=targetClause&&essence.isMandatoryTimeFilter(targetClause.dimension)}var existingClause=filter.clauseForDimension(dimension.name);if(existingClause){var newFilter=void 0;if(dragPosition.isReplace()){newFilter=filter.replaceByIndex(dragPosition.replace,existingClause)}else{newFilter=filter.insertByIndex(dragPosition.insert,existingClause)}var newFilterSame=filter.equals(newFilter);if(!newFilterSame){clicker.changeFilter(newFilter)}if(drag_manager_1.DragManager.getDragOrigin()!=="filter-tile"){if(newFilterSame){this.filterMenuRequest(dimension)}else{setTimeout(function(){_this.filterMenuRequest(dimension)},ANIMATION_DURATION+50)}}}else{if(dragPosition&&!tryingToReplaceMandatory){this.addDummy(dimension,dragPosition)}}}this.setState(newState)};FilterTile.prototype.addDummy=function(dimension,possiblePosition){var _this=this;this.dummyDeferred=new deferred_1.Deferred;this.setState({possibleDimension:dimension,possiblePosition:possiblePosition});this.dummyDeferred.promise.then(function(){_this.openMenuOnDimension(dimension)})};FilterTile.prototype.filterMenuRequest=function(dimension){var essence=this.props.essence;var filter=essence.getEffectiveFilter();if(filter.filteredOn(dimension.name)){this.openMenuOnDimension(dimension)}else{this.addDummy(dimension,new models_1.DragPosition({insert:filter.length()}))}};FilterTile.prototype.overflowButtonClick=function(){this.openOverflowMenu(this.overflowDOM)};FilterTile.prototype.renderMenu=function(maxItems){var _this=this;var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,clicker=_a.clicker,deltaSourceFilter=_a.deltaSourceFilter;var _b=this.state,menuOpenOn=_b.menuOpenOn,menuDimension=_b.menuDimension,menuInside=_b.menuInside,possiblePosition=_b.possiblePosition;if(!menuDimension)return null;if(possiblePosition&&possiblePosition.replace===maxItems){possiblePosition=new models_1.DragPosition({insert:possiblePosition.replace})}return React.createElement(filter_menu_1.FilterMenu,{clicker:clicker,essence:essence,deltaSourceFilter:deltaSourceFilter,timekeeper:timekeeper,openOn:menuOpenOn,dimension:menuDimension,changePosition:possiblePosition,onClose:function(){return _this.closeMenu()},insideId:menuInside?this.overflowMenuId:null})};FilterTile.prototype.renderOverflowMenu=function(overflowItemBlanks,pillColor){var _this=this;var overflowMenuOpenOn=this.state.overflowMenuOpenOn;if(!overflowMenuOpenOn)return null;var segmentHeight=29+constants_1.CORE_ITEM_GAP;var itemY=constants_1.CORE_ITEM_GAP;var filterItems=overflowItemBlanks.map(function(itemBlank){var style=dom_1.transformStyle(0,itemY);style.backgroundColor=pillColor;itemY+=segmentHeight;return _this.renderDimensionPill(itemBlank,style,pillColor)});return React.createElement(caladan_1.BubbleMenu,{className:"overflow-menu",id:this.overflowMenuId,ref:function(e){if(!e||!_this.overflowMenuDeferred)return;window.setTimeout(function(){var overflowMenuDOM=_this.getOverflowMenu();if(_this.overflowMenuDeferred){_this.overflowMenuDeferred.resolve(overflowMenuDOM);_this.overflowMenuDeferred=null}},1)},direction:"down",stage:beltful_1.Stage.fromSize(constants_1.CORE_ITEM_WIDTH+16,itemY),fixedSize:true,openOn:overflowMenuOpenOn,onClose:this.closeOverflowMenu.bind(this)},filterItems)};FilterTile.prototype.renderOverflow=function(overflowItemBlanks,itemX,pillColor){var _this=this;var classes=["overflow",{"all-continuous":overflowItemBlanks.every(function(item){return item.dimension.isContinuous()})}];return React.createElement(dimension_pill_1.DimensionPill,{key:"overflow",ref:function(pill){return _this.overflowDOM=ReactDOM.findDOMNode(pill)},label:"+"+overflowItemBlanks.length,color:pillColor,classes:classes,style:dom_1.transformStyle(itemX,0),onClick:function(){return _this.overflowButtonClick()}},this.renderOverflowMenu(overflowItemBlanks,pillColor))};FilterTile.prototype.renderDimensionPill=function(itemBlank,style,pillColor){var _this=this;var _a=this.props,essence=_a.essence,clicker=_a.clicker;var menuDimension=this.state.menuDimension;var dimension=itemBlank.dimension,clause=itemBlank.clause,source=itemBlank.source;var classes=[FILTER_CLASS_NAME,source,clause&&clause.getExclude()?"excluded":"included",dimension===menuDimension?"selected":undefined,"type-"+dimension.type.toLowerCase()];var _b=clause?formatter_1.getFormattedClause(dimension,clause,essence.timezone):{title:dimension.title,values:undefined},title=_b.title,values=_b.values;var onClick=source==="from-highlight"?function(){return clicker.acceptHighlight()}:clause?function(e){return _this.clickDimension(dimension,e)}:undefined;var onDrag=clause?function(e){return _this.dragStart(dimension,clause,e)}:undefined;var onRemove=essence.isMandatoryTimeFilter(dimension.name)?null:function(e){return _this.removeFilter(itemBlank,e)};return React.createElement(dimension_pill_1.DimensionPill,{key:dimension.name,ref:dimension.name,label:title,values:values,color:pillColor,classes:classes,style:style,icon:dimension.getIcon(),onDrag:onDrag,onClick:onClick,onRemove:onRemove})};FilterTile.prototype.getItemBlankCount=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;var possiblePosition=this.state.possiblePosition;return essence.getSpecificFilterWithHighlight(timekeeper).clauses.length+Number(Boolean(possiblePosition))};FilterTile.prototype.getPillModels=function(maxItems){var essence=this.props.essence;var _a=this.state,possibleDimension=_a.possibleDimension,possiblePosition=_a.possiblePosition;var highlight=essence.highlight;var filter=essence.getEffectiveFilter();var itemBlanks=filter.clauses.map(function(clause){var dimension=essence.getDimension(clause.dimension);if(!dimension)return null;return{dimension:dimension,source:"from-filter",clause:clause}}).filter(Boolean);if(highlight){highlight.delta.clauses.forEach(function(clause){var added=false;itemBlanks=itemBlanks.map(function(blank){if(clause.dimension===blank.clause.dimension){added=true;return{dimension:blank.dimension,source:"from-highlight",clause:clause}}else{return blank}});if(!added){var dimension=essence.getDimension(clause.dimension);if(dimension){itemBlanks.push({dimension:dimension,source:"from-highlight",clause:clause})}}})}if(possibleDimension&&possiblePosition){var dummyBlank={dimension:possibleDimension,source:"from-drag"};if(possiblePosition.replace===maxItems){possiblePosition=new models_1.DragPosition({insert:possiblePosition.replace})}if(possiblePosition.isInsert()){itemBlanks.splice(possiblePosition.insert,0,dummyBlank)}else{itemBlanks[possiblePosition.replace]=dummyBlank}}return itemBlanks};FilterTile.prototype.renderItems=function(maxItems,titleWidthOverride){var _this=this;var _a=this.props,essence=_a.essence,customization=_a.customization;var _b=this.state,dragPosition=_b.dragPosition,addMenuOpen=_b.addMenuOpen;var pillColor=customization.getPreferredTheme(essence.actualDataCube.theme).getPillColor();var itemBlanks=this.getPillModels(maxItems);var itemX=0;var filterItems=itemBlanks.slice(0,maxItems).map(function(item){var style=dom_1.transformStyle(itemX,0);itemX+=pill_tile_1.SECTION_WIDTH;return _this.renderDimensionPill(item,style,pillColor)});var overflow=itemBlanks.slice(maxItems);if(overflow.length>0){var overFlowStart=filterItems.length*pill_tile_1.SECTION_WIDTH;itemX+=pill_tile_1.OVERFLOW_SECTION_WIDTH;filterItems.push(this.renderOverflow(overflow,overFlowStart,pillColor))}return React.createElement("div",{className:"items",ref:function(e){return _this.itemsDOM=e},style:{left:titleWidthOverride}},filterItems,!(dragPosition&&dragPosition.replace===filterItems.length)?React.createElement("div",{className:"add-filter",style:dom_1.transformStyle(itemX,8),ref:function(element){return _this.addButton=element},onClick:function(){return _this.setState({addMenuOpen:!addMenuOpen})}},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.FULL_ADD})):null)};FilterTile.prototype.renderAddMenu=function(){var _this=this;var essence=this.props.essence;var addMenuOpen=this.state.addMenuOpen;if(!addMenuOpen)return null;return React.createElement(dimension_picker_menu_1.DimensionPickerMenu,{dimensions:essence.getDimensions(),onSelect:function(d){_this.setState({addMenuOpen:false});_this.filterMenuRequest(d)},openOn:this.addButton,onClose:function(){return _this.setState({addMenuOpen:false})}})};FilterTile.prototype.render=function(){var customization=this.props.customization;var _a=this.state,dragPosition=_a.dragPosition,itemStage=_a.itemStage;var renameFilterTo=customization?customization.renameFilterTo:null;var titleWidthOverride=customization&&customization.renameFilterOrSplit()?74:null;var maxItems=itemStage?pill_tile_1.getMaxItems(itemStage.width,this.getItemBlankCount()):20;return React.createElement("div",{className:"filter-tile",onDragEnter:this.dragEnter.bind(this)},React.createElement(caladan_1.GlobalEventListener,{resize:this.calculateSize.bind(this)}),React.createElement("div",{className:"title",style:{width:titleWidthOverride}},renameFilterTo||strings_1.STRINGS.filter),this.renderItems(maxItems,titleWidthOverride),dragPosition?React.createElement(fancy_drag_indicator_1.FancyDragIndicator,{dragPosition:dragPosition,style:{left:titleWidthOverride}}):null,dragPosition?React.createElement("div",{className:"drag-mask",onDragOver:this.dragOver.bind(this),onDragLeave:this.dragLeave.bind(this),onDragExit:this.dragLeave.bind(this),onDrop:this.drop.bind(this)}):null,this.renderMenu(maxItems),this.renderAddMenu())};return FilterTile}(React.Component);exports.FilterTile=FilterTile},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var React=__webpack_require__(1);__webpack_require__(582);var DescriptionIcon=function(_super){tslib_1.__extends(DescriptionIcon,_super);function DescriptionIcon(){var _this=_super.call(this)||this;_this.state={isOpen:false};return _this}DescriptionIcon.prototype.onOpen=function(e){var isOpen=this.state.isOpen;e.stopPropagation();this.setState({isOpen:!isOpen})};DescriptionIcon.prototype.renderMenu=function(){var _this=this;var description=this.props.description;var isOpen=this.state.isOpen;if(!isOpen)return null;var onClose=function(){_this.setState({isOpen:false})};return React.createElement(caladan_1.BubbleMenu,{className:"description-icon-menu",direction:"down",stage:beltful_1.Stage.fromSize(200,200),openOn:isOpen?this.containerDOM:null,onClose:onClose},React.createElement("p",{className:"info"},description))};DescriptionIcon.prototype.render=function(){var _this=this;var description=this.props.description;if(!description)return null;var isOpen=this.state.isOpen;return React.createElement("div",{className:"description-icon",ref:function(e){return _this.containerDOM=e},onClick:this.onOpen.bind(this)},React.createElement(caladan_1.SvgIcon,{className:isOpen?"open":"closed",svg:Icons.HELP_2}),this.renderMenu())};return DescriptionIcon}(React.Component);exports.DescriptionIcon=DescriptionIcon},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var filesaver=__webpack_require__(468);function getMIMEType(fileType){switch(fileType){case"csv":return"text/csv";case"tsv":return"text/tsv";default:return"application/json"}}exports.getMIMEType=getMIMEType;function download(dataset,fileName,fileFormat){var type=getMIMEType(fileFormat)+";charset=utf-8";var blob=new Blob([datasetToFileString(dataset,fileFormat)],{type:type});if(!fileName)fileName=new Date+"-data";fileName+="."+fileFormat;filesaver.saveAs(blob,fileName,true)}exports.download=download;function datasetToFileString(dataset,fileFormat){if(fileFormat==="csv"){return dataset.toCSV({columnOrdering:"keys-first"})}else if(fileFormat==="tsv"){return dataset.toTSV({columnOrdering:"keys-first"})}else{return JSON.stringify(dataset.toJS(),null,2)}}exports.datasetToFileString=datasetToFileString;function makeFileName(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}var nameComponents=[];args.forEach(function(arg){if(arg)nameComponents.push(arg.toLowerCase())});var nameString=nameComponents.join("_");return nameString.length<200?nameString:nameString.substr(0,200)}exports.makeFileName=makeFileName},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var segment_action_buttons_1=__webpack_require__(197);var shpitz_1=__webpack_require__(437);__webpack_require__(641);var OFFSET_V=-10;var PIXELS_PER_LETTER=8;var SegmentBubble=function(_super){tslib_1.__extends(SegmentBubble,_super);function SegmentBubble(){return _super.call(this)||this}SegmentBubble.getTinyIndicator=function(props){var left=props.left,top=props.top,direction=props.direction,label=props.label,onClick=props.onClick;return React.createElement(caladan_1.BodyPortal,{left:left,top:top+OFFSET_V},React.createElement("div",{className:classNames("segment-bubble tiny",direction),onClick:onClick},React.createElement("div",{className:"text"},label),React.createElement(shpitz_1.Shpitz,{direction:direction})))};SegmentBubble.prototype.onSelect=function(){var _a=this.props,onClose=_a.onClose,clicker=_a.clicker;clicker.acceptHighlight();if(onClose)onClose()};SegmentBubble.prototype.onCancel=function(){var _a=this.props,onClose=_a.onClose,clicker=_a.clicker;if(clicker)clicker.dropHighlight();if(onClose)onClose()};SegmentBubble.prototype.onMouseLeave=function(){if(this.props.onMouseLeave)this.props.onMouseLeave()};SegmentBubble.prototype.render=function(){var _a=this.props,left=_a.left,top=_a.top,dimensions=_a.dimensions,segmentLabel=_a.segmentLabel,measureLabel=_a.measureLabel,clicker=_a.clicker,openRawDataModal=_a.openRawDataModal,onClose=_a.onClose,onMouseLeave=_a.onMouseLeave,disableExclusion=_a.disableExclusion,selectionMode=_a.selectionMode,toggleSelectionMode=_a.toggleSelectionMode;var textElement;if(segmentLabel){var minTextWidth=beltful_1.NumberUtils.clamp(segmentLabel.length*PIXELS_PER_LETTER,80,300);textElement=React.createElement("div",{className:"text",style:{minWidth:minTextWidth}},React.createElement("div",{className:"segment"},segmentLabel),measureLabel?React.createElement("div",{className:"measure-value"},measureLabel):null)}var actionsElement=null;if(clicker){actionsElement=React.createElement(segment_action_buttons_1.SegmentActionButtons,{clicker:clicker,dimensions:dimensions,segmentLabel:segmentLabel,openRawDataModal:openRawDataModal,onClose:onClose,disableExclusion:disableExclusion,selectionMode:selectionMode,toggleSelectionMode:toggleSelectionMode})}var needsPointerEvents=!!clicker||!!onMouseLeave;return React.createElement(caladan_1.BodyPortal,{left:left,top:top+OFFSET_V,disablePointerEvents:!needsPointerEvents},React.createElement("div",{className:"segment-bubble",ref:"bubble",onMouseLeave:this.onMouseLeave.bind(this)},React.createElement(caladan_1.GlobalEventListener,{escape:this.onCancel.bind(this),enter:this.onSelect.bind(this)}),textElement,actionsElement,React.createElement(shpitz_1.Shpitz,{direction:"up"})))};SegmentBubble.defaultProps={left:0,top:0};return SegmentBubble}(React.Component);exports.SegmentBubble=SegmentBubble},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var strings_1=__webpack_require__(474);var role_1=__webpack_require__(386);var DEFAULT_ADMIN_NAME="admin@admin.com";var DEFAULT_ADMIN_PROPERTIES={name:DEFAULT_ADMIN_NAME,email:"admin@admin.com",firstName:"Default",lastName:"Admin",roles:["super-admin"],status:"ok"};var User=function(_super){tslib_1.__extends(User,_super);function User(){return _super!==null&&_super.apply(this,arguments)||this}User.isUser=function(candidate){return candidate instanceof User};User.fromJS=function(parameters){var id=parameters.id;if(id&&!parameters.name){parameters.name=id}if(parameters.status==="passwordReset")parameters.status=User.STATUS_OK;return new User(immutable_class_1.BaseImmutable.jsToValue(User.PROPERTIES,parameters,User.BACK_COMPATS))};User.fromName=function(name){return new User({name:name})};User.prototype.isSuperAdmin=function(){return this.getRoles().includes(role_1.Role.SUPER_ADMIN_NAME)};User.prototype.canAccessSettings=function(){return this.isSuperAdmin()};User.prototype.can=function(permission,accountRoles){if(!accountRoles||!accountRoles.length)accountRoles=[role_1.Role.SUPER_ADMIN,role_1.Role.USER];var myInflatedRoles=this.getRoles().map(function(role){return immutable_class_1.NamedArray.findByName(accountRoles,role)}).filter(Boolean);return myInflatedRoles.some(function(role){return role.can(permission)})||myInflatedRoles.some(function(role){return role.isSuperAdmin()})};User.prototype.getRole=function(){return this.getRoles()[0]};User.prototype.changeRole=function(role){return this.changeRoles([role])};User.prototype.getStatusDisplay=function(){var status=this.getStatus();switch(status){case User.STATUS_INVITATION_LINK:return strings_1.STRINGS.invitationLink;default:return strings_1.STRINGS.ok}};User.prototype.getDisplayName=function(){var _a=this,firstName=_a.firstName,lastName=_a.lastName;if(firstName&&lastName)return firstName+" "+lastName;return firstName||lastName||"???"};User.prototype.equalsByName=function(other){if(!other)return false;return this.name===other.name};User.STATUS_INVITATION_LINK="invitationLink";User.STATUS_NEEDS_TO_SET_PASS="needsToSetPass";User.STATUS_OK="ok";User.STATUSES=[User.STATUS_INVITATION_LINK,User.STATUS_OK,User.STATUS_NEEDS_TO_SET_PASS];User.SUPER_ADMIN_NAME="super-admin";User.BACK_COMPATS=[{condition:function(js){return!js.roles},action:function(js){var oldValue=js.permissionType;js.roles=oldValue==="admin"?["super-admin"]:["user"]}}];User.PROPERTIES=[{name:"name"},{name:"accountId",defaultValue:null},{name:"email",defaultValue:null},{name:"firstName",defaultValue:null},{name:"lastName",defaultValue:null},{name:"status",defaultValue:User.STATUS_OK,possibleValues:User.STATUSES},{name:"roles",defaultValue:[role_1.Role.USER.name],preserveUndefined:true},{name:"favorites",type:immutable_class_1.PropertyType.ARRAY}];return User}(immutable_class_1.BaseImmutable);exports.User=User;immutable_class_1.BaseImmutable.finalize(User);User.DEFAULT_ADMIN=new User(DEFAULT_ADMIN_PROPERTIES);User.DEFAULT_ADMIN_NAME=User.DEFAULT_ADMIN.name},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.STRINGS={cancel:"Cancel",invitationLink:"Invitation link",login:"Login",loggingIn:"Logging in...",ok:"OK",privacyPolicy:"Privacy Policy",termsOfUse:"Terms of Use"}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var USER={name:{label:"User Id"},email:{label:"Email"},permissionType:{label:"User type",description:"Admins have access to editing clusters and data cubes. Users can only create collections."},firstName:{label:"First Name"},lastName:{label:"Last Name"},pass:{label:"Password"}};exports.CLOUD_USER={name:{label:"email"},permissionType:{label:"User type",description:"Admins can create new user account and have universal access, users can only manage clusters and see Pivot and Imply SQL."}};exports.AWS_CONNECTION={awsRegion:{label:"AWS region",description:'The <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html" target="_blank">\n      AWS Region\n    </a> that the cloud instance is operating within.'},roleARN:{label:"Role ARN",description:'The <a href="http://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html" target="_blank">\n      Role Namespace\n    </a> that this account is linked to.'}};exports.SUPPORT_DEMAND={subject:{label:"Subject",description:""},urgency:{label:"Urgency",description:""},question:{label:"Comment",description:""},optimization:{label:"Performance optimization",description:""},general:{label:"General",description:""},ui:{label:"User Interface",description:""}};var ROLE={title:{label:"Name",description:""},permissions:{label:"Permissions",description:""}};var PERMISSION={name:{label:"Name",description:""},value:{label:"Value",description:""}};exports.LABELS={USER:USER,ROLE:ROLE,PERMISSION:PERMISSION}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Device=function(){function Device(){}Device.getSize=function(){if(window.innerWidth<=1080)return"small";if(window.innerWidth<=1250)return"medium";return"large"};return Device}();exports.Device=Device},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function listItemize(labelField,valueField,descField){return function(object){var o={label:object[labelField],value:object[valueField]};if(descField)o.description=object[descField];return o}}exports.listItemize=listItemize},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var plywood_1=__webpack_require__(14);var dimension_1=__webpack_require__(107);var measure_1=__webpack_require__(177);var check;var SortOn=function(){function SortOn(parameters){this.dimension=parameters.dimension;this.measure=parameters.measure;if(!(this.dimension||this.measure))throw new Error("must have a dimension or a measure")}SortOn.isSortOn=function(candidate){return candidate instanceof SortOn};SortOn.equal=function(s1,s2){return s1===s2||s1.equals(s2)};SortOn.getName=function(s){return s.toName()};SortOn.getTitle=function(s){return s.getTitle()};SortOn.fromDimension=function(dimension){return new SortOn({dimension:dimension})};SortOn.fromMeasure=function(measure){return new SortOn({measure:measure})};SortOn.fromSortAction=function(sortAction,dataCube,fallbackDimension){if(!sortAction)return SortOn.fromDimension(fallbackDimension);var sortOnName=sortAction.expression.name;var measure=dataCube.getMeasure(sortOnName);if(measure)return SortOn.fromMeasure(measure);return SortOn.fromDimension(fallbackDimension)};SortOn.fromJS=function(parameters){var value={};if(parameters.dimension){value.dimension=dimension_1.Dimension.fromJS(parameters.dimension)}else{value.measure=measure_1.Measure.fromJS(parameters.measure)}return new SortOn(value)};SortOn.prototype.valueOf=function(){return{dimension:this.dimension,measure:this.measure}};SortOn.prototype.toJS=function(){var js={};if(this.dimension){js.dimension=this.dimension.toJS()}else{js.measure=this.measure.toJS()}return js};SortOn.prototype.toJSON=function(){return this.toJS()};SortOn.prototype.toString=function(){return"[SortOn: "+this.toName()+"]"};SortOn.prototype.equals=function(other){return SortOn.isSortOn(other)&&(this.dimension?this.dimension.equals(other.dimension):this.measure.equals(other.measure))};SortOn.prototype.toName=function(){var measure=this.measure;return measure?measure.name:this.dimension.name};SortOn.prototype.getTitle=function(){var measure=this.measure;return measure?measure.title:this.dimension.title};SortOn.prototype.getExpression=function(){return plywood_1.$(this.toName())};return SortOn}();exports.SortOn=SortOn;check=SortOn},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var bar_chart_manifest_1=__webpack_require__(392);var geo_manifest_1=__webpack_require__(397);var heatmap_manifest_1=__webpack_require__(396);var line_chart_manifest_1=__webpack_require__(391);var table_manifest_1=__webpack_require__(394);var grid_manifest_1=__webpack_require__(395);var totals_manifest_1=__webpack_require__(393);exports.MANIFESTS=[totals_manifest_1.TOTALS_MANIFEST,table_manifest_1.TABLE_MANIFEST,grid_manifest_1.GRID_MANIFEST,line_chart_manifest_1.LINE_CHART_MANIFEST,bar_chart_manifest_1.BAR_CHART_MANIFEST,heatmap_manifest_1.HEATMAP_MANIFEST,geo_manifest_1.GEO_MANIFEST]},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var essence_1=__webpack_require__(70);var collection_essence_1=__webpack_require__(399);var AnyEssence=function(){function AnyEssence(){throw new Error("can not make an AnyEssence")}AnyEssence.fromJS=function(parameters){if(parameters.dataCube){return essence_1.Essence.fromJS(parameters)}else if(parameters.collection){return collection_essence_1.CollectionEssence.fromJS(parameters)}else{throw new Error("essence must have a dataCube or collection")}};return AnyEssence}();exports.AnyEssence=AnyEssence},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(root,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports==="object"){module.exports=factory()}else{root.owaspPasswordStrengthTest=factory()}})(this,function(){var owasp={};owasp.configs={allowPassphrases:true,maxLength:128,minLength:10,minPhraseLength:20,minOptionalTestsToPass:4};owasp.config=function(params){for(var prop in params){if(params.hasOwnProperty(prop)&&this.configs.hasOwnProperty(prop)){this.configs[prop]=params[prop]}}};owasp.tests={required:[function(password){if(password.length<owasp.configs.minLength){return"The password must be at least "+owasp.configs.minLength+" characters long."}},function(password){if(password.length>owasp.configs.maxLength){return"The password must be fewer than "+owasp.configs.maxLength+" characters."}},function(password){if(/(.)\1{2,}/.test(password)){return"The password may not contain sequences of three or more repeated characters."}}],optional:[function(password){if(!/[a-z]/.test(password)){return"The password must contain at least one lowercase letter."}},function(password){if(!/[A-Z]/.test(password)){return"The password must contain at least one uppercase letter."}},function(password){if(!/[0-9]/.test(password)){return"The password must contain at least one number."}},function(password){if(!/[^A-Za-z0-9]/.test(password)){return"The password must contain at least one special character."}}]};owasp.test=function(password){var result={errors:[],failedTests:[],passedTests:[],requiredTestErrors:[],optionalTestErrors:[],isPassphrase:false,strong:true,optionalTestsPassed:0};var i=0;this.tests.required.forEach(function(test){var err=test(password);if(typeof err==="string"){result.strong=false;result.errors.push(err);result.requiredTestErrors.push(err);result.failedTests.push(i)}else{result.passedTests.push(i)}i++});if(this.configs.allowPassphrases===true&&password.length>=this.configs.minPhraseLength){result.isPassphrase=true}if(!result.isPassphrase){var j=this.tests.required.length;this.tests.optional.forEach(function(test){var err=test(password);if(typeof err==="string"){result.errors.push(err);result.optionalTestErrors.push(err);result.failedTests.push(j)}else{result.optionalTestsPassed++;result.passedTests.push(j)}j++})}if(!result.isPassphrase&&result.optionalTestsPassed<this.configs.minOptionalTestsToPass){result.strong=false}return result};return owasp})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var hasOwnProperty=__webpack_require__(29);var check;var DragPosition=function(){function DragPosition(parameters){this.insert=hasOwnProperty(parameters,"insert")?parameters.insert:null;this.replace=hasOwnProperty(parameters,"replace")?parameters.replace:null;if(this.insert==null&&this.replace==null)throw new Error("invalid drag position")}DragPosition.isDragPosition=function(candidate){return candidate instanceof DragPosition};DragPosition.calculateFromOffset=function(offset,numItems,itemWidth,itemGap){if(!numItems){return new DragPosition({replace:0})}if(offset<0){return new DragPosition({insert:0})}var sectionWidth=itemWidth+itemGap;var sectionNumber=Math.floor(offset/sectionWidth);if(numItems<=sectionNumber){return new DragPosition({replace:numItems})}var offsetWithinSection=offset-sectionWidth*sectionNumber;if(offsetWithinSection<itemWidth){return new DragPosition({replace:sectionNumber})}else{return new DragPosition({insert:sectionNumber+1})}};DragPosition.fromJS=function(parameters){return new DragPosition(parameters)};DragPosition.prototype.valueOf=function(){return{insert:this.insert,replace:this.replace}};DragPosition.prototype.toJS=function(){var js={};if(this.insert!=null)js.insert=this.insert;if(this.replace!=null)js.replace=this.replace;return js};DragPosition.prototype.toJSON=function(){return this.toJS()};DragPosition.prototype.toString=function(){if(this.insert!=null){return"[insert "+this.insert+"]"}else{return"[replace "+this.replace+"]"}};DragPosition.prototype.equals=function(other){return DragPosition.isDragPosition(other)&&this.insert===other.insert&&this.replace===other.replace};DragPosition.prototype.isInsert=function(){return this.insert!==null};DragPosition.prototype.isReplace=function(){return this.replace!==null};return DragPosition}();exports.DragPosition=DragPosition;check=DragPosition},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var collection_1=__webpack_require__(398);var customization_1=__webpack_require__(401);var data_cube_1=__webpack_require__(188);var settings_version_1=__webpack_require__(400);var im_auth_1=__webpack_require__(76);var beltful_1=__webpack_require__(8);function checkNamedArrayUnique(as){var seen={};for(var _i=0,as_1=as;_i<as_1.length;_i++){var a=as_1[_i];var name_1=a.name;if(seen[name_1])throw new Error("duplicate '"+name_1+"'");seen[name_1]=1}}var AppSettings=function(_super){tslib_1.__extends(AppSettings,_super);function AppSettings(parameters){var _this=_super.call(this,parameters)||this;checkNamedArrayUnique(_this.dataCubes);checkNamedArrayUnique(_this.collections);return _this}AppSettings.isAppSettings=function(candidate){return candidate instanceof AppSettings};AppSettings.fromJS=function(parameters,context){if(context===void 0){context={}}var dataCubes=(parameters.dataCubes||[]).map(function(dataCubeJS){return data_cube_1.DataCube.fromJS(dataCubeJS)});var collectionContext={dataCubes:dataCubes,visualizations:context.visualizations};var value={version:parameters.version?settings_version_1.SettingsVersion.fromJS(parameters.version):null,customization:customization_1.Customization.fromJS(parameters.customization||{}),numClusters:parameters.numClusters,dataCubes:dataCubes,collections:(parameters.collections||[]).map(function(js){return collection_1.Collection.fromJS(js,collectionContext)}),users:(parameters.users||[]).map(function(js){return im_auth_1.User.fromJS(js)})};return new AppSettings(value)};AppSettings.prototype.applyLogoutHref=function(logoutHref){var customization=this.customization;if(customization.logoutHref)return this;return this.changeCustomization(customization.changeLogoutHref(logoutHref))};AppSettings.prototype.getDataCube=function(dataCubeName){return immutable_class_1.NamedArray.findByName(this.dataCubes,dataCubeName)};AppSettings.prototype.appendDataCubes=function(dataCubes){return this.changeDataCubes(immutable_class_1.NamedArray.overridesByName(this.dataCubes,dataCubes))};AppSettings.prototype.addOrUpdateDataCube=function(dataCube){return this.changeDataCubes(immutable_class_1.NamedArray.overrideByName(this.dataCubes,dataCube))};AppSettings.prototype.deleteDataCube=function(dataCubeName){return this.changeDataCubes(immutable_class_1.NamedArray.deleteByName(this.dataCubes,dataCubeName))};AppSettings.prototype.duplicateDataCube=function(dataCube,newOwner){var _this=this;var name=beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!_this.getDataCube(name)}});return dataCube.makeDuplicate(name,newOwner)};AppSettings.prototype.getCollection=function(collectionName){return immutable_class_1.NamedArray.findByName(this.collections,collectionName)};AppSettings.prototype.addOrUpdateCollection=function(collection){return this.changeCollections(immutable_class_1.NamedArray.overrideByName(this.collections,collection))};AppSettings.prototype.deleteCollection=function(collectionName){return this.changeCollections(immutable_class_1.NamedArray.deleteByName(this.collections,collectionName))};AppSettings.prototype.duplicateCollection=function(collection,newOwner){var _this=this;var name=beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!_this.getCollection(name)}});return collection.makeDuplicate(name,newOwner)};AppSettings.prototype.hasUsers=function(){return Boolean(this.users.length)};AppSettings.prototype.constrainToUser=function(user){if(user.isSuperAdmin())return this;var _a=this,dataCubes=_a.dataCubes,collections=_a.collections;return this.changeMany({dataCubes:dataCubes.filter(function(dataCube){return dataCube.getReadAccess().hasAccess(user)}),collections:collections.filter(function(collection){return collection.getReadAccess().hasAccess(user)})})};AppSettings.PROPERTIES=[{name:"version",immutableClass:settings_version_1.SettingsVersion,defaultValue:null},{name:"customization",immutableClass:customization_1.Customization},{name:"numClusters",defaultValue:0},{name:"dataCubes",immutableClassArray:data_cube_1.DataCube,type:immutable_class_1.PropertyType.ARRAY},{name:"collections",immutableClassArray:collection_1.Collection,type:immutable_class_1.PropertyType.ARRAY},{name:"users",immutableClassArray:im_auth_1.User,type:immutable_class_1.PropertyType.ARRAY}];return AppSettings}(immutable_class_1.BaseImmutable);exports.AppSettings=AppSettings;immutable_class_1.BaseImmutable.finalize(AppSettings);AppSettings.BLANK=AppSettings.fromJS({},{visualizations:[]})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var measure_filter_1=__webpack_require__(403);var MeasureFormula=function(_super){tslib_1.__extends(MeasureFormula,_super);function MeasureFormula(params){if(params===void 0){params={}}return _super.call(this,params)||this}MeasureFormula.fromJS=function(params){return new MeasureFormula(immutable_class_1.BaseImmutable.jsToValue(MeasureFormula.PROPERTIES,params))};MeasureFormula.fromFormula=function(formula){return MeasureFormula.fromExpression(plywood_1.Expression.parse(formula))};MeasureFormula.fromExpression=function(ex){if(ex instanceof plywood_1.CountExpression){if(!MeasureFormula.isMainDataReference(ex.operand))return null;var simpleFormula=MeasureFormula.fromJS({aggregation:"count",column:null,filter:measure_filter_1.MeasureFilter.fromExpression(ex.operand.expression)});if(simpleFormula.hasSimpleFilter())return simpleFormula}if(ex instanceof plywood_1.SumExpression||ex instanceof plywood_1.MinExpression||ex instanceof plywood_1.MaxExpression||ex instanceof plywood_1.AverageExpression||ex instanceof plywood_1.CountDistinctExpression||ex instanceof plywood_1.QuantileExpression){if(!MeasureFormula.isMainDataReference(ex.operand))return null;if(ex.tuning)return null;var innerRef=ex.expression;if(!(innerRef instanceof plywood_1.RefExpression))return null;var aggregation=void 0;if(ex instanceof plywood_1.QuantileExpression){if(ex.value===.5){aggregation="median"}else if(ex.value===.98){aggregation="98th"}else{return null}}else{aggregation=ex.op}var simpleFormula=MeasureFormula.fromJS({aggregation:aggregation,column:innerRef.name,filter:measure_filter_1.MeasureFilter.fromExpression(ex.operand.expression)});if(simpleFormula.hasSimpleFilter())return simpleFormula}return null};MeasureFormula.isMainDataReference=function(ex){var $main=plywood_1.$("main");return ex.equals($main)||ex instanceof plywood_1.FilterExpression&&ex.operand.equals($main)};MeasureFormula.prototype.toFormula=function(){return this.toExpression().toString()};MeasureFormula.prototype.toExpression=function(){var ex=plywood_1.$("main");if(this.filter){ex=ex.filter(this.filter.toString())}var op=this.aggregation;var value=null;if(op==="median"||op==="98th"){value=op==="median"?.5:.98;op="quantile"}var action=plywood_1.Expression.fromJS({op:op,expression:this.column?plywood_1.$(this.column):null,value:value});return ex.performAction(action)};MeasureFormula.prototype.canHaveColumn=function(){return this.aggregation!=="count"};MeasureFormula.prototype.changeAggregation=function(aggregation){var value=this.valueOf();value.aggregation=aggregation;if(value.aggregation!=="count"&&!value.column){value.column=this.possibleColumns[0]}return new MeasureFormula(value)};MeasureFormula.prototype.hasSimpleFilter=function(){if(!this.filter)return true;return this.filter.isSimpleFilter()};MeasureFormula.prototype.removeFilter=function(){var value=this.valueOf();value.filter=null;return new MeasureFormula(value)};MeasureFormula.prototype.createDefaultFilter=function(column){var filter=measure_filter_1.MeasureFilter.fromJS({column:column,operator:measure_filter_1.MeasureFilter.OPERATORS[0].value,value:""});return this.changeFilter(filter)};MeasureFormula.AGGREGATIONS=[{label:"Count",value:"count"},{label:"Sum",value:"sum"},{label:"Average",value:"average"},{label:"Min",value:"min"},{label:"Max",value:"max"},{label:"Unique values",value:"countDistinct"},{label:"Median",value:"median"},{label:"98th percentile",value:"98th"}];MeasureFormula.DEFAULT_AGGREGATION=MeasureFormula.AGGREGATIONS[1].value;MeasureFormula.PROPERTIES=[{name:"aggregation",defaultValue:"count"},{name:"column",defaultValue:null},{name:"possibleColumns",defaultValue:[]},{name:"filter",immutableClass:measure_filter_1.MeasureFilter,defaultValue:null}];return MeasureFormula}(immutable_class_1.BaseImmutable);exports.MeasureFormula=MeasureFormula;immutable_class_1.BaseImmutable.finalize(MeasureFormula)},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[module,__webpack_require__(486),__webpack_require__(488),__webpack_require__(489)],__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!=="undefined"){factory(module,require("./clipboard-action"),require("tiny-emitter"),require("good-listener"))}else{var mod={exports:{}};factory(mod,global.clipboardAction,global.tinyEmitter,global.goodListener);global.clipboard=mod.exports}})(this,function(module,_clipboardAction,_tinyEmitter,_goodListener){"use strict";var _clipboardAction2=_interopRequireDefault(_clipboardAction);var _tinyEmitter2=_interopRequireDefault(_tinyEmitter);var _goodListener2=_interopRequireDefault(_goodListener);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Clipboard=function(_Emitter){_inherits(Clipboard,_Emitter);function Clipboard(trigger,options){_classCallCheck(this,Clipboard);var _this=_possibleConstructorReturn(this,(Clipboard.__proto__||Object.getPrototypeOf(Clipboard)).call(this));_this.resolveOptions(options);_this.listenClick(trigger);return _this}_createClass(Clipboard,[{key:"resolveOptions",value:function resolveOptions(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=typeof options.action==="function"?options.action:this.defaultAction;this.target=typeof options.target==="function"?options.target:this.defaultTarget;this.text=typeof options.text==="function"?options.text:this.defaultText;this.container=_typeof(options.container)==="object"?options.container:document.body}},{key:"listenClick",value:function listenClick(trigger){var _this2=this;this.listener=(0,_goodListener2.default)(trigger,"click",function(e){return _this2.onClick(e)})}},{key:"onClick",value:function onClick(e){var trigger=e.delegateTarget||e.currentTarget;if(this.clipboardAction){this.clipboardAction=null}this.clipboardAction=new _clipboardAction2.default({action:this.action(trigger),target:this.target(trigger),text:this.text(trigger),container:this.container,trigger:trigger,emitter:this})}},{key:"defaultAction",value:function defaultAction(trigger){return getAttributeValue("action",trigger)}},{key:"defaultTarget",value:function defaultTarget(trigger){var selector=getAttributeValue("target",trigger);if(selector){return document.querySelector(selector)}}},{key:"defaultText",value:function defaultText(trigger){return getAttributeValue("text",trigger)}},{key:"destroy",value:function destroy(){this.listener.destroy();if(this.clipboardAction){this.clipboardAction.destroy();this.clipboardAction=null}}}],[{key:"isSupported",value:function isSupported(){var action=arguments.length>0&&arguments[0]!==undefined?arguments[0]:["copy","cut"];var actions=typeof action==="string"?[action]:action;var support=!!document.queryCommandSupported;actions.forEach(function(action){support=support&&!!document.queryCommandSupported(action)});return support}}]);return Clipboard}(_tinyEmitter2.default);function getAttributeValue(suffix,element){var attribute="data-clipboard-"+suffix;if(!element.hasAttribute(attribute)){return}return element.getAttribute(attribute)}module.exports=Clipboard})},function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(global,factory){if(true){!(__WEBPACK_AMD_DEFINE_ARRAY__=[module,__webpack_require__(487)],__WEBPACK_AMD_DEFINE_FACTORY__=factory,__WEBPACK_AMD_DEFINE_RESULT__=typeof __WEBPACK_AMD_DEFINE_FACTORY__==="function"?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}else if(typeof exports!=="undefined"){factory(module,require("select"))}else{var mod={exports:{}};factory(mod,global.select);global.clipboardAction=mod.exports}})(this,function(module,_select){"use strict";var _select2=_interopRequireDefault(_select);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var ClipboardAction=function(){function ClipboardAction(options){_classCallCheck(this,ClipboardAction);this.resolveOptions(options);this.initSelection()}_createClass(ClipboardAction,[{key:"resolveOptions",value:function resolveOptions(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};this.action=options.action;this.container=options.container;this.emitter=options.emitter;this.target=options.target;this.text=options.text;this.trigger=options.trigger;this.selectedText=""}},{key:"initSelection",value:function initSelection(){if(this.text){this.selectFake()}else if(this.target){this.selectTarget()}}},{key:"selectFake",value:function selectFake(){var _this=this;var isRTL=document.documentElement.getAttribute("dir")=="rtl";this.removeFake();this.fakeHandlerCallback=function(){return _this.removeFake()};this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||true;this.fakeElem=document.createElement("textarea");this.fakeElem.style.fontSize="12pt";this.fakeElem.style.border="0";this.fakeElem.style.padding="0";this.fakeElem.style.margin="0";this.fakeElem.style.position="absolute";this.fakeElem.style[isRTL?"right":"left"]="-9999px";var yPosition=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=yPosition+"px";this.fakeElem.setAttribute("readonly","");this.fakeElem.value=this.text;this.container.appendChild(this.fakeElem);this.selectedText=(0,_select2.default)(this.fakeElem);this.copyText()}},{key:"removeFake",value:function removeFake(){if(this.fakeHandler){this.container.removeEventListener("click",this.fakeHandlerCallback);this.fakeHandler=null;this.fakeHandlerCallback=null}if(this.fakeElem){this.container.removeChild(this.fakeElem);this.fakeElem=null}}},{key:"selectTarget",value:function selectTarget(){this.selectedText=(0,_select2.default)(this.target);this.copyText()}},{key:"copyText",value:function copyText(){var succeeded=void 0;try{succeeded=document.execCommand(this.action)}catch(err){succeeded=false}this.handleResult(succeeded)}},{key:"handleResult",value:function handleResult(succeeded){this.emitter.emit(succeeded?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function clearSelection(){if(this.trigger){this.trigger.focus()}window.getSelection().removeAllRanges()}},{key:"destroy",value:function destroy(){this.removeFake()}},{key:"action",set:function set(){var action=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"copy";this._action=action;if(this._action!=="copy"&&this._action!=="cut"){throw new Error('Invalid "action" value, use either "copy" or "cut"')}},get:function get(){return this._action}},{key:"target",set:function set(target){if(target!==undefined){if(target&&(typeof target==="undefined"?"undefined":_typeof(target))==="object"&&target.nodeType===1){if(this.action==="copy"&&target.hasAttribute("disabled")){throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute')}if(this.action==="cut"&&(target.hasAttribute("readonly")||target.hasAttribute("disabled"))){throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}this._target=target}else{throw new Error('Invalid "target" value, use a valid Element')}}},get:function get(){return this._target}}]);return ClipboardAction}();module.exports=ClipboardAction})},function(module,exports){function select(element){var selectedText;if(element.nodeName==="SELECT"){element.focus();selectedText=element.value}else if(element.nodeName==="INPUT"||element.nodeName==="TEXTAREA"){var isReadOnly=element.hasAttribute("readonly");if(!isReadOnly){element.setAttribute("readonly","")}element.select();element.setSelectionRange(0,element.value.length);if(!isReadOnly){element.removeAttribute("readonly")}selectedText=element.value}else{if(element.hasAttribute("contenteditable")){element.focus()}var selection=window.getSelection();var range=document.createRange();range.selectNodeContents(element);selection.removeAllRanges();selection.addRange(range);selectedText=selection.toString()}return selectedText}module.exports=select},function(module,exports){function E(){}E.prototype={on:function(name,callback,ctx){var e=this.e||(this.e={});(e[name]||(e[name]=[])).push({fn:callback,ctx:ctx});return this},once:function(name,callback,ctx){var self=this;function listener(){self.off(name,listener);callback.apply(ctx,arguments)}listener._=callback;return this.on(name,listener,ctx)},emit:function(name){var data=[].slice.call(arguments,1);var evtArr=((this.e||(this.e={}))[name]||[]).slice();var i=0;var len=evtArr.length;for(i;i<len;i++){evtArr[i].fn.apply(evtArr[i].ctx,data)}return this},off:function(name,callback){var e=this.e||(this.e={});var evts=e[name];var liveEvents=[];if(evts&&callback){for(var i=0,len=evts.length;i<len;i++){if(evts[i].fn!==callback&&evts[i].fn._!==callback)liveEvents.push(evts[i])}}liveEvents.length?e[name]=liveEvents:delete e[name];return this}};module.exports=E},function(module,exports,__webpack_require__){var is=__webpack_require__(490);var delegate=__webpack_require__(491);function listen(target,type,callback){if(!target&&!type&&!callback){throw new Error("Missing required arguments")}if(!is.string(type)){throw new TypeError("Second argument must be a String")}if(!is.fn(callback)){throw new TypeError("Third argument must be a Function")}if(is.node(target)){return listenNode(target,type,callback)}else if(is.nodeList(target)){return listenNodeList(target,type,callback)}else if(is.string(target)){return listenSelector(target,type,callback)}else{throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}}function listenNode(node,type,callback){node.addEventListener(type,callback);return{destroy:function(){node.removeEventListener(type,callback)}}}function listenNodeList(nodeList,type,callback){Array.prototype.forEach.call(nodeList,function(node){node.addEventListener(type,callback)});return{destroy:function(){Array.prototype.forEach.call(nodeList,function(node){node.removeEventListener(type,callback)})}}}function listenSelector(selector,type,callback){return delegate(document.body,selector,type,callback)}module.exports=listen},function(module,exports){exports.node=function(value){return value!==undefined&&value instanceof HTMLElement&&value.nodeType===1};exports.nodeList=function(value){var type=Object.prototype.toString.call(value);return value!==undefined&&(type==="[object NodeList]"||type==="[object HTMLCollection]")&&"length"in value&&(value.length===0||exports.node(value[0]))};exports.string=function(value){return typeof value==="string"||value instanceof String};exports.fn=function(value){var type=Object.prototype.toString.call(value);return type==="[object Function]"}},function(module,exports,__webpack_require__){var closest=__webpack_require__(492);function delegate(element,selector,type,callback,useCapture){var listenerFn=listener.apply(this,arguments);element.addEventListener(type,listenerFn,useCapture);return{destroy:function(){element.removeEventListener(type,listenerFn,useCapture)}}}function listener(element,selector,type,callback){return function(e){e.delegateTarget=closest(e.target,selector);if(e.delegateTarget){callback.call(element,e)}}}module.exports=delegate},function(module,exports){var DOCUMENT_NODE_TYPE=9;if(typeof Element!=="undefined"&&!Element.prototype.matches){var proto=Element.prototype;proto.matches=proto.matchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector||proto.webkitMatchesSelector}function closest(element,selector){while(element&&element.nodeType!==DOCUMENT_NODE_TYPE){if(typeof element.matches==="function"&&element.matches(selector)){return element}element=element.parentNode}}module.exports=closest},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var strings_1=__webpack_require__(17);__webpack_require__(494);var AboutModal=function(_super){tslib_1.__extends(AboutModal,_super);function AboutModal(){return _super.call(this)||this}AboutModal.prototype.render=function(){var _a=this.props,version=_a.version,onClose=_a.onClose;return React.createElement(caladan_1.Modal,{className:"about-modal",title:"About Pivot",onClose:onClose},React.createElement("div",{className:"p-group"},React.createElement("p",null,React.createElement("a",{href:"http://pivot.imply.io",target:"_blank"},"Pivot")," (version ",version,") is built and maintained with great care by ",React.createElement("a",{href:"https://imply.io/",target:"_blank"},"imply.io"),"."),React.createElement("p",null,"For feedback and support please visit the ",React.createElement("a",{href:"https://groups.google.com/forum/#!forum/imply-user-group",target:"_blank"},"Imply User Group"),".")),React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{type:"primary",onClick:onClose,title:strings_1.STRINGS.close})))};return AboutModal}(React.Component);exports.AboutModal=AboutModal},function(module,exports,__webpack_require__){var content=__webpack_require__(495);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./about-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./about-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".about-modal p{margin-bottom:14px;line-height:20px}.about-modal p:last-child{margin-bottom:0}.about-modal a{color:#1ea3e6;cursor:pointer}.about-modal a:hover{text-decoration:underline}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(497);var React=__webpack_require__(1);var caladan_1=__webpack_require__(10);var beltful_1=__webpack_require__(8);var immutable_class_1=__webpack_require__(7);var Icons=__webpack_require__(11);var strings_1=__webpack_require__(17);var models_1=__webpack_require__(19);var AppDrawer=function(_super){tslib_1.__extends(AppDrawer,_super);function AppDrawer(){var _this=_super.call(this)||this;_this.state={cropThresholds:{collections:5,dataCubes:5,favorites:5}};return _this}AppDrawer.prototype.componentWillReceiveProps=function(nextProps){var isOpen=nextProps.isOpen;if(isOpen)this.setState({searchText:""})};AppDrawer.prototype.isSelectedItem=function(item){var breadCrumbs=this.props.breadCrumbs;return breadCrumbs&&breadCrumbs[1]===item.name};AppDrawer.prototype.isHome=function(){var breadCrumbs=this.props.breadCrumbs;return!breadCrumbs||!breadCrumbs.length||breadCrumbs[0]==="home"};AppDrawer.prototype.isLinkView=function(){var breadCrumbs=this.props.breadCrumbs;return breadCrumbs&&breadCrumbs[0]==="link"};AppDrawer.prototype.renderSideDrawerSearch=function(){var _this=this;var searchText=this.state.searchText;return React.createElement("div",{className:"search-box grid-row"},React.createElement("div",{className:"grid-col-fit-content"},React.createElement("div",{className:"search-icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_SEARCH}))),React.createElement(caladan_1.ClearableInput,{className:"grid-col-auto-expand",placeholder:"Search",focusOnMount:true,value:searchText,onChange:function(searchText){return _this.setState({searchText:searchText})}}))};AppDrawer.prototype.showAllUnder=function(key){var cropThresholds=this.state.cropThresholds;cropThresholds[key]=Number.POSITIVE_INFINITY;this.setState({cropThresholds:cropThresholds})};AppDrawer.prototype.itemize=function(category){var _this=this;var _a=this.props,mount=_a.mount,needsGateKeeping=_a.needsGateKeeping,customization=_a.customization,useHrefs=_a.useHrefs,open=_a.open;var cropThresholds=this.state.cropThresholds;return function(item,index,array){var threshold=cropThresholds[category];if(array.length>threshold){if(index>threshold)return null;if(index===threshold){return React.createElement("div",{className:"side-drawer-item more",onClick:function(){return _this.showAllUnder(category)}},React.createElement("span",{className:"badge"},array.length-threshold),"More")}}var hash=mount([models_1.Collection.isCollection(item)?"c":"d",item.name,beltful_1.StringUtils.makeUrlSafeTitle(item.title)]);var sideDrawerItem={svgIcon:models_1.DataCube.isDataCube(item)?Icons.FULL_CUBE:Icons.DASHBOARD,label:item.title,color:customization.getPreferredTheme(item.theme).mainColor,selected:_this.isSelectedItem(item),needsGateKeeping:needsGateKeeping};if(useHrefs){sideDrawerItem.href=hash}else{sideDrawerItem.hash=hash;sideDrawerItem.onClick=function(){return open(item)}}return sideDrawerItem}};AppDrawer.prototype.isItemVisible=function(item){var searchText=this.state.searchText;return!searchText||item.title.toLowerCase().includes(searchText.toLowerCase())};AppDrawer.prototype.itemizeDataCubes=function(){var _this=this;var dataCubes=this.props.dataCubes;var searchText=this.state.searchText;if(!dataCubes)return[];var filteredCubes=dataCubes.filter(function(d){return _this.isItemVisible(d)});return[filteredCubes.length?React.createElement("div",{className:"section-title"},strings_1.STRINGS.dataCubes):null].concat(filteredCubes.map(this.itemize("dataCubes")))};AppDrawer.prototype.itemizeCollections=function(){var _this=this;var collections=this.props.collections;var searchText=this.state.searchText;if(!collections)return[];var filteredCollections=collections.filter(function(d){return _this.isItemVisible(d)});return[filteredCollections.length?React.createElement("div",{className:"section-title"},strings_1.STRINGS.dashboards):null].concat(filteredCollections.map(this.itemize("collections")))};AppDrawer.prototype.itemizeFavorites=function(){var _this=this;var _a=this.props,collections=_a.collections,favorites=_a.favorites,dataCubes=_a.dataCubes;var searchText=this.state.searchText;var all=collections.concat(dataCubes);var items=(this.props.favorites||[]).map(function(f){return immutable_class_1.NamedArray.findByName(all,f)}).filter(Boolean).filter(function(item){return _this.isItemVisible(item)});return[items.length?React.createElement("div",{className:"section-title"},strings_1.STRINGS.favorites):null].concat(items.map(this.itemize("favorites")))};AppDrawer.prototype.getHomeItem=function(){var _a=this.props,useHrefs=_a.useHrefs,mount=_a.mount,goHome=_a.goHome,needsGateKeeping=_a.needsGateKeeping;var searchText=this.state.searchText;var label=this.isLinkView()?"Overview":"Home";if(searchText&&!label.toLowerCase().includes(searchText.toLowerCase()))return null;var item={svgIcon:Icons.HOME,label:label,selected:this.isHome(),needsGateKeeping:needsGateKeeping};if(useHrefs){item.href=mount(["home"])}else{item.hash=mount(["home"]);item.onClick=goHome}return item};AppDrawer.prototype.renderImplyPlatform=function(){var _a=this.props,launcherHref=_a.launcherHref,settingsHref=_a.settingsHref;if(!launcherHref&&!settingsHref)return null;return React.createElement("div",{className:"section"},React.createElement("div",{className:"section-title"},strings_1.STRINGS.implyPlatform),launcherHref?React.createElement("a",{className:"side-drawer-item",href:launcherHref},React.createElement("span",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.LAUNCHER})),"Imply home"):null,settingsHref?React.createElement("a",{className:"side-drawer-item",href:settingsHref},React.createElement("span",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_SETTINGS})),"Settings"):null)};AppDrawer.prototype.render=function(){var _a=this.props,customization=_a.customization,onClose=_a.onClose,isOpen=_a.isOpen,settingsSelected=_a.settingsSelected,needsGateKeeping=_a.needsGateKeeping,settingsVisible=_a.settingsVisible,showAboutModal=_a.showAboutModal,launcherHref=_a.launcherHref,mount=_a.mount;var searchText=this.state.searchText;var searchableItems=[this.getHomeItem()].concat(this.itemizeFavorites(),this.itemizeDataCubes(),this.itemizeCollections()).filter(Boolean);if(searchableItems.length===0){searchableItems=[React.createElement("div",{className:"placeholder no-search-results"},'Nothing matches "',searchText,'"')]}var items=[this.renderSideDrawerSearch()].concat(searchableItems,[caladan_1.SideDrawer.separator()]);if(launcherHref){items.push(this.renderImplyPlatform())}else{if(settingsVisible){items.push({label:strings_1.STRINGS.settings,href:mount(["settings"]),needsGateKeeping:needsGateKeeping,selected:settingsSelected})}}return React.createElement(caladan_1.SideDrawer,{className:"app-drawer",open:isOpen,items:items.filter(Boolean),onClose:onClose,navLogo:customization&&customization.menuLogoSvg?customization.menuLogoSvg:Icons.IMPLY_PIVOT_LOGO,onSelfClick:function(item){return window.open(item.hash,"_self")}})};return AppDrawer}(React.Component);exports.AppDrawer=AppDrawer},function(module,exports,__webpack_require__){var content=__webpack_require__(498);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./app-drawer.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./app-drawer.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".app-drawer .nav-logo .logo{height:38px;top:16px}.app-drawer .section-title{padding-left:19px;margin-top:5px;line-height:38px;color:#bababa;font-size:13px;font-weight:600}.app-drawer .no-search-results{text-align:center;margin:20px;font-style:italic}.app-drawer .search-box{border:1px solid #e6e6e6;margin:10px 17px}.app-drawer .search-box .search-icon{width:28px;height:20px;padding-top:1px;padding-left:12px;background-color:white}.app-drawer .search-box .search-icon .svg-icon{width:20px;fill:#a6a6a6}.app-drawer .search-box .clearable-input{background-color:white;padding:10px}.app-drawer .search-box .clearable-input .clear{top:11px}.app-drawer .more .badge{background-color:#1ea3e6;display:inline-block;text-align:center;line-height:18px;min-width:18px;color:white;padding:0 5px;border-radius:10px;margin-left:1px;margin-right:9px;margin-top:10px;font-size:11px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(500);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./fancy-drag-indicator.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./fancy-drag-indicator.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".fancy-drag-indicator{pointer-events:none}.fancy-drag-indicator .drag-ghost-element{position:absolute;top:4px;bottom:4px;width:200px;background:rgba(102,102,102,0.14);border-radius:4px}.fancy-drag-indicator .drag-ghost-arrow{position:absolute;top:-12px;width:16px;margin-left:-8px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(502);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./filter-options-dropdown.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./filter-options-dropdown.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".filter-options-dropdown .selected-item{padding:8px 16px 0 4px}.filter-options-dropdown .selected-item .icon{padding:0;bottom:4px}.filter-options-dropdown .selected-item .caret-icon{right:6px}.filter-options-dropdown .dropdown-menu{width:180px}.filter-options-dropdown .dropdown-menu .filter-option{display:block}.filter-options-dropdown .dropdown-menu .filter-option .option-label{display:inline-block;padding:2px 10px}.filter-options-dropdown svg.icon{display:inline-block;padding:5px 0;cursor:pointer;width:19px;fill:#888}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(504);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./query-error.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./query-error.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".query-error{text-align:center}.query-error .whiteout{position:absolute;top:0;bottom:0;left:0;right:0;background:#fff;opacity:0.5}.query-error .error-container{position:absolute;top:50%;left:50%;width:180px;height:50px;margin-left:-90px;margin-top:-25px;color:red;text-align:left}.query-error .error-container .error{font-size:14px}.query-error .error-container .message{margin-top:5px;font-size:13px;overflow:hidden}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(506);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./range-handle.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./range-handle.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".range-handle{width:16px;height:16px;background:#1ea3e6;border-radius:50%;border:2px solid #1ea3e6;z-index:2}.range-handle.empty{background:#fff}.range-handle.beyond::before{border-style:solid;border-color:#ededed;border-width:2.5px 2.5px 0 0;content:'';display:inline-block;height:4px;position:relative;top:2.5px;vertical-align:top;width:4px}.range-handle.beyond.min::before{top:3px;left:4px;-webkit-transform:rotate(-135deg);-ms-transform:rotate(-135deg);transform:rotate(-135deg)}.range-handle.beyond.max::before{left:2px;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg)}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(508);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./number-range-picker.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./number-range-picker.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".number-range-picker{margin:10px 0;height:25px}.number-range-picker .range-bar{position:absolute;top:6px;height:6px}.number-range-picker .range-bar.full{background-color:#dedede;left:8px;right:8px}.number-range-picker .range-bar.selected{background-color:#1ea3e6}.number-range-picker.inverted .range-bar.full{background-color:#1ea3e6}.number-range-picker.inverted .range-bar.selected{background-color:#dedede}.number-range-picker .range-handle{position:absolute}.number-range-picker .loader,.number-range-picker .query-error{position:absolute;top:0;bottom:0;left:0;right:0}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(510);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./number-filter-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./number-filter-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".number-filter-menu .side-by-side{display:-webkit-box;display:-ms-flexbox;display:flex}.number-filter-menu .side-by-side>*{margin-right:5px}.number-filter-menu .side-by-side>*:last-child{margin-right:0}.number-filter-menu .input-top-label{text-transform:uppercase;font-size:12px;color:#a6a6a6;margin-bottom:5px}.number-filter-menu input{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px}.number-filter-menu input:hover{border-color:#b8b8b8}.number-filter-menu input:focus{border-color:#1ea3e6}.number-filter-menu input.error{border-color:#e24c4c}.number-filter-menu input.disabled{pointer-events:none;background:#f2f2f2}.number-filter-menu .group{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.number-filter-menu input.gray{color:#ccc}.number-filter-menu input,.number-filter-menu .filter-options-dropdown{margin-top:6px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var general_1=__webpack_require__(43);var constants_1=__webpack_require__(52);var query_runner_1=__webpack_require__(73);var highlight_string_1=__webpack_require__(105);var loader_1=__webpack_require__(106);var query_error_1=__webpack_require__(111);__webpack_require__(514);var TOP_N=100;function getRegexError(text){try{new RegExp(text);return null}catch(e){return e.message}}var PreviewStringFilterMenu=function(_super){tslib_1.__extends(PreviewStringFilterMenu,_super);function PreviewStringFilterMenu(){var _this=_super.call(this)||this;_this.state={loading:false,dataset:null,queryError:null,fetchQueued:false,regexErrorMessage:null};_this.collectTriggerSearch=general_1.collect(constants_1.SEARCH_WAIT,function(){if(!_this.mounted)return;var _a=_this.props,essence=_a.essence,deltaSourceFilter=_a.deltaSourceFilter,timekeeper=_a.timekeeper,dimension=_a.dimension,filterMode=_a.filterMode,searchText=_a.searchText;var regexErrorMessage=_this.state.regexErrorMessage;if(regexErrorMessage)return;_this.fetchData(essence,deltaSourceFilter,timekeeper,dimension,filterMode,searchText)});return _this}PreviewStringFilterMenu.prototype.fetchData=function(essence,deltaSourceFilter,timekeeper,dimension,filterMode,searchText){var _this=this;if(deltaSourceFilter){essence=essence.changeFilter(deltaSourceFilter.applyDelta(essence.getEffectiveFilter()))}var dimensions=essence.getDimensions();var filter=essence.getSpecificFilterWithHighlight(timekeeper,dimension);if(searchText){if(filterMode===models_1.Filter.CONTAINS){filter=filter.setSearch(dimension.name,"contains",searchText)}else if(filterMode===models_1.Filter.REGEX){filter=filter.setSearch(dimension.name,"match",searchText)}}var query=plywood_1.$("main").filter(filter.toExpression(dimensions)).split(dimension.expression,dimension.name).apply("MEASURE",essence.getCountExpression()).sort(plywood_1.$("MEASURE"),plywood_1.SortExpression.DESCENDING).limit(TOP_N+1);this.setState({loading:true,fetchQueued:false});query_runner_1.QueryRunner.fetch("preview-string-filter-menu",essence.dataCube,essence.instance,query,essence.timezone).then(function(dataset){if(!_this.mounted)return;_this.setState({loading:false,dataset:dataset,queryError:null})},function(error){if(error.canceled)return;if(!_this.mounted)return;_this.setState({loading:false,dataset:null,queryError:error})})};PreviewStringFilterMenu.prototype.componentWillMount=function(){var _a=this.props,essence=_a.essence,deltaSourceFilter=_a.deltaSourceFilter,timekeeper=_a.timekeeper,dimension=_a.dimension,searchText=_a.searchText,filterMode=_a.filterMode;if(searchText&&filterMode===models_1.Filter.REGEX){var regexErrorMessage=getRegexError(searchText);if(regexErrorMessage){this.setState({regexErrorMessage:regexErrorMessage});return}}this.fetchData(essence,deltaSourceFilter,timekeeper,dimension,filterMode,searchText)};PreviewStringFilterMenu.prototype.componentDidMount=function(){this.mounted=true};PreviewStringFilterMenu.prototype.componentWillUnmount=function(){this.mounted=false};PreviewStringFilterMenu.prototype.componentWillReceiveProps=function(nextProps){var _a=this.props,searchText=_a.searchText,filterMode=_a.filterMode;var incomingSearchText=nextProps.searchText;var _b=this.state,fetchQueued=_b.fetchQueued,loading=_b.loading,dataset=_b.dataset;var regexErrorMessage=incomingSearchText&&filterMode===models_1.Filter.REGEX?getRegexError(incomingSearchText):null;if(regexErrorMessage){this.setState({regexErrorMessage:regexErrorMessage});return}if(incomingSearchText&&incomingSearchText.includes(searchText)&&filterMode===models_1.Filter.CONTAINS&&!fetchQueued&&!loading&&dataset&&dataset.data.length<TOP_N)return;this.setState({fetchQueued:true,regexErrorMessage:null});this.collectTriggerSearch()};PreviewStringFilterMenu.prototype.constructFilter=function(){var _a=this.props,dimension=_a.dimension,filterMode=_a.filterMode,onClauseChange=_a.onClauseChange,searchText=_a.searchText;var name=dimension.name;var clause=null;if(searchText){if(filterMode===models_1.Filter.REGEX){clause=new models_1.FilterClause({dimension:name,action:"match",search:searchText})}else if(filterMode===models_1.Filter.CONTAINS){clause=new models_1.FilterClause({dimension:name,action:"contains",search:searchText})}}return onClauseChange(clause)};PreviewStringFilterMenu.prototype.onOkClick=function(){if(!this.actionEnabled())return;var _a=this.props,clicker=_a.clicker,onClose=_a.onClose;clicker.changeFilter(this.constructFilter());onClose()};PreviewStringFilterMenu.prototype.onCancelClick=function(){var onClose=this.props.onClose;onClose()};PreviewStringFilterMenu.prototype.actionEnabled=function(){var regexErrorMessage=this.state.regexErrorMessage;var essence=this.props.essence;if(regexErrorMessage)return false;return!essence.getEffectiveFilter().equals(this.constructFilter())};PreviewStringFilterMenu.prototype.renderRows=function(){var _a=this.state,loading=_a.loading,dataset=_a.dataset,fetchQueued=_a.fetchQueued,regexErrorMessage=_a.regexErrorMessage;var _b=this.props,dimension=_b.dimension,searchText=_b.searchText,filterMode=_b.filterMode;var rows=[];var search=null;if(dataset){var rowStrings=dataset.data.slice(0,TOP_N).map(function(d){return d[dimension.name]});if(searchText){rowStrings=rowStrings.filter(function(d){if(filterMode===models_1.Filter.REGEX){try{var escaped=searchText.replace(/\\[^\\]]/g,"\\\\");search=new RegExp(escaped);return search.test(String(d))}catch(e){return false}}else if(filterMode===models_1.Filter.CONTAINS){search=searchText;return String(d).toLowerCase().includes(searchText.toLowerCase())}return false})}rows=rowStrings.map(function(segmentValue){var segmentValueStr=String(segmentValue);return React.createElement("div",{className:"row no-select",key:segmentValueStr,title:segmentValueStr},React.createElement("div",{className:"row-wrapper"},React.createElement(highlight_string_1.HighlightString,{className:"label",text:segmentValueStr,highlight:search})))})}var grayMessage=null;if(regexErrorMessage){grayMessage=React.createElement("div",{className:"message"},regexErrorMessage)}else if(!loading&&dataset&&!fetchQueued&&!rows.length){var text=searchText?'No results for "'+searchText+'"':"No results";grayMessage=React.createElement("div",{className:"message"},text)}return React.createElement("div",{className:"rows"},rows.length===0||!searchText?null:React.createElement("div",{className:"matching-values-message"},"Matching Values"),rows,grayMessage)};PreviewStringFilterMenu.prototype.render=function(){var filterMode=this.props.filterMode;var _a=this.state,dataset=_a.dataset,loading=_a.loading,queryError=_a.queryError;var hasMore=dataset&&dataset.data.length>TOP_N;return React.createElement("div",{className:classNames("string-filter-menu",filterMode)},React.createElement(caladan_1.GlobalEventListener,{enter:this.onOkClick.bind(this)}),React.createElement("div",{className:classNames("menu-table",hasMore?"has-more":"no-more")},this.renderRows(),queryError?React.createElement(query_error_1.QueryError,{error:queryError}):null,loading?React.createElement(loader_1.Loader,null):null),React.createElement("div",{className:"ok-cancel-bar"},React.createElement(caladan_1.Button,{type:"secondary",title:strings_1.STRINGS.cancel,onClick:this.onCancelClick.bind(this)}),React.createElement(caladan_1.Button,{type:"primary",title:strings_1.STRINGS.ok,onClick:this.onOkClick.bind(this),disabled:!this.actionEnabled()})))};return PreviewStringFilterMenu}(React.Component);exports.PreviewStringFilterMenu=PreviewStringFilterMenu},function(module,exports,__webpack_require__){var content=__webpack_require__(513);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./highlight-string.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./highlight-string.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".highlight-string .bold{border-bottom:1px solid #000}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(515);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./preview-string-filter-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./preview-string-filter-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".string-filter-menu .row.no-select{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.string-filter-menu .matching-values-message{padding:4px 10px;color:#999}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var general_1=__webpack_require__(43);var constants_1=__webpack_require__(52);var query_runner_1=__webpack_require__(73);var highlight_string_1=__webpack_require__(105);var loader_1=__webpack_require__(106);var query_error_1=__webpack_require__(111);__webpack_require__(517);var TOP_N=100;var SelectableStringFilterMenu=function(_super){tslib_1.__extends(SelectableStringFilterMenu,_super);function SelectableStringFilterMenu(){var _this=_super.call(this)||this;_this.state={loading:false,dataset:null,error:null,fetchQueued:false,selectedValues:null,promotedValues:null};_this.collectTriggerSearch=general_1.collect(constants_1.SEARCH_WAIT,function(){if(!_this.mounted)return;var _a=_this.props,essence=_a.essence,deltaSourceFilter=_a.deltaSourceFilter,timekeeper=_a.timekeeper,dimension=_a.dimension,searchText=_a.searchText;_this.fetchData(essence,deltaSourceFilter,timekeeper,dimension,searchText)});return _this}SelectableStringFilterMenu.prototype.fetchData=function(essence,deltaSourceFilter,timekeeper,dimension,searchText){var _this=this;if(deltaSourceFilter){essence=essence.changeFilter(deltaSourceFilter.applyDelta(essence.getEffectiveFilter()))}var dimensions=essence.getDimensions();var filter=essence.getSpecificFilterWithHighlight(timekeeper,dimension);if(searchText){filter=filter.setSearch(dimension.name,"contains",searchText)}var query=plywood_1.$("main").filter(filter.toExpression(dimensions)).split(dimension.expression,dimension.name).apply("MEASURE",essence.getCountExpression()).sort(plywood_1.$("MEASURE"),plywood_1.SortExpression.DESCENDING).limit(TOP_N+1);this.setState({loading:true,fetchQueued:false});query_runner_1.QueryRunner.fetch("selectable-string-filter-menu",essence.dataCube,essence.instance,query,essence.timezone).then(function(dataset){if(!_this.mounted)return;_this.setState({loading:false,dataset:dataset,error:null})},function(error){if(error.canceled)return;if(!_this.mounted)return;_this.setState({loading:false,dataset:null,error:error})})};SelectableStringFilterMenu.prototype.componentWillMount=function(){var _a=this.props,essence=_a.essence,deltaSourceFilter=_a.deltaSourceFilter,timekeeper=_a.timekeeper,dimension=_a.dimension,searchText=_a.searchText;var filter=essence.getEffectiveFilter();var selectedValues=filter.getLiteralSet(dimension.name)||plywood_1.Set.EMPTY;this.setState({selectedValues:selectedValues,promotedValues:selectedValues});this.fetchData(essence,deltaSourceFilter,timekeeper,dimension,searchText)};SelectableStringFilterMenu.prototype.componentDidMount=function(){this.mounted=true};SelectableStringFilterMenu.prototype.componentWillUnmount=function(){this.mounted=false};SelectableStringFilterMenu.prototype.componentWillReceiveProps=function(nextProps){var searchText=this.props.searchText;var _a=this.state,fetchQueued=_a.fetchQueued,loading=_a.loading,dataset=_a.dataset;if(nextProps.searchText&&nextProps.searchText.includes(searchText)&&!fetchQueued&&!loading&&dataset&&dataset.data.length<TOP_N){return}else{this.setState({fetchQueued:true});this.collectTriggerSearch()}};SelectableStringFilterMenu.prototype.constructFilter=function(){var _a=this.props,dimension=_a.dimension,filterMode=_a.filterMode,onClauseChange=_a.onClauseChange;var selectedValues=this.state.selectedValues;var clause=null;if(selectedValues.size()){clause=new models_1.FilterClause({dimension:dimension.name,values:selectedValues,exclude:filterMode===models_1.Filter.EXCLUDE})}return onClauseChange(clause)};SelectableStringFilterMenu.prototype.onValueClick=function(value,e){var selectedValues=this.state.selectedValues;if(e.altKey||e.ctrlKey||e.metaKey){if(selectedValues.contains(value)&&selectedValues.size()===1){selectedValues=plywood_1.Set.EMPTY}else{selectedValues=plywood_1.Set.EMPTY.add(value)}}else{selectedValues=selectedValues.toggle(value)}this.setState({selectedValues:selectedValues})};SelectableStringFilterMenu.prototype.onOkClick=function(){if(!this.actionEnabled())return;var _a=this.props,clicker=_a.clicker,onClose=_a.onClose;clicker.changeFilter(this.constructFilter());onClose()};SelectableStringFilterMenu.prototype.onCancelClick=function(){var onClose=this.props.onClose;onClose()};SelectableStringFilterMenu.prototype.actionEnabled=function(){var essence=this.props.essence;return!essence.getEffectiveFilter().equals(this.constructFilter())};SelectableStringFilterMenu.prototype.renderRows=function(){var _this=this;var _a=this.state,loading=_a.loading,dataset=_a.dataset,fetchQueued=_a.fetchQueued,selectedValues=_a.selectedValues,promotedValues=_a.promotedValues;var _b=this.props,dimension=_b.dimension,filterMode=_b.filterMode,searchText=_b.searchText;var rows=[];if(dataset){var promotedElements_1=promotedValues?promotedValues.elements:[];var rowData=dataset.data.slice(0,TOP_N).filter(function(d){return!promotedElements_1.includes(d[dimension.name])});var rowStrings=promotedElements_1.concat(rowData.map(function(d){return d[dimension.name]}));if(searchText){var searchTextLower_1=searchText.toLowerCase();rowStrings=rowStrings.filter(function(d){return String(d).toLowerCase().includes(searchTextLower_1)})}var checkboxType_1=filterMode===models_1.Filter.EXCLUDE?"cross":"check";rows=rowStrings.map(function(segmentValue){var segmentValueStr=String(segmentValue);var selected=selectedValues&&selectedValues.contains(segmentValue);return React.createElement("div",{className:classNames("row",{selected:selected}),key:segmentValueStr,title:segmentValueStr,onClick:_this.onValueClick.bind(_this,segmentValue)},React.createElement("div",{className:"row-wrapper"},React.createElement(caladan_1.Checkbox,{type:checkboxType_1,selected:selected}),React.createElement(highlight_string_1.HighlightString,{className:"label",text:segmentValueStr,highlight:searchText})))})}var message=null;if(!loading&&dataset&&!fetchQueued&&!rows.length){var text=searchText?'No results for "'+searchText+'"':"No results";message=React.createElement("div",{className:"message"},text)}return React.createElement("div",{className:"rows"},rows,message)};SelectableStringFilterMenu.prototype.render=function(){var filterMode=this.props.filterMode;var _a=this.state,dataset=_a.dataset,loading=_a.loading,error=_a.error;var hasMore=dataset&&dataset.data.length>TOP_N;return React.createElement("div",{className:classNames("string-filter-menu",filterMode)},React.createElement(caladan_1.GlobalEventListener,{enter:this.onOkClick.bind(this)}),React.createElement("div",{className:classNames("menu-table",hasMore?"has-more":"no-more")},this.renderRows(),error?React.createElement(query_error_1.QueryError,{error:error}):null,loading?React.createElement(loader_1.Loader,null):null),React.createElement("div",{className:"ok-cancel-bar"},React.createElement(caladan_1.Button,{type:"secondary",title:strings_1.STRINGS.cancel,onClick:this.onCancelClick.bind(this)}),React.createElement(caladan_1.Button,{type:"primary",title:strings_1.STRINGS.ok,onClick:this.onOkClick.bind(this),disabled:!this.actionEnabled()})))};return SelectableStringFilterMenu}(React.Component);exports.SelectableStringFilterMenu=SelectableStringFilterMenu},function(module,exports,__webpack_require__){var content=__webpack_require__(518);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./selectable-string-filter-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./selectable-string-filter-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".string-filter-menu .row{height:24px;cursor:pointer;padding:0 14px}.string-filter-menu .row:hover{background:#e3f4fc}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(520);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./string-filter-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./string-filter-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".string-filter-menu .side-by-side{display:-webkit-box;display:-ms-flexbox;display:flex}.string-filter-menu .side-by-side>*{margin-right:5px}.string-filter-menu .side-by-side>*:last-child{margin-right:0}.string-filter-menu .search-box .clearable-input{background:#fff;border:1px solid #d1d1d1;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px 0 rgba(0,0,0,0.1);box-shadow:inset 0 1px 1px 0 rgba(0,0,0,0.1)}.string-filter-menu .menu-table::after{position:absolute;top:0;bottom:0;left:0;right:0;content:'';pointer-events:none;-webkit-box-shadow:inset 0 -20px 10px -10px #fff;box-shadow:inset 0 -20px 10px -10px #fff;border-radius:2px}.string-filter-menu .side-by-side :not(:last-child){margin-right:0}.string-filter-menu .search-box{height:30px;margin-left:6px;width:100%}.string-filter-menu .search-box .clearable-input{width:100%;height:30px;padding-left:6px}.string-filter-menu .menu-table{background:#fff;color:#000}.string-filter-menu .menu-table::after{position:absolute;top:0;bottom:0;left:-14px;right:-14px}.string-filter-menu .menu-table .rows{height:280px;margin-top:10px;margin-left:-14px;margin-right:-14px;overflow:auto}.string-filter-menu .menu-table .row{height:24px;cursor:pointer;padding:0 14px}.string-filter-menu .menu-table .row .row-wrapper{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;height:100%}.string-filter-menu .menu-table .row .row-wrapper .label{display:inline-block;vertical-align:top;padding-top:4px}.string-filter-menu .menu-table .row:hover{background:#e3f4fc}.string-filter-menu .menu-table .row:last-child{margin-bottom:12px}.string-filter-menu .menu-table .row.no-select{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.string-filter-menu .menu-table .row .checkbox.selected .checkbox-body{background:rgba(0,0,0,0.45)}.string-filter-menu .menu-table .message{padding:4px 14px;color:#999;font-style:italic}.string-filter-menu .menu-table .matching-values-message{padding:4px 14px;color:#999}.string-filter-menu .menu-table .loader,.string-filter-menu .menu-table .query-error{position:absolute;top:0;bottom:0;left:0;right:0}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(522);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./date-ranges-input.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./date-ranges-input.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".date-ranges-input .ranges{max-height:300px;overflow-y:auto;overflow-x:hidden;margin-bottom:10px;margin-right:-14px;padding-right:14px;margin-left:-14px;padding-left:14px}.date-ranges-input .ranges .date-range-input:not(:last-child){margin-bottom:15px}.date-ranges-input .ranges .date-range-input .date-input:not(:last-child){margin-bottom:8px}.date-ranges-input .add-button{padding-left:20px}.date-ranges-input .add-button svg{fill:#1ea3e6}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(524);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./date-range-picker.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./date-range-picker.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".date-range-picker .calendar{padding-left:4px;padding-right:4px}.date-range-picker .calendar .calendar-nav{margin-top:18px;margin-bottom:12px;text-align:center;line-height:23px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.date-range-picker .calendar .calendar-nav .caret{position:absolute;top:0;padding:3px 3px;cursor:pointer}.date-range-picker .calendar .calendar-nav .caret svg{width:19px;fill:#777}.date-range-picker .calendar .calendar-nav .caret:hover svg{fill:#555}.date-range-picker .calendar .calendar-nav .caret.left{left:0}.date-range-picker .calendar .calendar-nav .caret.right{right:0}.date-range-picker .calendar .week{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%}.date-range-picker .calendar .week .day{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-preferred-size:0;flex-basis:0;text-align:center;height:26px;line-height:26px;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.date-range-picker .calendar .week .day.label{color:#bbb;pointer-events:none}.date-range-picker .calendar .week .day.value.selected{background-color:rgba(30,163,230,0.26)}.date-range-picker .calendar .week .day.value.selected.past:not(.selected-edge),.date-range-picker .calendar .week .day.value.selected.future:not(.selected-edge){color:#87acbf}.date-range-picker .calendar .week .day.value:hover::after{position:absolute;top:0;bottom:0;left:0;right:0;content:'';pointer-events:none;background-color:rgba(0,0,0,0.06)}.date-range-picker .calendar .week .day.value:hover.beyond-max-range::after{background-color:rgba(0,0,0,0.1)}.date-range-picker .calendar .week .day.value.beyond-max-range::after{position:absolute;top:0;bottom:0;left:0;right:0;content:'';pointer-events:none;background-color:rgba(0,0,0,0.05)}.date-range-picker .calendar .week .day.value.past,.date-range-picker .calendar .week .day.value.future{color:#bbb}.date-range-picker .calendar .week .day.value.selected-edge{background-color:#1ea3e6;color:#fff}.date-range-picker .calendar .week .day.value.about-to-be-selected{background-color:rgba(30,163,230,0.16)}.date-range-picker .calendar .week .day span.space{color:transparent}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(526);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./date-range-input.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./date-range-input.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,'.date-range-input{margin-right:10px;padding-right:20px}.date-range-input.non-removable .date-input .time-field{width:84px}.date-range-input .remove-button{right:-13px;position:absolute;top:50%;-webkit-transform:translate(0, -50%);-ms-transform:translate(0, -50%);transform:translate(0, -50%);border-radius:50%}.date-range-input .remove-button svg{fill:#bababa}.date-range-input .remove-button:focus{background-color:transparent}.date-range-input .remove-button:hover{background-color:transparent}.date-range-input .remove-button:hover svg{fill:#666}.date-range-input .remove-button:hover:before{content:"";position:absolute;top:-6px;left:9px;width:6px;height:10px;border:2px solid #d9d9d9;border-left-width:0px;border-bottom-width:0px}.date-range-input .remove-button:hover:after{content:"";position:absolute;top:26px;left:9px;width:6px;height:10px;border:2px solid #d9d9d9;border-left-width:0px;border-top-width:0px}\n',""])},function(module,exports,__webpack_require__){var content=__webpack_require__(528);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./date-input.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./date-input.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".date-input .date-field,.date-input .time-field{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px}.date-input .date-field:hover,.date-input .time-field:hover{border-color:#b8b8b8}.date-input .date-field:focus,.date-input .time-field:focus{border-color:#1ea3e6}.date-input .error.date-field,.date-input .error.time-field{border-color:#e24c4c}.date-input .disabled.date-field,.date-input .disabled.time-field{pointer-events:none;background:#f2f2f2}.date-input{white-space:nowrap;display:-webkit-box;display:-ms-flexbox;display:flex}.date-input>*{-ms-flex-item-align:center;align-self:center}.date-input .date-field.invalid,.date-input .time-field.invalid{border-color:#e24b4b}.date-input .label{min-width:42px;text-align:right;padding-right:8px;color:#999;font-size:12px;text-transform:uppercase}.date-input .date-field{width:88px;margin-right:8px}.date-input .time-field{width:55px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(530);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./time-filter-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./time-filter-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".time-filter-menu .menu-tab .type{text-transform:uppercase;font-size:12px;color:#a6a6a6;margin-bottom:5px}.time-filter-menu .menu-tab .preview{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;height:30px;line-height:28px;background:#f2f2f2;border-radius:2px;color:#909090;text-align:center;padding-left:8px;padding-right:8px}.time-filter-menu .menu-tab{margin-top:16px}.time-filter-menu .menu-tab .date-range .date-input:not(:last-child){margin-bottom:5px}.time-filter-menu .menu-tab .buttons{margin-bottom:14px}.time-filter-menu .menu-tab .buttons button{min-width:0;padding:0;width:17.5%;margin-right:3%}.time-filter-menu .menu-tab .buttons button.selected{min-width:0;padding:0}.time-filter-menu .menu-tab .buttons button:last-child{margin-right:0}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(532);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./filter-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./filter-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".filter-menu .ok-cancel-bar{text-align:right}.filter-menu .ok-cancel-bar .button.more{min-width:initial;width:33px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(534);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./dimension-pill.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./dimension-pill.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".dimension-pill{padding:0 0 0 9px;border-radius:4px;cursor:pointer;overflow:hidden;-webkit-transition:-webkit-transform 0.1s ease-in-out;transition:-webkit-transform 0.1s ease-in-out;-o-transition:transform 0.1s ease-in-out;transition:transform 0.1s ease-in-out;transition:transform 0.1s ease-in-out, -webkit-transform 0.1s ease-in-out;width:200px;top:4px;bottom:4px}.dimension-pill .background{position:absolute;top:0;bottom:0;left:0;right:0}.dimension-pill .border{position:absolute;top:0;bottom:0;left:0;right:0;display:none;border:1px dashed #168bc5;border-radius:4px}.dimension-pill .icon{position:absolute;width:19px;height:19px;padding:0;left:6px;top:4px}.dimension-pill .icon svg{fill:rgba(0,0,0,0.25)}.dimension-pill .reading{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;pointer-events:none;white-space:nowrap;margin-right:20px;height:16px;margin-top:7px}.dimension-pill .reading .label{margin-right:3px}.dimension-pill.has-icon .reading{margin-left:19px}.dimension-pill .remove{position:absolute;top:0;bottom:0;right:0;width:27px;text-align:center;padding-top:9px;cursor:pointer}.dimension-pill .remove svg{width:10px;fill:rgba(0,0,0,0.2)}.dimension-pill .remove:hover svg{fill:rgba(0,0,0,0.5)}.dimension-pill:hover,.dimension-pill.selected{-webkit-filter:brightness(96%) saturate(116%);filter:brightness(96%) saturate(116%)}.dimension-pill.from-highlight .background{opacity:0.5}.dimension-pill.from-highlight .border{display:block}.dimension-pill .dimension-title{margin-right:5px}.dimension-pill.excluded .values{text-decoration:line-through}.dimension-pill.overflow{width:40px}.dimension-pill.overflow .reading{margin-right:0px}.overflow-menu .dimension-pill{position:absolute;left:8px;top:0;height:29px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(536);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./dimension-picker-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./dimension-picker-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".dimension-picker-menu .bubble-list{overflow:auto;height:100%}.dimension-picker-menu .bubble-list .item{height:30px;padding:5px 0;cursor:pointer}.dimension-picker-menu .bubble-list .item:hover{background-color:rgba(30,163,230,0.12)}.dimension-picker-menu .bubble-list .item .icon{position:absolute;width:19px;height:19px;padding:0;left:10px}.dimension-picker-menu .bubble-list .item .icon svg{width:19px;fill:#1ea3e6}.dimension-picker-menu .bubble-list .item .item-title{position:absolute;font-weight:bold;left:35px;right:10px;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;line-height:20px;color:#1ea3e6}.dimension-picker-menu .bubble-list{max-height:405px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(538);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./filter-tile.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./filter-tile.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".filter-tile{background:#fff}.filter-tile .title{position:absolute;top:0;bottom:0;left:0;width:64px;padding:12px 0 0 14px;font-size:12px;text-transform:uppercase;color:#999;cursor:default;white-space:nowrap}.filter-tile .drag-mask{position:absolute;top:0;bottom:0;left:0;right:0}.filter-tile .items{position:absolute;top:0;bottom:0;left:64px;right:0;-webkit-transition:height 0.1s ease-in-out;-o-transition:height 0.1s ease-in-out;transition:height 0.1s ease-in-out;overflow:hidden}.filter-tile .items .dimension-pill{position:absolute;left:0}.filter-tile .items .add-filter{position:absolute;cursor:pointer}.filter-tile .items .add-filter svg{margin-top:1px;height:19px;width:19px;fill:#bbb}.filter-tile .items .add-filter:hover svg{fill:#888}.filter-tile .fancy-drag-indicator{position:absolute;top:0;bottom:0;left:64px;right:0}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(540);var React=__webpack_require__(1);var classNames=__webpack_require__(4);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var strings_1=__webpack_require__(17);var AccessListEditor=function(_super){tslib_1.__extends(AccessListEditor,_super);function AccessListEditor(){var _this=_super.call(this)||this;_this.state={};return _this}AccessListEditor.prototype.renderAccessDropdown=function(){var _this=this;var _a=this.props,value=_a.value,user=_a.user,onChange=_a.onChange;var accessValues=[{label:"Only you",value:"only_you",selected:value.isOnly(user.name)},{label:"Everyone",value:"everyone",selected:value.isAll()},{label:"Specific",value:"specific",selected:value.isSpecific()}];var change=function(v){var newValue;switch(v.value){case"only_you":newValue=value.changeMany({access:"single",users:[user.name]});break;case"everyone":newValue=value.changeMany({access:"all",users:[]});break;case"specific":newValue=value.changeMany({access:"specific",users:[user.name]});_this.openModal();break}onChange(newValue)};var AccessDropdown=caladan_1.Dropdown.specialize();var selectedItem=accessValues.filter(function(v){return v.selected})[0];if(user.isSuperAdmin()&&value.isSingle()&&value.users[0]!==user.name){selectedItem={label:"Only "+value.users[0],value:null,selected:true}}return React.createElement(AccessDropdown,{selectedItem:selectedItem,items:accessValues,keyItem:function(v){return v.value},renderItem:function(v){return v?v.label:""},onSelect:change})};AccessListEditor.prototype.openModal=function(){this.setState({modalVisible:true})};AccessListEditor.prototype.closeModal=function(){this.setState({modalVisible:false})};AccessListEditor.prototype.renderCheckboxes=function(){var _a=this.props,value=_a.value,availableUsers=_a.availableUsers,onChange=_a.onChange;var searchText=this.state.searchText;var toggle=function(u){onChange(value.toggle(u.name))};var cantRemoveLastSelected=value.users.length===1;return availableUsers.map(function(u){if(searchText&&!u.name.includes(searchText))return null;var selected=value.users.includes(u.name);var disabled=selected&&cantRemoveLastSelected;return React.createElement("div",{className:classNames("list-item",{disabled:disabled}),key:u.name,onClick:disabled?null:function(){return toggle(u)}},React.createElement(caladan_1.Checkbox,{disabled:disabled,selected:selected,label:u.name}))})};AccessListEditor.prototype.renderModal=function(){var _this=this;var accessLabel=this.props.accessLabel;var _a=this.state,modalVisible=_a.modalVisible,searchText=_a.searchText;if(!modalVisible)return null;return React.createElement(caladan_1.Modal,{className:"access-list-editor-modal",title:"Users who can "+accessLabel,onEnter:function(){return _this.closeModal()}},React.createElement("form",{className:"general vertical"},React.createElement(caladan_1.ClearableInput,{placeholder:"Search",value:searchText,onChange:function(v){return _this.setState({searchText:v})}}),React.createElement("div",{className:"checkbox-list"},this.renderCheckboxes())),React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{className:"close",title:strings_1.STRINGS.close,type:"primary",onClick:function(){return _this.closeModal()}})))};AccessListEditor.prototype.renderList=function(){var _this=this;var value=this.props.value;if(!value.isSpecific())return null;return React.createElement("div",{className:"values-list",onClick:function(){return _this.openModal()}},value.users.map(function(u){return React.createElement("div",{className:"item",key:u},u)}),React.createElement(caladan_1.SvgIcon,{className:"open-modal-button",svg:Icons.FULL_EDIT}))};AccessListEditor.prototype.renderWarning=function(){var _a=this.props,value=_a.value,user=_a.user,accessLabel=_a.accessLabel;if(value.isAll()||value.users.includes(user.name))return null;if(user.isSuperAdmin())return null;return React.createElement("div",{className:"warning"},"Warning: you're not in this list")};AccessListEditor.prototype.render=function(){return React.createElement("div",{className:"access-list-editor"},this.renderAccessDropdown(),this.renderList(),this.renderModal(),this.renderWarning())};return AccessListEditor}(React.Component);exports.AccessListEditor=AccessListEditor},function(module,exports,__webpack_require__){var content=__webpack_require__(541);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./access-list-editor.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./access-list-editor.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".access-list-editor-modal .clearable-input{background:#fff;border:1px solid #d1d1d1;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px 0 rgba(0,0,0,0.1);box-shadow:inset 0 1px 1px 0 rgba(0,0,0,0.1)}.access-list-editor{max-width:620px}.access-list-editor .values-list{border:1px solid #d1d1d1;border-radius:2px;margin-top:10px;cursor:pointer;min-height:30px}.access-list-editor .values-list .item{padding:8px 6px}.access-list-editor .values-list .open-modal-button{position:absolute;right:4px;top:3px;width:20px;fill:#a6a6a6}.access-list-editor .values-list:hover{border-color:#bababa}.access-list-editor .values-list:hover .open-modal-button{fill:#999}.access-list-editor .warning{color:#a6a6a6;text-align:right;font-style:italic;padding-top:5px;font-size:12px}.access-list-editor-modal .clearable-input{width:100%;height:30px;padding-left:6px}.access-list-editor-modal .checkbox-list{border:1px solid #d1d1d1;margin-top:10px;height:200px;overflow:auto}.access-list-editor-modal .checkbox-list .list-item{padding:3px 10px 0px 10px}.access-list-editor-modal .checkbox-list .list-item.disabled{pointer-events:none;cursor:initial;color:#bababa}.access-list-editor-modal .checkbox-list .list-item:hover{background-color:#c3e7f8}.access-list-editor-modal .checkbox-list .list-item .checkbox{display:block;height:25px;width:100%}.access-list-editor-modal .button-bar{margin-top:15px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);var dom_1=__webpack_require__(68);__webpack_require__(543);var TICK_HEIGHT=5;var BucketMarks=function(_super){tslib_1.__extends(BucketMarks,_super);function BucketMarks(){return _super.call(this)||this}BucketMarks.prototype.render=function(){var _a=this.props,stage=_a.stage,ticks=_a.ticks,scale=_a.scale;var stageWidth=stage.width;var lines=[];function addLine(x,key){if(stageWidth<x)return;lines.push(React.createElement("line",{key:key,x1:x,y1:0,x2:x,y2:TICK_HEIGHT}))}for(var _i=0,ticks_1=ticks;_i<ticks_1.length;_i++){var tick=ticks_1[_i];var x=dom_1.roundToHalfInteger(scale(String(tick)));addLine(x,"_"+tick)}if(ticks.length){var x=dom_1.roundToHalfInteger(scale(String(ticks[ticks.length-1]))+scale.bandwidth());addLine(x,"last")}return React.createElement("g",{className:"bucket-marks",transform:stage.getTransform()},lines)};return BucketMarks}(React.Component);exports.BucketMarks=BucketMarks},function(module,exports,__webpack_require__){var content=__webpack_require__(544);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./bucket-marks.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./bucket-marks.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".bucket-marks{pointer-events:none}.bucket-marks line{pointer-events:none;stroke:#ccc}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var d3_shape_1=__webpack_require__(546);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);__webpack_require__(572);var lineFn=d3_shape_1.line();var ChartLine=function(_super){tslib_1.__extends(ChartLine,_super);function ChartLine(){return _super.call(this)||this}ChartLine.prototype.render=function(){var _a=this.props,stage=_a.stage,dataset=_a.dataset,getY=_a.getY,getX=_a.getX,scaleX=_a.scaleX,scaleY=_a.scaleY,color=_a.color,showArea=_a.showArea,hoverRange=_a.hoverRange;if(!dataset||!color)return null;var dataPoints=[];var hoverDataPoint=null;var ds=dataset.data;for(var i=0;i<ds.length;i++){var datum=ds[i];var range=getX(datum);if(!range||!plywood_1.Range.isRange(range))return null;var rangeMidpoint=range.midpoint();var measureValue=getY(datum);var prevDatum=ds[i-1];if(prevDatum){var prevRange=getX(prevDatum);if(prevRange.end.valueOf()<range.start.valueOf()){dataPoints.push([scaleX(rangeMidpoint.valueOf()-(range.end.valueOf()-range.start.valueOf())),scaleY(0)])}}var y=scaleY(measureValue);var dataPoint=[scaleX(rangeMidpoint),isNaN(y)?0:y];dataPoints.push(dataPoint);if(hoverRange&&immutable_class_1.immutableEqual(hoverRange,range)){hoverDataPoint=dataPoint}var nextDatum=ds[i+1];if(nextDatum){var nextRange=getX(nextDatum);if(range.end.valueOf()<nextRange.start.valueOf()){dataPoints.push([scaleX(rangeMidpoint.valueOf()+(range.end.valueOf()-range.start.valueOf())),scaleY(0)])}}}var strokeStyle=null;var fillStyle=null;if(color!=="default"){strokeStyle={stroke:color};fillStyle={fill:color}}var areaPath=null;var linePath=null;var singletonCircle=null;if(dataPoints.length>1){if(showArea){var areaFn=d3_shape_1.area().y0(scaleY(0));areaPath=React.createElement("path",{className:"area",d:areaFn(dataPoints)})}linePath=React.createElement("path",{className:"line",d:lineFn(dataPoints),style:strokeStyle})}else if(dataPoints.length===1){singletonCircle=React.createElement("circle",{className:"singleton",cx:dataPoints[0][0],cy:dataPoints[0][1],r:"2",style:fillStyle})}var hoverCircle=null;if(hoverDataPoint){hoverCircle=React.createElement("circle",{className:"hover",cx:hoverDataPoint[0],cy:hoverDataPoint[1],r:"2.5",style:strokeStyle})}return React.createElement("g",{className:"chart-line",transform:stage.getTransform()},areaPath,linePath,singletonCircle,hoverCircle)};return ChartLine}(React.Component);exports.ChartLine=ChartLine},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});var __WEBPACK_IMPORTED_MODULE_0__src_arc__=__webpack_require__(547);__webpack_require__.d(__webpack_exports__,"arc",function(){return __WEBPACK_IMPORTED_MODULE_0__src_arc__["a"]});var __WEBPACK_IMPORTED_MODULE_1__src_area__=__webpack_require__(418);__webpack_require__.d(__webpack_exports__,"area",function(){return __WEBPACK_IMPORTED_MODULE_1__src_area__["a"]});var __WEBPACK_IMPORTED_MODULE_2__src_line__=__webpack_require__(192);__webpack_require__.d(__webpack_exports__,"line",function(){return __WEBPACK_IMPORTED_MODULE_2__src_line__["a"]});var __WEBPACK_IMPORTED_MODULE_3__src_pie__=__webpack_require__(549);__webpack_require__.d(__webpack_exports__,"pie",function(){return __WEBPACK_IMPORTED_MODULE_3__src_pie__["a"]});var __WEBPACK_IMPORTED_MODULE_4__src_areaRadial__=__webpack_require__(552);__webpack_require__.d(__webpack_exports__,"areaRadial",function(){return __WEBPACK_IMPORTED_MODULE_4__src_areaRadial__["a"]});__webpack_require__.d(__webpack_exports__,"radialArea",function(){return __WEBPACK_IMPORTED_MODULE_4__src_areaRadial__["a"]});var __WEBPACK_IMPORTED_MODULE_5__src_lineRadial__=__webpack_require__(420);__webpack_require__.d(__webpack_exports__,"lineRadial",function(){return __WEBPACK_IMPORTED_MODULE_5__src_lineRadial__["a"]});__webpack_require__.d(__webpack_exports__,"radialLine",function(){return __WEBPACK_IMPORTED_MODULE_5__src_lineRadial__["a"]});var __WEBPACK_IMPORTED_MODULE_6__src_pointRadial__=__webpack_require__(421);__webpack_require__.d(__webpack_exports__,"pointRadial",function(){return __WEBPACK_IMPORTED_MODULE_6__src_pointRadial__["a"]});var __WEBPACK_IMPORTED_MODULE_7__src_link_index__=__webpack_require__(553);__webpack_require__.d(__webpack_exports__,"linkHorizontal",function(){return __WEBPACK_IMPORTED_MODULE_7__src_link_index__["a"]});__webpack_require__.d(__webpack_exports__,"linkVertical",function(){return __WEBPACK_IMPORTED_MODULE_7__src_link_index__["c"]});__webpack_require__.d(__webpack_exports__,"linkRadial",function(){return __WEBPACK_IMPORTED_MODULE_7__src_link_index__["b"]});var __WEBPACK_IMPORTED_MODULE_8__src_symbol__=__webpack_require__(554);__webpack_require__.d(__webpack_exports__,"symbol",function(){return __WEBPACK_IMPORTED_MODULE_8__src_symbol__["a"]});__webpack_require__.d(__webpack_exports__,"symbols",function(){return __WEBPACK_IMPORTED_MODULE_8__src_symbol__["b"]});var __WEBPACK_IMPORTED_MODULE_9__src_symbol_circle__=__webpack_require__(423);__webpack_require__.d(__webpack_exports__,"symbolCircle",function(){return __WEBPACK_IMPORTED_MODULE_9__src_symbol_circle__["a"]});var __WEBPACK_IMPORTED_MODULE_10__src_symbol_cross__=__webpack_require__(424);__webpack_require__.d(__webpack_exports__,"symbolCross",function(){return __WEBPACK_IMPORTED_MODULE_10__src_symbol_cross__["a"]});var __WEBPACK_IMPORTED_MODULE_11__src_symbol_diamond__=__webpack_require__(425);__webpack_require__.d(__webpack_exports__,"symbolDiamond",function(){return __WEBPACK_IMPORTED_MODULE_11__src_symbol_diamond__["a"]});var __WEBPACK_IMPORTED_MODULE_12__src_symbol_square__=__webpack_require__(427);__webpack_require__.d(__webpack_exports__,"symbolSquare",function(){return __WEBPACK_IMPORTED_MODULE_12__src_symbol_square__["a"]});var __WEBPACK_IMPORTED_MODULE_13__src_symbol_star__=__webpack_require__(426);__webpack_require__.d(__webpack_exports__,"symbolStar",function(){return __WEBPACK_IMPORTED_MODULE_13__src_symbol_star__["a"]});var __WEBPACK_IMPORTED_MODULE_14__src_symbol_triangle__=__webpack_require__(428);__webpack_require__.d(__webpack_exports__,"symbolTriangle",function(){return __WEBPACK_IMPORTED_MODULE_14__src_symbol_triangle__["a"]});var __WEBPACK_IMPORTED_MODULE_15__src_symbol_wye__=__webpack_require__(429);__webpack_require__.d(__webpack_exports__,"symbolWye",function(){return __WEBPACK_IMPORTED_MODULE_15__src_symbol_wye__["a"]});var __WEBPACK_IMPORTED_MODULE_16__src_curve_basisClosed__=__webpack_require__(555);__webpack_require__.d(__webpack_exports__,"curveBasisClosed",function(){return __WEBPACK_IMPORTED_MODULE_16__src_curve_basisClosed__["a"]});var __WEBPACK_IMPORTED_MODULE_17__src_curve_basisOpen__=__webpack_require__(556);__webpack_require__.d(__webpack_exports__,"curveBasisOpen",function(){return __WEBPACK_IMPORTED_MODULE_17__src_curve_basisOpen__["a"]});var __WEBPACK_IMPORTED_MODULE_18__src_curve_basis__=__webpack_require__(180);__webpack_require__.d(__webpack_exports__,"curveBasis",function(){return __WEBPACK_IMPORTED_MODULE_18__src_curve_basis__["b"]});var __WEBPACK_IMPORTED_MODULE_19__src_curve_bundle__=__webpack_require__(557);__webpack_require__.d(__webpack_exports__,"curveBundle",function(){return __WEBPACK_IMPORTED_MODULE_19__src_curve_bundle__["a"]});var __WEBPACK_IMPORTED_MODULE_20__src_curve_cardinalClosed__=__webpack_require__(430);__webpack_require__.d(__webpack_exports__,"curveCardinalClosed",function(){return __WEBPACK_IMPORTED_MODULE_20__src_curve_cardinalClosed__["b"]});var __WEBPACK_IMPORTED_MODULE_21__src_curve_cardinalOpen__=__webpack_require__(431);__webpack_require__.d(__webpack_exports__,"curveCardinalOpen",function(){return __WEBPACK_IMPORTED_MODULE_21__src_curve_cardinalOpen__["b"]});var __WEBPACK_IMPORTED_MODULE_22__src_curve_cardinal__=__webpack_require__(181);__webpack_require__.d(__webpack_exports__,"curveCardinal",function(){return __WEBPACK_IMPORTED_MODULE_22__src_curve_cardinal__["b"]});var __WEBPACK_IMPORTED_MODULE_23__src_curve_catmullRomClosed__=__webpack_require__(558);__webpack_require__.d(__webpack_exports__,"curveCatmullRomClosed",function(){return __WEBPACK_IMPORTED_MODULE_23__src_curve_catmullRomClosed__["a"]});var __WEBPACK_IMPORTED_MODULE_24__src_curve_catmullRomOpen__=__webpack_require__(559);__webpack_require__.d(__webpack_exports__,"curveCatmullRomOpen",function(){return __WEBPACK_IMPORTED_MODULE_24__src_curve_catmullRomOpen__["a"]});var __WEBPACK_IMPORTED_MODULE_25__src_curve_catmullRom__=__webpack_require__(194);__webpack_require__.d(__webpack_exports__,"curveCatmullRom",function(){return __WEBPACK_IMPORTED_MODULE_25__src_curve_catmullRom__["a"]});var __WEBPACK_IMPORTED_MODULE_26__src_curve_linearClosed__=__webpack_require__(560);__webpack_require__.d(__webpack_exports__,"curveLinearClosed",function(){return __WEBPACK_IMPORTED_MODULE_26__src_curve_linearClosed__["a"]});var __WEBPACK_IMPORTED_MODULE_27__src_curve_linear__=__webpack_require__(178);__webpack_require__.d(__webpack_exports__,"curveLinear",function(){return __WEBPACK_IMPORTED_MODULE_27__src_curve_linear__["a"]});var __WEBPACK_IMPORTED_MODULE_28__src_curve_monotone__=__webpack_require__(561);__webpack_require__.d(__webpack_exports__,"curveMonotoneX",function(){return __WEBPACK_IMPORTED_MODULE_28__src_curve_monotone__["a"]});__webpack_require__.d(__webpack_exports__,"curveMonotoneY",function(){return __WEBPACK_IMPORTED_MODULE_28__src_curve_monotone__["b"]});var __WEBPACK_IMPORTED_MODULE_29__src_curve_natural__=__webpack_require__(562);__webpack_require__.d(__webpack_exports__,"curveNatural",function(){return __WEBPACK_IMPORTED_MODULE_29__src_curve_natural__["a"]});var __WEBPACK_IMPORTED_MODULE_30__src_curve_step__=__webpack_require__(563);__webpack_require__.d(__webpack_exports__,"curveStep",function(){return __WEBPACK_IMPORTED_MODULE_30__src_curve_step__["a"]});__webpack_require__.d(__webpack_exports__,"curveStepAfter",function(){return __WEBPACK_IMPORTED_MODULE_30__src_curve_step__["b"]});__webpack_require__.d(__webpack_exports__,"curveStepBefore",function(){return __WEBPACK_IMPORTED_MODULE_30__src_curve_step__["c"]});var __WEBPACK_IMPORTED_MODULE_31__src_stack__=__webpack_require__(564);__webpack_require__.d(__webpack_exports__,"stack",function(){return __WEBPACK_IMPORTED_MODULE_31__src_stack__["a"]});var __WEBPACK_IMPORTED_MODULE_32__src_offset_expand__=__webpack_require__(565);__webpack_require__.d(__webpack_exports__,"stackOffsetExpand",function(){return __WEBPACK_IMPORTED_MODULE_32__src_offset_expand__["a"]});var __WEBPACK_IMPORTED_MODULE_33__src_offset_diverging__=__webpack_require__(566);__webpack_require__.d(__webpack_exports__,"stackOffsetDiverging",function(){return __WEBPACK_IMPORTED_MODULE_33__src_offset_diverging__["a"]});var __WEBPACK_IMPORTED_MODULE_34__src_offset_none__=__webpack_require__(114);__webpack_require__.d(__webpack_exports__,"stackOffsetNone",function(){return __WEBPACK_IMPORTED_MODULE_34__src_offset_none__["a"]});var __WEBPACK_IMPORTED_MODULE_35__src_offset_silhouette__=__webpack_require__(567);__webpack_require__.d(__webpack_exports__,"stackOffsetSilhouette",function(){return __WEBPACK_IMPORTED_MODULE_35__src_offset_silhouette__["a"]});var __WEBPACK_IMPORTED_MODULE_36__src_offset_wiggle__=__webpack_require__(568);__webpack_require__.d(__webpack_exports__,"stackOffsetWiggle",function(){return __WEBPACK_IMPORTED_MODULE_36__src_offset_wiggle__["a"]});var __WEBPACK_IMPORTED_MODULE_37__src_order_ascending__=__webpack_require__(195);__webpack_require__.d(__webpack_exports__,"stackOrderAscending",function(){return __WEBPACK_IMPORTED_MODULE_37__src_order_ascending__["a"]});var __WEBPACK_IMPORTED_MODULE_38__src_order_descending__=__webpack_require__(569);__webpack_require__.d(__webpack_exports__,"stackOrderDescending",function(){return __WEBPACK_IMPORTED_MODULE_38__src_order_descending__["a"]});var __WEBPACK_IMPORTED_MODULE_39__src_order_insideOut__=__webpack_require__(570);__webpack_require__.d(__webpack_exports__,"stackOrderInsideOut",function(){return __WEBPACK_IMPORTED_MODULE_39__src_order_insideOut__["a"]});var __WEBPACK_IMPORTED_MODULE_40__src_order_none__=__webpack_require__(115);__webpack_require__.d(__webpack_exports__,"stackOrderNone",function(){return __WEBPACK_IMPORTED_MODULE_40__src_order_none__["a"]});var __WEBPACK_IMPORTED_MODULE_41__src_order_reverse__=__webpack_require__(571);__webpack_require__.d(__webpack_exports__,"stackOrderReverse",function(){return __WEBPACK_IMPORTED_MODULE_41__src_order_reverse__["a"]})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_path__=__webpack_require__(112);var __WEBPACK_IMPORTED_MODULE_1__constant__=__webpack_require__(74);var __WEBPACK_IMPORTED_MODULE_2__math__=__webpack_require__(113);function arcInnerRadius(d){return d.innerRadius}function arcOuterRadius(d){return d.outerRadius}function arcStartAngle(d){return d.startAngle}function arcEndAngle(d){return d.endAngle}function arcPadAngle(d){return d&&d.padAngle}function intersect(x0,y0,x1,y1,x2,y2,x3,y3){var x10=x1-x0,y10=y1-y0,x32=x3-x2,y32=y3-y2,t=(x32*(y0-y2)-y32*(x0-x2))/(y32*x10-x32*y10);return[x0+t*x10,y0+t*y10]}function cornerTangents(x0,y0,x1,y1,r1,rc,cw){var x01=x0-x1,y01=y0-y1,lo=(cw?rc:-rc)/Object(__WEBPACK_IMPORTED_MODULE_2__math__["l"])(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r=r1-rc,D=x11*y10-x10*y11,d=(dy<0?-1:1)*Object(__WEBPACK_IMPORTED_MODULE_2__math__["l"])(Object(__WEBPACK_IMPORTED_MODULE_2__math__["h"])(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;if(dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1)cx0=cx1,cy0=cy1;return{cx:cx0,cy:cy0,x01:-ox,y01:-oy,x11:cx0*(r1/r-1),y11:cy0*(r1/r-1)}}__webpack_exports__["a"]=function(){var innerRadius=arcInnerRadius,outerRadius=arcOuterRadius,cornerRadius=Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(0),padRadius=null,startAngle=arcStartAngle,endAngle=arcEndAngle,padAngle=arcPadAngle,context=null;function arc(){var buffer,r,r0=+innerRadius.apply(this,arguments),r1=+outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)-__WEBPACK_IMPORTED_MODULE_2__math__["g"],a1=endAngle.apply(this,arguments)-__WEBPACK_IMPORTED_MODULE_2__math__["g"],da=Object(__WEBPACK_IMPORTED_MODULE_2__math__["a"])(a1-a0),cw=a1>a0;if(!context)context=buffer=Object(__WEBPACK_IMPORTED_MODULE_0_d3_path__["a"])();if(r1<r0)r=r1,r1=r0,r0=r;if(!(r1>__WEBPACK_IMPORTED_MODULE_2__math__["f"]))context.moveTo(0,0);else if(da>__WEBPACK_IMPORTED_MODULE_2__math__["m"]-__WEBPACK_IMPORTED_MODULE_2__math__["f"]){context.moveTo(r1*Object(__WEBPACK_IMPORTED_MODULE_2__math__["e"])(a0),r1*Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(a0));context.arc(0,0,r1,a0,a1,!cw);if(r0>__WEBPACK_IMPORTED_MODULE_2__math__["f"]){context.moveTo(r0*Object(__WEBPACK_IMPORTED_MODULE_2__math__["e"])(a1),r0*Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(a1));context.arc(0,0,r0,a1,a0,cw)}}else{var a01=a0,a11=a1,a00=a0,a10=a1,da0=da,da1=da,ap=padAngle.apply(this,arguments)/2,rp=ap>__WEBPACK_IMPORTED_MODULE_2__math__["f"]&&(padRadius?+padRadius.apply(this,arguments):Object(__WEBPACK_IMPORTED_MODULE_2__math__["l"])(r0*r0+r1*r1)),rc=Object(__WEBPACK_IMPORTED_MODULE_2__math__["i"])(Object(__WEBPACK_IMPORTED_MODULE_2__math__["a"])(r1-r0)/2,+cornerRadius.apply(this,arguments)),rc0=rc,rc1=rc,t0,t1;if(rp>__WEBPACK_IMPORTED_MODULE_2__math__["f"]){var p0=Object(__WEBPACK_IMPORTED_MODULE_2__math__["c"])(rp/r0*Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(ap)),p1=Object(__WEBPACK_IMPORTED_MODULE_2__math__["c"])(rp/r1*Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(ap));if((da0-=p0*2)>__WEBPACK_IMPORTED_MODULE_2__math__["f"])p0*=cw?1:-1,a00+=p0,a10-=p0;else da0=0,a00=a10=(a0+a1)/2;if((da1-=p1*2)>__WEBPACK_IMPORTED_MODULE_2__math__["f"])p1*=cw?1:-1,a01+=p1,a11-=p1;else da1=0,a01=a11=(a0+a1)/2}var x01=r1*Object(__WEBPACK_IMPORTED_MODULE_2__math__["e"])(a01),y01=r1*Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(a01),x10=r0*Object(__WEBPACK_IMPORTED_MODULE_2__math__["e"])(a10),y10=r0*Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(a10);if(rc>__WEBPACK_IMPORTED_MODULE_2__math__["f"]){var x11=r1*Object(__WEBPACK_IMPORTED_MODULE_2__math__["e"])(a11),y11=r1*Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(a11),x00=r0*Object(__WEBPACK_IMPORTED_MODULE_2__math__["e"])(a00),y00=r0*Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(a00);if(da<__WEBPACK_IMPORTED_MODULE_2__math__["j"]){var oc=da0>__WEBPACK_IMPORTED_MODULE_2__math__["f"]?intersect(x01,y01,x00,y00,x11,y11,x10,y10):[x10,y10],ax=x01-oc[0],ay=y01-oc[1],bx=x11-oc[0],by=y11-oc[1],kc=1/Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(Object(__WEBPACK_IMPORTED_MODULE_2__math__["b"])((ax*bx+ay*by)/(Object(__WEBPACK_IMPORTED_MODULE_2__math__["l"])(ax*ax+ay*ay)*Object(__WEBPACK_IMPORTED_MODULE_2__math__["l"])(bx*bx+by*by)))/2),lc=Object(__WEBPACK_IMPORTED_MODULE_2__math__["l"])(oc[0]*oc[0]+oc[1]*oc[1]);rc0=Object(__WEBPACK_IMPORTED_MODULE_2__math__["i"])(rc,(r0-lc)/(kc-1));rc1=Object(__WEBPACK_IMPORTED_MODULE_2__math__["i"])(rc,(r1-lc)/(kc+1))}}if(!(da1>__WEBPACK_IMPORTED_MODULE_2__math__["f"]))context.moveTo(x01,y01);else if(rc1>__WEBPACK_IMPORTED_MODULE_2__math__["f"]){t0=cornerTangents(x00,y00,x01,y01,r1,rc1,cw);t1=cornerTangents(x11,y11,x10,y10,r1,rc1,cw);context.moveTo(t0.cx+t0.x01,t0.cy+t0.y01);if(rc1<rc)context.arc(t0.cx,t0.cy,rc1,Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t0.y01,t0.x01),Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t1.y01,t1.x01),!cw);else{context.arc(t0.cx,t0.cy,rc1,Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t0.y01,t0.x01),Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t0.y11,t0.x11),!cw);context.arc(0,0,r1,Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t0.cy+t0.y11,t0.cx+t0.x11),Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t1.cy+t1.y11,t1.cx+t1.x11),!cw);context.arc(t1.cx,t1.cy,rc1,Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t1.y11,t1.x11),Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t1.y01,t1.x01),!cw)}}else context.moveTo(x01,y01),context.arc(0,0,r1,a01,a11,!cw);if(!(r0>__WEBPACK_IMPORTED_MODULE_2__math__["f"])||!(da0>__WEBPACK_IMPORTED_MODULE_2__math__["f"]))context.lineTo(x10,y10);else if(rc0>__WEBPACK_IMPORTED_MODULE_2__math__["f"]){t0=cornerTangents(x10,y10,x11,y11,r0,-rc0,cw);t1=cornerTangents(x01,y01,x00,y00,r0,-rc0,cw);context.lineTo(t0.cx+t0.x01,t0.cy+t0.y01);if(rc0<rc)context.arc(t0.cx,t0.cy,rc0,Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t0.y01,t0.x01),Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t1.y01,t1.x01),!cw);else{context.arc(t0.cx,t0.cy,rc0,Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t0.y01,t0.x01),Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t0.y11,t0.x11),!cw);context.arc(0,0,r0,Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t0.cy+t0.y11,t0.cx+t0.x11),Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t1.cy+t1.y11,t1.cx+t1.x11),cw);context.arc(t1.cx,t1.cy,rc0,Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t1.y11,t1.x11),Object(__WEBPACK_IMPORTED_MODULE_2__math__["d"])(t1.y01,t1.x01),!cw)}}else context.arc(0,0,r0,a10,a00,cw)}context.closePath();if(buffer)return context=null,buffer+""||null}arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-__WEBPACK_IMPORTED_MODULE_2__math__["j"]/2;return[Object(__WEBPACK_IMPORTED_MODULE_2__math__["e"])(a)*r,Object(__WEBPACK_IMPORTED_MODULE_2__math__["k"])(a)*r]};arc.innerRadius=function(_){return arguments.length?(innerRadius=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),arc):innerRadius};arc.outerRadius=function(_){return arguments.length?(outerRadius=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),arc):outerRadius};arc.cornerRadius=function(_){return arguments.length?(cornerRadius=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),arc):cornerRadius};arc.padRadius=function(_){return arguments.length?(padRadius=_==null?null:typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),arc):padRadius};arc.startAngle=function(_){return arguments.length?(startAngle=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),arc):startAngle};arc.endAngle=function(_){return arguments.length?(endAngle=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),arc):endAngle};arc.padAngle=function(_){return arguments.length?(padAngle=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),arc):padAngle};arc.context=function(_){return arguments.length?(context=_==null?null:_,arc):context};return arc}},function(module,__webpack_exports__,__webpack_require__){"use strict";var pi=Math.PI,tau=2*pi,epsilon=1e-6,tauEpsilon=tau-epsilon;function Path(){this._x0=this._y0=this._x1=this._y1=null;this._=""}function path(){return new Path}Path.prototype=path.prototype={constructor:Path,moveTo:function(x,y){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)},closePath:function(){if(this._x1!==null){this._x1=this._x0,this._y1=this._y0;this._+="Z"}},lineTo:function(x,y){this._+="L"+(this._x1=+x)+","+(this._y1=+y)},quadraticCurveTo:function(x1,y1,x,y){this._+="Q"+ +x1+","+ +y1+","+(this._x1=+x)+","+(this._y1=+y)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._+="C"+ +x1+","+ +y1+","+ +x2+","+ +y2+","+(this._x1=+x)+","+(this._y1=+y)},arcTo:function(x1,y1,x2,y2,r){x1=+x1,y1=+y1,x2=+x2,y2=+y2,r=+r;var x0=this._x1,y0=this._y1,x21=x2-x1,y21=y2-y1,x01=x0-x1,y01=y0-y1,l01_2=x01*x01+y01*y01;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null){this._+="M"+(this._x1=x1)+","+(this._y1=y1)}else if(!(l01_2>epsilon)){}else if(!(Math.abs(y01*x21-y21*x01)>epsilon)||!r){this._+="L"+(this._x1=x1)+","+(this._y1=y1)}else{var x20=x2-x0,y20=y2-y0,l21_2=x21*x21+y21*y21,l20_2=x20*x20+y20*y20,l21=Math.sqrt(l21_2),l01=Math.sqrt(l01_2),l=r*Math.tan((pi-Math.acos((l21_2+l01_2-l20_2)/(2*l21*l01)))/2),t01=l/l01,t21=l/l21;if(Math.abs(t01-1)>epsilon){this._+="L"+(x1+t01*x01)+","+(y1+t01*y01)}this._+="A"+r+","+r+",0,0,"+ +(y01*x20>x01*y20)+","+(this._x1=x1+t21*x21)+","+(this._y1=y1+t21*y21)}},arc:function(x,y,r,a0,a1,ccw){x=+x,y=+y,r=+r;var dx=r*Math.cos(a0),dy=r*Math.sin(a0),x0=x+dx,y0=y+dy,cw=1^ccw,da=ccw?a0-a1:a1-a0;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null){this._+="M"+x0+","+y0}else if(Math.abs(this._x1-x0)>epsilon||Math.abs(this._y1-y0)>epsilon){this._+="L"+x0+","+y0}if(!r)return;if(da<0)da=da%tau+tau;if(da>tauEpsilon){this._+="A"+r+","+r+",0,1,"+cw+","+(x-dx)+","+(y-dy)+"A"+r+","+r+",0,1,"+cw+","+(this._x1=x0)+","+(this._y1=y0)}else if(da>epsilon){this._+="A"+r+","+r+",0,"+ +(da>=pi)+","+cw+","+(this._x1=x+r*Math.cos(a1))+","+(this._y1=y+r*Math.sin(a1))}},rect:function(x,y,w,h){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)+"h"+ +w+"v"+ +h+"h"+-w+"Z"},toString:function(){return this._}};__webpack_exports__["a"]=path},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__constant__=__webpack_require__(74);var __WEBPACK_IMPORTED_MODULE_1__descending__=__webpack_require__(550);var __WEBPACK_IMPORTED_MODULE_2__identity__=__webpack_require__(551);var __WEBPACK_IMPORTED_MODULE_3__math__=__webpack_require__(113);__webpack_exports__["a"]=function(){var value=__WEBPACK_IMPORTED_MODULE_2__identity__["a"],sortValues=__WEBPACK_IMPORTED_MODULE_1__descending__["a"],sort=null,startAngle=Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(0),endAngle=Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(__WEBPACK_IMPORTED_MODULE_3__math__["m"]),padAngle=Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(0);function pie(data){var i,n=data.length,j,k,sum=0,index=new Array(n),arcs=new Array(n),a0=+startAngle.apply(this,arguments),da=Math.min(__WEBPACK_IMPORTED_MODULE_3__math__["m"],Math.max(-__WEBPACK_IMPORTED_MODULE_3__math__["m"],endAngle.apply(this,arguments)-a0)),a1,p=Math.min(Math.abs(da)/n,padAngle.apply(this,arguments)),pa=p*(da<0?-1:1),v;for(i=0;i<n;++i){if((v=arcs[index[i]=i]=+value(data[i],i,data))>0){sum+=v}}if(sortValues!=null)index.sort(function(i,j){return sortValues(arcs[i],arcs[j])});else if(sort!=null)index.sort(function(i,j){return sort(data[i],data[j])});for(i=0,k=sum?(da-n*pa)/sum:0;i<n;++i,a0=a1){j=index[i],v=arcs[j],a1=a0+(v>0?v*k:0)+pa,arcs[j]={data:data[j],index:i,value:v,startAngle:a0,endAngle:a1,padAngle:p}}return arcs}pie.value=function(_){return arguments.length?(value=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(+_),pie):value};pie.sortValues=function(_){return arguments.length?(sortValues=_,sort=null,pie):sortValues};pie.sort=function(_){return arguments.length?(sort=_,sortValues=null,pie):sort};pie.startAngle=function(_){return arguments.length?(startAngle=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(+_),pie):startAngle};pie.endAngle=function(_){return arguments.length?(endAngle=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(+_),pie):endAngle};pie.padAngle=function(_){return arguments.length?(padAngle=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(+_),pie):padAngle};return pie}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(d){return d}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__curve_radial__=__webpack_require__(419);var __WEBPACK_IMPORTED_MODULE_1__area__=__webpack_require__(418);var __WEBPACK_IMPORTED_MODULE_2__lineRadial__=__webpack_require__(420);__webpack_exports__["a"]=function(){var a=Object(__WEBPACK_IMPORTED_MODULE_1__area__["a"])().curve(__WEBPACK_IMPORTED_MODULE_0__curve_radial__["a"]),c=a.curve,x0=a.lineX0,x1=a.lineX1,y0=a.lineY0,y1=a.lineY1;a.angle=a.x,delete a.x;a.startAngle=a.x0,delete a.x0;a.endAngle=a.x1,delete a.x1;a.radius=a.y,delete a.y;a.innerRadius=a.y0,delete a.y0;a.outerRadius=a.y1,delete a.y1;a.lineStartAngle=function(){return Object(__WEBPACK_IMPORTED_MODULE_2__lineRadial__["b"])(x0())},delete a.lineX0;a.lineEndAngle=function(){return Object(__WEBPACK_IMPORTED_MODULE_2__lineRadial__["b"])(x1())},delete a.lineX1;a.lineInnerRadius=function(){return Object(__WEBPACK_IMPORTED_MODULE_2__lineRadial__["b"])(y0())},delete a.lineY0;a.lineOuterRadius=function(){return Object(__WEBPACK_IMPORTED_MODULE_2__lineRadial__["b"])(y1())},delete a.lineY1;a.curve=function(_){return arguments.length?c(Object(__WEBPACK_IMPORTED_MODULE_0__curve_radial__["b"])(_)):c()._curve};return a}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=linkHorizontal;__webpack_exports__["c"]=linkVertical;__webpack_exports__["b"]=linkRadial;var __WEBPACK_IMPORTED_MODULE_0_d3_path__=__webpack_require__(112);var __WEBPACK_IMPORTED_MODULE_1__array__=__webpack_require__(422);var __WEBPACK_IMPORTED_MODULE_2__constant__=__webpack_require__(74);var __WEBPACK_IMPORTED_MODULE_3__point__=__webpack_require__(193);var __WEBPACK_IMPORTED_MODULE_4__pointRadial__=__webpack_require__(421);function linkSource(d){return d.source}function linkTarget(d){return d.target}function link(curve){var source=linkSource,target=linkTarget,x=__WEBPACK_IMPORTED_MODULE_3__point__["a"],y=__WEBPACK_IMPORTED_MODULE_3__point__["b"],context=null;function link(){var buffer,argv=__WEBPACK_IMPORTED_MODULE_1__array__["a"].call(arguments),s=source.apply(this,argv),t=target.apply(this,argv);if(!context)context=buffer=Object(__WEBPACK_IMPORTED_MODULE_0_d3_path__["a"])();curve(context,+x.apply(this,(argv[0]=s,argv)),+y.apply(this,argv),+x.apply(this,(argv[0]=t,argv)),+y.apply(this,argv));if(buffer)return context=null,buffer+""||null}link.source=function(_){return arguments.length?(source=_,link):source};link.target=function(_){return arguments.length?(target=_,link):target};link.x=function(_){return arguments.length?(x=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_2__constant__["a"])(+_),link):x};link.y=function(_){return arguments.length?(y=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_2__constant__["a"])(+_),link):y};link.context=function(_){return arguments.length?(context=_==null?null:_,link):context};return link}function curveHorizontal(context,x0,y0,x1,y1){context.moveTo(x0,y0);context.bezierCurveTo(x0=(x0+x1)/2,y0,x0,y1,x1,y1)}function curveVertical(context,x0,y0,x1,y1){context.moveTo(x0,y0);context.bezierCurveTo(x0,y0=(y0+y1)/2,x1,y0,x1,y1)}function curveRadial(context,x0,y0,x1,y1){var p0=Object(__WEBPACK_IMPORTED_MODULE_4__pointRadial__["a"])(x0,y0),p1=Object(__WEBPACK_IMPORTED_MODULE_4__pointRadial__["a"])(x0,y0=(y0+y1)/2),p2=Object(__WEBPACK_IMPORTED_MODULE_4__pointRadial__["a"])(x1,y0),p3=Object(__WEBPACK_IMPORTED_MODULE_4__pointRadial__["a"])(x1,y1);context.moveTo(p0[0],p0[1]);context.bezierCurveTo(p1[0],p1[1],p2[0],p2[1],p3[0],p3[1])}function linkHorizontal(){return link(curveHorizontal)}function linkVertical(){return link(curveVertical)}function linkRadial(){var l=link(curveRadial);l.angle=l.x,delete l.x;l.radius=l.y,delete l.y;return l}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return symbols});var __WEBPACK_IMPORTED_MODULE_0_d3_path__=__webpack_require__(112);var __WEBPACK_IMPORTED_MODULE_1__symbol_circle__=__webpack_require__(423);var __WEBPACK_IMPORTED_MODULE_2__symbol_cross__=__webpack_require__(424);var __WEBPACK_IMPORTED_MODULE_3__symbol_diamond__=__webpack_require__(425);var __WEBPACK_IMPORTED_MODULE_4__symbol_star__=__webpack_require__(426);var __WEBPACK_IMPORTED_MODULE_5__symbol_square__=__webpack_require__(427);var __WEBPACK_IMPORTED_MODULE_6__symbol_triangle__=__webpack_require__(428);var __WEBPACK_IMPORTED_MODULE_7__symbol_wye__=__webpack_require__(429);var __WEBPACK_IMPORTED_MODULE_8__constant__=__webpack_require__(74);var symbols=[__WEBPACK_IMPORTED_MODULE_1__symbol_circle__["a"],__WEBPACK_IMPORTED_MODULE_2__symbol_cross__["a"],__WEBPACK_IMPORTED_MODULE_3__symbol_diamond__["a"],__WEBPACK_IMPORTED_MODULE_5__symbol_square__["a"],__WEBPACK_IMPORTED_MODULE_4__symbol_star__["a"],__WEBPACK_IMPORTED_MODULE_6__symbol_triangle__["a"],__WEBPACK_IMPORTED_MODULE_7__symbol_wye__["a"]];__webpack_exports__["a"]=function(){var type=Object(__WEBPACK_IMPORTED_MODULE_8__constant__["a"])(__WEBPACK_IMPORTED_MODULE_1__symbol_circle__["a"]),size=Object(__WEBPACK_IMPORTED_MODULE_8__constant__["a"])(64),context=null;function symbol(){var buffer;if(!context)context=buffer=Object(__WEBPACK_IMPORTED_MODULE_0_d3_path__["a"])();type.apply(this,arguments).draw(context,+size.apply(this,arguments));if(buffer)return context=null,buffer+""||null}symbol.type=function(_){return arguments.length?(type=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_8__constant__["a"])(_),symbol):type};symbol.size=function(_){return arguments.length?(size=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_8__constant__["a"])(+_),symbol):size};symbol.context=function(_){return arguments.length?(context=_==null?null:_,symbol):context};return symbol}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__noop__=__webpack_require__(179);var __WEBPACK_IMPORTED_MODULE_1__basis__=__webpack_require__(180);function BasisClosed(context){this._context=context}BasisClosed.prototype={areaStart:__WEBPACK_IMPORTED_MODULE_0__noop__["a"],areaEnd:__WEBPACK_IMPORTED_MODULE_0__noop__["a"],lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN;this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2);this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3);this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3);this._context.closePath();break}case 3:{this.point(this._x2,this._y2);this.point(this._x3,this._y3);this.point(this._x4,this._y4);break}}},point:function(x,y){x=+x,y=+y;switch(this._point){case 0:this._point=1;this._x2=x,this._y2=y;break;case 1:this._point=2;this._x3=x,this._y3=y;break;case 2:this._point=3;this._x4=x,this._y4=y;this._context.moveTo((this._x0+4*this._x1+x)/6,(this._y0+4*this._y1+y)/6);break;default:Object(__WEBPACK_IMPORTED_MODULE_1__basis__["c"])(this,x,y);break}this._x0=this._x1,this._x1=x;this._y0=this._y1,this._y1=y}};__webpack_exports__["a"]=function(context){return new BasisClosed(context)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__basis__=__webpack_require__(180);function BasisOpen(context){this._context=context}BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN;this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(x,y){x=+x,y=+y;switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var x0=(this._x0+4*this._x1+x)/6,y0=(this._y0+4*this._y1+y)/6;this._line?this._context.lineTo(x0,y0):this._context.moveTo(x0,y0);break;case 3:this._point=4;default:Object(__WEBPACK_IMPORTED_MODULE_0__basis__["c"])(this,x,y);break}this._x0=this._x1,this._x1=x;this._y0=this._y1,this._y1=y}};__webpack_exports__["a"]=function(context){return new BasisOpen(context)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__basis__=__webpack_require__(180);function Bundle(context,beta){this._basis=new __WEBPACK_IMPORTED_MODULE_0__basis__["a"](context);this._beta=beta}Bundle.prototype={lineStart:function(){this._x=[];this._y=[];this._basis.lineStart()},lineEnd:function(){var x=this._x,y=this._y,j=x.length-1;if(j>0){var x0=x[0],y0=y[0],dx=x[j]-x0,dy=y[j]-y0,i=-1,t;while(++i<=j){t=i/j;this._basis.point(this._beta*x[i]+(1-this._beta)*(x0+t*dx),this._beta*y[i]+(1-this._beta)*(y0+t*dy))}}this._x=this._y=null;this._basis.lineEnd()},point:function(x,y){this._x.push(+x);this._y.push(+y)}};__webpack_exports__["a"]=function custom(beta){function bundle(context){return beta===1?new __WEBPACK_IMPORTED_MODULE_0__basis__["a"](context):new Bundle(context,beta)}bundle.beta=function(beta){return custom(+beta)};return bundle}(.85)},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__cardinalClosed__=__webpack_require__(430);var __WEBPACK_IMPORTED_MODULE_1__noop__=__webpack_require__(179);var __WEBPACK_IMPORTED_MODULE_2__catmullRom__=__webpack_require__(194);function CatmullRomClosed(context,alpha){this._context=context;this._alpha=alpha}CatmullRomClosed.prototype={areaStart:__WEBPACK_IMPORTED_MODULE_1__noop__["a"],areaEnd:__WEBPACK_IMPORTED_MODULE_1__noop__["a"],lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3);this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3);this._context.closePath();break}case 3:{this.point(this._x3,this._y3);this.point(this._x4,this._y4);this.point(this._x5,this._y5);break}}},point:function(x,y){x=+x,y=+y;if(this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1;this._x3=x,this._y3=y;break;case 1:this._point=2;this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3;this._x5=x,this._y5=y;break;default:Object(__WEBPACK_IMPORTED_MODULE_2__catmullRom__["b"])(this,x,y);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=x;this._y0=this._y1,this._y1=this._y2,this._y2=y}};__webpack_exports__["a"]=function custom(alpha){function catmullRom(context){return alpha?new CatmullRomClosed(context,alpha):new __WEBPACK_IMPORTED_MODULE_0__cardinalClosed__["a"](context,0)}catmullRom.alpha=function(alpha){return custom(+alpha)};return catmullRom}(.5)},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__cardinalOpen__=__webpack_require__(431);var __WEBPACK_IMPORTED_MODULE_1__catmullRom__=__webpack_require__(194);function CatmullRomOpen(context,alpha){this._context=context;this._alpha=alpha}CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN;this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){if(this._line||this._line!==0&&this._point===3)this._context.closePath();this._line=1-this._line},point:function(x,y){x=+x,y=+y;if(this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Object(__WEBPACK_IMPORTED_MODULE_1__catmullRom__["b"])(this,x,y);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a;this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a;this._x0=this._x1,this._x1=this._x2,this._x2=x;this._y0=this._y1,this._y1=this._y2,this._y2=y}};__webpack_exports__["a"]=function custom(alpha){function catmullRom(context){return alpha?new CatmullRomOpen(context,alpha):new __WEBPACK_IMPORTED_MODULE_0__cardinalOpen__["a"](context,0)}catmullRom.alpha=function(alpha){return custom(+alpha)};return catmullRom}(.5)},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__noop__=__webpack_require__(179);function LinearClosed(context){this._context=context}LinearClosed.prototype={areaStart:__WEBPACK_IMPORTED_MODULE_0__noop__["a"],areaEnd:__WEBPACK_IMPORTED_MODULE_0__noop__["a"],lineStart:function(){this._point=0},lineEnd:function(){if(this._point)this._context.closePath()},point:function(x,y){x=+x,y=+y;if(this._point)this._context.lineTo(x,y);else this._point=1,this._context.moveTo(x,y)}};__webpack_exports__["a"]=function(context){return new LinearClosed(context)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=monotoneX;__webpack_exports__["b"]=monotoneY;function sign(x){return x<0?-1:1}function slope3(that,x2,y2){var h0=that._x1-that._x0,h1=x2-that._x1,s0=(that._y1-that._y0)/(h0||h1<0&&-0),s1=(y2-that._y1)/(h1||h0<0&&-0),p=(s0*h1+s1*h0)/(h0+h1);return(sign(s0)+sign(s1))*Math.min(Math.abs(s0),Math.abs(s1),.5*Math.abs(p))||0}function slope2(that,t){var h=that._x1-that._x0;return h?(3*(that._y1-that._y0)/h-t)/2:t}function point(that,t0,t1){var x0=that._x0,y0=that._y0,x1=that._x1,y1=that._y1,dx=(x1-x0)/3;that._context.bezierCurveTo(x0+dx,y0+dx*t0,x1-dx,y1-dx*t1,x1,y1)}function MonotoneX(context){this._context=context}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN;this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point(this,this._t0,slope2(this,this._t0));break}if(this._line||this._line!==0&&this._point===1)this._context.closePath();this._line=1-this._line},point:function(x,y){var t1=NaN;x=+x,y=+y;if(x===this._x1&&y===this._y1)return;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3;point(this,slope2(this,t1=slope3(this,x,y)),t1);break;default:point(this,this._t0,t1=slope3(this,x,y));break}this._x0=this._x1,this._x1=x;this._y0=this._y1,this._y1=y;this._t0=t1}};function MonotoneY(context){this._context=new ReflectContext(context)}(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(x,y){MonotoneX.prototype.point.call(this,y,x)};function ReflectContext(context){this._context=context}ReflectContext.prototype={moveTo:function(x,y){this._context.moveTo(y,x)},closePath:function(){this._context.closePath()},lineTo:function(x,y){this._context.lineTo(y,x)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._context.bezierCurveTo(y1,x1,y2,x2,y,x)}};function monotoneX(context){return new MonotoneX(context)}function monotoneY(context){return new MonotoneY(context)}},function(module,__webpack_exports__,__webpack_require__){"use strict";function Natural(context){this._context=context}Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[];this._y=[]},lineEnd:function(){var x=this._x,y=this._y,n=x.length;if(n){this._line?this._context.lineTo(x[0],y[0]):this._context.moveTo(x[0],y[0]);if(n===2){this._context.lineTo(x[1],y[1])}else{var px=controlPoints(x),py=controlPoints(y);for(var i0=0,i1=1;i1<n;++i0,++i1){this._context.bezierCurveTo(px[0][i0],py[0][i0],px[1][i0],py[1][i0],x[i1],y[i1])}}}if(this._line||this._line!==0&&n===1)this._context.closePath();this._line=1-this._line;this._x=this._y=null},point:function(x,y){this._x.push(+x);this._y.push(+y)}};function controlPoints(x){var i,n=x.length-1,m,a=new Array(n),b=new Array(n),r=new Array(n);a[0]=0,b[0]=2,r[0]=x[0]+2*x[1];for(i=1;i<n-1;++i)a[i]=1,b[i]=4,r[i]=4*x[i]+2*x[i+1];a[n-1]=2,b[n-1]=7,r[n-1]=8*x[n-1]+x[n];for(i=1;i<n;++i)m=a[i]/b[i-1],b[i]-=m,r[i]-=m*r[i-1];a[n-1]=r[n-1]/b[n-1];for(i=n-2;i>=0;--i)a[i]=(r[i]-a[i+1])/b[i];b[n-1]=(x[n]+a[n-1])/2;for(i=0;i<n-1;++i)b[i]=2*x[i+1]-a[i+1];return[a,b]}__webpack_exports__["a"]=function(context){return new Natural(context)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["c"]=stepBefore;__webpack_exports__["b"]=stepAfter;function Step(context,t){this._context=context;this._t=t}Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN;this._point=0},lineEnd:function(){if(0<this._t&&this._t<1&&this._point===2)this._context.lineTo(this._x,this._y);if(this._line||this._line!==0&&this._point===1)this._context.closePath();if(this._line>=0)this._t=1-this._t,this._line=1-this._line},point:function(x,y){x=+x,y=+y;switch(this._point){case 0:this._point=1;this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:{if(this._t<=0){this._context.lineTo(this._x,y);this._context.lineTo(x,y)}else{var x1=this._x*(1-this._t)+x*this._t;this._context.lineTo(x1,this._y);this._context.lineTo(x1,y)}break}}this._x=x,this._y=y}};__webpack_exports__["a"]=function(context){return new Step(context,.5)};function stepBefore(context){return new Step(context,0)}function stepAfter(context){return new Step(context,1)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__array__=__webpack_require__(422);var __WEBPACK_IMPORTED_MODULE_1__constant__=__webpack_require__(74);var __WEBPACK_IMPORTED_MODULE_2__offset_none__=__webpack_require__(114);var __WEBPACK_IMPORTED_MODULE_3__order_none__=__webpack_require__(115);function stackValue(d,key){return d[key]}__webpack_exports__["a"]=function(){var keys=Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])([]),order=__WEBPACK_IMPORTED_MODULE_3__order_none__["a"],offset=__WEBPACK_IMPORTED_MODULE_2__offset_none__["a"],value=stackValue;function stack(data){var kz=keys.apply(this,arguments),i,m=data.length,n=kz.length,sz=new Array(n),oz;for(i=0;i<n;++i){for(var ki=kz[i],si=sz[i]=new Array(m),j=0,sij;j<m;++j){si[j]=sij=[0,+value(data[j],ki,j,data)];sij.data=data[j]}si.key=ki}for(i=0,oz=order(sz);i<n;++i){sz[oz[i]].index=i}offset(sz,oz);return sz}stack.keys=function(_){return arguments.length?(keys=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(__WEBPACK_IMPORTED_MODULE_0__array__["a"].call(_)),stack):keys};stack.value=function(_){return arguments.length?(value=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(+_),stack):value};stack.order=function(_){return arguments.length?(order=_==null?__WEBPACK_IMPORTED_MODULE_3__order_none__["a"]:typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_1__constant__["a"])(__WEBPACK_IMPORTED_MODULE_0__array__["a"].call(_)),stack):order};stack.offset=function(_){return arguments.length?(offset=_==null?__WEBPACK_IMPORTED_MODULE_2__offset_none__["a"]:_,stack):offset};return stack}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__none__=__webpack_require__(114);__webpack_exports__["a"]=function(series,order){if(!((n=series.length)>0))return;for(var i,n,j=0,m=series[0].length,y;j<m;++j){for(y=i=0;i<n;++i)y+=series[i][j][1]||0;if(y)for(i=0;i<n;++i)series[i][j][1]/=y}Object(__WEBPACK_IMPORTED_MODULE_0__none__["a"])(series,order)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(series,order){if(!((n=series.length)>1))return;for(var i,j=0,d,dy,yp,yn,n,m=series[order[0]].length;j<m;++j){for(yp=yn=0,i=0;i<n;++i){if((dy=(d=series[order[i]][j])[1]-d[0])>=0){d[0]=yp,d[1]=yp+=dy}else if(dy<0){d[1]=yn,d[0]=yn+=dy}else{d[0]=yp}}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__none__=__webpack_require__(114);__webpack_exports__["a"]=function(series,order){if(!((n=series.length)>0))return;for(var j=0,s0=series[order[0]],n,m=s0.length;j<m;++j){for(var i=0,y=0;i<n;++i)y+=series[i][j][1]||0;s0[j][1]+=s0[j][0]=-y/2}Object(__WEBPACK_IMPORTED_MODULE_0__none__["a"])(series,order)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__none__=__webpack_require__(114);__webpack_exports__["a"]=function(series,order){if(!((n=series.length)>0)||!((m=(s0=series[order[0]]).length)>0))return;for(var y=0,j=1,s0,m,n;j<m;++j){for(var i=0,s1=0,s2=0;i<n;++i){var si=series[order[i]],sij0=si[j][1]||0,sij1=si[j-1][1]||0,s3=(sij0-sij1)/2;for(var k=0;k<i;++k){var sk=series[order[k]],skj0=sk[j][1]||0,skj1=sk[j-1][1]||0;s3+=skj0-skj1}s1+=sij0,s2+=s3*sij0}s0[j-1][1]+=s0[j-1][0]=y;if(s1)y-=s2/s1}s0[j-1][1]+=s0[j-1][0]=y;Object(__WEBPACK_IMPORTED_MODULE_0__none__["a"])(series,order)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__ascending__=__webpack_require__(195);__webpack_exports__["a"]=function(series){return Object(__WEBPACK_IMPORTED_MODULE_0__ascending__["a"])(series).reverse()}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__none__=__webpack_require__(115);var __WEBPACK_IMPORTED_MODULE_1__ascending__=__webpack_require__(195);__webpack_exports__["a"]=function(series){var n=series.length,i,j,sums=series.map(__WEBPACK_IMPORTED_MODULE_1__ascending__["b"]),order=Object(__WEBPACK_IMPORTED_MODULE_0__none__["a"])(series).sort(function(a,b){return sums[b]-sums[a]}),top=0,bottom=0,tops=[],bottoms=[];for(i=0;i<n;++i){j=order[i];if(top<bottom){top+=sums[j];tops.push(j)}else{bottom+=sums[j];bottoms.push(j)}}return bottoms.reverse().concat(tops)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__none__=__webpack_require__(115);__webpack_exports__["a"]=function(series){return Object(__WEBPACK_IMPORTED_MODULE_0__none__["a"])(series).reverse()}},function(module,exports,__webpack_require__){var content=__webpack_require__(573);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./chart-line.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./chart-line.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".chart-line{pointer-events:none}.chart-line .area{stroke:none;fill:rgba(30,163,230,0.14);fill-opacity:.9}.chart-line .line{fill:none;stroke:#1ea3e6;stroke-width:1.6px}.chart-line .singleton{fill:#1ea3e6;stroke:none}.chart-line .hover{fill:#fff;stroke:#1ea3e6;stroke-width:2}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var immutable_ui_1=__webpack_require__(104);var classNames=__webpack_require__(4);var React=__webpack_require__(1);__webpack_require__(580);var ClusterSourcePicker=function(_super){tslib_1.__extends(ClusterSourcePicker,_super);function ClusterSourcePicker(){var _this=_super.call(this)||this;_this.state={};return _this}ClusterSourcePicker.prototype.onClusterSourceChange=function(newSource){var _a=this.props,onChange=_a.onChange,dataCube=_a.dataCube;var newDataCube=dataCube.change("clusterName",newSource.clusterName).change("source",newSource.source);onChange(newDataCube)};ClusterSourcePicker.prototype.initFromProps=function(props){var dataCube=props.dataCube;if(dataCube){this.setState({fileMode:dataCube.clusterName==="native"});this.originalSource=this.originalSource||dataCube.source;this.originalClusterName=this.originalClusterName||dataCube.clusterName}};ClusterSourcePicker.prototype.componentWillMount=function(){this.initFromProps(this.props)};ClusterSourcePicker.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};ClusterSourcePicker.prototype.getClusterSource=function(){var _a=this.props,dataCube=_a.dataCube,clusterSources=_a.clusterSources;if(!dataCube||!dataCube.clusterName)return null;var clusterName=dataCube.clusterName,source=dataCube.source;return clusterSources.find(function(cs){return cs.clusterName===clusterName&&cs.source===source})||{clusterName:clusterName,source:source}};ClusterSourcePicker.prototype.toggleMode=function(){var fileMode=this.state.fileMode;this.onClusterSourceChange({clusterName:fileMode?this.originalClusterName:"native",source:this.originalSource})};ClusterSourcePicker.prototype.onFileChange=function(newInstance,valid){this.props.onChange(newInstance,valid)};ClusterSourcePicker.prototype.onKeyDown=function(event){if(event.metaKey&&event.shiftKey&&event.keyCode===70){this.toggleMode();event.preventDefault()}};ClusterSourcePicker.prototype.render=function(){var _a=this.props,clusterSources=_a.clusterSources,dataCube=_a.dataCube,className=_a.className;var fileMode=this.state.fileMode;if(!clusterSources||!dataCube)return null;var MyDropdown=caladan_1.Dropdown.specialize();var fileNameValidator=function(path){return!!path};return React.createElement("div",{className:classNames("cluster-source-picker",className)},React.createElement(caladan_1.GlobalEventListener,{keyDown:this.onKeyDown.bind(this)}),fileMode?React.createElement(immutable_ui_1.ImmutableTextInput,{instance:dataCube,path:"source",className:"source actionable",onChange:this.onFileChange.bind(this),validator:fileNameValidator}):React.createElement(MyDropdown,{items:clusterSources,selectedItem:this.getClusterSource(),equal:function(a,b){return a&&b&&a.clusterName===b.clusterName&&a.source===b.source},renderItem:function(cs){return cs?(cs.clusterTitle||cs.clusterName)+": "+cs.source:""},keyItem:function(cs){return cs?cs.clusterName+"_"+cs.source:""},onSelect:this.onClusterSourceChange.bind(this)}))};return ClusterSourcePicker}(React.Component);exports.ClusterSourcePicker=ClusterSourcePicker},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var immutable_utils_1=__webpack_require__(182);var ImmutableCheckbox=function(_super){tslib_1.__extends(ImmutableCheckbox,_super);function ImmutableCheckbox(){return _super.call(this)||this}ImmutableCheckbox.simpleGenerator=function(instance,changeFn,labels,errors){return function(name){var myLabels=immutable_utils_1.getLabel(name,labels);return React.createElement(ImmutableCheckbox,{instance:instance,path:name,onChange:changeFn,label:myLabels.label,helpTitle:myLabels.label,helpText:myLabels.description,errorText:errors[name]})}};ImmutableCheckbox.prototype.onClick=function(){var _a=this.props,instance=_a.instance,path=_a.path,onChange=_a.onChange;var oldValue=immutable_utils_1.getProperty(instance,path);onChange(immutable_utils_1.setProperty(instance,path,!oldValue),true,path,undefined)};ImmutableCheckbox.prototype.onFocus=function(){var _a=this.props,path=_a.path,helpTitle=_a.helpTitle,helpText=_a.helpText,errorText=_a.errorText;caladan_1.InfoManager.show({sourceId:path,title:helpTitle,lines:[helpText,errorText].filter(Boolean),type:errorText?"error":"info"})};ImmutableCheckbox.prototype.onBlur=function(){caladan_1.InfoManager.hide(this.props.path)};ImmutableCheckbox.prototype.render=function(){var _a=this.props,label=_a.label,instance=_a.instance,path=_a.path,helpText=_a.helpText,showHelpOnFocus=_a.showHelpOnFocus;var isSelected=immutable_utils_1.getProperty(instance,path);return React.createElement(caladan_1.Checkbox,{onClick:this.onClick.bind(this),label:label,selected:isSelected,onFocus:showHelpOnFocus?this.onFocus.bind(this):null,onBlur:showHelpOnFocus?this.onBlur.bind(this):null})};return ImmutableCheckbox}(React.Component);exports.ImmutableCheckbox=ImmutableCheckbox},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var immutable_class_1=__webpack_require__(7);var React=__webpack_require__(1);var classNames=__webpack_require__(4);var immutable_utils_1=__webpack_require__(182);var ImmutableDropdown=function(_super){tslib_1.__extends(ImmutableDropdown,_super);function ImmutableDropdown(){return _super.call(this)||this}ImmutableDropdown.specialize=function(){return ImmutableDropdown};ImmutableDropdown.simpleGenerator=function(instance,changeFn,labels,errors){return function(name,items,focusOnStartUp){if(focusOnStartUp===void 0){focusOnStartUp=false}var MyDropdown=ImmutableDropdown.specialize();var myLabels=immutable_utils_1.getLabel(name,labels);return React.createElement(MyDropdown,{key:"dropdown-"+name,items:items,instance:instance,path:name,equal:immutable_class_1.generalEqual,renderItem:function(a){return a?a.label:""},keyItem:function(a){return a.value||"default_value"},itemToValue:function(a){return a?a.value:""},onChange:changeFn,focusOnStartUp:focusOnStartUp,helpTitle:myLabels.label,helpText:myLabels.description,errorText:errors[name]})}};ImmutableDropdown.prototype.onChange=function(newSelectedItem){var _a=this.props,instance=_a.instance,path=_a.path,onChange=_a.onChange,itemToValue=_a.itemToValue;onChange(immutable_utils_1.setProperty(instance,path,itemToValue(newSelectedItem)),true,path,undefined)};ImmutableDropdown.prototype.onFocus=function(){var _a=this.props,showHelpOnFocus=_a.showHelpOnFocus,path=_a.path,helpTitle=_a.helpTitle,helpText=_a.helpText,errorText=_a.errorText;if(showHelpOnFocus){caladan_1.InfoManager.show({sourceId:path,title:helpTitle,lines:[helpText,errorText].filter(Boolean),type:errorText?"error":"info"})}};ImmutableDropdown.prototype.onBlur=function(){if(this.props.showHelpOnFocus)caladan_1.InfoManager.hide(this.props.path)};ImmutableDropdown.prototype.render=function(){var _a=this.props,label=_a.label,items=_a.items,equal=_a.equal,renderItem=_a.renderItem,keyItem=_a.keyItem,itemToValue=_a.itemToValue,instance=_a.instance,path=_a.path,focusOnStartUp=_a.focusOnStartUp,disabled=_a.disabled,showHelpOnFocus=_a.showHelpOnFocus;var MyDropdown=caladan_1.Dropdown.specialize();var selectedValue=immutable_utils_1.getProperty(instance,path);var selectedItem=immutable_class_1.SimpleArray.find(items,function(item){return equal(itemToValue(item),selectedValue)});return React.createElement(MyDropdown,{className:classNames("immutable-dropdown","input",path,{disabled:disabled}),label:label,items:items,selectedItem:selectedItem,equal:function(a,b){return equal(itemToValue(a),itemToValue(b))},renderItem:renderItem,keyItem:keyItem,onSelect:this.onChange.bind(this),focusOnStartUp:focusOnStartUp,onFocus:showHelpOnFocus?this.onFocus.bind(this):null,onBlur:showHelpOnFocus?this.onBlur.bind(this):null})};return ImmutableDropdown}(React.Component);exports.ImmutableDropdown=ImmutableDropdown},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ImmutableFormDelegate=function(){function ImmutableFormDelegate(form){this.form=form;if(!this.form.state)this.form.state={};this.form.state.canSave=false;this.form.state.errors={};this.onChange=this.onChange.bind(this);this.updateErrors=this.updateErrors.bind(this);this.callbacks={}}ImmutableFormDelegate.prototype.on=function(path,callback){var listeners=this.callbacks[path]||[];listeners.push(callback);this.callbacks[path]=listeners};ImmutableFormDelegate.prototype.onAnyChange=function(callback){this.on("*",callback)};ImmutableFormDelegate.prototype.setState=function(state,callback){return this.form.setState.call(this.form,state,callback)};ImmutableFormDelegate.prototype.updateErrors=function(path,isValid,error){var errors=this.form.state.errors;errors[path]=isValid?false:error;var canSave=true;for(var key in errors)canSave=canSave&&errors[key]===false;return{errors:errors,canSave:canSave}};ImmutableFormDelegate.prototype.onChange=function(newItem,isValid,path,error){var _a=this.updateErrors(path,isValid,error),errors=_a.errors,canSave=_a.canSave;if(isValid){this.setState({errors:errors,newInstance:newItem,canSave:canSave},this.callListeners.bind(this,newItem,isValid,path,error))}else{this.setState({errors:errors,canSave:false},this.callListeners.bind(this,newItem,isValid,path,error))}};ImmutableFormDelegate.prototype.callListeners=function(newItem,isValid,path,error){var specificListeners=this.callbacks[path]||[];var wildCardListeners=this.callbacks["*"]||[];var listeners=specificListeners.concat(wildCardListeners);listeners.forEach(function(l){return l(newItem,isValid,path,error)})};return ImmutableFormDelegate}();exports.ImmutableFormDelegate=ImmutableFormDelegate},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var immutable_class_1=__webpack_require__(7);var React=__webpack_require__(1);function isPromiseAlike(thing){return Boolean(thing&&typeof thing.then==="function")}var ImmutableList=function(_super){tslib_1.__extends(ImmutableList,_super);function ImmutableList(){var _this=_super.call(this)||this;_this.state={};return _this}ImmutableList.specialize=function(){return ImmutableList};ImmutableList.prototype.editItem=function(index){this.setState({editedIndex:index})};ImmutableList.prototype.addItem=function(){this.setState({pendingAddItem:this.props.getNewItem()})};ImmutableList.prototype.componentWillReceiveProps=function(nextProps){if(nextProps.items){this.setState({tempItems:nextProps.items})}};ImmutableList.prototype.componentDidMount=function(){if(this.props.items){this.setState({tempItems:this.props.items})}};ImmutableList.prototype.deleteItems=function(indices){var tempItems=this.state.tempItems;this.setState({tempItems:tempItems.filter(function(item,i){return indices.indexOf(i)===-1})},this.onChange)};ImmutableList.prototype.onReorder=function(newIndices){var groupField=this.props.groupField;var tempItems=this.state.tempItems;var newTempItems=[];newIndices.forEach(function(_a,i){var group=_a.group,index=_a.index;var item=tempItems[index];if(groupField)item=item.change(groupField,group);newTempItems[i]=item});this.setState({tempItems:newTempItems},this.onChange)};ImmutableList.prototype.onGroupRename=function(oldName,newName,indices){var groupField=this.props.groupField;var tempItems=this.state.tempItems;indices.forEach(function(i){var item=tempItems[i];if(groupField)item=item.change(groupField,newName);tempItems[i]=item});this.setState({tempItems:tempItems},this.onChange)};ImmutableList.prototype.onChange=function(){var _this=this;var onChange=this.props.onChange;var tempItems=this.state.tempItems;var result=onChange(tempItems);if(isPromiseAlike(result)){this.setState({loadingChange:true});result.then(function(res){_this.setState({editedIndex:undefined,pendingAddItem:null,loadingChange:false})}).catch(function(error){_this.setState({loadingChange:false,changeError:error})})}else{this.setState({editedIndex:undefined,pendingAddItem:null})}};ImmutableList.prototype.onSearchChange=function(value){this.setState({searchString:value?value.toLowerCase():value})};ImmutableList.prototype.renderEditModal=function(itemIndex){var _this=this;var _a=this.state,tempItems=_a.tempItems,loadingChange=_a.loadingChange,changeError=_a.changeError;var item=tempItems[itemIndex];var onSave=function(newItem){var newItems=immutable_class_1.SimpleArray.change(tempItems,itemIndex,newItem);_this.setState({tempItems:newItems},_this.onChange)};var onClose=function(){return _this.setState({editedIndex:undefined})};return React.cloneElement(this.props.getModal(item),{onSave:onSave,onClose:onClose,mode:"edit",loading:loadingChange,error:changeError})};ImmutableList.prototype.renderAddModal=function(item){var _this=this;var preAddHook=this.props.preAddHook;var _a=this.state,loadingChange=_a.loadingChange,tempItems=_a.tempItems,changeError=_a.changeError;var onSave=function(newItem){var newItems=immutable_class_1.SimpleArray.append(tempItems,preAddHook?preAddHook(newItem):newItem);_this.setState({tempItems:newItems},_this.onChange)};var onSaveMany=function(newItems){_this.setState({tempItems:tempItems.concat(newItems)},_this.onChange)};var onClose=function(){return _this.setState({pendingAddItem:null})};return React.cloneElement(this.props.getModal(item),{onSave:onSave,onSaveMany:onSaveMany,onClose:onClose,mode:"create",loading:loadingChange,error:changeError})};ImmutableList.prototype.renderEmptyList=function(){var _a=this.props,label=_a.label,icon=_a.icon;return React.createElement("div",{className:"empty-container"},React.createElement("div",{className:"empty-message"},React.createElement("div",{className:"title"},icon?React.createElement("div",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:icon})):null,React.createElement("div",{className:"label"},"No ",label))))};ImmutableList.prototype.renderEmptySearchResults=function(){var searchString=this.state.searchString;return React.createElement("div",{className:"empty-container"},React.createElement("div",{className:"empty-message no-search-results"},React.createElement("div",{className:"label"},"No results for ",searchString)))};ImmutableList.prototype.renderList=function(){var _this=this;var _a=this.props,items=_a.items,getRows=_a.getRows,disableReordering=_a.disableReordering,groupField=_a.groupField,actions=_a.actions;var searchString=this.state.searchString;if(items.length===0){return this.renderEmptyList()}var originalRows=getRows(items);if(groupField){originalRows.forEach(function(r,i){return r.group=items[i][groupField]})}var filteredRows=originalRows;if(searchString){filteredRows=filteredRows.filter(function(row){return row.title.toLowerCase().indexOf(searchString)>-1});if(filteredRows.length===0)return this.renderEmptySearchResults()}var edit={callback:function(indices){return _this.editItem(originalRows.indexOf(filteredRows[indices[0]]))}};if(actions&&actions.edit)edit=Object.assign(edit,actions.edit);var remove={callback:function(indices){return _this.deleteItems(indices.map(function(index){return originalRows.indexOf(filteredRows[index])}))}};if(actions&&actions.remove)remove=Object.assign(remove,actions.remove);return React.createElement(caladan_1.SimpleList,{rows:filteredRows,actions:{edit:edit,remove:remove},onReorder:disableReordering||!!searchString?null:this.onReorder.bind(this),onGroupRename:disableReordering||!groupField||!!searchString?null:this.onGroupRename.bind(this)})};ImmutableList.prototype.renderActions=function(){var getCustomActions=this.props.getCustomActions;if(getCustomActions){return React.createElement("div",{className:"actions"},getCustomActions(this.addItem.bind(this)))}return React.createElement("div",{className:"actions"},React.createElement(caladan_1.SearchButton,{onChange:this.onSearchChange.bind(this)}),React.createElement(caladan_1.Button,{type:"secondary",onClick:this.addItem.bind(this),title:"Add"}))};ImmutableList.prototype.render=function(){var _a=this.props,items=_a.items,label=_a.label,className=_a.className;var _b=this.state,editedIndex=_b.editedIndex,pendingAddItem=_b.pendingAddItem;if(!items)return null;return React.createElement("div",{className:classNames("immutable-list",className)},React.createElement("div",{className:"list-title"},React.createElement("div",{className:"label"},label),this.renderActions()),this.renderList(),editedIndex!=null?this.renderEditModal(editedIndex):null,pendingAddItem?this.renderAddModal(pendingAddItem):null)};return ImmutableList}(React.Component);exports.ImmutableList=ImmutableList},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var immutable_utils_1=__webpack_require__(182);var simpleStringToValue=function(str){return String(str)};var simpleValueToString=function(value){return value?String(value):""};var ImmutableTextInput=function(_super){tslib_1.__extends(ImmutableTextInput,_super);function ImmutableTextInput(){var _this=_super.call(this)||this;_this.hasFocus=false;_this.focusTarget=null;_this.focusAlreadyGiven=false;_this.wasInError=false;_this.triggeredInfoBubble=false;_this.state={};return _this}ImmutableTextInput.simpleGenerator=function(instance,changeFn,labels,errors){return function(name,validator,focusOnStartUp,converters,restrictor,type){if(focusOnStartUp===void 0){focusOnStartUp=false}if(!validator)validator=/^.*$/;if(!converters){converters={stringToValue:simpleStringToValue,valueToString:simpleValueToString}}var myLabels=immutable_utils_1.getLabel(name,labels);return React.createElement(ImmutableTextInput,{key:"input-"+name,instance:instance,path:name,className:name,onChange:changeFn,focusOnStartUp:focusOnStartUp,validator:validator,converters:converters,restrictor:restrictor,infoId:name,helpTitle:myLabels.label,helpText:myLabels.description,errorText:errors[name],type:type})}};ImmutableTextInput.prototype.initFromProps=function(props){if(!props.instance||!props.path)return;var validString;var _a=props.converters,valueToString=_a.valueToString,stringToValue=_a.stringToValue;if(this.state.validString===undefined){validString=valueToString(immutable_utils_1.getProperty(props.instance,props.path))}else{var currentCanonical=valueToString(stringToValue(this.state.validString));var possibleCanonical=valueToString(immutable_utils_1.getProperty(props.instance,props.path));validString=currentCanonical===possibleCanonical?this.state.validString:possibleCanonical}this.setState({myInstance:props.instance,invalidString:undefined,validString:validString})};ImmutableTextInput.prototype.reset=function(callback){this.setState({invalidString:undefined,validString:undefined},callback)};ImmutableTextInput.prototype.componentWillReceiveProps=function(nextProps){var _this=this;if(this.isInfoVisible()||nextProps.errorText){this.updateVisibleHelpText({title:nextProps.helpTitle,infoId:nextProps.path,helpText:nextProps.helpText,errorText:nextProps.errorText})}if(nextProps.instance===undefined){this.reset(function(){return _this.initFromProps(nextProps)});return}if(this.state.invalidString===undefined&&nextProps.instance!==this.state.myInstance){this.initFromProps(nextProps)}};ImmutableTextInput.prototype.componentDidUpdate=function(){this.maybeFocus()};ImmutableTextInput.prototype.componentDidMount=function(){this.initFromProps(this.props);this.maybeFocus()};ImmutableTextInput.prototype.maybeFocus=function(){if(!this.focusAlreadyGiven&&this.props.focusOnStartUp&&this.focusTarget){ReactDOM.findDOMNode(this.focusTarget).select();this.focusAlreadyGiven=true}};ImmutableTextInput.prototype.isValueValid=function(value){var validator=this.props.validator;if(!validator)return true;if(validator instanceof RegExp){return validator.test(value)}if(validator instanceof Function){return!!validator(value)}return true};ImmutableTextInput.prototype.update=function(newString){var _a=this.props,path=_a.path,onChange=_a.onChange,instance=_a.instance,validator=_a.validator,onInvalid=_a.onInvalid,converters=_a.converters,restrictor=_a.restrictor;if(restrictor)newString=restrictor(newString);var myInstance;var invalidString;var validString;var error="";var newValue;try{newValue=converters.stringToValue(newString);if(validator&&!this.isValueValid(newString)){myInstance=instance;invalidString=newString;if(onInvalid)onInvalid(newValue)}else{myInstance=immutable_utils_1.setProperty(instance,path,newValue);validString=newString}}catch(e){myInstance=instance;invalidString=newString;error=e.message;if(onInvalid)onInvalid(newValue)}this.setState({myInstance:myInstance,invalidString:invalidString,validString:validString},function(){if(onChange)onChange(myInstance,invalidString===undefined,path,error)})};ImmutableTextInput.prototype.onChange=function(event){this.update(event.target.value)};ImmutableTextInput.prototype.isInfoVisible=function(){return caladan_1.InfoManager.currentInfo&&caladan_1.InfoManager.currentInfo.sourceId===this.props.infoId};ImmutableTextInput.prototype.updateVisibleHelpText=function(info){var showHelpOnFocus=this.props.showHelpOnFocus;var infoId=info.infoId,title=info.title,errorText=info.errorText,helpText=info.helpText;if(!infoId||!this.hasFocus)return;var inError=!!errorText;if(!showHelpOnFocus&&!inError&&this.wasInError&&this.triggeredInfoBubble){caladan_1.InfoManager.hide(infoId);return}this.wasInError=inError;this.triggeredInfoBubble=!this.isInfoVisible();caladan_1.InfoManager.show({sourceId:infoId,title:title,lines:[helpText,errorText].filter(Boolean),type:inError?"error":"info"})};ImmutableTextInput.prototype.onFocus=function(){var _a=this.props,helpTitle=_a.helpTitle,infoId=_a.infoId,helpText=_a.helpText,errorText=_a.errorText,showHelpOnFocus=_a.showHelpOnFocus;this.hasFocus=true;if(showHelpOnFocus)this.updateVisibleHelpText({title:helpTitle,infoId:infoId,helpText:helpText,errorText:errorText})};ImmutableTextInput.prototype.onBlur=function(){var _a=this.props,infoId=_a.infoId,showHelpOnFocus=_a.showHelpOnFocus;this.hasFocus=false;if(showHelpOnFocus)caladan_1.InfoManager.hide(infoId)};ImmutableTextInput.prototype.render=function(){var _this=this;var _a=this.props,path=_a.path,type=_a.type,className=_a.className;var _b=this.state,myInstance=_b.myInstance,invalidString=_b.invalidString,validString=_b.validString,showingPass=_b.showingPass;var isInvalid=invalidString!==undefined;if(!path||!myInstance)return null;var value=(isInvalid?invalidString:validString)||"";if(type==="textarea"){return React.createElement("textarea",{key:"input-"+path,className:classNames("immutable-text-input",className,{error:isInvalid}),ref:function(c){return _this.focusTarget=c},type:"text",value:value,onChange:this.onChange.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)})}var getInputType=function(){if(type==="password"||type==="toggleablePass"&&!showingPass)return"password";return"text"};var input=React.createElement("input",{key:"input-"+path,className:classNames("immutable-text-input",className,{error:isInvalid}),ref:function(c){return _this.focusTarget=c},type:getInputType(),value:value,onChange:this.onChange.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)});if(type==="toggleablePass"){var buttonTitle=showingPass?"Mask Password":"Show Password";var toggleShow=function(){return _this.setState({showingPass:!showingPass})};return React.createElement("div",{key:"input-"+path},input,React.createElement("div",{className:"row",onClick:toggleShow},React.createElement(caladan_1.Button,{type:"light-action",title:buttonTitle,onClick:toggleShow})))}return input};ImmutableTextInput.defaultProps={type:"text",converters:{stringToValue:simpleStringToValue,valueToString:simpleValueToString}};return ImmutableTextInput}(React.Component);exports.ImmutableTextInput=ImmutableTextInput},function(module,exports,__webpack_require__){var content=__webpack_require__(581);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./cluster-source-picker.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./cluster-source-picker.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".cluster-source-picker input.source{margin-bottom:0px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(583);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./description-icon.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./description-icon.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".description-icon{cursor:pointer;padding-bottom:10px}.description-icon svg{pointer-events:none;width:19px}.description-icon-menu .info{max-width:100%;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var React=__webpack_require__(1);__webpack_require__(585);var LineLoader=function(_super){tslib_1.__extends(LineLoader,_super);function LineLoader(){return _super.call(this)||this}LineLoader.prototype.render=function(){return React.createElement("div",{className:"line-loader"},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.LINE_LOADER}))};return LineLoader}(React.Component);exports.LineLoader=LineLoader},function(module,exports,__webpack_require__){var content=__webpack_require__(586);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./line-loader.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./line-loader.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".line-loader{position:absolute;top:0;bottom:0;left:0;right:0}.line-loader svg{position:absolute;top:50%;left:50%;width:25px;height:15px;margin-left:-12.5px;margin-top:-7.5px;-webkit-animation-name:loader-appears;animation-name:loader-appears;-webkit-animation-duration:.3s;animation-duration:.3s;-webkit-animation-timing-function:linear;animation-timing-function:linear}.line-loader svg circle{-webkit-animation-name:loader-circle;animation-name:loader-circle;-webkit-animation-duration:0.5s;animation-duration:0.5s;-webkit-animation-timing-function:linear;animation-timing-function:linear;-webkit-animation-iteration-count:infinite;animation-iteration-count:infinite;-webkit-animation-direction:alternate;animation-direction:alternate}@-webkit-keyframes loader-circle{0%{fill-opacity:1}100%{fill-opacity:0.2}}@keyframes loader-circle{0%{fill-opacity:1}100%{fill-opacity:0.2}}@-webkit-keyframes loader-appears{0%{opacity:0}100%{opacity:1}}@keyframes loader-appears{0%{opacity:0}100%{opacity:1}}.line-loader svg circle:nth-child(1){-webkit-animation-delay:-400s;animation-delay:-400s}.line-loader svg circle:nth-child(2){-webkit-animation-delay:-300ms;animation-delay:-300ms}.line-loader svg circle:nth-child(3){-webkit-animation-delay:-100ms;animation-delay:-100ms}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(588);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./dimension-actions-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./dimension-actions-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".dimension-actions-menu{padding:8px}.dimension-actions-menu .action{display:inline-block;width:50px;height:50px;cursor:pointer;text-align:center;color:#1ea3e6;font-size:12px}.dimension-actions-menu .action svg{width:18px;padding-top:7px;padding-bottom:4px;fill:#1ea3e6}.dimension-actions-menu .action:hover::before{content:'';position:absolute;top:3px;bottom:3px;left:3px;right:3px;background:#e3f4fc}.dimension-actions-menu .preview{position:absolute;top:0;bottom:0;left:0;right:0;top:108px;border-top:1px solid #e6e6e6;height:30px;color:#999;text-align:center}.dimension-actions-menu .preview .preview-text{top:9px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var hasOwnProp=__webpack_require__(29);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var plywood_1=__webpack_require__(14);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var constants_1=__webpack_require__(52);var dom_1=__webpack_require__(68);var drag_manager_1=__webpack_require__(110);var dimension_actions_menu_1=__webpack_require__(432);var highlight_string_1=__webpack_require__(105);var searchable_tile_1=__webpack_require__(183);var query_runner_1=__webpack_require__(73);__webpack_require__(594);var DimensionListTile=function(_super){tslib_1.__extends(DimensionListTile,_super);function DimensionListTile(){var _this=_super.call(this)||this;_this.state={menuOpenOn:null,menuDimension:null,highlightDimension:null,showSearch:false,searchText:"",openGroups:{}};return _this}DimensionListTile.prototype.fetchData=function(essence,timekeeper){var _this=this;if(!window.grayOutTrivial)return;var dimensions=essence.getDimensions();var filter=essence.getSpecificFilterWithHighlight(timekeeper);var $main=plywood_1.$("main");var query=plywood_1.ply().apply("main",$main.filter(filter.toExpression(dimensions)));for(var _i=0,dimensions_1=dimensions;_i<dimensions_1.length;_i++){var dimension=dimensions_1[_i];if(dimension.isContinuous()){query=query.apply("_min_"+dimension.name,$main.min(dimension.expression)).apply("_max_"+dimension.name,$main.max(dimension.expression))}else{query=query.apply(dimension.name,$main.countDistinct(dimension.expression))}}query_runner_1.QueryRunner.fetch("dimension-list-tile",essence.dataCube,essence.instance,query,essence.timezone).then(function(dataset){if(!_this.mounted)return;_this.setState({cardinalities:dataset.data[0]})},function(error){if(error.canceled)return;if(!_this.mounted)return;_this.setState({cardinalities:null})})};DimensionListTile.prototype.componentWillMount=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;this.fetchData(essence,timekeeper)};DimensionListTile.prototype.componentWillReceiveProps=function(nextProps){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;var nextEssence=nextProps.essence;var nextTimekeeper=nextProps.timekeeper;if(essence.differentDataCube(nextEssence)||essence.differentSpecificFilterWithHighlight(nextEssence,timekeeper,nextTimekeeper)){this.fetchData(nextEssence,nextTimekeeper)}};DimensionListTile.prototype.componentDidMount=function(){this.mounted=true};DimensionListTile.prototype.componentWillUnmount=function(){this.mounted=false};DimensionListTile.prototype.clickDimension=function(dimension,e){var menuOpenOn=this.state.menuOpenOn;var target=dom_1.findParentWithClass(e.target,"dimension");if(menuOpenOn===target){this.closeMenu();return}this.setState({menuOpenOn:target,menuDimension:dimension})};DimensionListTile.prototype.closeMenu=function(){var menuOpenOn=this.state.menuOpenOn;if(!menuOpenOn)return;this.setState({menuOpenOn:null,menuDimension:null})};DimensionListTile.prototype.dragStart=function(dimension,e){var _a=this.props,essence=_a.essence,getLongUrl=_a.getLongUrl;var filter=essence.getEffectiveFilter();var dataTransfer=e.dataTransfer;dataTransfer.effectAllowed="all";if(getLongUrl){var newSplit=models_1.SplitCombine.fromDimensionAndFilterAndMeasure(dimension,filter,essence.getSortMeasure());essence=essence.addSplit(newSplit);var newUrl=getLongUrl(essence);dataTransfer.setData("text/url-list",newUrl);dataTransfer.setData("text/plain",newUrl)}drag_manager_1.DragManager.setDragDimension(dimension,"dimension-list-tile");beltful_1.DOMUtils.setDragGhost(dataTransfer,dimension.title);this.closeMenu()};DimensionListTile.prototype.onMouseOver=function(dimension){var highlightDimension=this.state.highlightDimension;if(highlightDimension===dimension)return;this.setState({highlightDimension:dimension})};DimensionListTile.prototype.onMouseLeave=function(dimension){var highlightDimension=this.state.highlightDimension;if(highlightDimension!==dimension)return;this.setState({highlightDimension:null})};DimensionListTile.prototype.toggleSearch=function(){var showSearch=this.state.showSearch;this.setState({showSearch:!showSearch});this.onSearchChange("")};DimensionListTile.prototype.onSearchChange=function(text){var searchText=this.state.searchText;var newSearchText=text.substr(0,constants_1.MAX_SEARCH_LENGTH);if(searchText===newSearchText)return;this.setState({searchText:newSearchText})};DimensionListTile.prototype.renderMenu=function(){var _a=this.props,essence=_a.essence,clicker=_a.clicker,triggerFilterMenu=_a.triggerFilterMenu,triggerSplitMenu=_a.triggerSplitMenu,timekeeper=_a.timekeeper;var _b=this.state,menuOpenOn=_b.menuOpenOn,menuDimension=_b.menuDimension;if(!menuDimension)return null;var onClose=this.closeMenu.bind(this);return React.createElement(dimension_actions_menu_1.DimensionActionsMenu,{clicker:clicker,essence:essence,direction:"right",openOn:menuOpenOn,dimension:menuDimension,triggerFilterMenu:triggerFilterMenu,triggerSplitMenu:triggerSplitMenu,onClose:onClose,timekeeper:timekeeper})};DimensionListTile.prototype.isTrivialDimension=function(dimension){var cardinalities=this.state.cardinalities;if(!cardinalities)return false;var dimensionName=dimension.name;if(dimension.isContinuous()){return hasOwnProp(cardinalities,"_min_"+dimensionName)&&hasOwnProp(cardinalities,"_max_"+dimensionName)&&cardinalities["_min_"+dimensionName]===cardinalities["_max_"+dimensionName]}else{return hasOwnProp(cardinalities,dimensionName)&&cardinalities[dimensionName]<2}};DimensionListTile.prototype.renderDimension=function(dimension){var _a=this.state,menuDimension=_a.menuDimension,highlightDimension=_a.highlightDimension,searchText=_a.searchText;var className=classNames("dimension","type-"+dimension.kind,{highlight:dimension===highlightDimension,selected:dimension===menuDimension,trivial:this.isTrivialDimension(dimension)});return React.createElement("div",{className:className,key:dimension.name,onClick:this.clickDimension.bind(this,dimension),onMouseOver:this.onMouseOver.bind(this,dimension),onMouseLeave:this.onMouseLeave.bind(this,dimension),draggable:true,onDragStart:this.dragStart.bind(this,dimension)},React.createElement("div",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:dimension.getIcon()})),React.createElement("div",{className:"item-title"},React.createElement(highlight_string_1.HighlightString,{className:"label",text:dimension.title,highlight:searchText})))};DimensionListTile.prototype.renderDimensionGroup=function(dimensions,forceOpen){var _this=this;var openGroups=this.state.openGroups;var groupName=dimensions[0].group;var isOpen=openGroups[groupName]||forceOpen;var toggle=function(e){openGroups[groupName]=!isOpen;_this.setState({openGroups:openGroups})};var trivial=dimensions.every(function(dimension){return _this.isTrivialDimension(dimension)});var className=classNames("dimension-group",isOpen?"open":"closed",{trivial:trivial});return React.createElement("div",{key:groupName,className:className},React.createElement("div",{className:classNames("group-header",{trivial:trivial}),onClick:toggle},React.createElement("div",{className:"icon group-icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_CARET_BOTTOM})),React.createElement("div",{className:"item-title group-title"},React.createElement("div",{className:"label"},groupName))),React.createElement("div",{className:"group-items"},dimensions.map(this.renderDimension,this)))};DimensionListTile.prototype.getGroupedDimensions=function(dimensions){var items=[];var lastGroup;dimensions.forEach(function(d){if(d.group){if(d.group===lastGroup){items[items.length-1].push(d)}else{lastGroup=d.group;items.push([d])}}else{items.push(d)}});return items};DimensionListTile.prototype.renderDimensions=function(){var _this=this;var essence=this.props.essence;var searchText=this.state.searchText;var shownDimensions=essence.getDimensions();if(searchText){shownDimensions=shownDimensions.filter(function(r){return r.title.toLowerCase().includes(searchText.toLowerCase())})}var items=this.getGroupedDimensions(shownDimensions);var forceOpen=Boolean(searchText);return items.map(function(item){if(Array.isArray(item))return _this.renderDimensionGroup(item,forceOpen);return _this.renderDimension(item)})};DimensionListTile.prototype.render=function(){var style=this.props.style;var _a=this.state,showSearch=_a.showSearch,searchText=_a.searchText;var dimensionItems=this.renderDimensions();var message=null;if(searchText&&!dimensionItems.length){message=React.createElement("div",{className:"message"},"No "+strings_1.STRINGS.dimensions.toLowerCase()+' for "'+searchText+'"')}var icons=[{name:"search",ref:"search",onClick:this.toggleSearch.bind(this),svg:Icons.FULL_SEARCH,active:showSearch}];return React.createElement(searchable_tile_1.SearchableTile,{style:style,title:strings_1.STRINGS.dimensions,toggleChangeFn:this.toggleSearch.bind(this),onSearchChange:this.onSearchChange.bind(this),searchText:searchText,showSearch:showSearch,icons:icons,className:"dimension-list-tile"},React.createElement("div",{className:"items",ref:"items"},dimensionItems,message),this.renderMenu())};return DimensionListTile}(React.Component);exports.DimensionListTile=DimensionListTile},function(module,exports,__webpack_require__){var content=__webpack_require__(591);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./tile-header.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./tile-header.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".tile-header .title{padding:15px 14px 10px 14px;font-size:12px;text-transform:uppercase;color:#000;cursor:default}.tile-header .icons{position:absolute;top:1px;right:10px}.tile-header .icons .icon{display:inline-block;padding:10px 0;cursor:pointer;width:19px;margin-left:3px}.tile-header .icons .icon svg{fill:#bbb}.tile-header .icons .icon:hover svg,.tile-header .icons .icon.active svg{fill:#888}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(593);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./searchable-tile.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./searchable-tile.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".searchable-tile .search-box .clearable-input{background:#fff;border:1px solid #d1d1d1;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px 0 rgba(0,0,0,0.1);box-shadow:inset 0 1px 1px 0 rgba(0,0,0,0.1)}.searchable-tile{background:#fff}.searchable-tile::after{position:absolute;top:0;bottom:0;left:0;right:0;content:'';pointer-events:none;-webkit-box-shadow:inset 0 -20px 10px -10px #fff;box-shadow:inset 0 -20px 10px -10px #fff;border-radius:2px}.searchable-tile .rows{position:absolute;top:36px;bottom:0;left:0;right:0;overflow:auto}.searchable-tile .search-box{position:absolute;top:36px;left:0;right:0;height:26px;padding:0 14px;margin-bottom:4px}.searchable-tile .search-box .clearable-input{width:100%;height:26px;padding-left:6px}.searchable-tile .search-box .clearable-input .clear{top:3px}.searchable-tile.has-search .rows{top:65px}.searchable-tile.has-search .items{top:65px}.searchable-tile .message{padding:4px 10px;color:#999;font-style:italic}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(595);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./dimension-list-tile.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./dimension-list-tile.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".dimension-list-tile{overflow:hidden}.dimension-list-tile .items{position:absolute;top:36px;bottom:0;width:100%;overflow:auto;color:#000}.dimension-list-tile .items .dimension,.dimension-list-tile .items .dimension-group .group-header{-webkit-transition:height 0.2s;-o-transition:height 0.2s;transition:height 0.2s;height:27px;background:#fff;cursor:pointer;overflow:hidden}.dimension-list-tile .items .dimension:last-child,.dimension-list-tile .items .dimension-group .group-header:last-child{margin-bottom:12px}.dimension-list-tile .items .dimension.highlight,.dimension-list-tile .items .dimension-group .group-header.highlight{background:#e3f4fc}.dimension-list-tile .items .dimension.selected,.dimension-list-tile .items .dimension-group .group-header.selected{background:#c3e7f8}.dimension-list-tile .items .dimension.trivial,.dimension-list-tile .items .dimension-group .group-header.trivial{color:#bababa}.dimension-list-tile .items .dimension>*,.dimension-list-tile .items .dimension-group .group-header>*{top:4px}.dimension-list-tile .items .dimension .icon,.dimension-list-tile .items .dimension-group .group-header .icon{position:absolute;width:19px;height:19px;padding:0;left:10px}.dimension-list-tile .items .dimension .icon svg,.dimension-list-tile .items .dimension-group .group-header .icon svg{width:19px;fill:rgba(0,0,0,0.3)}.dimension-list-tile .items .dimension .item-title,.dimension-list-tile .items .dimension-group .group-header .item-title{position:absolute;left:35px;right:10px;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;line-height:20px}.dimension-list-tile .items .dimension .item-title .label,.dimension-list-tile .items .dimension-group .group-header .item-title .label{width:100%;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;height:20px;line-height:20px}.dimension-list-tile .items .dimension-group{height:initial}.dimension-list-tile .items .dimension-group .dimension .icon{left:30px}.dimension-list-tile .items .dimension-group .dimension .item-title{left:55px}.dimension-list-tile .items .dimension-group .dimension:first-child{margin-top:0px}.dimension-list-tile .items .dimension-group .dimension:last-child{margin-bottom:0px}.dimension-list-tile .items .dimension-group.closed .group-icon{-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg)}.dimension-list-tile .items .dimension-group.closed .group-items .dimension{height:0px;overflow:hidden}.dimension-list-tile .items .dimension-group:last-child{margin-bottom:12px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var d3_dsv_1=__webpack_require__(597);function parseCSV(text){return d3_dsv_1.csvParse(text)}exports.parseCSV=parseCSV;function parseTSV(text){return d3_dsv_1.tsvParse(text)}exports.parseTSV=parseTSV;function parseJSON(text){text=text.trim();var firstChar=text[0];if(firstChar[0]==="["){try{return JSON.parse(text)}catch(e){throw new Error("could not parse")}}else if(firstChar[0]==="{"){return text.split(/\r?\n/).map(function(line,i){try{return JSON.parse(line)}catch(e){throw new Error("problem in line: "+i+": '"+line+"'")}})}else{throw new Error("Unsupported start, starts with '"+firstChar[0]+"'")}}exports.parseJSON=parseJSON;function parseData(text,type){type=type.replace(".","");switch(type){case"csv":case"text/csv":return parseCSV(text);case"tsv":case"text/tsv":case"text/tab-separated-values":return parseTSV(text);case"json":case"application/json":return parseJSON(text);default:throw new Error("Unsupported file type '"+type+"'")}}exports.parseData=parseData},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});var __WEBPACK_IMPORTED_MODULE_0__src_dsv__=__webpack_require__(196);__webpack_require__.d(__webpack_exports__,"dsvFormat",function(){return __WEBPACK_IMPORTED_MODULE_0__src_dsv__["a"]});var __WEBPACK_IMPORTED_MODULE_1__src_csv__=__webpack_require__(598);__webpack_require__.d(__webpack_exports__,"csvParse",function(){return __WEBPACK_IMPORTED_MODULE_1__src_csv__["c"]});__webpack_require__.d(__webpack_exports__,"csvParseRows",function(){return __WEBPACK_IMPORTED_MODULE_1__src_csv__["d"]});__webpack_require__.d(__webpack_exports__,"csvFormat",function(){return __WEBPACK_IMPORTED_MODULE_1__src_csv__["a"]});__webpack_require__.d(__webpack_exports__,"csvFormatRows",function(){return __WEBPACK_IMPORTED_MODULE_1__src_csv__["b"]});var __WEBPACK_IMPORTED_MODULE_2__src_tsv__=__webpack_require__(599);__webpack_require__.d(__webpack_exports__,"tsvParse",function(){return __WEBPACK_IMPORTED_MODULE_2__src_tsv__["c"]});__webpack_require__.d(__webpack_exports__,"tsvParseRows",function(){return __WEBPACK_IMPORTED_MODULE_2__src_tsv__["d"]});__webpack_require__.d(__webpack_exports__,"tsvFormat",function(){return __WEBPACK_IMPORTED_MODULE_2__src_tsv__["a"]});__webpack_require__.d(__webpack_exports__,"tsvFormatRows",function(){return __WEBPACK_IMPORTED_MODULE_2__src_tsv__["b"]})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return csvParse});__webpack_require__.d(__webpack_exports__,"d",function(){return csvParseRows});__webpack_require__.d(__webpack_exports__,"a",function(){return csvFormat});__webpack_require__.d(__webpack_exports__,"b",function(){return csvFormatRows});var __WEBPACK_IMPORTED_MODULE_0__dsv__=__webpack_require__(196);var csv=Object(__WEBPACK_IMPORTED_MODULE_0__dsv__["a"])(",");var csvParse=csv.parse;var csvParseRows=csv.parseRows;var csvFormat=csv.format;var csvFormatRows=csv.formatRows},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return tsvParse});__webpack_require__.d(__webpack_exports__,"d",function(){return tsvParseRows});__webpack_require__.d(__webpack_exports__,"a",function(){return tsvFormat});__webpack_require__.d(__webpack_exports__,"b",function(){return tsvFormatRows});var __WEBPACK_IMPORTED_MODULE_0__dsv__=__webpack_require__(196);var tsv=Object(__WEBPACK_IMPORTED_MODULE_0__dsv__["a"])("\t");var tsvParse=tsv.parse;var tsvParseRows=tsv.parseRows;var tsvFormat=tsv.format;var tsvFormatRows=tsv.formatRows},function(module,exports,__webpack_require__){var content=__webpack_require__(601);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./dimension-tile.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./dimension-tile.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".dimension-tile{min-height:94px;overflow-y:hidden}.dimension-tile.has-folder .rows{bottom:32px}.dimension-tile .folder{position:absolute;bottom:0;left:0;right:0;height:32px;cursor:pointer;color:#1ea3e6;padding-left:12px;padding-top:9px;z-index:2;border-top:1px solid #e6e6e6}.dimension-tile .folder svg{width:11px;margin-right:6px;margin-top:2px;fill:#1ea3e6}.dimension-tile .folder.folded svg{margin-top:1px;-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.dimension-tile .folder:hover{background:#e3f4fc}.dimension-tile .row{height:25px;cursor:pointer}.dimension-tile .row:hover{background:#e3f4fc}.dimension-tile .row:last-child{margin-bottom:12px}.dimension-tile .row.not-selected{color:#a6a6a6}.dimension-tile .row .highlight-controls{position:absolute;top:-29px;right:1px;z-index:4}.dimension-tile .row:nth-child(1) .highlight-controls,.dimension-tile .row:nth-child(2) .highlight-controls{top:auto;bottom:-34px}.dimension-tile .segment-value{position:absolute;top:0;bottom:0;left:0;right:85px;left:14px;overflow:hidden;white-space:nowrap}.dimension-tile .segment-value .checkbox{margin-top:1px}.dimension-tile .segment-value .label{display:inline-block;vertical-align:top;padding-top:6px}.dimension-tile .measure-value{position:absolute;top:0;bottom:0;right:0;width:85px;text-align:right;padding-top:6px;padding-right:14px;white-space:nowrap}.dimension-tile .loader,.dimension-tile .query-error{position:absolute;top:37px;bottom:0;left:0;right:0}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var React=__webpack_require__(1);__webpack_require__(603);var DropIndicator=function(_super){tslib_1.__extends(DropIndicator,_super);function DropIndicator(){return _super.call(this)||this}DropIndicator.prototype.render=function(){return React.createElement("div",{className:"drop-indicator"},React.createElement("div",{className:"white-out"}),React.createElement("div",{className:"action"},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.SPLIT_REPLACE})))};return DropIndicator}(React.Component);exports.DropIndicator=DropIndicator},function(module,exports,__webpack_require__){var content=__webpack_require__(604);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./drop-indicator.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./drop-indicator.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".drop-indicator .white-out{position:absolute;top:8px;bottom:8px;left:8px;right:8px;background:rgba(102,102,102,0.14);border-radius:4px}.drop-indicator .action{position:absolute;display:inline-block;padding:7px;top:50%;left:50%;-webkit-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);transform:translate(-50%, -50%);background:#fff;border-radius:4px}.drop-indicator .action svg{width:30px;fill:#666}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(606);var React=__webpack_require__(1);var classNames=__webpack_require__(4);var caladan_1=__webpack_require__(10);var FlatModal=function(_super){tslib_1.__extends(FlatModal,_super);function FlatModal(){var _this=_super.call(this)||this;_this.mounted=false;_this.state={};return _this}FlatModal.prototype.setCrumbs=function(crumbs){if(caladan_1.RouterCore.areSameCrumbs(crumbs,this.state.crumbs))return;this.setState({crumbs:crumbs})};FlatModal.prototype.renderTabs=function(){var _this=this;var _a=this.props,theme=_a.theme,tabs=_a.tabs;var crumbs=this.state.crumbs;var mainColor=theme.getMainColor();return tabs.map(function(tab){var active=crumbs&&crumbs[0]===tab.value;return React.createElement(caladan_1.Button,{className:tab.value,key:tab.value,title:tab.label,type:"primary",svg:tab.icon,onClick:function(){return _this.setState({crumbs:[tab.value]})},active:active,style:{color:active?"#ffffff":mainColor,backgroundColor:active?mainColor:null},svgStyle:{fill:active?"#ffffff":mainColor}})})};FlatModal.prototype.renderRoutes=function(){var tabs=this.props.tabs;return tabs.map(function(t){return React.createElement(caladan_1.Route,{fragment:t.value,key:t.value},t.noTitle!==true?React.createElement("div",{className:"tab-title"},t.label):null,t.render())})};FlatModal.prototype.render=function(){var _this=this;var className=this.props.className;var crumbs=this.state.crumbs;return React.createElement("div",{className:classNames("flat-modal",className)},React.createElement("div",{className:"tabs"},this.renderTabs()),React.createElement("div",{className:"tab-content"},React.createElement(caladan_1.RouterCore,{crumbs:crumbs,onChange:function(c){return _this.setCrumbs(c)}},this.renderRoutes())))};return FlatModal}(React.Component);exports.FlatModal=FlatModal},function(module,exports,__webpack_require__){var content=__webpack_require__(607);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./flat-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./flat-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".flat-modal{margin-left:auto;margin-right:auto;background-color:white;max-width:1000px;height:100%}.flat-modal .tabs{position:absolute;top:0;bottom:0;width:190px;border-right:1px solid #e6e6e6;padding:12px 0}.flat-modal .tabs .button{background-color:transparent;display:block;width:100%;height:38px;text-align:left;border-radius:0px}.flat-modal .tabs .button.icon-and-text svg{margin-top:-3px;margin-left:9px;margin-right:9px}.flat-modal .tabs .button:hover{background-color:#e3f4fc}.flat-modal .tab-content{position:absolute;top:0;bottom:0;left:190px;right:0;overflow:auto}.flat-modal .tab-content .tab-title{position:absolute;top:0;bottom:0;left:0;right:0;font-size:16px;text-transform:capitalize;padding:0 24px;height:56px;line-height:55px;border-bottom:1px solid #e6e6e6}.flat-modal .tab-content .form{position:absolute;top:56px;bottom:0;left:0;right:0;width:100%;overflow:auto;padding:10px 24px 24px 24px}.flat-modal .tab-content .form .msg{padding-bottom:8px}.flat-modal .tab-content .form .info-spot{position:absolute;top:8px;margin-left:16px}.flat-modal .tab-content .form textarea{height:200px;outline:none;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:13px;line-height:16px;padding:6px}.flat-modal .tab-content .columns{height:500px}.flat-modal .tab-content .buttons{padding:10px 0}.flat-modal .tab-content .buttons>button:not(:last-child){margin-right:10px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var immutable_ui_1=__webpack_require__(104);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var labels_1=__webpack_require__(404);__webpack_require__(609);var FormulaInput=function(_super){tslib_1.__extends(FormulaInput,_super);function FormulaInput(){var _this=_super.call(this)||this;_this.state={newInstance:new models_1.MeasureFormula};_this.delegate=new immutable_ui_1.ImmutableFormDelegate(_this);_this.delegate.onAnyChange(_this.onChange.bind(_this));return _this}FormulaInput.prototype.onChange=function(newFormula,isValid,formulaPath,error){if(isValid===void 0){isValid=true}if(formulaPath===void 0){formulaPath="formula"}if(error===void 0){error=null}var newMeasure=isValid?this.props.measure.changeFormula(newFormula.toFormula()):this.props.measure;if(this.props.onChange)this.props.onChange(newMeasure,isValid,formulaPath,error)};FormulaInput.prototype.componentWillMount=function(){this.initFromProps(this.props)};FormulaInput.prototype.initFromProps=function(props){var measure=props.measure,columns=props.columns;if(!measure||!columns)return;var simpleFormula=models_1.MeasureFormula.fromFormula(measure.formula);this.setState({isNotSimpleFormula:!simpleFormula,newInstance:simpleFormula?simpleFormula.changePossibleColumns(columns.map(function(c){return c.name})):null})};FormulaInput.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};FormulaInput.prototype.renderFilter=function(simpleColumns){var _a=this.state,newInstance=_a.newInstance,errors=_a.errors;if(!newInstance.filter)return null;var makeInput=immutable_ui_1.ImmutableTextInput.simpleGenerator(newInstance,this.delegate.onChange,labels_1.SIMPLE_MEASURE_FORMULA,errors);var makeDropdown=immutable_ui_1.ImmutableDropdown.simpleGenerator(newInstance,this.delegate.onChange,labels_1.SIMPLE_MEASURE_FORMULA,errors);return React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-33 h-padded"},caladan_1.FormLabel.dumbLabel(labels_1.SIMPLE_MEASURE_FORMULA["filter.column"].label),makeDropdown("filter.column",simpleColumns)),React.createElement("div",{className:"grid-col-33 h-padded"},caladan_1.FormLabel.dumbLabel(labels_1.SIMPLE_MEASURE_FORMULA["filter.operator"].label),makeDropdown("filter.operator",models_1.MeasureFilter.OPERATORS)),React.createElement("div",{className:"grid-col-33 h-padded"},caladan_1.FormLabel.dumbLabel(labels_1.SIMPLE_MEASURE_FORMULA["filter.value"].label),makeInput("filter.value",/[a-zA-Z]*/)))};FormulaInput.prototype.getFirstNonTimeColumn=function(){var columns=this.props.columns;if(!columns)return null;return columns.filter(function(c){return c.type!=="TIME"})[0]};FormulaInput.prototype.toggleFilter=function(){var _this=this;var newInstance=this.state.newInstance;this.setState({newInstance:newInstance.filter?newInstance.removeFilter():newInstance.createDefaultFilter(this.getFirstNonTimeColumn().name)},function(){_this.onChange(_this.state.newInstance)})};FormulaInput.prototype.convertToSimpleFormula=function(){var _this=this;this.setState({isNotSimpleFormula:false,newInstance:models_1.MeasureFormula.fromJS({column:this.getFirstNonTimeColumn().name,aggregation:models_1.MeasureFormula.DEFAULT_AGGREGATION})},function(){_this.onChange(_this.state.newInstance,true,"formula",undefined)})};FormulaInput.prototype.renderPlaceholder=function(){var goToAdvanced=this.props.goToAdvanced;return React.createElement("div",{className:"formula-input placeholder"},React.createElement("div",{className:"title"},"This measure's formula can only be displayed in advanced mode"),React.createElement("div",{className:"actions"},React.createElement("div",{className:"action"},React.createElement("span",{onClick:goToAdvanced},"Switch to advanced mode")),React.createElement("div",{className:"action"},React.createElement("span",{onClick:this.convertToSimpleFormula.bind(this)},"Convert to a simple formula"))))};FormulaInput.prototype.render=function(){var _a=this.props,columns=_a.columns,measure=_a.measure,focusOnStartup=_a.focusOnStartup;var _b=this.state,newInstance=_b.newInstance,errors=_b.errors,isNotSimpleFormula=_b.isNotSimpleFormula;if(isNotSimpleFormula)return this.renderPlaceholder();var simpleColumns=(columns||[]).map(models_1.listItemize("name","name"));var makeLabel=caladan_1.FormLabel.simpleGenerator(labels_1.SIMPLE_MEASURE_FORMULA,errors);var makeDropdown=immutable_ui_1.ImmutableDropdown.simpleGenerator(newInstance,this.delegate.onChange,labels_1.SIMPLE_MEASURE_FORMULA,errors);return React.createElement("div",{className:"formula-input"},React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-50 h-padded"},makeLabel("aggregation"),makeDropdown("aggregation",models_1.MeasureFormula.AGGREGATIONS,focusOnStartup)),React.createElement("div",{className:"grid-col-50 h-padded"},makeLabel("column","column",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["aggregation","column"]})),React.cloneElement(makeDropdown("column",simpleColumns),{disabled:!newInstance.canHaveColumn()}))),React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-100"},React.createElement(caladan_1.Checkbox,{onClick:this.toggleFilter.bind(this),selected:!!newInstance.filter,type:"check",label:"Filter"}))),this.renderFilter(simpleColumns))};return FormulaInput}(React.Component);exports.FormulaInput=FormulaInput},function(module,exports,__webpack_require__){var content=__webpack_require__(610);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./formula-input.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./formula-input.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".formula-input .filter-input input.filter-value{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px}.formula-input .filter-input input.filter-value:hover{border-color:#b8b8b8}.formula-input .filter-input input.filter-value:focus{border-color:#1ea3e6}.formula-input .filter-input input.error.filter-value{border-color:#e24c4c}.formula-input .filter-input input.disabled.filter-value{pointer-events:none;background:#f2f2f2}.formula-input .dropdown-menu{max-height:230px;overflow:auto}.formula-input.placeholder{height:163px;padding:25px 20px 0px 20px;border:1px solid #e6e6e6}.formula-input.placeholder .title{text-align:center;margin-bottom:10px;font-style:italic;line-height:20px;color:#999}.formula-input.placeholder .actions .action{text-align:center;padding:5px;color:#1ea3e6}.formula-input.placeholder .actions .action span{cursor:pointer}.formula-input.placeholder .actions .action span:hover{border-bottom:1px dashed}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var dom_1=__webpack_require__(68);__webpack_require__(612);var GridLines=function(_super){tslib_1.__extends(GridLines,_super);function GridLines(){return _super.call(this)||this}GridLines.prototype.render=function(){var _a=this.props,orientation=_a.orientation,stage=_a.stage,ticks=_a.ticks,scale=_a.scale;var lines=ticks.map(function(tick){var lineProps={key:String(tick)};if(orientation==="horizontal"){var y=dom_1.roundToHalfInteger(scale(tick));lineProps.x1=0;lineProps.x2=stage.width;lineProps.y1=y;lineProps.y2=y}else{var x=dom_1.roundToHalfInteger(scale(tick));lineProps.x1=x;lineProps.x2=x;lineProps.y1=0;lineProps.y2=stage.height}return React.createElement("line",lineProps)});return React.createElement("g",{className:classNames("grid-lines",orientation),transform:stage.getTransform()},lines)};return GridLines}(React.Component);exports.GridLines=GridLines},function(module,exports,__webpack_require__){var content=__webpack_require__(613);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./grid-lines.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./grid-lines.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".grid-lines line{pointer-events:none;stroke:#ebebeb}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var strings_1=__webpack_require__(17);var download_1=__webpack_require__(471);var HilukMenu=function(_super){tslib_1.__extends(HilukMenu,_super);function HilukMenu(){var _this=_super.call(this)||this;_this.state={url:null,specificUrl:null};return _this}HilukMenu.prototype.componentDidMount=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,getLongUrl=_a.getLongUrl;var specificUrl=essence.getEffectiveFilter().isDynamic()?getLongUrl(essence.convertToSpecificFilter(timekeeper)):null;this.setState({url:window.location.href,specificUrl:specificUrl})};HilukMenu.prototype.onExport=function(){var _a=this.props,onClose=_a.onClose,getDownloadableDataset=_a.getDownloadableDataset,essence=_a.essence,timekeeper=_a.timekeeper;var splits=essence.getConstrainedSplits();if(!getDownloadableDataset)return;var specialTimeDimension=essence.getSpecialTimeDimension();var filters=essence.getSpecificFilterWithHighlight(timekeeper).getFileString(specialTimeDimension?specialTimeDimension.name:null);var splitsString=splits.toArray().map(function(split){return strings_1.STRINGS.splitDelimiter+"_"+split.dimension}).join("_");download_1.download(getDownloadableDataset(),download_1.makeFileName(essence.dataCube,filters,splitsString),"csv");onClose()};HilukMenu.prototype.render=function(){var _a=this.props,openOn=_a.openOn,onClose=_a.onClose,externalViews=_a.externalViews,essence=_a.essence,getDownloadableDataset=_a.getDownloadableDataset;var _b=this.state,url=_b.url,specificUrl=_b.specificUrl;var shareOptions=[];shareOptions.push(React.createElement("li",{className:"copy-url clipboard",key:"copy-url","data-clipboard-text":url,onClick:onClose},strings_1.STRINGS.copyUrl));if(specificUrl){shareOptions.push(React.createElement("li",{className:"copy-specific-url clipboard",key:"copy-specific-url","data-clipboard-text":specificUrl,onClick:onClose},strings_1.STRINGS.copySpecificUrl))}if(getDownloadableDataset()){shareOptions.push(React.createElement("li",{className:"export",key:"export",onClick:this.onExport.bind(this)},strings_1.STRINGS.exportToCSV))}if(externalViews){externalViews.forEach(function(externalView,i){var url=externalView.linkGeneratorFn(essence.actualDataCube,essence.timezone,essence.getEffectiveFilter(),essence.getConstrainedSplits());if(typeof url!=="string")return;var title=strings_1.STRINGS.openIn+" "+externalView.title;var target=externalView.sameWindow?"_self":"_blank";shareOptions.push(React.createElement("li",{key:"custom-url-"+i},React.createElement("a",{href:url,target:target},title)))})}var stage=beltful_1.Stage.fromSize(200,200);return React.createElement(caladan_1.BubbleMenu,{className:"hiluk-menu",direction:"down",stage:stage,openOn:openOn,onClose:onClose},React.createElement("ul",{className:"bubble-list"},shareOptions))};return HilukMenu}(React.Component);exports.HilukMenu=HilukMenu},function(module,exports){module.exports=function(){throw new Error("define cannot be used indirect")}},function(module,exports){(function(__webpack_amd_options__){module.exports=__webpack_amd_options__}).call(exports,{})},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var segment_action_buttons_1=__webpack_require__(197);__webpack_require__(620);var LEFT_OFFSET=22;var ColorSegmentBubble=function(_super){tslib_1.__extends(ColorSegmentBubble,_super);function ColorSegmentBubble(){return _super.call(this)||this}ColorSegmentBubble.prototype.renderColorSwabs=function(){var colorEntries=this.props.colorEntries;if(!colorEntries||!colorEntries.length)return null;var colorSwabs=colorEntries.map(function(colorEntry){var color=colorEntry.color,segmentLabel=colorEntry.segmentLabel,measureLabel=colorEntry.measureLabel;var swabStyle={background:color};return React.createElement("div",{className:"color",key:segmentLabel},React.createElement("div",{className:"color-swab",style:swabStyle}),React.createElement("div",{className:"color-name"},segmentLabel),React.createElement("div",{className:"color-value"},measureLabel))});return React.createElement("div",{className:"colors"},colorSwabs)};ColorSegmentBubble.prototype.render=function(){var _a=this.props,left=_a.left,top=_a.top,dimensions=_a.dimensions,segmentLabel=_a.segmentLabel,clicker=_a.clicker,onClose=_a.onClose;return React.createElement(caladan_1.BodyPortal,{left:left+LEFT_OFFSET,top:top,disablePointerEvents:!clicker},React.createElement("div",{className:"color-segment-bubble"},React.createElement("div",{className:"bucket"},segmentLabel),this.renderColorSwabs(),clicker?React.createElement(segment_action_buttons_1.SegmentActionButtons,{clicker:clicker,dimensions:dimensions,segmentLabel:segmentLabel,disableMoreMenu:true,onClose:onClose}):null))};return ColorSegmentBubble}(React.Component);exports.ColorSegmentBubble=ColorSegmentBubble},function(module,exports,__webpack_require__){var content=__webpack_require__(619);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./segment-action-buttons.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./segment-action-buttons.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".segment-action-buttons{white-space:nowrap}.segment-action-buttons .button{margin-right:5px}.segment-action-buttons .button.main,.segment-action-buttons .button.act{width:65px}.segment-action-buttons .button:last-child{margin-right:0}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(621);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./color-segment-bubble.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./color-segment-bubble.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".color-segment-bubble{background:#fff;border-radius:2px;-webkit-box-shadow:0 3px 10px 0 rgba(0,0,0,0.26),0 0 3px 0 rgba(0,0,0,0.16);box-shadow:0 3px 10px 0 rgba(0,0,0,0.26),0 0 3px 0 rgba(0,0,0,0.16)}.color-segment-bubble{background:rgba(255,255,255,0.9);position:absolute;width:220px;padding:8px}.color-segment-bubble .bucket{color:#a6a6a6;margin-bottom:6px}.color-segment-bubble .color .color-swab{position:absolute;top:1px;left:0;width:15px;height:15px;border-radius:2px}.color-segment-bubble .color .color-name{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;display:inline-block;margin-left:22px;line-height:18px;width:108px}.color-segment-bubble .color .color-value{position:absolute;top:0;bottom:0;right:0;width:72px;line-height:18px;text-align:right;white-space:nowrap;overflow:hidden}.color-segment-bubble .segment-action-buttons{margin-top:7px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);var time_1=__webpack_require__(109);var dom_1=__webpack_require__(68);__webpack_require__(623);var TICK_HEIGHT=5;var TEXT_OFFSET=12;var LABEL_Y=TICK_HEIGHT+TEXT_OFFSET;var BOUNDARY_Y_OFFSET=14;var LineChartAxis=function(_super){tslib_1.__extends(LineChartAxis,_super);function LineChartAxis(){return _super.call(this)||this}LineChartAxis.prototype.renderBoundaryTick=function(x,d){var value=d.value,boundary=d.boundary;return React.createElement("text",{x:x,y:LABEL_Y,key:value+boundary},React.createElement("tspan",{x:x,y:LABEL_Y},value),React.createElement("tspan",{x:x,y:LABEL_Y+BOUNDARY_Y_OFFSET},boundary))};LineChartAxis.prototype.render=function(){var _this=this;var _a=this.props,stage=_a.stage,ticks=_a.ticks,scale=_a.scale,tickFormatter=_a.tickFormatter;var lines=ticks.map(function(tick){var x=dom_1.roundToHalfInteger(scale(tick));return React.createElement("line",{key:String(tick),x1:x,y1:0,x2:x,y2:TICK_HEIGHT})});var labels=ticks.map(function(tick){var x=scale(tick);var formatted=tickFormatter(tick);if(time_1.isBoundaryTick(formatted)){return _this.renderBoundaryTick(x,formatted)}return React.createElement("text",{key:String(tick),x:x,y:LABEL_Y},formatted)});return React.createElement("g",{className:"line-chart-axis",transform:stage.getTransform()},lines,labels)};return LineChartAxis}(React.Component);exports.LineChartAxis=LineChartAxis},function(module,exports,__webpack_require__){var content=__webpack_require__(624);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./line-chart-axis.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./line-chart-axis.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".line-chart-axis{position:absolute;top:0;bottom:0;left:0;right:0}.line-chart-axis line{pointer-events:none}.line-chart-axis line{stroke:#ccc}.line-chart-axis text{text-anchor:middle;font-size:12px;fill:#666}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);__webpack_require__(626);var ManualFallback=function(_super){tslib_1.__extends(ManualFallback,_super);function ManualFallback(){return _super.call(this)||this}ManualFallback.prototype.onSplitResolutionClick=function(resolution){var clicker=this.props.clicker;clicker.changeSplits(resolution.adjustment.splits,models_1.VisStrategy.KeepAlways)};ManualFallback.prototype.onVisualizationClick=function(visualizationName){var clicker=this.props.clicker;var visualization=immutable_class_1.NamedArray.findByName(models_1.MANIFESTS,visualizationName);if(!visualization)return;clicker.summonVisualization(visualization)};ManualFallback.prototype.render=function(){var _this=this;var essence=this.props.essence;var visResolve=essence.getVisResolve();if(!visResolve.rejectedDimensions()&&!visResolve.rejectedCombines())return null;var onClick=null;var getDescription=null;if(visResolve.rejectedDimensions()){var splits_1=essence.getConstrainedSplits();onClick=this.onSplitResolutionClick;getDescription=function(r){var returnStr=strings_1.STRINGS.try+" "+r.description;if(!splits_1.isSubsetOf(r.adjustment.splits)){returnStr+=" "+strings_1.STRINGS.instead}return returnStr}}else{onClick=this.onVisualizationClick;getDescription=function(r){var vis=immutable_class_1.NamedArray.findByName(models_1.MANIFESTS,r);return vis?strings_1.STRINGS.try+" the "+vis.title+" "+strings_1.STRINGS.instead:"?"}}var items=visResolve.resolutions.map(function(r,i){return React.createElement("li",{key:i,onClick:onClick.bind(_this,r)},getDescription(r))});return React.createElement("div",{className:"manual-fallback"},React.createElement("div",{className:"message"},visResolve.message),React.createElement("ul",null,items))};return ManualFallback}(React.Component);exports.ManualFallback=ManualFallback},function(module,exports,__webpack_require__){var content=__webpack_require__(627);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./manual-fallback.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./manual-fallback.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".manual-fallback{text-align:center;padding:100px 30px}.manual-fallback .message{font-size:20px;color:#666}.manual-fallback ul{margin-top:24px}.manual-fallback li{font-size:14px;cursor:pointer;color:#1ea3e6;margin-bottom:10px}.manual-fallback li:hover{text-decoration:underline}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var immutable_class_1=__webpack_require__(7);var React=__webpack_require__(1);var strings_1=__webpack_require__(17);var constants_1=__webpack_require__(52);var highlight_string_1=__webpack_require__(105);var searchable_tile_1=__webpack_require__(183);__webpack_require__(629);var MeasuresTile=function(_super){tslib_1.__extends(MeasuresTile,_super);function MeasuresTile(){var _this=_super.call(this)||this;_this.state={showSearch:false,searchText:"",openGroups:{}};return _this}MeasuresTile.prototype.componentWillMount=function(){var essence=this.props.essence;var openGroups={};var selectedMeasures=essence.getEffectiveSelectedMeasure();var groups=this.getGroupedMeasures(essence.actualDataCube.getMeasures()).filter(Array.isArray);groups.forEach(function(group){openGroups[group[0].group]=group.some(function(m){return selectedMeasures.indexOf(m.name)>-1})});this.setState({openGroups:openGroups})};MeasuresTile.prototype.measureClick=function(measure){var clicker=this.props.clicker;clicker.toggleEffectiveMeasure(measure)};MeasuresTile.prototype.toggleSearch=function(){var showSearch=this.state.showSearch;this.setState({showSearch:!showSearch});this.onSearchChange("")};MeasuresTile.prototype.onSearchChange=function(text){var searchText=this.state.searchText;var newSearchText=text.substr(0,constants_1.MAX_SEARCH_LENGTH);if(searchText===newSearchText)return;this.setState({searchText:newSearchText})};MeasuresTile.prototype.toggleMultiMeasure=function(){var clicker=this.props.clicker;if(!clicker.toggleMultiMeasureMode)return;clicker.toggleMultiMeasureMode()};MeasuresTile.prototype.getGroupedMeasures=function(measures){var items=[];var lastGroup;measures.forEach(function(d){if(d.group){if(d.group===lastGroup){items[items.length-1].push(d)}else{lastGroup=d.group;items.push([d])}}else{items.push(d)}});return items};MeasuresTile.prototype.renderMeasure=function(measure,checkboxType){var essence=this.props.essence;var _a=this.state,showSearch=_a.showSearch,searchText=_a.searchText;var selectedMeasures=essence.getEffectiveSelectedMeasure();var measureName=measure.name;var selected=immutable_class_1.SimpleArray.contains(selectedMeasures,measureName);return React.createElement("div",{className:classNames("measure",{selected:selected}),key:measureName,onClick:this.measureClick.bind(this,measure)},React.createElement(caladan_1.Checkbox,{type:checkboxType,selected:selected}),React.createElement(highlight_string_1.HighlightString,{className:"label",text:measure.getTitleWithUnits(),highlight:searchText}))};MeasuresTile.prototype.renderMeasureGroup=function(measures,checkboxType){var _this=this;var essence=this.props.essence;var openGroups=this.state.openGroups;var groupName=measures[0].group;var isOpen=openGroups[groupName];var toggle=function(e){openGroups[groupName]=!isOpen;_this.setState({openGroups:openGroups})};return React.createElement("div",{key:groupName,className:classNames("measure-group",{open:isOpen,closed:!isOpen})},React.createElement("div",{className:"grid-row",onClick:toggle},React.createElement("div",{className:"icon group-icon grid-col-fit-content middle"},React.createElement("div",{className:"pouet"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_CARET_BOTTOM}))),React.createElement("div",{className:"item-title group-title grid-col-auto-expand middle"},React.createElement("div",{className:"label"},groupName))),React.createElement("div",{className:"group-items"},measures.map(function(m){return _this.renderMeasure(m,checkboxType)})))};MeasuresTile.prototype.renderMeasures=function(){var _this=this;var essence=this.props.essence;var _a=this.state,showSearch=_a.showSearch,searchText=_a.searchText;var checkboxType=essence.getMeasureMode()==="multi"?"check":"radio";var shownMeasures=essence.actualDataCube.getMeasures();if(searchText){shownMeasures=shownMeasures.filter(function(m){return m.getTitleWithUnits().toLowerCase().includes(searchText.toLowerCase())})}var items=this.getGroupedMeasures(shownMeasures);return items.map(function(item){if(Array.isArray(item))return _this.renderMeasureGroup(item,checkboxType);return _this.renderMeasure(item,checkboxType)})};MeasuresTile.prototype.render=function(){var _this=this;var _a=this.props,essence=_a.essence,style=_a.style;var _b=this.state,showSearch=_b.showSearch,searchText=_b.searchText;var measureMode=essence.getMeasureMode();var rows=this.renderMeasures();var message=null;if(searchText&&!rows.length){message=React.createElement("div",{className:"message"},"No "+strings_1.STRINGS.measures.toLowerCase()+' for "'+searchText+'"')}var icons=[];if(essence.getVisualizationManifest().supportsMultipleMeasureMode){icons.push({name:"multi",onClick:function(){return _this.toggleMultiMeasure()},svg:Icons.FULL_MULTI,active:measureMode==="multi"})}icons.push({name:"search",ref:"search",onClick:this.toggleSearch.bind(this),svg:Icons.FULL_SEARCH,active:showSearch});return React.createElement(searchable_tile_1.SearchableTile,{style:style,title:strings_1.STRINGS.measures,toggleChangeFn:this.toggleSearch.bind(this),onSearchChange:this.onSearchChange.bind(this),searchText:searchText,showSearch:showSearch,icons:icons,className:"measures-tile"},React.createElement("div",{className:"rows"},rows,message))};return MeasuresTile}(React.Component);exports.MeasuresTile=MeasuresTile},function(module,exports,__webpack_require__){var content=__webpack_require__(630);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./measures-tile.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./measures-tile.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".measures-tile .measure{-webkit-transition:height 0.2s;-o-transition:height 0.2s;transition:height 0.2s;padding-left:14px;height:27px;cursor:pointer;overflow:hidden;white-space:nowrap}.measures-tile .measure:last-child{margin-bottom:12px}.measures-tile .measure .label{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;position:absolute;top:7px;bottom:0;left:37px;right:10px}.measures-tile .measure:hover{background:#e3f4fc}.measures-tile .checkbox{margin-top:2px}.measures-tile .checkbox.selected .checkbox-body{background:rgba(0,0,0,0.45)}.measures-tile .measure-group{height:initial}.measures-tile .measure-group>.grid-row{padding-left:12px;cursor:pointer}.measures-tile .measure-group .group-icon{-webkit-transition:-webkit-transform 0.2s;transition:-webkit-transform 0.2s;-o-transition:transform 0.2s;transition:transform 0.2s;transition:transform 0.2s, -webkit-transform 0.2s;width:19px;height:19px;padding:0}.measures-tile .measure-group .group-icon svg{width:19px;fill:rgba(0,0,0,0.3)}.measures-tile .measure-group .group-title{padding:5px 0px 5px 5px}.measures-tile .measure-group .measure{padding-left:30px}.measures-tile .measure-group .measure:first-child{margin-top:0}.measures-tile .measure-group .measure:last-child{margin-bottom:0}.measures-tile .measure-group .measure .label{left:57px}.measures-tile .measure-group.closed .group-icon{-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg)}.measures-tile .measure-group.closed .group-items .measure{height:0px;overflow:hidden}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var React=__webpack_require__(1);__webpack_require__(632);var NavList=function(_super){tslib_1.__extends(NavList,_super);function NavList(){return _super!==null&&_super.apply(this,arguments)||this}NavList.prototype.renderIcon=function(iconSvg){if(!iconSvg)return null;return React.createElement("span",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:iconSvg}))};NavList.prototype.renderA=function(isSelected,navLink){var _a=this.props,onClose=_a.onClose,iconSvg=_a.iconSvg;return React.createElement("a",{className:classNames("item",{selected:isSelected}),key:navLink.name,title:navLink.tooltip,href:navLink.href,target:navLink.newTab?"_blank":null,onClick:isSelected?onClose:navLink.onClick},this.renderIcon(iconSvg),navLink.title)};NavList.prototype.renderDIV=function(isSelected,navLink){var _a=this.props,onClose=_a.onClose,iconSvg=_a.iconSvg;return React.createElement("div",{className:classNames("item",{selected:isSelected}),key:navLink.name,title:navLink.tooltip,href:navLink.href,target:navLink.newTab?"_blank":null,onClick:isSelected?onClose:navLink.onClick},this.renderIcon(iconSvg),navLink.title)};NavList.prototype.renderNavList=function(){var _this=this;var _a=this.props,navLinks=_a.navLinks,iconSvg=_a.iconSvg,selected=_a.selected,onClose=_a.onClose;return navLinks.map(function(navLink){var isSelected=selected&&selected===navLink.name;return navLink.href?_this.renderA(isSelected,navLink):_this.renderDIV(isSelected,navLink)})};NavList.prototype.render=function(){var title=this.props.title;var className="nav-list";var titleSection=null;if(title){titleSection=React.createElement("div",{className:"group-title"},title)}else{className+=" no-title"}return React.createElement("div",{className:className},titleSection,React.createElement("div",{className:"items"},this.renderNavList()))};return NavList}(React.Component);exports.NavList=NavList},function(module,exports,__webpack_require__){var content=__webpack_require__(633);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./nav-list.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./nav-list.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".nav-list{border-top:1px solid #ddd}.nav-list:first-child{border-top:0}.nav-list svg{height:19px;width:19px}.nav-list .group-title{padding-left:18px;text-transform:uppercase;font-size:12px;padding-top:15px;padding-bottom:12px;color:#999}.nav-list .group-title .icons{position:absolute;padding-right:18px;top:1px;right:0;cursor:pointer}.nav-list .group-title .icons .icon{display:inline-block;padding:10px 1px}.nav-list .group-title .icons .icon:not(:first-child){margin-left:4px}.nav-list .group-title .icons .icon:hover svg{fill:#888}.nav-list .items .item{white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;display:block;line-height:34px;padding-left:18px;padding-right:18px;cursor:pointer}.nav-list .items .item .icon{display:inline-block;top:7px;left:0;margin-right:9px}.nav-list .items .item:hover{background:rgba(30,163,230,0.12)}.nav-list .items .selected{background:rgba(30,163,230,0.14)}.nav-list .items .selected .icon svg{fill:#1ea3e6}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(635);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./pinboard-measure-tile.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./pinboard-measure-tile.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".pinboard-measure-tile .dropdown .selected-item:hover{background:#fff;border:1px solid #d1d1d1;border-radius:2px;cursor:pointer;-webkit-box-shadow:0 1px 1px 0 rgba(0,0,0,0.1);box-shadow:0 1px 1px 0 rgba(0,0,0,0.1)}.pinboard-measure-tile .dropdown .selected-item:hover{border-color:#bababa}.pinboard-measure-tile{background:#fff}.pinboard-measure-tile{height:36px;margin-bottom:1px}.pinboard-measure-tile .title{margin-left:14px;margin-top:12px;font-size:12px;color:#999;text-transform:uppercase}.pinboard-measure-tile .dropdown{display:inline-block;position:absolute;top:5px;right:5px;font-size:12px;border-radius:2px}.pinboard-measure-tile .dropdown .selected-item{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;line-height:19px;padding:2px 22px 2px 7px;border:1px solid transparent;color:#999;max-width:104px;height:auto;-webkit-box-shadow:none;box-shadow:none}.pinboard-measure-tile .dropdown .selected-item .caret-icon{position:absolute;right:7px;bottom:6px}.pinboard-measure-tile .dropdown .selected-item .caret-icon svg{fill:#bababa}.pinboard-measure-tile .dropdown .selected-item:hover{color:#000}.pinboard-measure-tile .dropdown .selected-item:hover .caret-icon svg{fill:#999}.pinboard-measure-tile .dropdown .dropdown-menu{margin-top:1px;right:0;width:190px;max-height:600px;overflow-y:auto}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var drag_manager_1=__webpack_require__(110);var dimension_tile_1=__webpack_require__(434);var pinboard_measure_tile_1=__webpack_require__(436);__webpack_require__(637);var PinboardPanel=function(_super){tslib_1.__extends(PinboardPanel,_super);function PinboardPanel(){var _this=_super.call(this)||this;_this.state={dragOver:false};return _this}PinboardPanel.prototype.canDrop=function(e){var dimension=drag_manager_1.DragManager.getDragDimension();if(dimension){var pinnedDimensions=this.props.essence.pinnedDimensions;return!pinnedDimensions.includes(dimension.name)}return false};PinboardPanel.prototype.dragEnter=function(e){if(!this.canDrop(e))return;e.preventDefault();this.setState({dragOver:true})};PinboardPanel.prototype.dragOver=function(e){if(!this.canDrop(e))return;e.dataTransfer.dropEffect="move";e.preventDefault()};PinboardPanel.prototype.dragLeave=function(e){if(!this.canDrop(e))return;this.setState({dragOver:false})};PinboardPanel.prototype.drop=function(e){if(!this.canDrop(e))return;e.preventDefault();var dimension=drag_manager_1.DragManager.getDragDimension();if(dimension){this.props.clicker.pin(dimension)}this.setState({dragOver:false})};PinboardPanel.prototype.getColorsSortOn=function(){var essence=this.props.essence;var split=essence.getEffectiveColorSplit();if(split){return models_1.SortOn.fromSortAction(split.sortAction,essence.actualDataCube,essence.getDimension(split.dimension))}return null};PinboardPanel.prototype.onLegendSortOnSelect=function(sortOn){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var splits=essence.getConstrainedSplits();var colorSplit=essence.getEffectiveColorSplit();if(colorSplit){var sortAction=colorSplit.sortAction;var direction=sortAction?sortAction.direction:plywood_1.SortExpression.DESCENDING;var newSplit=colorSplit.changeSortAction(plywood_1.Expression._.sort(sortOn.getExpression(),direction));var newColors=models_1.Colors.fromLimit(colorSplit.dimension,5);clicker.changeSplits(splits.replace(colorSplit,newSplit),models_1.VisStrategy.UnfairGame,newColors)}};PinboardPanel.prototype.onPinboardSortOnSelect=function(sortOn){if(!sortOn.measure)return;var clicker=this.props.clicker;clicker.changePinnedSortMeasure(sortOn.measure)};PinboardPanel.prototype.onRemoveLegend=function(){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var splits=essence.getConstrainedSplits();var colors=essence.getEffectiveColors();if(colors){var split=splits.findSplitForDimension(colors.dimension);if(split){clicker.changeSplits(splits.removeSplit(split),models_1.VisStrategy.UnfairGame,null)}}};PinboardPanel.prototype.render=function(){var _a=this.props,clicker=_a.clicker,essence=_a.essence,timekeeper=_a.timekeeper,customColors=_a.customColors,getLongUrl=_a.getLongUrl,style=_a.style;var dragOver=this.state.dragOver;var pinnedDimensions=essence.pinnedDimensions;var colors=essence.getEffectiveColors();var legendMeasureSelector=null;var legendDimensionTile=null;var colorDimension=colors?colors.dimension:null;if(colorDimension){var dimension=essence.getDimension(colorDimension);if(dimension){var colorsSortOn=this.getColorsSortOn();legendMeasureSelector=React.createElement(pinboard_measure_tile_1.PinboardMeasureTile,{essence:essence,title:"Legend",dimension:dimension,sortOn:colorsSortOn,onSelect:this.onLegendSortOnSelect.bind(this)});legendDimensionTile=React.createElement(dimension_tile_1.DimensionTile,{clicker:clicker,essence:essence,timekeeper:timekeeper,dimension:dimension,sortOn:colorsSortOn,colorSplit:essence.getEffectiveColorSplit(),colors:colors&&colors.isLimitMode()&&customColors?customColors:colors,onClose:this.onRemoveLegend.bind(this),getLongUrl:getLongUrl})}}var pinnedSortOn=models_1.SortOn.fromMeasure(essence.getPinnedSortMeasure());var dimensionTiles=[];pinnedDimensions.forEach(function(dimensionName){var dimension=essence.getDimension(dimensionName);if(!dimension)return null;dimensionTiles.push(React.createElement(dimension_tile_1.DimensionTile,{key:dimension.name,clicker:clicker,essence:essence,timekeeper:timekeeper,dimension:dimension,sortOn:pinnedSortOn,onClose:clicker.unpin?clicker.unpin.bind(clicker,dimension):null,getLongUrl:getLongUrl}))});var placeholder=null;if(!dragOver&&!dimensionTiles.length){placeholder=React.createElement("div",{className:"placeholder"},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.PREVIEW_PIN}),React.createElement("div",{className:"placeholder-message"},strings_1.STRINGS.pinboardPlaceholder))}return React.createElement("div",{className:"pinboard-panel",onDragEnter:this.dragEnter.bind(this),style:style},legendMeasureSelector,legendDimensionTile,React.createElement(pinboard_measure_tile_1.PinboardMeasureTile,{essence:essence,title:strings_1.STRINGS.pinboard,sortOn:pinnedSortOn,onSelect:this.onPinboardSortOnSelect.bind(this)}),dimensionTiles,dragOver?React.createElement("div",{className:"drop-indicator-tile"}):null,placeholder,dragOver?React.createElement("div",{className:"drag-mask",onDragOver:this.dragOver.bind(this),onDragLeave:this.dragLeave.bind(this),onDragExit:this.dragLeave.bind(this),onDrop:this.drop.bind(this)}):null)};return PinboardPanel}(React.Component);exports.PinboardPanel=PinboardPanel},function(module,exports,__webpack_require__){var content=__webpack_require__(638);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./pinboard-panel.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./pinboard-panel.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".pinboard-panel .placeholder{background:#fff}.pinboard-panel{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-ms-flex-wrap:wrap;flex-wrap:wrap}@media only screen and (max-width: 1080px){.pinboard-panel{font-size:0.9em}}.pinboard-panel .dimension-tile,.pinboard-panel .drop-indicator-tile{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;margin-bottom:1px}.pinboard-panel .dimension-tile.has-colors{margin-bottom:5px}.pinboard-panel .drop-indicator-tile{pointer-events:none}.pinboard-panel .drop-indicator-tile::after{position:absolute;top:4px;bottom:4px;left:0;right:0;content:'';background:rgba(102,102,102,0.14);border-radius:2px}.pinboard-panel .placeholder{border-radius:0 0 2px 2px;max-height:280px;min-height:150px;-webkit-box-flex:1;-ms-flex:1;flex:1;pointer-events:none}.pinboard-panel .placeholder::after{position:absolute;top:10px;bottom:10px;left:10px;right:10px;content:'';border-radius:5px}.pinboard-panel .placeholder svg{position:absolute;width:40px;left:50%;top:50%;margin-left:-20px;margin-top:-63px;fill:#d4d4d4}.pinboard-panel .placeholder .placeholder-message{position:absolute;top:50%;width:100%;height:16px;margin-top:-15px;padding-left:30px;padding-right:30px;font-style:italic;line-height:20px;color:#a6a6a6;text-align:center}.pinboard-panel .drag-mask{position:absolute;top:0;bottom:0;left:0;right:0}.pinboard-panel .checkbox.selected .checkbox-body{background:rgba(0,0,0,0.45)}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(640);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./shpitz.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./shpitz.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".shpitz{position:absolute;width:40px;height:40px;overflow:hidden;pointer-events:none}.shpitz .rectangle{position:absolute}.shpitz .rectangle::after{content:'';position:absolute;width:12px;height:12px;-webkit-transform:translate(-50%, -50%) rotate(45deg);-ms-transform:translate(-50%, -50%) rotate(45deg);transform:translate(-50%, -50%) rotate(45deg);background:#fff;-webkit-box-shadow:0 0 4px 0 rgba(0,0,0,0.35);box-shadow:0 0 4px 0 rgba(0,0,0,0.35)}.shpitz.up{margin-bottom:-40px;margin-left:-20px}.shpitz.up .rectangle{bottom:100%;left:50%}.shpitz.down{margin-top:-40px;margin-left:-20px}.shpitz.down .rectangle{top:100%;left:50%}.shpitz.left{margin-right:-40px;margin-top:-20px}.shpitz.left .rectangle{right:100%;top:50%}.shpitz.right{margin-left:-40px;margin-top:-20px}.shpitz.right .rectangle{left:100%;top:50%}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(642);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./segment-bubble.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./segment-bubble.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".segment-bubble{background:#fff;border-radius:2px;-webkit-box-shadow:0 3px 10px 0 rgba(0,0,0,0.26),0 0 3px 0 rgba(0,0,0,0.16);box-shadow:0 3px 10px 0 rgba(0,0,0,0.26),0 0 3px 0 rgba(0,0,0,0.16)}.segment-bubble{position:absolute;background:rgba(255,255,255,0.9);padding:10px;text-align:center;-webkit-transform:translate(-50%, -100%);-ms-transform:translate(-50%, -100%);transform:translate(-50%, -100%);max-width:400px}.segment-bubble .text .segment{color:#999;line-height:17px;display:block;padding-bottom:2px;overflow:hidden;word-wrap:break-word}.segment-bubble .text .measure-value{white-space:nowrap}.segment-bubble .segment-action-buttons:nth-child(n+2){margin-top:7px}.segment-bubble .shpitz{left:50%;top:100%}.segment-bubble.tiny{cursor:pointer}.segment-bubble.tiny .text{white-space:nowrap}.segment-bubble.tiny.down{-webkit-transform:translate(-50%, 50%);-ms-transform:translate(-50%, 50%);transform:translate(-50%, 50%)}.segment-bubble.tiny.down .shpitz{top:0px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(644);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./options-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./options-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".options-menu .update-info{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;height:30px;line-height:28px;background:#f2f2f2;border-radius:2px;color:#909090;text-align:center;padding-left:8px;padding-right:8px}.options-menu .timezone-dropdown{margin-bottom:15px}.options-menu .refresh-controls{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:100%}.options-menu .refresh-controls .dropdown{-webkit-box-flex:2;-ms-flex:2;flex:2;margin-right:5px}.options-menu .refresh-controls .button{top:17px;width:30px}.options-menu .update-info{-webkit-box-flex:1;-ms-flex:1;flex:1;margin-top:8px}.options-menu .bubble-list{margin-top:8px}.options-menu .checkbox{width:100%}.options-menu .checkbox .checkbox-body,.options-menu .checkbox .main-icon{top:7px}.options-menu .checkbox .label{top:0}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(646);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./split-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./split-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".split-menu .sort-direction .direction{background:#fff;border:1px solid #d1d1d1;border-radius:2px;cursor:pointer;-webkit-box-shadow:0 1px 1px 0 rgba(0,0,0,0.1);box-shadow:0 1px 1px 0 rgba(0,0,0,0.1)}.split-menu .sort-direction .direction:hover{border-color:#bababa}.split-menu input{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px}.split-menu input:hover{border-color:#b8b8b8}.split-menu input:focus{border-color:#1ea3e6}.split-menu input.error{border-color:#e24c4c}.split-menu input.disabled{pointer-events:none;background:#f2f2f2}.split-menu .dropdown{margin-bottom:12px}.split-menu .sort-direction .dropdown{margin-right:38px}.split-menu .sort-direction .direction{position:absolute;right:0;bottom:0;width:32px;height:30px}.split-menu .sort-direction .direction svg{position:absolute;height:13px;top:7px;left:11px}.split-menu .sort-direction .direction.ascending svg{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.split-menu .ok-cancel-bar{text-align:right}.split-menu .ok-cancel-bar>*:not(:last-child){margin-right:8px}.split-menu .ok-cancel-bar .ok{min-width:60px}.split-menu input{margin-bottom:12px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var little_pictures_1=__webpack_require__(11);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var constants_1=__webpack_require__(52);var dom_1=__webpack_require__(68);var drag_manager_1=__webpack_require__(110);var pill_tile_1=__webpack_require__(405);var fancy_drag_indicator_1=__webpack_require__(189);var split_menu_1=__webpack_require__(438);var dimension_picker_menu_1=__webpack_require__(191);var dimension_pill_1=__webpack_require__(416);var deferred_1=__webpack_require__(417);__webpack_require__(648);var SPLIT_CLASS_NAME="split";var SplitTile=function(_super){tslib_1.__extends(SplitTile,_super);function SplitTile(){var _this=_super.call(this)||this;_this.overflowMenuId=beltful_1.DOMUtils.uniqueId("overflow-menu-");_this.state={menuOpenOn:null,menuDimension:null,dragPosition:null};return _this}SplitTile.prototype.componentDidMount=function(){this.calculateSize()};SplitTile.prototype.calculateSize=function(){if(!this.itemsDOM)return;var itemStage=this.state.itemStage;var newItemStage=beltful_1.Stage.fromClientRect(this.itemsDOM.getBoundingClientRect());if(!newItemStage.equals(itemStage)){this.setState({itemStage:newItemStage})}};SplitTile.prototype.selectDimensionSplit=function(dimension,split,e){var target=dom_1.findParentWithClass(e.target,SPLIT_CLASS_NAME);this.openMenu(dimension,split,target)};SplitTile.prototype.openMenu=function(dimension,split,target){var menuOpenOn=this.state.menuOpenOn;if(menuOpenOn===target){this.closeMenu();return}var overflowMenu=this.getOverflowMenu();var menuInsideID=null;if(overflowMenu&&beltful_1.DOMUtils.isInside(target,overflowMenu)){menuInsideID=this.overflowMenuId}this.setState({menuOpenOn:target,menuDimension:dimension,menuSplit:split,menuInsideID:menuInsideID})};SplitTile.prototype.closeMenu=function(){var menuOpenOn=this.state.menuOpenOn;if(!menuOpenOn)return;this.setState({menuOpenOn:null,menuDimension:null,menuInsideID:null,menuSplit:null})};SplitTile.prototype.getOverflowMenu=function(){return document.getElementById(this.overflowMenuId)};SplitTile.prototype.openOverflowMenu=function(target){if(!target)return Promise.resolve(null);var overflowMenuOpenOn=this.state.overflowMenuOpenOn;if(overflowMenuOpenOn===target){this.closeOverflowMenu();return Promise.resolve(null)}this.overflowMenuDeferred=new deferred_1.Deferred;this.setState({overflowMenuOpenOn:target});return this.overflowMenuDeferred.promise};SplitTile.prototype.closeOverflowMenu=function(){var overflowMenuOpenOn=this.state.overflowMenuOpenOn;if(!overflowMenuOpenOn)return;this.setState({overflowMenuOpenOn:null})};SplitTile.prototype.removeSplit=function(split,e){var clicker=this.props.clicker;clicker.removeSplit(split);this.closeMenu();this.closeOverflowMenu();e.stopPropagation()};SplitTile.prototype.dragStart=function(dimension,split,e){var _a=this.props,essence=_a.essence,getLongUrl=_a.getLongUrl;var filter=essence.getEffectiveFilter();var dataTransfer=e.dataTransfer;dataTransfer.effectAllowed="all";if(getLongUrl){var newUrl=getLongUrl(essence.addSplit(models_1.SplitCombine.fromDimensionAndFilterAndMeasure(dimension,filter,essence.getSortMeasure()),models_1.VisStrategy.FairGame));dataTransfer.setData("text/url-list",newUrl);dataTransfer.setData("text/plain",newUrl)}drag_manager_1.DragManager.setDragSplit(split,"filter-tile");drag_manager_1.DragManager.setDragDimension(dimension,"filter-tile");beltful_1.DOMUtils.setDragGhost(dataTransfer,dimension.title);this.closeMenu();this.closeOverflowMenu()};SplitTile.prototype.calculateDragPosition=function(e){var essence=this.props.essence;var splits=essence.getConstrainedSplits();var numItems=splits.length();var rect=this.itemsDOM.getBoundingClientRect();var x=beltful_1.EventUtils.getXFromEvent(e);var offset=x-rect.left;return models_1.DragPosition.calculateFromOffset(offset,numItems,constants_1.CORE_ITEM_WIDTH,constants_1.CORE_ITEM_GAP)};SplitTile.prototype.canDrop=function(e){return Boolean(drag_manager_1.DragManager.getDragSplit()||drag_manager_1.DragManager.getDragDimension())};SplitTile.prototype.dragEnter=function(e){if(!this.canDrop(e))return;e.preventDefault();this.setState({dragPosition:this.calculateDragPosition(e)})};SplitTile.prototype.dragOver=function(e){if(!this.canDrop(e))return;e.dataTransfer.dropEffect="move";e.preventDefault();var dragPosition=this.calculateDragPosition(e);if(dragPosition.equals(this.state.dragPosition))return;this.setState({dragPosition:dragPosition})};SplitTile.prototype.dragLeave=function(e){if(!this.canDrop(e))return;this.setState({dragPosition:null})};SplitTile.prototype.drop=function(e){if(!this.canDrop(e))return;e.preventDefault();var _a=this.props,clicker=_a.clicker,essence=_a.essence;var filter=essence.getEffectiveFilter();var splits=essence.getConstrainedSplits();var newSplitCombine=null;var splitDimension=drag_manager_1.DragManager.getDragDimension();if(drag_manager_1.DragManager.getDragSplit()){newSplitCombine=drag_manager_1.DragManager.getDragSplit()}else if(splitDimension){newSplitCombine=models_1.SplitCombine.fromDimensionAndFilterAndMeasure(splitDimension,filter,essence.getSortMeasure())}if(newSplitCombine){var dragPosition=this.calculateDragPosition(e);var newSplits=null;if(dragPosition.isReplace()){newSplits=splits.replaceByIndex(dragPosition.replace,newSplitCombine)}else{newSplits=splits.insertByIndex(dragPosition.insert,newSplitCombine)}clicker.changeSplits(newSplits)}this.setState({dragPosition:null})};SplitTile.prototype.openMenuOnDimension=function(dimension,split){var _this=this;var targetRef=this.refs[dimension.name];if(targetRef){var target=ReactDOM.findDOMNode(targetRef);if(!target)return;this.openMenu(dimension,split,target)}else{var overflowButtonTarget=this.overflowDOM;if(overflowButtonTarget){this.openOverflowMenu(overflowButtonTarget).then(function(){var target=ReactDOM.findDOMNode(_this.refs[dimension.name]);if(!target)return;_this.openMenu(dimension,split,target)})}}};SplitTile.prototype.splitMenuRequest=function(dimension){var essence=this.props.essence;var splits=essence.getConstrainedSplits();var split=splits.findSplitForDimension(dimension.name);if(split){this.openMenuOnDimension(dimension,split)}};SplitTile.prototype.overflowButtonClick=function(){this.openOverflowMenu(this.overflowDOM)};SplitTile.prototype.renderMenu=function(){var _a=this.props,essence=_a.essence,clicker=_a.clicker,customization=_a.customization;var _b=this.state,menuOpenOn=_b.menuOpenOn,menuDimension=_b.menuDimension,menuSplit=_b.menuSplit,menuInsideID=_b.menuInsideID;if(!menuDimension)return null;var onClose=this.closeMenu.bind(this);return React.createElement(split_menu_1.SplitMenu,{clicker:clicker,essence:essence,openOn:menuOpenOn,dimension:menuDimension,split:menuSplit,displayLimit:essence.getEffectiveSplitForDimension(menuDimension.name).getLimitAction(),onClose:onClose,insideId:menuInsideID,customization:customization})};SplitTile.prototype.renderOverflowMenu=function(splits,pillColor){var _this=this;var overflowMenuOpenOn=this.state.overflowMenuOpenOn;if(!overflowMenuOpenOn)return null;var segmentHeight=29+constants_1.CORE_ITEM_GAP;var itemY=constants_1.CORE_ITEM_GAP;var filterItems=splits.map(function(split){var style=dom_1.transformStyle(0,itemY);style.backgroundColor=pillColor;itemY+=segmentHeight;return _this.renderSplit(split,style,pillColor)});return React.createElement(caladan_1.BubbleMenu,{className:"overflow-menu",id:this.overflowMenuId,ref:function(e){if(!e||!_this.overflowMenuDeferred)return;window.setTimeout(function(){var overflowMenuDOM=_this.getOverflowMenu();if(_this.overflowMenuDeferred){_this.overflowMenuDeferred.resolve(overflowMenuDOM);_this.overflowMenuDeferred=null}},1)},direction:"down",stage:beltful_1.Stage.fromSize(constants_1.CORE_ITEM_WIDTH+16,itemY),fixedSize:true,openOn:overflowMenuOpenOn,onClose:this.closeOverflowMenu.bind(this)},filterItems)};SplitTile.prototype.renderOverflow=function(items,itemX,pillColor){var _this=this;var essence=this.props.essence;var style=dom_1.transformStyle(itemX,0);var classes=["overflow",{"all-continuous":items.every(function(item){return item.getDimension(essence.getDimensions()).isContinuous()})}];return React.createElement(dimension_pill_1.DimensionPill,{key:"overflow",ref:function(pill){return _this.overflowDOM=ReactDOM.findDOMNode(pill)},label:"+"+items.length,color:pillColor,classes:classes,style:dom_1.transformStyle(itemX,0),onClick:function(){return _this.overflowButtonClick()}},this.renderOverflowMenu(items,pillColor))};SplitTile.prototype.renderSplit=function(split,style,pillColor){var _this=this;var essence=this.props.essence;var menuDimension=this.state.menuDimension;var dimensions=essence.getDimensions();var dimension=split.getDimension(dimensions);if(!dimension)throw new Error("dimension not found");var classes=[SPLIT_CLASS_NAME,{selected:dimension===menuDimension},"type-"+dimension.type.toLowerCase()];return React.createElement(dimension_pill_1.DimensionPill,{key:dimension.name,ref:dimension.name,label:split.getTitle(dimensions),color:pillColor,classes:classes,style:style,icon:dimension.getIcon(),onDrag:function(e){return _this.dragStart(dimension,split,e)},onClick:function(e){return _this.selectDimensionSplit(dimension,split,e)},onRemove:function(e){return _this.removeSplit(split,e)}})};SplitTile.prototype.splitOnDimension=function(dimension){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var filter=essence.getEffectiveFilter();var splits=essence.getConstrainedSplits();if(splits.hasSplitOn(dimension.name)&&splits.length()===1){this.splitMenuRequest(dimension)}else{var split=models_1.SplitCombine.fromDimensionAndFilterAndMeasure(dimension,filter,essence.getSortMeasure());clicker.addSplit(split,models_1.VisStrategy.FairGame)}this.setState({addMenuOpen:false})};SplitTile.prototype.renderAddMenu=function(){var _this=this;var essence=this.props.essence;var addMenuOpen=this.state.addMenuOpen;if(!addMenuOpen)return null;return React.createElement(dimension_picker_menu_1.DimensionPickerMenu,{dimensions:essence.getDimensions(),onSelect:function(d){return _this.splitOnDimension(d)},openOn:this.addButton,onClose:function(){return _this.setState({addMenuOpen:false})}})};SplitTile.prototype.renderItems=function(titleWidthOverride){var _this=this;var _a=this.props,essence=_a.essence,customization=_a.customization;var _b=this.state,itemStage=_b.itemStage,addMenuOpen=_b.addMenuOpen,dragPosition=_b.dragPosition;var pillColor=customization.getPreferredTheme(essence.actualDataCube.theme).getPillColor();var splits=essence.getConstrainedSplits().toArray();var maxItems=itemStage?pill_tile_1.getMaxItems(itemStage.width,splits.length):20;var itemX=0;var splitItems=splits.slice(0,maxItems).map(function(split){var style=dom_1.transformStyle(itemX,0);itemX+=pill_tile_1.SECTION_WIDTH;return _this.renderSplit(split,style,pillColor)});var overflowItems=splits.slice(maxItems);if(overflowItems.length>0){var overFlowStart=splitItems.length*pill_tile_1.SECTION_WIDTH;itemX+=pill_tile_1.OVERFLOW_SECTION_WIDTH;splitItems.push(this.renderOverflow(overflowItems,overFlowStart,pillColor))}return React.createElement("div",{className:"items",ref:function(e){return _this.itemsDOM=e},style:{left:titleWidthOverride}},splitItems,!(dragPosition&&dragPosition.replace===splitItems.length)?React.createElement("div",{className:"add-split",style:dom_1.transformStyle(itemX,8),ref:function(element){return _this.addButton=element},onClick:function(){return _this.setState({addMenuOpen:!addMenuOpen})}},React.createElement(caladan_1.SvgIcon,{svg:little_pictures_1.FULL_ADD})):null)};SplitTile.prototype.render=function(){var customization=this.props.customization;var dragPosition=this.state.dragPosition;var renameSplitTo=customization?customization.renameSplitTo:null;var titleWidthOverride=customization&&customization.renameFilterOrSplit()?74:null;return React.createElement("div",{className:"split-tile",onDragEnter:this.dragEnter.bind(this)},React.createElement(caladan_1.GlobalEventListener,{resize:this.calculateSize.bind(this)}),React.createElement("div",{className:"title",style:{width:titleWidthOverride}},renameSplitTo||strings_1.STRINGS.split),this.renderItems(titleWidthOverride),dragPosition?React.createElement(fancy_drag_indicator_1.FancyDragIndicator,{dragPosition:dragPosition,style:{left:titleWidthOverride}}):null,dragPosition?React.createElement("div",{className:"drag-mask",onDragOver:this.dragOver.bind(this),onDragLeave:this.dragLeave.bind(this),onDragExit:this.dragLeave.bind(this),onDrop:this.drop.bind(this)}):null,this.renderMenu(),this.renderAddMenu())};return SplitTile}(React.Component);exports.SplitTile=SplitTile},function(module,exports,__webpack_require__){var content=__webpack_require__(649);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./split-tile.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./split-tile.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".split-tile{background:#fff}.split-tile .title{position:absolute;top:0;bottom:0;left:0;width:64px;padding:12px 0 0 14px;font-size:12px;text-transform:uppercase;color:#999;cursor:default;white-space:nowrap}.split-tile .drag-mask{position:absolute;top:0;bottom:0;left:0;right:0}.split-tile .items{position:absolute;top:0;bottom:0;left:64px;right:0;-webkit-transition:height 0.1s ease-in-out;-o-transition:height 0.1s ease-in-out;transition:height 0.1s ease-in-out;overflow:hidden}.split-tile .items .dimension-pill{position:absolute;left:0}.split-tile .fancy-drag-indicator{position:absolute;top:0;bottom:0;left:64px;right:0}.split-tile .add-split{position:absolute;cursor:pointer}.split-tile .add-split svg{margin-top:1px;height:19px;width:19px;fill:#bbb}.split-tile .add-split:hover svg{fill:#888}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var strings_1=__webpack_require__(17);__webpack_require__(651);var UserMenu=function(_super){tslib_1.__extends(UserMenu,_super);function UserMenu(){return _super.call(this)||this}UserMenu.prototype.renderLogoutButton=function(){var customization=this.props.customization;if(!customization.logoutHref)return null;var onLogout=function(){caladan_1.GateKeeper.checkAndCall(function(){return window.open(customization.logoutHref,"_self")})};return React.createElement("li",{className:"logout"},React.createElement("div",{onClick:onLogout},strings_1.STRINGS.logout))};UserMenu.prototype.render=function(){var _a=this.props,openOn=_a.openOn,onClose=_a.onClose,user=_a.user,showSettings=_a.showSettings;if(!user)return null;var stage=beltful_1.Stage.fromSize(200,200);var settingsLink=React.createElement("div",null,React.createElement("div",{className:"separator"}),React.createElement("a",{href:"/settings"},React.createElement("li",{className:"simple-item"},strings_1.STRINGS.generalSettings)));return React.createElement(caladan_1.BubbleMenu,{className:"user-menu",direction:"down",stage:stage,openOn:openOn,onClose:onClose},React.createElement("ul",{className:"bubble-list"},React.createElement("li",{className:"display-name"},user.getDisplayName()),this.renderLogoutButton(),showSettings?settingsLink:null))};return UserMenu}(React.Component);exports.UserMenu=UserMenu},function(module,exports,__webpack_require__){var content=__webpack_require__(652);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./user-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./user-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".user-menu ul.bubble-list li.display-name{pointer-events:none;color:#a6a6a6}.user-menu .separator{height:1px;margin:11px 0 11px 0;border-top:1px solid #dedede}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);var dom_1=__webpack_require__(68);var formatter_1=__webpack_require__(186);__webpack_require__(654);var TICK_WIDTH=5;var TEXT_OFFSET=2;var VerticalAxis=function(_super){tslib_1.__extends(VerticalAxis,_super);function VerticalAxis(){return _super.call(this)||this}VerticalAxis.prototype.render=function(){var _a=this.props,stage=_a.stage,ticks=_a.ticks,scale=_a.scale,measure=_a.measure,topLineExtend=_a.topLineExtend,hideZero=_a.hideZero;if(hideZero)ticks=ticks.filter(function(tick){return tick!==0});var formatter=formatter_1.formatterFromData(ticks,measure.getFormat());var lines=ticks.map(function(tick){var y=dom_1.roundToHalfInteger(scale(tick));return React.createElement("line",{className:"tick",key:String(tick),x1:0,y1:y,x2:TICK_WIDTH,y2:y})});var labelX=TICK_WIDTH+TEXT_OFFSET;var dy="0.31em";var labels=ticks.map(function(tick){var y=scale(tick);return React.createElement("text",{className:"tick",key:String(tick),x:labelX,y:y,dy:dy},formatter(tick))});return React.createElement("g",{className:"vertical-axis",transform:stage.getTransform()},React.createElement("line",{className:"border",x1:.5,y1:-topLineExtend,x2:.5,y2:stage.height}),lines,labels)};VerticalAxis.defaultProps={topLineExtend:0};return VerticalAxis}(React.Component);exports.VerticalAxis=VerticalAxis},function(module,exports,__webpack_require__){var content=__webpack_require__(655);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./vertical-axis.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./vertical-axis.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".vertical-axis{pointer-events:none}.vertical-axis line.border{stroke:#ccc}.vertical-axis line.tick{stroke:#ccc}.vertical-axis text{font-size:12px;fill:#666}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);__webpack_require__(657);var VisMeasureLabel=function(_super){tslib_1.__extends(VisMeasureLabel,_super);function VisMeasureLabel(){return _super.call(this)||this}VisMeasureLabel.prototype.render=function(){var _a=this.props,measure=_a.measure,datum=_a.datum,onClick=_a.onClick;return React.createElement("div",{onClick:onClick,className:"vis-measure-label"},React.createElement("span",{className:"measure-title"},measure.title),React.createElement("span",{className:"colon"},": "),React.createElement("span",{className:"measure-value"},measure.formatFn(datum[measure.name])))};return VisMeasureLabel}(React.Component);exports.VisMeasureLabel=VisMeasureLabel},function(module,exports,__webpack_require__){var content=__webpack_require__(658);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./vis-measure-label.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./vis-measure-label.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".vis-measure-label{pointer-events:none;white-space:nowrap}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var icons_1=__webpack_require__(439);var dom_1=__webpack_require__(68);var vis_selector_menu_1=__webpack_require__(440);__webpack_require__(662);var VisSelector=function(_super){tslib_1.__extends(VisSelector,_super);function VisSelector(){var _this=_super.call(this)||this;_this.state={menuOpenOn:null};return _this}VisSelector.prototype.openMenu=function(e){var menuOpenOn=this.state.menuOpenOn;var target=dom_1.findParentWithClass(e.target,"vis-selector");if(menuOpenOn===target){this.closeMenu();return}this.setState({menuOpenOn:target})};VisSelector.prototype.closeMenu=function(){this.setState({menuOpenOn:null})};VisSelector.prototype.render=function(){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var menuOpenOn=this.state.menuOpenOn;var visualization=essence.getVisualizationManifest();var menu=null;if(menuOpenOn){menu=React.createElement(vis_selector_menu_1.VisSelectorMenu,{clicker:clicker,essence:essence,openOn:menuOpenOn,onClose:this.closeMenu.bind(this)})}return React.createElement("div",{className:classNames("vis-selector",{active:!!menuOpenOn}),onClick:this.openMenu.bind(this)},React.createElement("div",{className:"vis-item selected"},React.createElement(caladan_1.SvgIcon,{svg:icons_1.VISUALIZATIONS[visualization.name]}),React.createElement("div",{className:"vis-title"},visualization.title)),menu)};return VisSelector}(React.Component);exports.VisSelector=VisSelector},function(module,exports,__webpack_require__){var content=__webpack_require__(661);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./vis-selector-menu.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./vis-selector-menu.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".vis-selector-menu{background:#fff;border-radius:2px;-webkit-box-shadow:0 3px 10px 0 rgba(0,0,0,0.26),0 0 3px 0 rgba(0,0,0,0.16);box-shadow:0 3px 10px 0 rgba(0,0,0,0.26),0 0 3px 0 rgba(0,0,0,0.16)}.vis-selector-menu{font-size:0;width:272px;padding:16px}.vis-selector-menu .vis-item{display:inline-block;width:78px;height:70px;cursor:pointer}.vis-selector-menu .vis-item .vis-title{position:absolute;left:0;right:0;bottom:7px;text-align:center;font-size:11px;font-weight:400;color:#666}.vis-selector-menu .vis-item svg{position:absolute;top:3px;left:50%;width:53px;height:53px;margin-left:-27px}.vis-selector-menu .vis-item{margin:1px;border-radius:2px}.vis-selector-menu .vis-item:hover{-webkit-box-shadow:inset 0 0 0 1px #dedede;box-shadow:inset 0 0 0 1px #dedede}.vis-selector-menu .vis-item.selected{-webkit-box-shadow:inset 0 0 0 1px #d1d1d1;box-shadow:inset 0 0 0 1px #d1d1d1}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(663);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./vis-selector.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./vis-selector.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".vis-selector{background:#fff}.vis-selector::before{position:absolute;top:0;bottom:0;left:0;right:0;content:'';z-index:6;background-color:rgba(255,255,255,0.65);pointer-events:none;opacity:0}.vis-selector::after{width:0;height:0;border-top:9px solid #666;border-bottom:0;border-left:7px solid transparent;border-right:7px solid transparent;content:'';z-index:7;position:absolute;top:50%;left:50%;margin-top:-6px;margin-left:-7px;pointer-events:none;opacity:0}.vis-selector:hover::after,.vis-selector:hover::before,.vis-selector.active::after,.vis-selector.active::before{opacity:1}.vis-selector .vis-item{display:inline-block;width:78px;height:70px;cursor:pointer}.vis-selector .vis-item .vis-title{position:absolute;left:0;right:0;bottom:7px;text-align:center;font-size:11px;font-weight:400;color:#666}.vis-selector .vis-item svg{position:absolute;top:3px;left:50%;width:53px;height:53px;margin-left:-27px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DEFAULT_DELAY=100;var LoadingMessageDelegate=function(){function LoadingMessageDelegate(component,delay){if(delay===void 0){delay=DEFAULT_DELAY}this.delay=DEFAULT_DELAY;this.component=component;this.delay=delay}LoadingMessageDelegate.prototype.setState=function(state,callback){return this.component.setState.call(this.component,state,callback)};LoadingMessageDelegate.prototype.start=function(message){var _this=this;this.timeoutId=window.setTimeout(function(){_this.timeoutId=undefined;_this.setState({isLoading:true,loadingMessage:message})},this.delay)};LoadingMessageDelegate.prototype.startNow=function(message){this.setState({isLoading:true,loadingMessage:message})};LoadingMessageDelegate.prototype.stop=function(){var _this=this;return new Promise(function(resolve){if(_this.timeoutId){window.clearTimeout(_this.timeoutId);resolve()}else{_this.setState({isLoading:false,loadingMessage:undefined},function(){return resolve()})}})};LoadingMessageDelegate.prototype.unmount=function(){if(this.timeoutId){window.clearTimeout(this.timeoutId)}};return LoadingMessageDelegate}();exports.LoadingMessageDelegate=LoadingMessageDelegate},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var ajax_1=__webpack_require__(69);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Clipboard=__webpack_require__(485);var immutable_class_1=__webpack_require__(7);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var local_storage_1=__webpack_require__(758);var about_modal_1=__webpack_require__(493);var expired_modal_1=__webpack_require__(806);var welcome_modal_1=__webpack_require__(809);var darkout_1=__webpack_require__(812);var app_drawer_1=__webpack_require__(496);var collection_view_1=__webpack_require__(815);var cube_edit_view_1=__webpack_require__(957);var cube_view_1=__webpack_require__(771);var home_view_1=__webpack_require__(970);var link_view_1=__webpack_require__(982);var query_runner_1=__webpack_require__(73);__webpack_require__(988);var PivotApplication=function(_super){tslib_1.__extends(PivotApplication,_super);function PivotApplication(){var _this=_super.call(this)||this;_this.fetchingSettings=false;_this.knownEssenceHash={};_this.knownCollectionEssenceHash={};_this.state={appSettings:null,drawerOpen:false,showAboutModal:false,showWelcomeModal:false,showExpiredModal:false};var resetEditStateIfNeeded=function(){var _a=_this.state,dataCubeEditController=_a.dataCubeEditController,collectionEditController=_a.collectionEditController;if(!dataCubeEditController&&!collectionEditController)return;_this.setState({dataCubeEditController:null,collectionEditController:null})};window.setDarkoutStage=function(stageJS){_this.setState({darkoutStage:stageJS?beltful_1.Stage.fromJS(stageJS):null})};_this.controller={openSideDrawer:function(){_this.setState({drawerOpen:true})},goHome:function(){window.setTimeout(function(){PivotApplication.pushState(_this.mount("home"));resetEditStateIfNeeded()},1)},openCollection:function(collection,collectionEssence){if(collectionEssence){_this.onCollectionEssenceChange(collectionEssence)}else{PivotApplication.pushState(_this.mount(["c",collection.name,beltful_1.StringUtils.makeUrlSafeName(collection.title)].join("/")))}resetEditStateIfNeeded()},openDataCube:function(dataCube,essence,goBack){_this.goBack=goBack;if(essence){_this.onEssenceChange(essence)}else{PivotApplication.pushState(_this.mount(["d",dataCube.name,beltful_1.StringUtils.makeUrlSafeName(dataCube.title)].join("/")))}resetEditStateIfNeeded()},editDataCube:function(dataCube,editMode){var user=_this.props.user;var appSettings=_this.state.appSettings;if(editMode==="update"&&!dataCube.getModifyAccess().hasAccess(user)){caladan_1.Notifier.ask({title:"Duplicate data cube",message:"You don't have permission to edit this data cube, but you can make your own duplicate and modify it.",choices:[{label:"Cancel",closeOnClick:true,type:"secondary"},{label:"Duplicate",type:"primary",closeOnClick:true,callback:function(){_this.controller.editDataCube(appSettings.duplicateDataCube(dataCube,user),"duplicate")}}]});return}_this.setState({dataCubeEditController:{dataCube:dataCube,editMode:editMode,onDelete:function(){caladan_1.Notifier.handleRemoval("data cube",function(){var _a=_this.state,appSettings=_a.appSettings,dataCubeEditController=_a.dataCubeEditController;_this.controller.updateSettings(appSettings.deleteDataCube(dataCubeEditController.dataCube.name)).then(function(){caladan_1.Notifier.success("Data cube deleted");_this.controller.goHome()})},dataCube.title)},onCancel:resetEditStateIfNeeded,onSave:function(newDataCube){var appSettings=_this.state.appSettings;var nextState=editMode==="create"?{}:{dataCubeEditController:null};return _this.controller.updateSettings(appSettings.addOrUpdateDataCube(newDataCube),nextState).then(function(){if(editMode==="create")_this.controller.openDataCube(newDataCube)},function(e){var jsonError=e.jsonError;if(jsonError&&jsonError.error==="conflict"){caladan_1.Notifier.failure("Conflict","Please refresh and try again")}else{caladan_1.Notifier.failure("Error",e.message)}})}}})},editCollection:function(collection,editMode){var user=_this.props.user;var appSettings=_this.state.appSettings;if(editMode==="update"&&!collection.getModifyAccess().hasAccess(user)){caladan_1.Notifier.ask({title:"Duplicate dashboard",message:"You don't have permission to edit this dashboard, but you can make your own duplicate and modify it.",choices:[{label:"Cancel",closeOnClick:true,type:"secondary"},{label:"Duplicate",type:"primary",closeOnClick:true,callback:function(){_this.controller.editCollection(appSettings.duplicateCollection(collection,user),"duplicate")}}]});return}_this.setState({collectionEditController:{collection:collection,editMode:editMode,onDelete:function(){caladan_1.Notifier.handleRemoval("collection",function(){var _a=_this.state,appSettings=_a.appSettings,collectionEditController=_a.collectionEditController;_this.controller.updateSettings(appSettings.deleteCollection(collectionEditController.collection.name)).then(function(){caladan_1.Notifier.success("Dashboard deleted");_this.controller.goHome()})},collection.title)},onCancel:resetEditStateIfNeeded,onSave:function(newCollection){var _a=_this.state,appSettings=_a.appSettings,collectionEditController=_a.collectionEditController;var nextState=editMode==="create"?{}:{collectionEditController:null};return _this.controller.updateSettings(appSettings.addOrUpdateCollection(newCollection),nextState).then(function(){if(editMode==="create"||editMode==="duplicate")_this.controller.openCollection(newCollection)},function(e){var jsonError=e.jsonError;if(jsonError&&jsonError.error==="conflict"){caladan_1.Notifier.failure("Conflict","Please refresh and try again")}else{caladan_1.Notifier.failure("Error",e.message)}})}}})},openSettings:function(preferredTab){window.open(_this.mount("settings"+(preferredTab?"/"+preferredTab:"")),"_self")},updateSettings:function(newSettings,nextState){var appSettings=_this.state.appSettings;return ajax_1.Ajax.query({method:"POST",url:_this.mount("change"),data:{dataCubeDiffs:immutable_class_1.NamedArray.computeDiffs(appSettings.dataCubes,newSettings.dataCubes),collectionDiffs:immutable_class_1.NamedArray.computeDiffs(appSettings.collections,newSettings.collections)}}).then(function(resp){if(!_this.mounted)return null;var newState=Object.assign({appSettings:models_1.AppSettings.fromJS(resp.clientSettings,{visualizations:models_1.MANIFESTS})},nextState||{});var undoFn=function(){_this.controller.updateSettings(appSettings).then(function(){return caladan_1.Notifier.success("Undone")},function(){return caladan_1.Notifier.failure("Woops","Something bad happened during undo")})};return new Promise(function(resolve){_this.setState(newState,function(){return resolve(undoFn)})})})},refreshMaxTime:function(dataCube){var timekeeper=_this.state.timekeeper;if(dataCube.getRefreshTimeWith()!=="query")return;_this.setState({updatingTimekeeper:true});ajax_1.Ajax.query({method:"POST",url:_this.mount("plywood/max-time"),data:{dataCube:dataCube.name}}).then(function(res){if(!_this.mounted||!res)return;var updatedMaxTime=new Date(res.result);_this.setState({timekeeper:timekeeper.addOrUpdateTimeTagFor(dataCube.name,updatedMaxTime),updatingTimekeeper:false})})}};_this.fetchSettings=_this.fetchSettings.bind(_this);var clipboard=new Clipboard(".clipboard");return _this}PivotApplication.setTitle=function(newTitle){if(document.title!==newTitle){document.title=newTitle}};PivotApplication.pushState=function(url){window.history.pushState(null,"",url)};PivotApplication.prototype.toggleFavorite=function(name){var _this=this;var favorites=this.state.favorites;var newFavorites=favorites.includes(name)?favorites.filter(function(n){return n!==name}):favorites.concat(name);ajax_1.Ajax.query({method:"POST",url:this.mount("set-favorites"),data:{favorites:newFavorites}}).catch(function(e){_this.setState({favorites:favorites});caladan_1.Notifier.failure("Could not save favorite")});this.setState({favorites:newFavorites})};PivotApplication.prototype.onEssenceChange=function(essence){var hash=essence.getHash();this.knownEssenceHash[hash]=essence.toJS();query_runner_1.QueryRunner.registerEssence(essence);var fragment=["d",hash,beltful_1.StringUtils.makeUrlSafeTitle(essence.actualDataCube.title)].join("/");PivotApplication.pushState(this.mount(fragment))};PivotApplication.prototype.onCollectionEssenceChange=function(essence){var hash=essence.getHash();this.knownCollectionEssenceHash[hash]=essence.toJS();query_runner_1.QueryRunner.registerEssence(essence);var fragment=["c",hash,beltful_1.StringUtils.makeUrlSafeTitle(essence.actualCollection.title)].join("/");PivotApplication.pushState(this.mount(fragment))};PivotApplication.prototype.fetchSettings=function(){var _this=this;if(this.fetchingSettings)return;this.fetchingSettings=true;ajax_1.Ajax.query({url:this.mount("load")}).then(function(resp){if(!_this.mounted)return;_this.fetchingSettings=false;var appSettings=models_1.AppSettings.fromJS(resp.clientSettings,{visualizations:models_1.MANIFESTS});_this.setState({appSettings:appSettings})},function(e){_this.fetchingSettings=false})};PivotApplication.prototype.componentWillMount=function(){var _a=this.props,appSettings=_a.appSettings,specialRun=_a.specialRun,initEssence=_a.initEssence,initTimekeeper=_a.initTimekeeper,user=_a.user,hasQueryCache=_a.hasQueryCache;query_runner_1.QueryRunner.hasQueryCache=hasQueryCache;var showWelcomeModal=specialRun==="welcome";var showExpiredModal=specialRun==="expired";if(initEssence){if(initEssence instanceof models_1.Essence){this.knownEssenceHash[initEssence.getHash()]=initEssence.toJS()}else if(initEssence instanceof models_1.CollectionEssence){this.knownCollectionEssenceHash[initEssence.getHash()]=initEssence.toJS()}}this.setState({appSettings:appSettings,showWelcomeModal:showWelcomeModal,showExpiredModal:showExpiredModal,timekeeper:initTimekeeper||models_1.Timekeeper.EMPTY,favorites:user?user.getFavorites():[]})};PivotApplication.prototype.componentDidMount=function(){var _this=this;this.mounted=true;ajax_1.Ajax.addUpdateHandler(this.fetchSettings);ajax_1.Ajax.settingsVersionGetter=function(){var appSettings=_this.state.appSettings;return appSettings.version?appSettings.version.getMs():null}};PivotApplication.prototype.componentWillUnmount=function(){this.mounted=false;ajax_1.Ajax.removeUpdateHandler(this.fetchSettings)};PivotApplication.prototype.setBaseTitle=function(){var _a=this.props,appSettings=_a.appSettings,version=_a.version;PivotApplication.setTitle(appSettings.customization.getTitleWithVersion(version))};PivotApplication.prototype.needsGateKeeping=function(){var _a=this.state,dataCubeEditController=_a.dataCubeEditController,collectionEditController=_a.collectionEditController;return Boolean(dataCubeEditController||collectionEditController)};PivotApplication.prototype.renderAboutModal=function(){var _this=this;var version=this.props.version;var showAboutModal=this.state.showAboutModal;if(!showAboutModal)return null;return React.createElement(about_modal_1.AboutModal,{version:version,onClose:function(){return _this.setState({showAboutModal:false})}})};PivotApplication.prototype.renderWelcomeModal=function(){var _this=this;var version=this.props.version;var showWelcomeModal=this.state.showWelcomeModal;if(!showWelcomeModal)return null;return React.createElement(welcome_modal_1.WelcomeModal,{version:version,onClose:function(){return _this.setState({showWelcomeModal:false})}})};PivotApplication.prototype.renderExpiredModal=function(){var version=this.props.version;var showExpiredModal=this.state.showExpiredModal;if(!showExpiredModal)return null;return React.createElement(expired_modal_1.ExpiredModal,{version:version})};PivotApplication.prototype.renderSideDrawer=function(){var _this=this;var _a=this.props,user=_a.user,stateful=_a.stateful,launcherHref=_a.launcherHref,settingsHref=_a.settingsHref;var _b=this.state,breadCrumbs=_b.breadCrumbs,drawerOpen=_b.drawerOpen,appSettings=_b.appSettings,favorites=_b.favorites;var open=function(item){if(models_1.DataCube.isDataCube(item)){_this.controller.openDataCube(item)}else{_this.controller.openCollection(item)}return false};return React.createElement(app_drawer_1.AppDrawer,{favorites:favorites,customization:appSettings.customization,dataCubes:appSettings.dataCubes,collections:appSettings.collections,breadCrumbs:breadCrumbs,onClose:function(){return _this.setState({drawerOpen:false})},needsGateKeeping:this.needsGateKeeping(),settingsVisible:stateful&&user&&user.canAccessSettings()&&appSettings.customization.getSettingsMode()!==models_1.Customization.SETTINGS_MODE_SUPPRESSED,launcherHref:launcherHref,settingsHref:settingsHref,isOpen:drawerOpen,mount:function(strings){return _this.mount(strings.join("/"))},open:open,goHome:function(){_this.controller.goHome();return false},showAboutModal:function(){return _this.setState({showAboutModal:true})}})};PivotApplication.prototype.onURLChange=function(breadCrumbs){this.setState({breadCrumbs:breadCrumbs})};PivotApplication.prototype.mount=function(path){var mountPoint=this.props.mountPoint;if(path.charAt(0)==="/")throw new Error("No leading / please (path is "+path+")");return mountPoint?"/"+mountPoint+"/"+path:"/"+path};PivotApplication.prototype.renderView=function(){var _this=this;var _a=this.props,user=_a.user,stateful=_a.stateful,launcherHref=_a.launcherHref;var _b=this.state,appSettings=_b.appSettings,timekeeper=_b.timekeeper,updatingTimekeeper=_b.updatingTimekeeper,dataCubeEditController=_b.dataCubeEditController,collectionEditController=_b.collectionEditController,favorites=_b.favorites;var dataCubes=appSettings.dataCubes,collections=appSettings.collections,customization=appSettings.customization;var dataCubeEssenceInflater=function(key,value){if(key!=="state")return{key:key,value:value};var parts=value.split("/");var dataCube=immutable_class_1.NamedArray.findByName(dataCubes,parts[0]);var context={dataCubes:dataCubes,visualizations:models_1.MANIFESTS,defaultMeasureModes:local_storage_1.LocalStorage.get("multi-measure")};var essence=null;if(dataCube){essence=models_1.Essence.fromDataCube(dataCube,context)}else if(parts[0].length===18){var essenceJS=_this.knownEssenceHash[parts[0]];essence=essenceJS?models_1.Essence.fromJS(essenceJS,context):null}else{essence=models_1.Essence.fromFullHash(parts[0],context)}if(essence){return{key:"essence",value:essence}}else{_this.controller.goHome();return null}};var collectionEssenceInflater=function(key,value){if(key!=="state")return{key:key,value:value};var parts=value.split("/");var collection=immutable_class_1.NamedArray.findByName(collections,parts[0]);var context={collections:collections};var collectionEssence=null;if(collection){collectionEssence=models_1.CollectionEssence.fromCollection(collection)}else if(parts[0].length===18){var collectionEssenceJS=_this.knownCollectionEssenceHash[parts[0]];collectionEssence=collectionEssenceJS?models_1.CollectionEssence.fromJS(collectionEssenceJS,context):null}else{collectionEssence=models_1.CollectionEssence.fromFullHash(parts[0],context)}if(collectionEssence){return{key:"collectionEssence",value:collectionEssence}}else{_this.controller.goHome();return null}};var setTitleFor=function(thing){if(thing)PivotApplication.setTitle(thing.title)};if(dataCubeEditController){return React.createElement(cube_edit_view_1.CubeEditView,{settings:appSettings,controller:this.controller,dataCube:dataCubeEditController.dataCube,editMode:dataCubeEditController.editMode,onDelete:dataCubeEditController.onDelete,onCancel:dataCubeEditController.onCancel,onSave:dataCubeEditController.onSave,user:user,customization:customization})}if(collectionEditController){return caladan_1.StateRouter.noop(React.createElement(collection_view_1.CollectionView,{settings:appSettings,collectionEssence:models_1.CollectionEssence.fromCollection(collectionEditController.collection),onEssenceChange:function(){return null},controller:this.controller,collectionEditController:collectionEditController,user:user,timekeeper:timekeeper,dataCubes:dataCubes,customization:customization,stateful:stateful}),this.mount(""),"router")}var linkViewCollection=customization.linkViewMode?appSettings.collections[0]:null;return React.createElement(caladan_1.StateRouter,{rootFragment:this.mount(""),key:"router",onURLChange:this.onURLChange.bind(this)},React.createElement(caladan_1.Route,{fragment:"home",onActivate:function(){return _this.setBaseTitle()}},linkViewCollection?React.createElement(link_view_1.LinkView,{controller:this.controller,user:user,collection:linkViewCollection,timekeeper:timekeeper,customization:customization,stateful:stateful}):React.createElement(home_view_1.HomeView,{settings:appSettings,controller:this.controller,user:user,customization:customization,stateful:stateful,favorites:favorites,toggleFavorite:function(name){return _this.toggleFavorite(name)},launcherHref:launcherHref})),React.createElement(caladan_1.Route,{fragment:"c"},React.createElement(caladan_1.Route,{fragment:":$state",inflate:collectionEssenceInflater,onActivate:function(_a){var collectionId=_a.collectionId;return setTitleFor(immutable_class_1.NamedArray.findByName(collections,collectionId))}},React.createElement(collection_view_1.CollectionView,{settings:appSettings,onEssenceChange:function(essence){return _this.onCollectionEssenceChange(essence)},controller:this.controller,user:user,timekeeper:timekeeper,updatingTimekeeper:updatingTimekeeper,dataCubes:dataCubes,customization:customization,stateful:stateful}))),React.createElement(caladan_1.Route,{fragment:"d"},React.createElement(caladan_1.Route,{fragment:":$state",inflate:dataCubeEssenceInflater,onActivate:function(_a){var dataCubeId=_a.dataCubeId;return setTitleFor(immutable_class_1.NamedArray.findByName(dataCubes,dataCubeId))}},React.createElement(cube_view_1.CubeView,{settings:appSettings,onEssenceChange:function(essence){return _this.onEssenceChange(essence)},controller:this.controller,user:user,timekeeper:timekeeper,updatingTimekeeper:updatingTimekeeper,customization:customization,stateful:stateful,goBack:this.goBack}))))};PivotApplication.prototype.render=function(){var darkoutStage=this.state.darkoutStage;return React.createElement("main",{className:"pivot-application"},this.renderView(),this.renderSideDrawer(),this.renderAboutModal(),this.renderWelcomeModal(),this.renderExpiredModal(),React.createElement(caladan_1.Notifications,null),React.createElement(caladan_1.Questions,null),darkoutStage?React.createElement(darkout_1.Darkout,{stage:darkoutStage}):null)};return PivotApplication}(React.Component);exports.PivotApplication=PivotApplication},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=newInterval;var t0=new Date,t1=new Date;function newInterval(floori,offseti,count,field){function interval(date){return floori(date=new Date(+date)),date}interval.floor=interval;interval.ceil=function(date){return floori(date=new Date(date-1)),offseti(date,1),floori(date),date};interval.round=function(date){var d0=interval(date),d1=interval.ceil(date);return date-d0<d1-date?d0:d1};interval.offset=function(date,step){return offseti(date=new Date(+date),step==null?1:Math.floor(step)),date};interval.range=function(start,stop,step){var range=[];start=interval.ceil(start);step=step==null?1:Math.floor(step);if(!(start<stop)||!(step>0))return range;do{range.push(new Date(+start))}while(offseti(start,step),floori(start),start<stop);return range};interval.filter=function(test){return newInterval(function(date){if(date>=date)while(floori(date),!test(date))date.setTime(date-1)},function(date,step){if(date>=date){if(step<0)while(++step<=0){while(offseti(date,-1),!test(date)){}}else while(--step>=0){while(offseti(date,+1),!test(date)){}}}})};if(count){interval.count=function(start,end){t0.setTime(+start),t1.setTime(+end);floori(t0),floori(t1);return Math.floor(count(t0,t1))};interval.every=function(step){step=Math.floor(step);return!isFinite(step)||!(step>0)?null:!(step>1)?interval:interval.filter(field?function(d){return field(d)%step===0}:function(d){return interval.count(0,d)%step===0})}}return interval}},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});var __WEBPACK_IMPORTED_MODULE_0__src_bisect__=__webpack_require__(772);__webpack_require__.d(__webpack_exports__,"bisect",function(){return __WEBPACK_IMPORTED_MODULE_0__src_bisect__["c"]});__webpack_require__.d(__webpack_exports__,"bisectRight",function(){return __WEBPACK_IMPORTED_MODULE_0__src_bisect__["b"]});__webpack_require__.d(__webpack_exports__,"bisectLeft",function(){return __WEBPACK_IMPORTED_MODULE_0__src_bisect__["a"]});var __WEBPACK_IMPORTED_MODULE_1__src_ascending__=__webpack_require__(747);__webpack_require__.d(__webpack_exports__,"ascending",function(){return __WEBPACK_IMPORTED_MODULE_1__src_ascending__["a"]});var __WEBPACK_IMPORTED_MODULE_2__src_bisector__=__webpack_require__(773);__webpack_require__.d(__webpack_exports__,"bisector",function(){return __WEBPACK_IMPORTED_MODULE_2__src_bisector__["a"]});var __WEBPACK_IMPORTED_MODULE_3__src_cross__=__webpack_require__(824);__webpack_require__.d(__webpack_exports__,"cross",function(){return __WEBPACK_IMPORTED_MODULE_3__src_cross__["a"]});var __WEBPACK_IMPORTED_MODULE_4__src_descending__=__webpack_require__(825);__webpack_require__.d(__webpack_exports__,"descending",function(){return __WEBPACK_IMPORTED_MODULE_4__src_descending__["a"]});var __WEBPACK_IMPORTED_MODULE_5__src_deviation__=__webpack_require__(775);__webpack_require__.d(__webpack_exports__,"deviation",function(){return __WEBPACK_IMPORTED_MODULE_5__src_deviation__["a"]});var __WEBPACK_IMPORTED_MODULE_6__src_extent__=__webpack_require__(777);__webpack_require__.d(__webpack_exports__,"extent",function(){return __WEBPACK_IMPORTED_MODULE_6__src_extent__["a"]});var __WEBPACK_IMPORTED_MODULE_7__src_histogram__=__webpack_require__(826);__webpack_require__.d(__webpack_exports__,"histogram",function(){return __WEBPACK_IMPORTED_MODULE_7__src_histogram__["a"]});var __WEBPACK_IMPORTED_MODULE_8__src_threshold_freedmanDiaconis__=__webpack_require__(829);__webpack_require__.d(__webpack_exports__,"thresholdFreedmanDiaconis",function(){return __WEBPACK_IMPORTED_MODULE_8__src_threshold_freedmanDiaconis__["a"]});var __WEBPACK_IMPORTED_MODULE_9__src_threshold_scott__=__webpack_require__(830);__webpack_require__.d(__webpack_exports__,"thresholdScott",function(){return __WEBPACK_IMPORTED_MODULE_9__src_threshold_scott__["a"]});var __WEBPACK_IMPORTED_MODULE_10__src_threshold_sturges__=__webpack_require__(781);__webpack_require__.d(__webpack_exports__,"thresholdSturges",function(){return __WEBPACK_IMPORTED_MODULE_10__src_threshold_sturges__["a"]});var __WEBPACK_IMPORTED_MODULE_11__src_max__=__webpack_require__(831);__webpack_require__.d(__webpack_exports__,"max",function(){return __WEBPACK_IMPORTED_MODULE_11__src_max__["a"]});var __WEBPACK_IMPORTED_MODULE_12__src_mean__=__webpack_require__(832);__webpack_require__.d(__webpack_exports__,"mean",function(){return __WEBPACK_IMPORTED_MODULE_12__src_mean__["a"]});var __WEBPACK_IMPORTED_MODULE_13__src_median__=__webpack_require__(833);__webpack_require__.d(__webpack_exports__,"median",function(){return __WEBPACK_IMPORTED_MODULE_13__src_median__["a"]});var __WEBPACK_IMPORTED_MODULE_14__src_merge__=__webpack_require__(834);__webpack_require__.d(__webpack_exports__,"merge",function(){return __WEBPACK_IMPORTED_MODULE_14__src_merge__["a"]});var __WEBPACK_IMPORTED_MODULE_15__src_min__=__webpack_require__(782);__webpack_require__.d(__webpack_exports__,"min",function(){return __WEBPACK_IMPORTED_MODULE_15__src_min__["a"]});var __WEBPACK_IMPORTED_MODULE_16__src_pairs__=__webpack_require__(774);__webpack_require__.d(__webpack_exports__,"pairs",function(){return __WEBPACK_IMPORTED_MODULE_16__src_pairs__["a"]});var __WEBPACK_IMPORTED_MODULE_17__src_permute__=__webpack_require__(835);__webpack_require__.d(__webpack_exports__,"permute",function(){return __WEBPACK_IMPORTED_MODULE_17__src_permute__["a"]});var __WEBPACK_IMPORTED_MODULE_18__src_quantile__=__webpack_require__(760);__webpack_require__.d(__webpack_exports__,"quantile",function(){return __WEBPACK_IMPORTED_MODULE_18__src_quantile__["a"]});var __WEBPACK_IMPORTED_MODULE_19__src_range__=__webpack_require__(779);__webpack_require__.d(__webpack_exports__,"range",function(){return __WEBPACK_IMPORTED_MODULE_19__src_range__["a"]});var __WEBPACK_IMPORTED_MODULE_20__src_scan__=__webpack_require__(836);__webpack_require__.d(__webpack_exports__,"scan",function(){return __WEBPACK_IMPORTED_MODULE_20__src_scan__["a"]});var __WEBPACK_IMPORTED_MODULE_21__src_shuffle__=__webpack_require__(837);__webpack_require__.d(__webpack_exports__,"shuffle",function(){return __WEBPACK_IMPORTED_MODULE_21__src_shuffle__["a"]});var __WEBPACK_IMPORTED_MODULE_22__src_sum__=__webpack_require__(838);__webpack_require__.d(__webpack_exports__,"sum",function(){return __WEBPACK_IMPORTED_MODULE_22__src_sum__["a"]});var __WEBPACK_IMPORTED_MODULE_23__src_ticks__=__webpack_require__(780);__webpack_require__.d(__webpack_exports__,"ticks",function(){return __WEBPACK_IMPORTED_MODULE_23__src_ticks__["a"]});__webpack_require__.d(__webpack_exports__,"tickIncrement",function(){return __WEBPACK_IMPORTED_MODULE_23__src_ticks__["b"]});__webpack_require__.d(__webpack_exports__,"tickStep",function(){return __WEBPACK_IMPORTED_MODULE_23__src_ticks__["c"]});var __WEBPACK_IMPORTED_MODULE_24__src_transpose__=__webpack_require__(783);__webpack_require__.d(__webpack_exports__,"transpose",function(){return __WEBPACK_IMPORTED_MODULE_24__src_transpose__["a"]});var __WEBPACK_IMPORTED_MODULE_25__src_variance__=__webpack_require__(776);__webpack_require__.d(__webpack_exports__,"variance",function(){return __WEBPACK_IMPORTED_MODULE_25__src_variance__["a"]});var __WEBPACK_IMPORTED_MODULE_26__src_zip__=__webpack_require__(839);__webpack_require__.d(__webpack_exports__,"zip",function(){return __WEBPACK_IMPORTED_MODULE_26__src_zip__["a"]})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",function(){return durationSecond});__webpack_require__.d(__webpack_exports__,"c",function(){return durationMinute});__webpack_require__.d(__webpack_exports__,"b",function(){return durationHour});__webpack_require__.d(__webpack_exports__,"a",function(){return durationDay});__webpack_require__.d(__webpack_exports__,"e",function(){return durationWeek});var durationSecond=1e3;var durationMinute=6e4;var durationHour=36e5;var durationDay=864e5;var durationWeek=6048e5},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__src_color__=__webpack_require__(763);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__src_color__["e"]});__webpack_require__.d(__webpack_exports__,"f",function(){return __WEBPACK_IMPORTED_MODULE_0__src_color__["g"]});__webpack_require__.d(__webpack_exports__,"d",function(){return __WEBPACK_IMPORTED_MODULE_0__src_color__["f"]});var __WEBPACK_IMPORTED_MODULE_1__src_lab__=__webpack_require__(848);__webpack_require__.d(__webpack_exports__,"e",function(){return __WEBPACK_IMPORTED_MODULE_1__src_lab__["a"]});__webpack_require__.d(__webpack_exports__,"c",function(){return __WEBPACK_IMPORTED_MODULE_1__src_lab__["b"]});var __WEBPACK_IMPORTED_MODULE_2__src_cubehelix__=__webpack_require__(849);__webpack_require__.d(__webpack_exports__,"b",function(){return __WEBPACK_IMPORTED_MODULE_2__src_cubehelix__["a"]})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return map});__webpack_require__.d(__webpack_exports__,"b",function(){return slice});var array=Array.prototype;var map=array.map;var slice=array.slice},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var components_1=__webpack_require__(466);var constants_1=__webpack_require__(52);var query_runner_1=__webpack_require__(73);__webpack_require__(899);function getSecretHavingFilter(){if(typeof window.secretHaving==="string"){try{return plywood_1.Expression.parse(window.secretHaving)}catch(e){console.log("Could not parse secretHaving: "+e.message);return null}}return null}var STAGE_MIN_WIDTH_TO_SHOW_AXES=350;var STAGE_MIN_HEIGHT_TO_SHOW_AXES=230;var queryIdCounter=0;var BaseVisualization=function(_super){tslib_1.__extends(BaseVisualization,_super);function BaseVisualization(){var _this=_super.call(this)||this;_this.lastRenderResult=null;_this.state=_this.getDefaultState();_this.queryId=BaseVisualization.nextQueryId();return _this}BaseVisualization.nextQueryId=function(){queryIdCounter++;return"visualization-"+queryIdCounter};BaseVisualization.getMultiFilter=function(splits,currentFilter,flatDatum){if(flatDatum["__nest"]===0)return null;var rowHighlight;if(currentFilter.sameLevelFilter(this.getFilterFromDatum(splits,flatDatum))){rowHighlight=this.toggleDatumInFilter(currentFilter,splits,flatDatum)}else{rowHighlight=this.getFilterFromDatum(splits,flatDatum)}return rowHighlight};BaseVisualization.flatDatumForPath=function(splits,path){var flatDatum={__nest:path.length};path.forEach(function(p,i){var dimension=splits.get(i).dimension;flatDatum[dimension]=path[i][dimension]});return flatDatum};BaseVisualization.isDatumInFilter=function(filter,splits,flatDatum){var datumFilter=this.getFilterFromDatum(splits,flatDatum);if(!datumFilter)return false;if(!filter.sameLevelFilter(datumFilter))return false;var filterClauses=filter.clauses;var datumFilterClauses=datumFilter.clauses;var datumFilterLastElements=datumFilterClauses[datumFilterClauses.length-1].getLiteralSet();var filterLastElements=filterClauses[filterClauses.length-1].getLiteralSet();return filterLastElements.contains(datumFilterLastElements)};BaseVisualization.isDatumSelected=function(filter,splits,flatDatum){var newFilter=this.getFilterFromDatum(splits,flatDatum);var sameFilter=filter.equals(newFilter);var invertedFilter=filter.equals(newFilter.toggleMode());var includingFilter=this.isDatumInFilter(filter,splits,flatDatum);return sameFilter||invertedFilter||includingFilter};BaseVisualization.toggleDatumInFilter=function(filter,splits,datum){var nest=datum["__nest"];var value=datum[splits.get(nest-1).dimension];var lastClause=filter.clauses[filter.clauses.length-1];var newElements=this.isDatumInFilter(filter,splits,datum)?lastClause.values.remove(value):lastClause.values.add(value);if(newElements.size()===0)return null;lastClause=lastClause.changeValues(plywood_1.Set.fromJS(newElements));return filter.replaceByIndex(filter.clauses.length-1,lastClause)};BaseVisualization.getFilterFromDatum=function(splits,flatDatum){var nest=flatDatum["__nest"];if(nest===0)return null;var segments=[];for(var i=0;i<nest;i++){var v=flatDatum[splits.get(i).dimension];if(typeof v==="undefined")return null;segments.push(v)}return new models_1.Filter({clauses:segments.map(function(segment,i){return new models_1.FilterClause({action:"overlap",dimension:splits.get(i).dimension,values:plywood_1.Set.fromJS([segment])})})})};BaseVisualization.prototype.getDefaultState=function(){return{datasetLoad:{},scrollLeft:0,scrollTop:0,hoverMeasure:null,selectionMode:"single"}};BaseVisualization.prototype.isMultiSelectEvent=function(event){return this.state.selectionMode==="multi"||event.shiftKey||event.ctrlKey||event.metaKey};BaseVisualization.prototype.queryExtra=function(query,splitIndex,essence,timekeeper){return null};BaseVisualization.prototype.makeQuery=function(essence,timekeeper){var _this=this;var dimensions=essence.getDimensions();var measures=essence.getEffectiveMeasures();var splits=essence.getEffectiveSplits();var colors=essence.getEffectiveColors();var $main=plywood_1.$("main");var query=plywood_1.ply().apply("main",$main.filter(essence.getSpecificFilter(timekeeper).toExpression(dimensions)));query=this.queryExtra(query,-1,essence,timekeeper)||query;measures.forEach(function(measure){var applyAction=measure.toApplyAction(0);query=query.performAction(applyAction)});var makeSubQuery=function(i){var split=splits.get(i);var splitDimension=essence.getDimension(split.dimension);var sortAction=split.sortAction,limitAction=split.limitAction;if(!sortAction){throw new Error("something went wrong during query generation")}var subQuery=$main.split(split.toSplitExpression(dimensions),splitDimension.name);if(colors&&colors.dimension===splitDimension.name){var havingFilter=colors.toHavingFilter(splitDimension.name);if(havingFilter){subQuery=subQuery.performAction(havingFilter)}}subQuery=_this.queryExtra(subQuery,i,essence,timekeeper)||subQuery;measures.forEach(function(measure){subQuery=subQuery.performAction(measure.toApplyAction(i+1))});var applyForSort=essence.getApplyForSort(sortAction,i+1);if(applyForSort){subQuery=subQuery.performAction(applyForSort)}subQuery=subQuery.performAction(sortAction);var secretHaving=getSecretHavingFilter();if(secretHaving)subQuery=subQuery.filter(secretHaving);if(colors&&colors.dimension===splitDimension.name){subQuery=subQuery.performAction(colors.toLimitAction())}else if(limitAction){subQuery=subQuery.performAction(limitAction)}else if(splitDimension.getKind()==="number"){subQuery=subQuery.limit(5e3)}if(i+1<splits.length()){subQuery=subQuery.apply(constants_1.SPLIT,makeSubQuery(i+1))}return subQuery};return query.apply(constants_1.SPLIT,makeSubQuery(0))};BaseVisualization.prototype.fetchData=function(essence,timekeeper){var _this=this;var registerDownloadableDataset=this.props.registerDownloadableDataset;var query=this.makeQuery(essence,timekeeper);this.precalculate(this.props,{loading:true});query_runner_1.QueryRunner.fetch(this.queryId,essence.dataCube,essence.instance,query,essence.timezone).then(function(dataset){if(!_this.mounted)return;_this.precalculate(_this.props,{loading:false,dataset:dataset,error:null})},function(error){if(error.canceled)return;if(registerDownloadableDataset)registerDownloadableDataset(null);if(!_this.mounted)return;_this.precalculate(_this.props,{loading:false,dataset:null,error:error})})};BaseVisualization.prototype.componentWillMount=function(){this.precalculate(this.props)};BaseVisualization.prototype.componentDidMount=function(){this.mounted=true;var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;this.calculateSize();this.fetchData(essence,timekeeper)};BaseVisualization.prototype.componentWillReceiveProps=function(nextProps){this.precalculate(nextProps);var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;var nextEssence=nextProps.essence;var nextTimekeeper=nextProps.timekeeper;if(nextEssence.differentDataCube(essence)||nextEssence.differentSpecificFilter(essence,timekeeper,nextTimekeeper)||nextEssence.differentEffectiveSplits(essence)||nextEssence.differentColors(essence)||nextEssence.newEffectiveMeasures(essence)){this.fetchData(nextEssence,nextTimekeeper)}this.calculateSize()};BaseVisualization.prototype.componentWillUnmount=function(){this.mounted=false};BaseVisualization.prototype.beforeSizeUpdate=function(newStage){};BaseVisualization.prototype.calculateSize=function(){var _this=this;var stage=this.state.stage;if(!this.containerDOM)return;var newStage=beltful_1.Stage.fromClientRect(this.containerDOM.getBoundingClientRect());if(!newStage.equals(stage)){this.beforeSizeUpdate(newStage);this.setState({canShowAxes:newStage.width>STAGE_MIN_WIDTH_TO_SHOW_AXES&&newStage.height>STAGE_MIN_HEIGHT_TO_SHOW_AXES,stage:newStage},function(){return _this.onResize()})}};BaseVisualization.prototype.onResize=function(){};BaseVisualization.prototype.globalMouseMoveListener=function(e){};BaseVisualization.prototype.globalMouseUpListener=function(e){};BaseVisualization.prototype.globalKeyDownListener=function(e){};BaseVisualization.prototype.globalEscapeListener=function(e){};BaseVisualization.prototype.renderInternals=function(){return null};BaseVisualization.prototype.precalculate=function(props,datasetLoad){if(datasetLoad===void 0){datasetLoad=null}this.setState({datasetLoad:datasetLoad})};BaseVisualization.prototype.toggleSelectionMode=function(){this.setState({selectionMode:this.state.selectionMode==="multi"?"single":"multi"})};BaseVisualization.prototype.render=function(){var _this=this;var _a=this.state,stage=_a.stage,datasetLoad=_a.datasetLoad;var className=classNames("base-visualization",this.constructor.visName);if(!datasetLoad){return React.createElement("div",{className:className},this.lastRenderResult)}if(stage&&(!datasetLoad.loading||!this.lastRenderResult)){this.lastRenderResult=this.renderInternals()}return React.createElement("div",{className:className,ref:function(e){return _this.containerDOM=e}},React.createElement(caladan_1.GlobalEventListener,{resize:this.calculateSize.bind(this),mouseMove:this.globalMouseMoveListener.bind(this),mouseUp:this.globalMouseUpListener.bind(this),keyDown:this.globalKeyDownListener.bind(this),escape:this.globalEscapeListener.bind(this)}),this.lastRenderResult,datasetLoad.error?React.createElement(components_1.QueryError,{error:datasetLoad.error}):null,datasetLoad.loading?React.createElement(caladan_1.Loader,null):null)};return BaseVisualization}(React.Component);exports.BaseVisualization=BaseVisualization},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x){return x===null?NaN:+x}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=linearish;__webpack_exports__["a"]=linear;var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1_d3_interpolate__=__webpack_require__(750);var __WEBPACK_IMPORTED_MODULE_2__continuous__=__webpack_require__(755);var __WEBPACK_IMPORTED_MODULE_3__tickFormat__=__webpack_require__(860);function linearish(scale){var domain=scale.domain;scale.ticks=function(count){var d=domain();return Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["ticks"])(d[0],d[d.length-1],count==null?10:count)};scale.tickFormat=function(count,specifier){return Object(__WEBPACK_IMPORTED_MODULE_3__tickFormat__["a"])(domain(),count,specifier)};scale.nice=function(count){if(count==null)count=10;var d=domain(),i0=0,i1=d.length-1,start=d[i0],stop=d[i1],step;if(stop<start){step=start,start=stop,stop=step;step=i0,i0=i1,i1=step}step=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["tickIncrement"])(start,stop,count);if(step>0){start=Math.floor(start/step)*step;stop=Math.ceil(stop/step)*step;step=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["tickIncrement"])(start,stop,count)}else if(step<0){start=Math.ceil(start*step)/step;stop=Math.floor(stop*step)/step;step=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["tickIncrement"])(start,stop,count)}if(step>0){d[i0]=Math.floor(start/step)*step;d[i1]=Math.ceil(stop/step)*step;domain(d)}else if(step<0){d[i0]=Math.ceil(start*step)/step;d[i1]=Math.floor(stop*step)/step;domain(d)}return scale};return scale}function linear(){var scale=Object(__WEBPACK_IMPORTED_MODULE_2__continuous__["b"])(__WEBPACK_IMPORTED_MODULE_2__continuous__["c"],__WEBPACK_IMPORTED_MODULE_1_d3_interpolate__["c"]);scale.copy=function(){return Object(__WEBPACK_IMPORTED_MODULE_2__continuous__["a"])(scale,linear())};return linearish(scale)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__src_value__=__webpack_require__(762);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__src_value__["a"]});var __WEBPACK_IMPORTED_MODULE_1__src_array__=__webpack_require__(789);var __WEBPACK_IMPORTED_MODULE_2__src_basis__=__webpack_require__(765);var __WEBPACK_IMPORTED_MODULE_3__src_basisClosed__=__webpack_require__(787);var __WEBPACK_IMPORTED_MODULE_4__src_date__=__webpack_require__(790);var __WEBPACK_IMPORTED_MODULE_5__src_number__=__webpack_require__(754);__webpack_require__.d(__webpack_exports__,"c",function(){return __WEBPACK_IMPORTED_MODULE_5__src_number__["a"]});var __WEBPACK_IMPORTED_MODULE_6__src_object__=__webpack_require__(791);var __WEBPACK_IMPORTED_MODULE_7__src_round__=__webpack_require__(850);__webpack_require__.d(__webpack_exports__,"d",function(){return __WEBPACK_IMPORTED_MODULE_7__src_round__["a"]});var __WEBPACK_IMPORTED_MODULE_8__src_string__=__webpack_require__(792);var __WEBPACK_IMPORTED_MODULE_9__src_transform_index__=__webpack_require__(851);var __WEBPACK_IMPORTED_MODULE_10__src_zoom__=__webpack_require__(854);var __WEBPACK_IMPORTED_MODULE_11__src_rgb__=__webpack_require__(786);var __WEBPACK_IMPORTED_MODULE_12__src_hsl__=__webpack_require__(855);var __WEBPACK_IMPORTED_MODULE_13__src_lab__=__webpack_require__(856);var __WEBPACK_IMPORTED_MODULE_14__src_hcl__=__webpack_require__(857);var __WEBPACK_IMPORTED_MODULE_15__src_cubehelix__=__webpack_require__(858);__webpack_require__.d(__webpack_exports__,"b",function(){return __WEBPACK_IMPORTED_MODULE_15__src_cubehelix__["a"]});var __WEBPACK_IMPORTED_MODULE_16__src_quantize__=__webpack_require__(859)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["c"]=hue;__webpack_exports__["b"]=gamma;__webpack_exports__["a"]=nogamma;var __WEBPACK_IMPORTED_MODULE_0__constant__=__webpack_require__(788);function linear(a,d){return function(t){return a+t*d}}function exponential(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}function hue(a,b){var d=b-a;return d?linear(a,d>180||d<-180?d-360*Math.round(d/360):d):Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(isNaN(a)?b:a)}function gamma(y){return(y=+y)===1?nogamma:function(a,b){return b-a?exponential(a,b,y):Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(isNaN(a)?b:a)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(s){return s.match(/.{6}/g).map(function(x){return"#"+x})}},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});var __WEBPACK_IMPORTED_MODULE_0__src_band__=__webpack_require__(840);__webpack_require__.d(__webpack_exports__,"scaleBand",function(){return __WEBPACK_IMPORTED_MODULE_0__src_band__["a"]});__webpack_require__.d(__webpack_exports__,"scalePoint",function(){return __WEBPACK_IMPORTED_MODULE_0__src_band__["b"]});var __WEBPACK_IMPORTED_MODULE_1__src_identity__=__webpack_require__(847);__webpack_require__.d(__webpack_exports__,"scaleIdentity",function(){return __WEBPACK_IMPORTED_MODULE_1__src_identity__["a"]});var __WEBPACK_IMPORTED_MODULE_2__src_linear__=__webpack_require__(749);__webpack_require__.d(__webpack_exports__,"scaleLinear",function(){return __WEBPACK_IMPORTED_MODULE_2__src_linear__["a"]});var __WEBPACK_IMPORTED_MODULE_3__src_log__=__webpack_require__(870);__webpack_require__.d(__webpack_exports__,"scaleLog",function(){return __WEBPACK_IMPORTED_MODULE_3__src_log__["a"]});var __WEBPACK_IMPORTED_MODULE_4__src_ordinal__=__webpack_require__(784);__webpack_require__.d(__webpack_exports__,"scaleOrdinal",function(){return __WEBPACK_IMPORTED_MODULE_4__src_ordinal__["a"]});__webpack_require__.d(__webpack_exports__,"scaleImplicit",function(){return __WEBPACK_IMPORTED_MODULE_4__src_ordinal__["b"]});var __WEBPACK_IMPORTED_MODULE_5__src_pow__=__webpack_require__(871);__webpack_require__.d(__webpack_exports__,"scalePow",function(){return __WEBPACK_IMPORTED_MODULE_5__src_pow__["a"]});__webpack_require__.d(__webpack_exports__,"scaleSqrt",function(){return __WEBPACK_IMPORTED_MODULE_5__src_pow__["b"]});var __WEBPACK_IMPORTED_MODULE_6__src_quantile__=__webpack_require__(872);__webpack_require__.d(__webpack_exports__,"scaleQuantile",function(){return __WEBPACK_IMPORTED_MODULE_6__src_quantile__["a"]});var __WEBPACK_IMPORTED_MODULE_7__src_quantize__=__webpack_require__(873);__webpack_require__.d(__webpack_exports__,"scaleQuantize",function(){return __WEBPACK_IMPORTED_MODULE_7__src_quantize__["a"]});var __WEBPACK_IMPORTED_MODULE_8__src_threshold__=__webpack_require__(874);__webpack_require__.d(__webpack_exports__,"scaleThreshold",function(){return __WEBPACK_IMPORTED_MODULE_8__src_threshold__["a"]});var __WEBPACK_IMPORTED_MODULE_9__src_time__=__webpack_require__(800);__webpack_require__.d(__webpack_exports__,"scaleTime",function(){return __WEBPACK_IMPORTED_MODULE_9__src_time__["b"]});var __WEBPACK_IMPORTED_MODULE_10__src_utcTime__=__webpack_require__(890);__webpack_require__.d(__webpack_exports__,"scaleUtc",function(){return __WEBPACK_IMPORTED_MODULE_10__src_utcTime__["a"]});var __WEBPACK_IMPORTED_MODULE_11__src_category10__=__webpack_require__(891);__webpack_require__.d(__webpack_exports__,"schemeCategory10",function(){return __WEBPACK_IMPORTED_MODULE_11__src_category10__["a"]});var __WEBPACK_IMPORTED_MODULE_12__src_category20b__=__webpack_require__(892);__webpack_require__.d(__webpack_exports__,"schemeCategory20b",function(){return __WEBPACK_IMPORTED_MODULE_12__src_category20b__["a"]});var __WEBPACK_IMPORTED_MODULE_13__src_category20c__=__webpack_require__(893);__webpack_require__.d(__webpack_exports__,"schemeCategory20c",function(){return __WEBPACK_IMPORTED_MODULE_13__src_category20c__["a"]});var __WEBPACK_IMPORTED_MODULE_14__src_category20__=__webpack_require__(894);__webpack_require__.d(__webpack_exports__,"schemeCategory20",function(){return __WEBPACK_IMPORTED_MODULE_14__src_category20__["a"]});var __WEBPACK_IMPORTED_MODULE_15__src_cubehelix__=__webpack_require__(895);__webpack_require__.d(__webpack_exports__,"interpolateCubehelixDefault",function(){return __WEBPACK_IMPORTED_MODULE_15__src_cubehelix__["a"]});var __WEBPACK_IMPORTED_MODULE_16__src_rainbow__=__webpack_require__(896);__webpack_require__.d(__webpack_exports__,"interpolateRainbow",function(){return __WEBPACK_IMPORTED_MODULE_16__src_rainbow__["b"]});__webpack_require__.d(__webpack_exports__,"interpolateWarm",function(){return __WEBPACK_IMPORTED_MODULE_16__src_rainbow__["c"]});__webpack_require__.d(__webpack_exports__,"interpolateCool",function(){return __WEBPACK_IMPORTED_MODULE_16__src_rainbow__["a"]});var __WEBPACK_IMPORTED_MODULE_17__src_viridis__=__webpack_require__(897);__webpack_require__.d(__webpack_exports__,"interpolateViridis",function(){return __WEBPACK_IMPORTED_MODULE_17__src_viridis__["a"]});__webpack_require__.d(__webpack_exports__,"interpolateMagma",function(){return __WEBPACK_IMPORTED_MODULE_17__src_viridis__["c"]});__webpack_require__.d(__webpack_exports__,"interpolateInferno",function(){return __WEBPACK_IMPORTED_MODULE_17__src_viridis__["b"]});__webpack_require__.d(__webpack_exports__,"interpolatePlasma",function(){return __WEBPACK_IMPORTED_MODULE_17__src_viridis__["d"]});var __WEBPACK_IMPORTED_MODULE_18__src_sequential__=__webpack_require__(898);__webpack_require__.d(__webpack_exports__,"scaleSequential",function(){return __WEBPACK_IMPORTED_MODULE_18__src_sequential__["a"]})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(a,b){return a=+a,b-=a,function(t){return a+b*t}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["c"]=deinterpolateLinear;__webpack_exports__["a"]=copy;__webpack_exports__["b"]=continuous;var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1_d3_interpolate__=__webpack_require__(750);var __WEBPACK_IMPORTED_MODULE_2__array__=__webpack_require__(745);var __WEBPACK_IMPORTED_MODULE_3__constant__=__webpack_require__(766);var __WEBPACK_IMPORTED_MODULE_4__number__=__webpack_require__(793);var unit=[0,1];function deinterpolateLinear(a,b){return(b-=a=+a)?function(x){return(x-a)/b}:Object(__WEBPACK_IMPORTED_MODULE_3__constant__["a"])(b)}function deinterpolateClamp(deinterpolate){return function(a,b){var d=deinterpolate(a=+a,b=+b);return function(x){return x<=a?0:x>=b?1:d(x)}}}function reinterpolateClamp(reinterpolate){return function(a,b){var r=reinterpolate(a=+a,b=+b);return function(t){return t<=0?a:t>=1?b:r(t)}}}function bimap(domain,range,deinterpolate,reinterpolate){var d0=domain[0],d1=domain[1],r0=range[0],r1=range[1];if(d1<d0)d0=deinterpolate(d1,d0),r0=reinterpolate(r1,r0);else d0=deinterpolate(d0,d1),r0=reinterpolate(r0,r1);return function(x){return r0(d0(x))}}function polymap(domain,range,deinterpolate,reinterpolate){var j=Math.min(domain.length,range.length)-1,d=new Array(j),r=new Array(j),i=-1;if(domain[j]<domain[0]){domain=domain.slice().reverse();range=range.slice().reverse()}while(++i<j){d[i]=deinterpolate(domain[i],domain[i+1]);r[i]=reinterpolate(range[i],range[i+1])}return function(x){var i=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["bisect"])(domain,x,1,j)-1;return r[i](d[i](x))}}function copy(source,target){return target.domain(source.domain()).range(source.range()).interpolate(source.interpolate()).clamp(source.clamp())}function continuous(deinterpolate,reinterpolate){var domain=unit,range=unit,interpolate=__WEBPACK_IMPORTED_MODULE_1_d3_interpolate__["a"],clamp=false,piecewise,output,input;function rescale(){piecewise=Math.min(domain.length,range.length)>2?polymap:bimap;output=input=null;return scale}function scale(x){return(output||(output=piecewise(domain,range,clamp?deinterpolateClamp(deinterpolate):deinterpolate,interpolate)))(+x)}scale.invert=function(y){return(input||(input=piecewise(range,domain,deinterpolateLinear,clamp?reinterpolateClamp(reinterpolate):reinterpolate)))(+y)};scale.domain=function(_){return arguments.length?(domain=__WEBPACK_IMPORTED_MODULE_2__array__["a"].call(_,__WEBPACK_IMPORTED_MODULE_4__number__["a"]),rescale()):domain.slice()};scale.range=function(_){return arguments.length?(range=__WEBPACK_IMPORTED_MODULE_2__array__["b"].call(_),rescale()):range.slice()};scale.rangeRound=function(_){return range=__WEBPACK_IMPORTED_MODULE_2__array__["b"].call(_),interpolate=__WEBPACK_IMPORTED_MODULE_1_d3_interpolate__["d"],rescale()};scale.clamp=function(_){return arguments.length?(clamp=!!_,rescale()):clamp};scale.interpolate=function(_){return arguments.length?(interpolate=_,rescale()):interpolate};return rescale()}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__formatDecimal__=__webpack_require__(767);__webpack_exports__["a"]=function(x){return x=Object(__WEBPACK_IMPORTED_MODULE_0__formatDecimal__["a"])(Math.abs(x)),x?x[1]:NaN}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var immutable_class_1=__webpack_require__(7);var d3_scale_1=__webpack_require__(753);var plywood_1=__webpack_require__(14);var TwoDimensionalDataLoader=function(){function TwoDimensionalDataLoader(){}TwoDimensionalDataLoader.precalculate=function(props,datasetLoad,minColor,maxColor){if(datasetLoad===void 0){datasetLoad=null}if(minColor===void 0){minColor="#e67320"}if(maxColor===void 0){maxColor="#98D2F3"}if(datasetLoad&&datasetLoad.dataset){var dataset=datasetLoad.dataset;var measure_1=props.essence.getEffectiveMeasures()[0];var xIndices_1={};var yIndices_1={};var _a=this.getAxesDatasets(dataset),xDataset=_a.xDataset,yDataset=_a.yDataset;var _b=this.getAxesFields(props.essence),xField_1=_b.xField,yField_1=_b.yField;xDataset.data.forEach(function(x,i){return xIndices_1[x.v]=i});yDataset.data.forEach(function(y,i){return yIndices_1[y.v]=i});var positiveScale=void 0;var negativeScale=void 0;var cells_1={"-1":{}};var min_1=Number.POSITIVE_INFINITY;var max_1=Number.NEGATIVE_INFINITY;TwoDimensionalDataLoader.getCellsData(datasetLoad).forEach(function(d){var value=d[measure_1.name];min_1=Math.min(min_1,value);max_1=Math.max(max_1,value);var x=String(xIndices_1[d[xField_1]]);var y=String(yIndices_1[d[yField_1]]);cells_1[x]=cells_1[x]||{};cells_1[x][y]=d;cells_1[x][-1]=cells_1[x][-1]||d;cells_1[-1][y]=cells_1[-1][y]||d});max_1=Math.max(Math.abs(min_1),Math.abs(max_1));positiveScale=d3_scale_1.scaleLog().domain([1,max_1]).range(["#ffffff",maxColor]);negativeScale=d3_scale_1.scaleLog().domain([1,max_1]).range(["#ffffff",minColor]);return{datasetLoad:datasetLoad,cells:cells_1,xIndices:xIndices_1,yIndices:yIndices_1,positiveColorScale:positiveScale,negativeColorScale:negativeScale}}return{datasetLoad:datasetLoad}};TwoDimensionalDataLoader.getCell=function(cells,x,y){var column=cells[x];if(column)return column[y];return null};TwoDimensionalDataLoader.getCellsData=function(datasetLoad){return datasetLoad.dataset.data[0].cells.data};TwoDimensionalDataLoader.getAxesDatasets=function(dataset){var datum=dataset&&Array.isArray(dataset.data)?dataset.data[0]:null;return{xDataset:datum?datum["xs"]:null,yDataset:datum?datum["ys"]:null}};TwoDimensionalDataLoader.getAxesFields=function(essence){var _a=TwoDimensionalDataLoader.getAxesDimensions(essence),xDimension=_a.xDimension,yDimension=_a.yDimension;return{xField:xDimension.name,yField:yDimension.name}};TwoDimensionalDataLoader.getAxesDimensions=function(essence){var splits=essence.getConstrainedSplits();var ySplit=splits.get(0);var xSplit=splits.get(1);return{xDimension:essence.getDimension(xSplit.dimension),yDimension:essence.getDimension(ySplit.dimension)}};TwoDimensionalDataLoader.subDatasetExpression=function(split,dimensions,measures){var expr=plywood_1.$("main").split(split.toSplitExpression(dimensions),"v");var sortMeasure=immutable_class_1.NamedArray.findByName(measures,split.sortAction.refName());if(sortMeasure){expr=expr.performActions([sortMeasure.toApplyAction(1),split.sortAction])}else{expr=expr.sort(plywood_1.$("v"),split.sortAction.direction)}return expr.performAction(split.limitAction)};TwoDimensionalDataLoader.makeQuery=function(essence,timekeeper){var dimensions=essence.getDimensions();var measures=essence.getEffectiveMeasures();var splits=essence.getEffectiveSplits();if(splits.length()!==2)return null;var firstSplit=splits.get(0);var firstSplitExpression=firstSplit.toSplitExpression(dimensions);var firstLimit=firstSplit.limitAction.value;var secondSplit=splits.get(1);var secondSplitExpression=secondSplit.toSplitExpression(dimensions);var secondLimit=secondSplit.limitAction.value;var splitFns={};splitFns[firstSplit.dimension]=firstSplitExpression;splitFns[secondSplit.dimension]=secondSplitExpression;var $main=plywood_1.$("main");var query=plywood_1.ply().apply("main",$main.filter(essence.getSpecificFilter(timekeeper).toExpression(dimensions))).performActions(measures.map(function(m){return m.toApplyAction(0)})).apply("ys",TwoDimensionalDataLoader.subDatasetExpression(firstSplit,dimensions,measures)).apply("xs",TwoDimensionalDataLoader.subDatasetExpression(secondSplit,dimensions,measures)).apply("cells",$main.filter(plywood_1.Expression.and([essence.getDimension(secondSplit.dimension).expression.overlap(plywood_1.$("xs").collect(plywood_1.$("v"))),essence.getDimension(firstSplit.dimension).expression.overlap(plywood_1.$("ys").collect(plywood_1.$("v")))])).split(splitFns).performActions(measures.map(function(m){return m.toApplyAction(1)})).limit(firstLimit*secondLimit));return query};return TwoDimensionalDataLoader}();exports.TwoDimensionalDataLoader=TwoDimensionalDataLoader},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var LocalStorage=function(){function LocalStorage(){}LocalStorage.get=function(key){try{return JSON.parse(localStorage[key])}catch(e){return undefined}};LocalStorage.set=function(key,value){try{localStorage[key]=JSON.stringify(value)}catch(e){}};return LocalStorage}();exports.LocalStorage=LocalStorage},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var bar_chart_1=__webpack_require__(823);var geo_1=__webpack_require__(905);var line_chart_1=__webpack_require__(908);var table_1=__webpack_require__(914);var heatmap_1=__webpack_require__(917);var grid_1=__webpack_require__(923);var totals_1=__webpack_require__(926);var VIS_COMPONENTS=[totals_1.Totals,table_1.Table,grid_1.Grid,line_chart_1.LineChart,bar_chart_1.BarChart,heatmap_1.Heatmap,geo_1.Geo];function getVisualizationComponent(visualizationManifest){var manifestName=visualizationManifest.name;return VIS_COMPONENTS.find(function(v){return v.visName===manifestName})}exports.getVisualizationComponent=getVisualizationComponent},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__number__=__webpack_require__(748);__webpack_exports__["a"]=function(values,p,valueof){if(valueof==null)valueof=__WEBPACK_IMPORTED_MODULE_0__number__["a"];if(!(n=values.length))return;if((p=+p)<=0||n<2)return+valueof(values[0],0,values);if(p>=1)return+valueof(values[n-1],n-1,values);var n,i=(n-1)*p,i0=Math.floor(i),value0=+valueof(values[i0],i0,values),value1=+valueof(values[i0+1],i0+1,values);return value0+(value1-value0)*(i-i0)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return prefix});var prefix="$";function Map(){}Map.prototype=map.prototype={constructor:Map,has:function(key){return prefix+key in this},get:function(key){return this[prefix+key]},set:function(key,value){this[prefix+key]=value;return this},remove:function(key){var property=prefix+key;return property in this&&delete this[property]},clear:function(){for(var property in this)if(property[0]===prefix)delete this[property]},keys:function(){var keys=[];for(var property in this)if(property[0]===prefix)keys.push(property.slice(1));return keys},values:function(){var values=[];for(var property in this)if(property[0]===prefix)values.push(this[property]);return values},entries:function(){var entries=[];for(var property in this)if(property[0]===prefix)entries.push({key:property.slice(1),value:this[property]});return entries},size:function(){var size=0;for(var property in this)if(property[0]===prefix)++size;return size},empty:function(){for(var property in this)if(property[0]===prefix)return false;return true},each:function(f){for(var property in this)if(property[0]===prefix)f(this[property],property.slice(1),this)}};function map(object,f){var map=new Map;if(object instanceof Map)object.each(function(value,key){map.set(key,value)});else if(Array.isArray(object)){var i=-1,n=object.length,o;if(f==null)while(++i<n)map.set(i,object[i]);else while(++i<n)map.set(f(o=object[i],i,object),o)}else if(object)for(var key in object)map.set(key,object[key]);return map}__webpack_exports__["a"]=map},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_color__=__webpack_require__(744);var __WEBPACK_IMPORTED_MODULE_1__rgb__=__webpack_require__(786);var __WEBPACK_IMPORTED_MODULE_2__array__=__webpack_require__(789);var __WEBPACK_IMPORTED_MODULE_3__date__=__webpack_require__(790);var __WEBPACK_IMPORTED_MODULE_4__number__=__webpack_require__(754);var __WEBPACK_IMPORTED_MODULE_5__object__=__webpack_require__(791);var __WEBPACK_IMPORTED_MODULE_6__string__=__webpack_require__(792);var __WEBPACK_IMPORTED_MODULE_7__constant__=__webpack_require__(788);__webpack_exports__["a"]=function(a,b){var t=typeof b,c;return b==null||t==="boolean"?Object(__WEBPACK_IMPORTED_MODULE_7__constant__["a"])(b):(t==="number"?__WEBPACK_IMPORTED_MODULE_4__number__["a"]:t==="string"?(c=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["a"])(b))?(b=c,__WEBPACK_IMPORTED_MODULE_1__rgb__["a"]):__WEBPACK_IMPORTED_MODULE_6__string__["a"]:b instanceof __WEBPACK_IMPORTED_MODULE_0_d3_color__["a"]?__WEBPACK_IMPORTED_MODULE_1__rgb__["a"]:b instanceof Date?__WEBPACK_IMPORTED_MODULE_3__date__["a"]:Array.isArray(b)?__WEBPACK_IMPORTED_MODULE_2__array__["a"]:typeof b.valueOf!=="function"&&typeof b.toString!=="function"||isNaN(b)?__WEBPACK_IMPORTED_MODULE_5__object__["a"]:__WEBPACK_IMPORTED_MODULE_4__number__["a"])(a,b)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=Color;__webpack_require__.d(__webpack_exports__,"d",function(){return darker});__webpack_require__.d(__webpack_exports__,"c",function(){return brighter});__webpack_exports__["e"]=color;__webpack_exports__["h"]=rgbConvert;__webpack_exports__["g"]=rgb;__webpack_exports__["b"]=Rgb;__webpack_exports__["f"]=hsl;var __WEBPACK_IMPORTED_MODULE_0__define__=__webpack_require__(764);function Color(){}var darker=.7;var brighter=1/darker;var reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex3=/^#([0-9a-f]{3})$/,reHex6=/^#([0-9a-f]{6})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$");var named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object(__WEBPACK_IMPORTED_MODULE_0__define__["a"])(Color,color,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}});function color(format){var m;format=(format+"").trim().toLowerCase();return(m=reHex3.exec(format))?(m=parseInt(m[1],16),new Rgb(m>>8&15|m>>4&240,m>>4&15|m&240,(m&15)<<4|m&15,1)):(m=reHex6.exec(format))?rgbn(parseInt(m[1],16)):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(m[1]*255/100,m[2]*255/100,m[3]*255/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(m[1]*255/100,m[2]*255/100,m[3]*255/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):format==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,n&255,1)}function rgba(r,g,b,a){if(a<=0)r=g=b=NaN;return new Rgb(r,g,b,a)}function rgbConvert(o){if(!(o instanceof Color))o=color(o);if(!o)return new Rgb;o=o.rgb();return new Rgb(o.r,o.g,o.b,o.opacity)}function rgb(r,g,b,opacity){return arguments.length===1?rgbConvert(r):new Rgb(r,g,b,opacity==null?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r;this.g=+g;this.b=+b;this.opacity=+opacity}Object(__WEBPACK_IMPORTED_MODULE_0__define__["a"])(Rgb,rgb,Object(__WEBPACK_IMPORTED_MODULE_0__define__["b"])(Color,{brighter:function(k){k=k==null?brighter:Math.pow(brighter,k);return new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker:function(k){k=k==null?darker:Math.pow(darker,k);return new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&(0<=this.g&&this.g<=255)&&(0<=this.b&&this.b<=255)&&(0<=this.opacity&&this.opacity<=1)},toString:function(){var a=this.opacity;a=isNaN(a)?1:Math.max(0,Math.min(1,a));return(a===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(a===1?")":", "+a+")")}}));function hsla(h,s,l,a){if(a<=0)h=s=l=NaN;else if(l<=0||l>=1)h=s=NaN;else if(s<=0)h=NaN;return new Hsl(h,s,l,a)}function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(!(o instanceof Color))o=color(o);if(!o)return new Hsl;if(o instanceof Hsl)return o;o=o.rgb();var r=o.r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;if(s){if(r===max)h=(g-b)/s+(g<b)*6;else if(g===max)h=(b-r)/s+2;else h=(r-g)/s+4;s/=l<.5?max+min:2-max-min;h*=60}else{s=l>0&&l<1?0:h}return new Hsl(h,s,l,o.opacity)}function hsl(h,s,l,opacity){return arguments.length===1?hslConvert(h):new Hsl(h,s,l,opacity==null?1:opacity)}function Hsl(h,s,l,opacity){this.h=+h;this.s=+s;this.l=+l;this.opacity=+opacity}Object(__WEBPACK_IMPORTED_MODULE_0__define__["a"])(Hsl,hsl,Object(__WEBPACK_IMPORTED_MODULE_0__define__["b"])(Color,{brighter:function(k){k=k==null?brighter:Math.pow(brighter,k);return new Hsl(this.h,this.s,this.l*k,this.opacity)},darker:function(k){k=k==null?darker:Math.pow(darker,k);return new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=this.h%360+(this.h<0)*360,s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&(0<=this.l&&this.l<=1)&&(0<=this.opacity&&this.opacity<=1)}}));function hsl2rgb(h,m1,m2){return(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)*255}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=extend;__webpack_exports__["a"]=function(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype;prototype.constructor=constructor};function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=basis;function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}__webpack_exports__["b"]=function(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x){return function(){return x}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x,p){if((i=(x=p?x.toExponential(p-1):x.toExponential()).indexOf("e"))<0)return null;var i,coefficient=x.slice(0,i);return[coefficient.length>1?coefficient[0]+coefficient.slice(2):coefficient,+x.slice(i+1)]}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__src_interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__src_millisecond__=__webpack_require__(875);__webpack_require__.d(__webpack_exports__,"c",function(){return __WEBPACK_IMPORTED_MODULE_1__src_millisecond__["a"]});__webpack_require__.d(__webpack_exports__,"m",function(){return __WEBPACK_IMPORTED_MODULE_1__src_millisecond__["a"]});var __WEBPACK_IMPORTED_MODULE_2__src_second__=__webpack_require__(876);__webpack_require__.d(__webpack_exports__,"g",function(){return __WEBPACK_IMPORTED_MODULE_2__src_second__["a"]});__webpack_require__.d(__webpack_exports__,"q",function(){return __WEBPACK_IMPORTED_MODULE_2__src_second__["a"]});var __WEBPACK_IMPORTED_MODULE_3__src_minute__=__webpack_require__(877);__webpack_require__.d(__webpack_exports__,"d",function(){return __WEBPACK_IMPORTED_MODULE_3__src_minute__["a"]});var __WEBPACK_IMPORTED_MODULE_4__src_hour__=__webpack_require__(878);__webpack_require__.d(__webpack_exports__,"b",function(){return __WEBPACK_IMPORTED_MODULE_4__src_hour__["a"]});var __WEBPACK_IMPORTED_MODULE_5__src_day__=__webpack_require__(879);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_5__src_day__["a"]});var __WEBPACK_IMPORTED_MODULE_6__src_week__=__webpack_require__(880);__webpack_require__.d(__webpack_exports__,"i",function(){return __WEBPACK_IMPORTED_MODULE_6__src_week__["b"]});__webpack_require__.d(__webpack_exports__,"h",function(){return __WEBPACK_IMPORTED_MODULE_6__src_week__["b"]});__webpack_require__.d(__webpack_exports__,"e",function(){return __WEBPACK_IMPORTED_MODULE_6__src_week__["a"]});var __WEBPACK_IMPORTED_MODULE_7__src_month__=__webpack_require__(881);__webpack_require__.d(__webpack_exports__,"f",function(){return __WEBPACK_IMPORTED_MODULE_7__src_month__["a"]});var __WEBPACK_IMPORTED_MODULE_8__src_year__=__webpack_require__(882);__webpack_require__.d(__webpack_exports__,"j",function(){return __WEBPACK_IMPORTED_MODULE_8__src_year__["a"]});var __WEBPACK_IMPORTED_MODULE_9__src_utcMinute__=__webpack_require__(883);__webpack_require__.d(__webpack_exports__,"n",function(){return __WEBPACK_IMPORTED_MODULE_9__src_utcMinute__["a"]});var __WEBPACK_IMPORTED_MODULE_10__src_utcHour__=__webpack_require__(884);__webpack_require__.d(__webpack_exports__,"l",function(){return __WEBPACK_IMPORTED_MODULE_10__src_utcHour__["a"]});var __WEBPACK_IMPORTED_MODULE_11__src_utcDay__=__webpack_require__(885);__webpack_require__.d(__webpack_exports__,"k",function(){return __WEBPACK_IMPORTED_MODULE_11__src_utcDay__["a"]});var __WEBPACK_IMPORTED_MODULE_12__src_utcWeek__=__webpack_require__(886);__webpack_require__.d(__webpack_exports__,"s",function(){return __WEBPACK_IMPORTED_MODULE_12__src_utcWeek__["b"]});__webpack_require__.d(__webpack_exports__,"r",function(){return __WEBPACK_IMPORTED_MODULE_12__src_utcWeek__["b"]});__webpack_require__.d(__webpack_exports__,"o",function(){return __WEBPACK_IMPORTED_MODULE_12__src_utcWeek__["a"]});var __WEBPACK_IMPORTED_MODULE_13__src_utcMonth__=__webpack_require__(887);__webpack_require__.d(__webpack_exports__,"p",function(){return __WEBPACK_IMPORTED_MODULE_13__src_utcMonth__["a"]});var __WEBPACK_IMPORTED_MODULE_14__src_utcYear__=__webpack_require__(888);__webpack_require__.d(__webpack_exports__,"t",function(){return __WEBPACK_IMPORTED_MODULE_14__src_utcYear__["a"]})},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return timeFormat});__webpack_require__.d(__webpack_exports__,"b",function(){return utcFormat});__webpack_require__.d(__webpack_exports__,"c",function(){return utcParse});var __WEBPACK_IMPORTED_MODULE_0__locale__=__webpack_require__(802);var locale;var timeFormat;var timeParse;var utcFormat;var utcParse;defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale(definition){locale=Object(__WEBPACK_IMPORTED_MODULE_0__locale__["a"])(definition);timeFormat=locale.format;timeParse=locale.parse;utcFormat=locale.utcFormat;utcParse=locale.utcParse;return locale}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var GridLayout=function(_super){tslib_1.__extends(GridLayout,_super);function GridLayout(parameters){var _this=_super.call(this,parameters)||this;GridLayout.PROPERTIES.forEach(function(p){if(!isNaN(p.defaultValue)&&isNaN(parameters[p.name]))_this[p.name]=p.defaultValue});return _this}GridLayout.isGridLayout=function(candidate){return candidate instanceof GridLayout};GridLayout.fromJS=function(parameters){return new GridLayout(immutable_class_1.BaseImmutable.jsToValue(GridLayout.PROPERTIES,parameters))};GridLayout.prototype.toScrollerLayout=function(stage){return{bodyWidth:this.scrollable?this.columnWidth*this.columns:stage.width-this.left,bodyHeight:this.scrollable?this.rows*this.rowHeight:stage.height-this.top,bodyPadding:{top:this.paddingTop,right:this.paddingRight,bottom:this.paddingBottom,left:this.paddingLeft},top:this.top,right:this.right,bottom:this.bottom,left:this.left}};GridLayout.prototype.getCellPosition=function(point){var x=point.x,y=point.y;var rowIndex=Math.floor((y-this.top-this.paddingTop)/this.rowHeight);var columnIndex=Math.floor((x-this.left-this.paddingLeft)/this.columnWidth);return{rowIndex:y<this.top||rowIndex>=this.rows?-1:rowIndex,columnIndex:x<this.left||columnIndex>=this.columns?-1:columnIndex}};GridLayout.prototype.getAbsolutePosition=function(cell,leftOffset,topOffset){if(leftOffset===void 0){leftOffset=0}if(topOffset===void 0){topOffset=0}leftOffset=isNaN(leftOffset)?0:leftOffset;topOffset=isNaN(topOffset)?0:topOffset;return{left:cell.x*this.columnWidth+this.left+this.paddingLeft+leftOffset,top:cell.y*this.rowHeight+this.top+this.paddingTop+topOffset}};GridLayout.prototype.getVisibilityChecker=function(scrollState,stage){var _a=this.getVisibleIndices(scrollState,stage),xBounds=_a.xBounds,yBounds=_a.yBounds;return function(x,y){return x>=xBounds.from&&x<=xBounds.to&&y>=yBounds.from&&y<=yBounds.to}};GridLayout.prototype.getVisibleIndices=function(scrollState,stage){var scrollTop=scrollState.scrollTop,scrollLeft=scrollState.scrollLeft;scrollTop=scrollTop||0;scrollLeft=scrollLeft||0;return{xBounds:{from:Math.max(0,Math.floor(scrollLeft/this.columnWidth)),to:Math.min(this.columns,Math.ceil((scrollLeft+stage.width)/this.columnWidth))},yBounds:{from:Math.max(0,Math.floor(scrollTop/this.rowHeight)),to:Math.min(this.rows,Math.ceil((scrollTop+stage.height)/this.rowHeight))}}};GridLayout.prototype.getIdealBodySize=function(stage){return{height:stage.height-this.bottom-this.top-this.paddingTop-this.paddingBottom,width:stage.width-this.right-this.left-this.paddingRight-this.paddingLeft}};GridLayout.prototype.getBodySize=function(){return{width:this.columnWidth*this.columns,height:this.rowHeight*this.rows}};GridLayout.prototype.getTotalSize=function(){var size=this.getBodySize();size.width+=this.left+this.right;size.height+=this.top+this.bottom;return size};GridLayout.prototype.getIdealCellSize=function(stage){var _a=this.getIdealBodySize(stage),width=_a.width,height=_a.height;return{width:width/this.columns,height:height/this.rows}};GridLayout.PROPERTIES=[{name:"scrollable",defaultValue:true},{name:"columns",defaultValue:0},{name:"rows",defaultValue:0},{name:"columnWidth",defaultValue:0},{name:"rowHeight",defaultValue:0},{name:"top",defaultValue:0},{name:"right",defaultValue:0},{name:"bottom",defaultValue:0},{name:"left",defaultValue:0},{name:"paddingTop",defaultValue:0},{name:"paddingRight",defaultValue:0},{name:"paddingBottom",defaultValue:0},{name:"paddingLeft",defaultValue:0}];return GridLayout}(immutable_class_1.BaseImmutable);exports.GridLayout=GridLayout;immutable_class_1.BaseImmutable.finalize(GridLayout)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var components_1=__webpack_require__(466);var raw_data_modal_1=__webpack_require__(816);var monitor_modal_1=__webpack_require__(820);var drag_manager_1=__webpack_require__(110);var local_storage_1=__webpack_require__(758);var visualizations_1=__webpack_require__(759);var cube_header_bar_1=__webpack_require__(929);var supervised_cube_header_bar_1=__webpack_require__(932);__webpack_require__(935);var PADDING=10;var SMALL_PANEL_WIDTH=200;var MIN_PANEL_WIDTH=240;var MAX_PANEL_WIDTH=400;var CubeView=function(_super){tslib_1.__extends(CubeView,_super);function CubeView(){var _this=_super.call(this)||this;_this.state={dragOver:false,showRawDataModal:false,showMonitorModal:false,layout:_this.getStoredLayout(),updatingTimekeeper:false};_this.clicker={changeTimezone:function(timezone){var essence=_this.props.essence;_this.props.onEssenceChange(essence.changeTimezone(timezone))},changeInstance:function(instance){var essence=_this.props.essence;_this.props.onEssenceChange(essence.changeInstance(instance))},changeFilter:function(filter){var essence=_this.props.essence;_this.props.onEssenceChange(essence.changeFilter(filter))},changeSplits:function(splits,strategy,colors){var essence=_this.props.essence;if(colors)essence=essence.changeColors(colors);_this.props.onEssenceChange(essence.updateWithNewSplits(splits,strategy))},changeSplit:function(split,strategy){var essence=_this.props.essence;_this.props.onEssenceChange(essence.changeSplit(split,strategy))},addSplit:function(split,strategy){var essence=_this.props.essence;_this.props.onEssenceChange(essence.addSplit(split,strategy))},removeSplit:function(split,strategy){var essence=_this.props.essence;_this.props.onEssenceChange(essence.removeSplit(split,strategy))},changeColors:function(colors){var essence=_this.props.essence;_this.props.onEssenceChange(essence.changeColors(colors))},summonVisualization:function(visualization){var essence=_this.props.essence;_this.props.onEssenceChange(essence.summonVisualization(visualization))},pin:function(dimension){var essence=_this.props.essence;_this.props.onEssenceChange(essence.pin(dimension))},unpin:function(dimension){var essence=_this.props.essence;_this.props.onEssenceChange(essence.unpin(dimension))},changePinnedSortMeasure:function(measure){var essence=_this.props.essence;_this.props.onEssenceChange(essence.changePinnedSortMeasure(measure))},toggleMultiMeasureMode:function(){var essence=_this.props.essence;var newEssence=essence.toggleMultiMeasureMode();var defaultMeasureMode=local_storage_1.LocalStorage.get("multi-measure")||models_1.Essence.DEFAULT_DEFAULT_MEASURE_MODE;if(Object.prototype.toString.call(defaultMeasureMode)!=="[object Object]")defaultMeasureMode={};defaultMeasureMode[newEssence.getVisualizationManifest().name]=newEssence.getMeasureMode();local_storage_1.LocalStorage.set("multi-measure",defaultMeasureMode);_this.props.onEssenceChange(newEssence.updateDefaultMeasureModes(defaultMeasureMode))},toggleEffectiveMeasure:function(measure){var essence=_this.props.essence;_this.props.onEssenceChange(essence.toggleEffectiveMeasure(measure))},switchToMeasure:function(measure){var essence=_this.props.essence;_this.props.onEssenceChange(essence.switchToMeasure(measure))},changeHighlight:function(highlight){var essence=_this.props.essence;_this.props.onEssenceChange(essence.changeHighlight(highlight))},acceptHighlight:function(){var essence=_this.props.essence;_this.props.onEssenceChange(essence.acceptHighlight())},dropHighlight:function(){var essence=_this.props.essence;_this.props.onEssenceChange(essence.dropHighlight())},invertHighlight:function(){var essence=_this.props.essence;if(!essence.canInvertHighlight())return false;_this.props.onEssenceChange(essence.invertHighlight());return true},acceptInvertedHighlight:function(){var essence=_this.props.essence;if(essence.canInvertHighlight()){_this.props.onEssenceChange(essence.invertHighlight().acceptHighlight())}}};return _this}CubeView.prototype.componentWillMount=function(){this.globalResizeListener()};CubeView.prototype.componentDidMount=function(){this.mounted=true;drag_manager_1.DragManager.init();this.emergencyRefreshIfNeeded()};CubeView.prototype.componentDidUpdate=function(prevProps){var essence=this.props.essence;if(essence&&prevProps.essence&&essence.dataCube!==prevProps.essence.dataCube){this.emergencyRefreshIfNeeded()}};CubeView.prototype.componentWillUnmount=function(){this.mounted=false};CubeView.prototype.emergencyRefreshIfNeeded=function(){var _a=this.props,controller=_a.controller,essence=_a.essence,timekeeper=_a.timekeeper;if(!essence)return;var dataCube=essence.actualDataCube;if(dataCube&&dataCube.refreshNeeded(timekeeper)){setTimeout(function(){return controller.refreshMaxTime(dataCube)},9)}};CubeView.prototype.globalResizeListener=function(){this.setState({deviceSize:models_1.Device.getSize()})};CubeView.prototype.canDrop=function(e){return Boolean(drag_manager_1.DragManager.getDragDimension())};CubeView.prototype.dragEnter=function(e){if(!this.canDrop(e))return;e.preventDefault();this.setState({dragOver:true})};CubeView.prototype.dragOver=function(e){if(!this.canDrop(e))return;e.dataTransfer.dropEffect="move";e.preventDefault()};CubeView.prototype.dragLeave=function(e){this.setState({dragOver:false})};CubeView.prototype.drop=function(e){var essence=this.props.essence;if(!this.canDrop(e))return;e.preventDefault();var dimension=drag_manager_1.DragManager.getDragDimension();if(dimension){this.clicker.changeSplits(models_1.Splits.fromSplitCombine(models_1.SplitCombine.fromDimensionAndFilterAndMeasure(dimension,essence.getEffectiveFilter(),essence.getSortMeasure())),models_1.VisStrategy.FairGame)}this.setState({dragOver:false})};CubeView.prototype.triggerFilterMenu=function(dimension){if(!dimension)return;this.filterTile.filterMenuRequest(dimension)};CubeView.prototype.triggerSplitMenu=function(dimension){if(!dimension)return;this.splitTile.splitMenuRequest(dimension)};CubeView.prototype.getStoredLayout=function(){var layout=local_storage_1.LocalStorage.get("cube-view-layout")||CubeView.DEFAULT_LAYOUT;if(Object.prototype.toString.call(layout)!=="[object Object]")layout=CubeView.DEFAULT_LAYOUT;return Object.assign({},CubeView.DEFAULT_LAYOUT,layout)};CubeView.prototype.storeLayout=function(layout){local_storage_1.LocalStorage.set("cube-view-layout",layout)};CubeView.prototype.onDimensionPanelResize=function(value){var layout=this.state.layout;layout.dimensionPanelWidth=value;this.setState({layout:layout});this.storeLayout(layout)};CubeView.prototype.onDimensionRatioChange=function(value){var layout=this.state.layout;layout.dimensionsPanelRatio=value;this.setState({layout:layout});this.storeLayout(layout)};CubeView.prototype.onPinboardPanelResize=function(value){var layout=this.state.layout;layout.pinboardWidth=value;this.setState({layout:layout});this.storeLayout(layout)};CubeView.prototype.onPanelResizeEnd=function(){if(this.visualization)this.visualization.calculateSize();if(this.filterTile)this.filterTile.calculateSize();if(this.splitTile)this.splitTile.calculateSize()};CubeView.prototype.getLongUrl=function(essence){var url=window.location;var urlBase=url.origin+url.pathname;return urlBase.replace(/\/[dc]\/.+$/,"")+"/d/"+essence.toFullHash()};CubeView.prototype.renderRawDataModal=function(){var _this=this;var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,customization=_a.customization;var showRawDataModal=this.state.showRawDataModal;if(!showRawDataModal)return null;return React.createElement(raw_data_modal_1.RawDataModal,{essence:essence,timekeeper:timekeeper,customization:customization,onClose:function(){return _this.setState({showRawDataModal:false})}})};CubeView.prototype.renderMonitorModal=function(){var _this=this;var showMonitorModal=this.state.showMonitorModal;if(!showMonitorModal)return null;return React.createElement(monitor_modal_1.MonitorModal,{onClose:function(){return _this.setState({showMonitorModal:false})}})};CubeView.prototype.renderHeaderBar=function(){var _this=this;var _a=this.props,settings=_a.settings,essence=_a.essence,timekeeper=_a.timekeeper,updatingTimekeeper=_a.updatingTimekeeper,controller=_a.controller,user=_a.user,customization=_a.customization,supervisor=_a.supervisor,stateful=_a.stateful,goBack=_a.goBack;if(supervisor){return React.createElement(supervised_cube_header_bar_1.SupervisedCubeHeaderBar,{clicker:this.clicker,essence:essence,customization:customization,supervisor:supervisor})}else{return React.createElement(cube_header_bar_1.CubeHeaderBar,{settings:settings,controller:controller,clicker:this.clicker,essence:essence,timekeeper:timekeeper,user:user,onEditClick:function(){return controller.editDataCube(essence.actualDataCube,"update")},getLongUrl:function(essence){return _this.getLongUrl(essence)},onRefreshMaxTime:function(){return controller.refreshMaxTime(essence.actualDataCube)},openRawDataModal:function(){return _this.setState({showRawDataModal:true})},openMonitorModal:function(){return _this.setState({showMonitorModal:true})},customization:customization,getDownloadableDataset:function(){return _this.downloadableDataset},updatingTimekeeper:updatingTimekeeper,stateful:stateful,goBack:goBack})}};CubeView.prototype.render=function(){var _this=this;var clicker=this.clicker;var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,customization=_a.customization;var _b=this.state,deviceSize=_b.deviceSize,layout=_b.layout,customColors=_b.customColors,dragOver=_b.dragOver;if(!essence)return null;var visualization=essence.getVisualizationManifest();var visResolve=essence.getVisResolve();var visElement=null;if(visResolve.proceedWithDimensions()){var visProps={ref:function(e){return _this.visualization=e},clicker:clicker,timekeeper:timekeeper,essence:essence,deviceSize:deviceSize,openRawDataModal:function(){return _this.setState({showRawDataModal:true})},registerDownloadableDataset:function(dataset){_this.downloadableDataset=dataset},registerCustomColors:function(colors){var customColors=_this.state.customColors;if(colors.equals(customColors))return;_this.setState({customColors:colors})}};visElement=React.createElement(visualizations_1.getVisualizationComponent(visualization),visProps)}var manualFallback=null;if(visResolve.rejectedDimensions()||visResolve.rejectedCombines()){manualFallback=React.createElement(components_1.ManualFallback,{clicker:clicker,essence:essence})}var styles={dimensionMeasurePanel:{width:layout.dimensionPanelWidth-2*PADDING,dimensionTile:{height:layout.dimensionsPanelRatio+"%"},measureTile:{top:layout.dimensionsPanelRatio+"%"}},centerPanel:{left:layout.dimensionPanelWidth,right:layout.pinboardWidth},pinboardPanel:{width:layout.pinboardWidth-2*PADDING}};if(deviceSize==="small"){styles={dimensionMeasurePanel:{width:SMALL_PANEL_WIDTH-1,dimensionTile:{height:layout.dimensionsPanelRatio+"%"},measureTile:{top:layout.dimensionsPanelRatio+"%"}},centerPanel:{left:SMALL_PANEL_WIDTH,right:SMALL_PANEL_WIDTH},pinboardPanel:{width:SMALL_PANEL_WIDTH-1}}}var theme=customization.getPreferredTheme(essence.actualDataCube.theme);var getLongUrl=function(essence){return _this.getLongUrl(essence)};return React.createElement("div",{className:"cube-view",style:{background:theme.backgroundColor}},React.createElement(caladan_1.GlobalEventListener,{resize:function(){return _this.globalResizeListener()}}),this.renderHeaderBar(),React.createElement("div",{className:"container",ref:"container"},React.createElement("div",{className:"dimension-measure-panel",style:styles.dimensionMeasurePanel},React.createElement(components_1.DimensionListTile,{style:styles.dimensionMeasurePanel.dimensionTile,clicker:clicker,essence:essence,timekeeper:timekeeper,triggerFilterMenu:function(d){return _this.triggerFilterMenu(d)},triggerSplitMenu:function(d){return _this.triggerSplitMenu(d)},getLongUrl:getLongUrl}),React.createElement(caladan_1.ResizeHandle,{side:"top",initialValue:layout.dimensionsPanelRatio,onResize:this.onDimensionRatioChange.bind(this),mode:"percentage",min:20,max:80}),React.createElement(components_1.MeasuresTile,{style:styles.dimensionMeasurePanel.measureTile,clicker:clicker,essence:essence})),deviceSize!=="small"?React.createElement(caladan_1.ResizeHandle,{side:"left",initialValue:layout.dimensionPanelWidth,onResize:this.onDimensionPanelResize.bind(this),onResizeEnd:this.onPanelResizeEnd.bind(this),min:MIN_PANEL_WIDTH,max:MAX_PANEL_WIDTH}):null,React.createElement("div",{className:"center-panel",style:styles.centerPanel},React.createElement("div",{className:"center-top-bar"},React.createElement("div",{className:"filter-split-section"},React.createElement(components_1.FilterTile,{ref:function(e){return _this.filterTile=e},clicker:clicker,essence:essence,timekeeper:timekeeper,customization:customization,getLongUrl:getLongUrl}),React.createElement(components_1.SplitTile,{ref:function(e){return _this.splitTile=e},clicker:clicker,essence:essence,customization:customization,getLongUrl:getLongUrl})),React.createElement(components_1.VisSelector,{clicker:clicker,essence:essence})),React.createElement("div",{className:"center-main",onDragEnter:this.dragEnter.bind(this)},React.createElement("div",{className:"visualization"},visElement),manualFallback,dragOver?React.createElement(components_1.DropIndicator,null):null,dragOver?React.createElement("div",{className:"drag-mask",onDragOver:this.dragOver.bind(this),onDragLeave:this.dragLeave.bind(this),onDragExit:this.dragLeave.bind(this),onDrop:this.drop.bind(this)}):null)),deviceSize!=="small"?React.createElement(caladan_1.ResizeHandle,{side:"right",initialValue:layout.pinboardWidth,onResize:this.onPinboardPanelResize.bind(this),onResizeEnd:this.onPanelResizeEnd.bind(this),min:MIN_PANEL_WIDTH,max:MAX_PANEL_WIDTH}):null,React.createElement(components_1.PinboardPanel,{style:styles.pinboardPanel,clicker:clicker,essence:essence,customColors:customColors,timekeeper:timekeeper,getLongUrl:getLongUrl})),this.renderRawDataModal(),this.renderMonitorModal())};CubeView.DEFAULT_LAYOUT={dimensionPanelWidth:240,pinboardWidth:240,dimensionsPanelRatio:60};return CubeView}(React.Component);exports.CubeView=CubeView},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return bisectRight});__webpack_require__.d(__webpack_exports__,"a",function(){return bisectLeft});var __WEBPACK_IMPORTED_MODULE_0__ascending__=__webpack_require__(747);var __WEBPACK_IMPORTED_MODULE_1__bisector__=__webpack_require__(773);var ascendingBisect=Object(__WEBPACK_IMPORTED_MODULE_1__bisector__["a"])(__WEBPACK_IMPORTED_MODULE_0__ascending__["a"]);var bisectRight=ascendingBisect.right;var bisectLeft=ascendingBisect.left;__webpack_exports__["c"]=bisectRight},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__ascending__=__webpack_require__(747);__webpack_exports__["a"]=function(compare){if(compare.length===1)compare=ascendingComparator(compare);return{left:function(a,x,lo,hi){if(lo==null)lo=0;if(hi==null)hi=a.length;while(lo<hi){var mid=lo+hi>>>1;if(compare(a[mid],x)<0)lo=mid+1;else hi=mid}return lo},right:function(a,x,lo,hi){if(lo==null)lo=0;if(hi==null)hi=a.length;while(lo<hi){var mid=lo+hi>>>1;if(compare(a[mid],x)>0)hi=mid;else lo=mid+1}return lo}}};function ascendingComparator(f){return function(d,x){return Object(__WEBPACK_IMPORTED_MODULE_0__ascending__["a"])(f(d),x)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=pair;__webpack_exports__["a"]=function(array,f){if(f==null)f=pair;var i=0,n=array.length-1,p=array[0],pairs=new Array(n<0?0:n);while(i<n)pairs[i]=f(p,p=array[++i]);return pairs};function pair(a,b){return[a,b]}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__variance__=__webpack_require__(776);__webpack_exports__["a"]=function(array,f){var v=Object(__WEBPACK_IMPORTED_MODULE_0__variance__["a"])(array,f);return v?Math.sqrt(v):v}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__number__=__webpack_require__(748);__webpack_exports__["a"]=function(values,valueof){var n=values.length,m=0,i=-1,mean=0,value,delta,sum=0;if(valueof==null){while(++i<n){if(!isNaN(value=Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(values[i]))){delta=value-mean;mean+=delta/++m;sum+=delta*(value-mean)}}}else{while(++i<n){if(!isNaN(value=Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(valueof(values[i],i,values)))){delta=value-mean;mean+=delta/++m;sum+=delta*(value-mean)}}}if(m>1)return sum/(m-1)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(values,valueof){var n=values.length,i=-1,value,min,max;if(valueof==null){while(++i<n){if((value=values[i])!=null&&value>=value){min=max=value;while(++i<n){if((value=values[i])!=null){if(min>value)min=value;if(max<value)max=value}}}}}else{while(++i<n){if((value=valueof(values[i],i,values))!=null&&value>=value){min=max=value;while(++i<n){if((value=valueof(values[i],i,values))!=null){if(min>value)min=value;if(max<value)max=value}}}}}return[min,max]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return slice});__webpack_require__.d(__webpack_exports__,"a",function(){return map});var array=Array.prototype;var slice=array.slice;var map=array.map},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(start,stop,step){start=+start,stop=+stop,step=(n=arguments.length)<2?(stop=start,start=0,1):n<3?1:+step;var i=-1,n=Math.max(0,Math.ceil((stop-start)/step))|0,range=new Array(n);while(++i<n){range[i]=start+i*step}return range}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=tickIncrement;__webpack_exports__["c"]=tickStep;var e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);__webpack_exports__["a"]=function(start,stop,count){var reverse=stop<start,i=-1,n,ticks,step;if(reverse)n=start,start=stop,stop=n;if((step=tickIncrement(start,stop,count))===0||!isFinite(step))return[];if(step>0){start=Math.ceil(start/step);stop=Math.floor(stop/step);ticks=new Array(n=Math.ceil(stop-start+1));while(++i<n)ticks[i]=(start+i)*step}else{start=Math.floor(start*step);stop=Math.ceil(stop*step);ticks=new Array(n=Math.ceil(start-stop+1));while(++i<n)ticks[i]=(start-i)/step}if(reverse)ticks.reverse();return ticks};function tickIncrement(start,stop,count){var step=(stop-start)/Math.max(0,count),power=Math.floor(Math.log(step)/Math.LN10),error=step/Math.pow(10,power);return power>=0?(error>=e10?10:error>=e5?5:error>=e2?2:1)*Math.pow(10,power):-Math.pow(10,-power)/(error>=e10?10:error>=e5?5:error>=e2?2:1)}function tickStep(start,stop,count){var step0=Math.abs(stop-start)/Math.max(0,count),step1=Math.pow(10,Math.floor(Math.log(step0)/Math.LN10)),error=step0/step1;if(error>=e10)step1*=10;else if(error>=e5)step1*=5;else if(error>=e2)step1*=2;return stop<start?-step1:step1}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(values){return Math.ceil(Math.log(values.length)/Math.LN2)+1}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(values,valueof){var n=values.length,i=-1,value,min;if(valueof==null){while(++i<n){if((value=values[i])!=null&&value>=value){min=value;while(++i<n){if((value=values[i])!=null&&min>value){min=value}}}}}else{while(++i<n){if((value=valueof(values[i],i,values))!=null&&value>=value){min=value;while(++i<n){if((value=valueof(values[i],i,values))!=null&&min>value){min=value}}}}}return min}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__min__=__webpack_require__(782);__webpack_exports__["a"]=function(matrix){if(!(n=matrix.length))return[];for(var i=-1,m=Object(__WEBPACK_IMPORTED_MODULE_0__min__["a"])(matrix,length),transpose=new Array(m);++i<m;){for(var j=-1,n,row=transpose[i]=new Array(n);++j<n;){row[j]=matrix[j][i]}}return transpose};function length(d){return d.length}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return implicit});__webpack_exports__["a"]=ordinal;var __WEBPACK_IMPORTED_MODULE_0_d3_collection__=__webpack_require__(841);var __WEBPACK_IMPORTED_MODULE_1__array__=__webpack_require__(745);var implicit={name:"implicit"};function ordinal(range){var index=Object(__WEBPACK_IMPORTED_MODULE_0_d3_collection__["a"])(),domain=[],unknown=implicit;range=range==null?[]:__WEBPACK_IMPORTED_MODULE_1__array__["b"].call(range);function scale(d){var key=d+"",i=index.get(key);if(!i){if(unknown!==implicit)return unknown;index.set(key,i=domain.push(d))}return range[(i-1)%range.length]}scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[],index=Object(__WEBPACK_IMPORTED_MODULE_0_d3_collection__["a"])();var i=-1,n=_.length,d,key;while(++i<n)if(!index.has(key=(d=_[i])+""))index.set(key,domain.push(d));return scale};scale.range=function(_){return arguments.length?(range=__WEBPACK_IMPORTED_MODULE_1__array__["b"].call(_),scale):range.slice()};scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown};scale.copy=function(){return ordinal().domain(domain).range(range).unknown(unknown)};return scale}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return deg2rad});__webpack_require__.d(__webpack_exports__,"b",function(){return rad2deg});var deg2rad=Math.PI/180;var rad2deg=180/Math.PI},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_color__=__webpack_require__(744);var __WEBPACK_IMPORTED_MODULE_1__basis__=__webpack_require__(765);var __WEBPACK_IMPORTED_MODULE_2__basisClosed__=__webpack_require__(787);var __WEBPACK_IMPORTED_MODULE_3__color__=__webpack_require__(751);__webpack_exports__["a"]=function rgbGamma(y){var color=Object(__WEBPACK_IMPORTED_MODULE_3__color__["b"])(y);function rgb(start,end){var r=color((start=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["f"])(start)).r,(end=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["f"])(end)).r),g=color(start.g,end.g),b=color(start.b,end.b),opacity=Object(__WEBPACK_IMPORTED_MODULE_3__color__["a"])(start.opacity,end.opacity);return function(t){start.r=r(t);start.g=g(t);start.b=b(t);start.opacity=opacity(t);return start+""}}rgb.gamma=rgbGamma;return rgb}(1);function rgbSpline(spline){return function(colors){var n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n),i,color;for(i=0;i<n;++i){color=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["f"])(colors[i]);r[i]=color.r||0;g[i]=color.g||0;b[i]=color.b||0}r=spline(r);g=spline(g);b=spline(b);color.opacity=1;return function(t){color.r=r(t);color.g=g(t);color.b=b(t);return color+""}}}var rgbBasis=rgbSpline(__WEBPACK_IMPORTED_MODULE_1__basis__["b"]);var rgbBasisClosed=rgbSpline(__WEBPACK_IMPORTED_MODULE_2__basisClosed__["a"])},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__basis__=__webpack_require__(765);__webpack_exports__["a"]=function(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return Object(__WEBPACK_IMPORTED_MODULE_0__basis__["a"])((t-i/n)*n,v0,v1,v2,v3)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x){return function(){return x}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__value__=__webpack_require__(762);__webpack_exports__["a"]=function(a,b){var nb=b?b.length:0,na=a?Math.min(nb,a.length):0,x=new Array(nb),c=new Array(nb),i;for(i=0;i<na;++i)x[i]=Object(__WEBPACK_IMPORTED_MODULE_0__value__["a"])(a[i],b[i]);for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<na;++i)c[i]=x[i](t);return c}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(a,b){var d=new Date;return a=+a,b-=a,function(t){return d.setTime(a+b*t),d}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__value__=__webpack_require__(762);__webpack_exports__["a"]=function(a,b){var i={},c={},k;if(a===null||typeof a!=="object")a={};if(b===null||typeof b!=="object")b={};for(k in b){if(k in a){i[k]=Object(__WEBPACK_IMPORTED_MODULE_0__value__["a"])(a[k],b[k])}else{c[k]=b[k]}}return function(t){for(k in i)c[k]=i[k](t);return c}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__number__=__webpack_require__(754);var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(b){return function(){return b}}function one(b){return function(t){return b(t)+""}}__webpack_exports__["a"]=function(a,b){var bi=reA.lastIndex=reB.lastIndex=0,am,bm,bs,i=-1,s=[],q=[];a=a+"",b=b+"";while((am=reA.exec(a))&&(bm=reB.exec(b))){if((bs=bm.index)>bi){bs=b.slice(bi,bs);if(s[i])s[i]+=bs;else s[++i]=bs}if((am=am[0])===(bm=bm[0])){if(s[i])s[i]+=bm;else s[++i]=bm}else{s[++i]=null;q.push({i:i,x:Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(am,bm)})}bi=reB.lastIndex}if(bi<b.length){bs=b.slice(bi);if(s[i])s[i]+=bs;else s[++i]=bs}return s.length<2?q[0]?one(q[0].x):zero(b):(b=q.length,function(t){for(var i=0,o;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x){return+x}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__src_defaultLocale__=__webpack_require__(861);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__src_defaultLocale__["a"]});__webpack_require__.d(__webpack_exports__,"b",function(){return __WEBPACK_IMPORTED_MODULE_0__src_defaultLocale__["b"]});var __WEBPACK_IMPORTED_MODULE_1__src_locale__=__webpack_require__(795);var __WEBPACK_IMPORTED_MODULE_2__src_formatSpecifier__=__webpack_require__(796);__webpack_require__.d(__webpack_exports__,"c",function(){return __WEBPACK_IMPORTED_MODULE_2__src_formatSpecifier__["a"]});var __WEBPACK_IMPORTED_MODULE_3__src_precisionFixed__=__webpack_require__(867);__webpack_require__.d(__webpack_exports__,"d",function(){return __WEBPACK_IMPORTED_MODULE_3__src_precisionFixed__["a"]});var __WEBPACK_IMPORTED_MODULE_4__src_precisionPrefix__=__webpack_require__(868);__webpack_require__.d(__webpack_exports__,"e",function(){return __WEBPACK_IMPORTED_MODULE_4__src_precisionPrefix__["a"]});var __WEBPACK_IMPORTED_MODULE_5__src_precisionRound__=__webpack_require__(869);__webpack_require__.d(__webpack_exports__,"f",function(){return __WEBPACK_IMPORTED_MODULE_5__src_precisionRound__["a"]})},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__exponent__=__webpack_require__(756);var __WEBPACK_IMPORTED_MODULE_1__formatGroup__=__webpack_require__(862);var __WEBPACK_IMPORTED_MODULE_2__formatNumerals__=__webpack_require__(863);var __WEBPACK_IMPORTED_MODULE_3__formatSpecifier__=__webpack_require__(796);var __WEBPACK_IMPORTED_MODULE_4__formatTypes__=__webpack_require__(797);var __WEBPACK_IMPORTED_MODULE_5__formatPrefixAuto__=__webpack_require__(798);var __WEBPACK_IMPORTED_MODULE_6__identity__=__webpack_require__(866);var prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];__webpack_exports__["a"]=function(locale){var group=locale.grouping&&locale.thousands?Object(__WEBPACK_IMPORTED_MODULE_1__formatGroup__["a"])(locale.grouping,locale.thousands):__WEBPACK_IMPORTED_MODULE_6__identity__["a"],currency=locale.currency,decimal=locale.decimal,numerals=locale.numerals?Object(__WEBPACK_IMPORTED_MODULE_2__formatNumerals__["a"])(locale.numerals):__WEBPACK_IMPORTED_MODULE_6__identity__["a"],percent=locale.percent||"%";function newFormat(specifier){specifier=Object(__WEBPACK_IMPORTED_MODULE_3__formatSpecifier__["a"])(specifier);var fill=specifier.fill,align=specifier.align,sign=specifier.sign,symbol=specifier.symbol,zero=specifier.zero,width=specifier.width,comma=specifier.comma,precision=specifier.precision,type=specifier.type;var prefix=symbol==="$"?currency[0]:symbol==="#"&&/[boxX]/.test(type)?"0"+type.toLowerCase():"",suffix=symbol==="$"?currency[1]:/[%p]/.test(type)?percent:"";var formatType=__WEBPACK_IMPORTED_MODULE_4__formatTypes__["a"][type],maybeSuffix=!type||/[defgprs%]/.test(type);precision=precision==null?type?6:12:/[gprs]/.test(type)?Math.max(1,Math.min(21,precision)):Math.max(0,Math.min(20,precision));function format(value){var valuePrefix=prefix,valueSuffix=suffix,i,n,c;if(type==="c"){valueSuffix=formatType(value)+valueSuffix;value=""}else{value=+value;var valueNegative=value<0;value=formatType(Math.abs(value),precision);if(valueNegative&&+value===0)valueNegative=false;valuePrefix=(valueNegative?sign==="("?sign:"-":sign==="-"||sign==="("?"":sign)+valuePrefix;valueSuffix=valueSuffix+(type==="s"?prefixes[8+__WEBPACK_IMPORTED_MODULE_5__formatPrefixAuto__["b"]/3]:"")+(valueNegative&&sign==="("?")":"");if(maybeSuffix){i=-1,n=value.length;while(++i<n){if(c=value.charCodeAt(i),48>c||c>57){valueSuffix=(c===46?decimal+value.slice(i+1):value.slice(i))+valueSuffix;value=value.slice(0,i);break}}}}if(comma&&!zero)value=group(value,Infinity);var length=valuePrefix.length+value.length+valueSuffix.length,padding=length<width?new Array(width-length+1).join(fill):"";if(comma&&zero)value=group(padding+value,padding.length?width-valueSuffix.length:Infinity),padding="";switch(align){case"<":value=valuePrefix+value+valueSuffix+padding;break;case"=":value=valuePrefix+padding+value+valueSuffix;break;case"^":value=padding.slice(0,length=padding.length>>1)+valuePrefix+value+valueSuffix+padding.slice(length);break;default:value=padding+valuePrefix+value+valueSuffix;break}return numerals(value)}format.toString=function(){return specifier+""};return format}function formatPrefix(specifier,value){var f=newFormat((specifier=Object(__WEBPACK_IMPORTED_MODULE_3__formatSpecifier__["a"])(specifier),specifier.type="f",specifier)),e=Math.max(-8,Math.min(8,Math.floor(Object(__WEBPACK_IMPORTED_MODULE_0__exponent__["a"])(value)/3)))*3,k=Math.pow(10,-e),prefix=prefixes[8+e/3];return function(value){return f(k*value)+prefix}}return{format:newFormat,formatPrefix:formatPrefix}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=formatSpecifier;var __WEBPACK_IMPORTED_MODULE_0__formatTypes__=__webpack_require__(797);var re=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function formatSpecifier(specifier){return new FormatSpecifier(specifier)}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(specifier){if(!(match=re.exec(specifier)))throw new Error("invalid format: "+specifier);var match,fill=match[1]||" ",align=match[2]||">",sign=match[3]||"-",symbol=match[4]||"",zero=!!match[5],width=match[6]&&+match[6],comma=!!match[7],precision=match[8]&&+match[8].slice(1),type=match[9]||"";if(type==="n")comma=true,type="g";else if(!__WEBPACK_IMPORTED_MODULE_0__formatTypes__["a"][type])type="";if(zero||fill==="0"&&align==="=")zero=true,fill="0",align="=";this.fill=fill;this.align=align;this.sign=sign;this.symbol=symbol;this.zero=zero;this.width=width;this.comma=comma;this.precision=precision;this.type=type}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,this.precision|0))+this.type}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__formatDefault__=__webpack_require__(864);var __WEBPACK_IMPORTED_MODULE_1__formatPrefixAuto__=__webpack_require__(798);var __WEBPACK_IMPORTED_MODULE_2__formatRounded__=__webpack_require__(865);__webpack_exports__["a"]={"":__WEBPACK_IMPORTED_MODULE_0__formatDefault__["a"],"%":function(x,p){return(x*100).toFixed(p)},b:function(x){return Math.round(x).toString(2)},c:function(x){return x+""},d:function(x){return Math.round(x).toString(10)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},g:function(x,p){return x.toPrecision(p)},o:function(x){return Math.round(x).toString(8)},p:function(x,p){return Object(__WEBPACK_IMPORTED_MODULE_2__formatRounded__["a"])(x*100,p)},r:__WEBPACK_IMPORTED_MODULE_2__formatRounded__["a"],s:__WEBPACK_IMPORTED_MODULE_1__formatPrefixAuto__["a"],X:function(x){return Math.round(x).toString(16).toUpperCase()},x:function(x){return Math.round(x).toString(16)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return prefixExponent});var __WEBPACK_IMPORTED_MODULE_0__formatDecimal__=__webpack_require__(767);var prefixExponent;__webpack_exports__["a"]=function(x,p){var d=Object(__WEBPACK_IMPORTED_MODULE_0__formatDecimal__["a"])(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1],i=exponent-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(exponent/3)))*3)+1,n=coefficient.length;return i===n?coefficient:i>n?coefficient+new Array(i-n+1).join("0"):i>0?coefficient.slice(0,i)+"."+coefficient.slice(i):"0."+new Array(1-i).join("0")+Object(__WEBPACK_IMPORTED_MODULE_0__formatDecimal__["a"])(x,Math.max(0,p+i-1))[0]}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(domain,interval){domain=domain.slice();var i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1],t;if(x1<x0){t=i0,i0=i1,i1=t;t=x0,x0=x1,x1=t}domain[i0]=interval.floor(x0);domain[i1]=interval.ceil(x1);return domain}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=calendar;var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1_d3_interpolate__=__webpack_require__(750);var __WEBPACK_IMPORTED_MODULE_2_d3_time__=__webpack_require__(768);var __WEBPACK_IMPORTED_MODULE_3_d3_time_format__=__webpack_require__(801);var __WEBPACK_IMPORTED_MODULE_4__array__=__webpack_require__(745);var __WEBPACK_IMPORTED_MODULE_5__continuous__=__webpack_require__(755);var __WEBPACK_IMPORTED_MODULE_6__nice__=__webpack_require__(799);var durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365;function date(t){return new Date(t)}function number(t){return t instanceof Date?+t:+new Date(+t)}function calendar(year,month,week,day,hour,minute,second,millisecond,format){var scale=Object(__WEBPACK_IMPORTED_MODULE_5__continuous__["b"])(__WEBPACK_IMPORTED_MODULE_5__continuous__["c"],__WEBPACK_IMPORTED_MODULE_1_d3_interpolate__["c"]),invert=scale.invert,domain=scale.domain;var formatMillisecond=format(".%L"),formatSecond=format(":%S"),formatMinute=format("%I:%M"),formatHour=format("%I %p"),formatDay=format("%a %d"),formatWeek=format("%b %d"),formatMonth=format("%B"),formatYear=format("%Y");var tickIntervals=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[minute,1,durationMinute],[minute,5,5*durationMinute],[minute,15,15*durationMinute],[minute,30,30*durationMinute],[hour,1,durationHour],[hour,3,3*durationHour],[hour,6,6*durationHour],[hour,12,12*durationHour],[day,1,durationDay],[day,2,2*durationDay],[week,1,durationWeek],[month,1,durationMonth],[month,3,3*durationMonth],[year,1,durationYear]];function tickFormat(date){return(second(date)<date?formatMillisecond:minute(date)<date?formatSecond:hour(date)<date?formatMinute:day(date)<date?formatHour:month(date)<date?week(date)<date?formatDay:formatWeek:year(date)<date?formatMonth:formatYear)(date)}function tickInterval(interval,start,stop,step){if(interval==null)interval=10;if(typeof interval==="number"){var target=Math.abs(stop-start)/interval,i=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["bisector"])(function(i){return i[2]}).right(tickIntervals,target);if(i===tickIntervals.length){step=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["tickStep"])(start/durationYear,stop/durationYear,interval);interval=year}else if(i){i=tickIntervals[target/tickIntervals[i-1][2]<tickIntervals[i][2]/target?i-1:i];step=i[1];interval=i[0]}else{step=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["tickStep"])(start,stop,interval);interval=millisecond}}return step==null?interval:interval.every(step)}scale.invert=function(y){return new Date(invert(y))};scale.domain=function(_){return arguments.length?domain(__WEBPACK_IMPORTED_MODULE_4__array__["a"].call(_,number)):domain().map(date)};scale.ticks=function(interval,step){var d=domain(),t0=d[0],t1=d[d.length-1],r=t1<t0,t;if(r)t=t0,t0=t1,t1=t;t=tickInterval(interval,t0,t1,step);t=t?t.range(t0,t1+1):[];return r?t.reverse():t};scale.tickFormat=function(count,specifier){return specifier==null?tickFormat:format(specifier)};scale.nice=function(interval,step){var d=domain();return(interval=tickInterval(interval,d[0],d[d.length-1],step))?domain(Object(__WEBPACK_IMPORTED_MODULE_6__nice__["a"])(d,interval)):scale};scale.copy=function(){return Object(__WEBPACK_IMPORTED_MODULE_5__continuous__["a"])(scale,calendar(year,month,week,day,hour,minute,second,millisecond,format))};return scale}__webpack_exports__["b"]=function(){return calendar(__WEBPACK_IMPORTED_MODULE_2_d3_time__["j"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["f"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["i"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["a"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["b"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["d"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["g"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["c"],__WEBPACK_IMPORTED_MODULE_3_d3_time_format__["a"]).domain([new Date(2e3,0,1),new Date(2e3,0,2)])}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__src_defaultLocale__=__webpack_require__(769);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_0__src_defaultLocale__["a"]});__webpack_require__.d(__webpack_exports__,"b",function(){return __WEBPACK_IMPORTED_MODULE_0__src_defaultLocale__["b"]});var __WEBPACK_IMPORTED_MODULE_1__src_locale__=__webpack_require__(802);var __WEBPACK_IMPORTED_MODULE_2__src_isoFormat__=__webpack_require__(803);var __WEBPACK_IMPORTED_MODULE_3__src_isoParse__=__webpack_require__(889)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=formatLocale;var __WEBPACK_IMPORTED_MODULE_0_d3_time__=__webpack_require__(768);function localDate(d){if(0<=d.y&&d.y<100){var date=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);date.setFullYear(d.y);return date}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function utcDate(d){if(0<=d.y&&d.y<100){var date=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));date.setUTCFullYear(d.y);return date}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function newYear(y){return{y:y,m:0,d:1,H:0,M:0,S:0,L:0}}function formatLocale(locale){var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_weekdays=locale.days,locale_shortWeekdays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths;var periodRe=formatRe(locale_periods),periodLookup=formatLookup(locale_periods),weekdayRe=formatRe(locale_weekdays),weekdayLookup=formatLookup(locale_weekdays),shortWeekdayRe=formatRe(locale_shortWeekdays),shortWeekdayLookup=formatLookup(locale_shortWeekdays),monthRe=formatRe(locale_months),monthLookup=formatLookup(locale_months),shortMonthRe=formatRe(locale_shortMonths),shortMonthLookup=formatLookup(locale_shortMonths);var formats={a:formatShortWeekday,A:formatWeekday,b:formatShortMonth,B:formatMonth,c:null,d:formatDayOfMonth,e:formatDayOfMonth,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:formatPeriod,S:formatSeconds,U:formatWeekNumberSunday,w:formatWeekdayNumber,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent};var utcFormats={a:formatUTCShortWeekday,A:formatUTCWeekday,b:formatUTCShortMonth,B:formatUTCMonth,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:formatUTCPeriod,S:formatUTCSeconds,U:formatUTCWeekNumberSunday,w:formatUTCWeekdayNumber,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent};var parses={a:parseShortWeekday,A:parseWeekday,b:parseShortMonth,B:parseMonth,c:parseLocaleDateTime,d:parseDayOfMonth,e:parseDayOfMonth,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:parsePeriod,S:parseSeconds,U:parseWeekNumberSunday,w:parseWeekdayNumber,W:parseWeekNumberMonday,x:parseLocaleDate,X:parseLocaleTime,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};formats.x=newFormat(locale_date,formats);formats.X=newFormat(locale_time,formats);formats.c=newFormat(locale_dateTime,formats);utcFormats.x=newFormat(locale_date,utcFormats);utcFormats.X=newFormat(locale_time,utcFormats);utcFormats.c=newFormat(locale_dateTime,utcFormats);function newFormat(specifier,formats){return function(date){var string=[],i=-1,j=0,n=specifier.length,c,pad,format;if(!(date instanceof Date))date=new Date(+date);while(++i<n){if(specifier.charCodeAt(i)===37){string.push(specifier.slice(j,i));if((pad=pads[c=specifier.charAt(++i)])!=null)c=specifier.charAt(++i);else pad=c==="e"?" ":"0";if(format=formats[c])c=format(date,pad);string.push(c);j=i+1}}string.push(specifier.slice(j,i));return string.join("")}}function newParse(specifier,newDate){return function(string){var d=newYear(1900),i=parseSpecifier(d,specifier,string+="",0);if(i!=string.length)return null;if("p"in d)d.H=d.H%12+d.p*12;if("W"in d||"U"in d){if(!("w"in d))d.w="W"in d?1:0;var day="Z"in d?utcDate(newYear(d.y)).getUTCDay():newDate(newYear(d.y)).getDay();d.m=0;d.d="W"in d?(d.w+6)%7+d.W*7-(day+5)%7:d.w+d.U*7-(day+6)%7}if("Z"in d){d.H+=d.Z/100|0;d.M+=d.Z%100;return utcDate(d)}return newDate(d)}}function parseSpecifier(d,specifier,string,j){var i=0,n=specifier.length,m=string.length,c,parse;while(i<n){if(j>=m)return-1;c=specifier.charCodeAt(i++);if(c===37){c=specifier.charAt(i++);parse=parses[c in pads?specifier.charAt(i++):c];if(!parse||(j=parse(d,string,j))<0)return-1}else if(c!=string.charCodeAt(j++)){return-1}}return j}function parsePeriod(d,string,i){var n=periodRe.exec(string.slice(i));return n?(d.p=periodLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseShortWeekday(d,string,i){var n=shortWeekdayRe.exec(string.slice(i));return n?(d.w=shortWeekdayLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseWeekday(d,string,i){var n=weekdayRe.exec(string.slice(i));return n?(d.w=weekdayLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseShortMonth(d,string,i){var n=shortMonthRe.exec(string.slice(i));return n?(d.m=shortMonthLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseMonth(d,string,i){var n=monthRe.exec(string.slice(i));return n?(d.m=monthLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseLocaleDateTime(d,string,i){return parseSpecifier(d,locale_dateTime,string,i)}function parseLocaleDate(d,string,i){return parseSpecifier(d,locale_date,string,i)}function parseLocaleTime(d,string,i){return parseSpecifier(d,locale_time,string,i)}function formatShortWeekday(d){return locale_shortWeekdays[d.getDay()]}function formatWeekday(d){return locale_weekdays[d.getDay()]}function formatShortMonth(d){return locale_shortMonths[d.getMonth()]}function formatMonth(d){return locale_months[d.getMonth()]}function formatPeriod(d){return locale_periods[+(d.getHours()>=12)]}function formatUTCShortWeekday(d){return locale_shortWeekdays[d.getUTCDay()]}function formatUTCWeekday(d){return locale_weekdays[d.getUTCDay()]}function formatUTCShortMonth(d){return locale_shortMonths[d.getUTCMonth()]}function formatUTCMonth(d){return locale_months[d.getUTCMonth()]}function formatUTCPeriod(d){return locale_periods[+(d.getUTCHours()>=12)]}return{format:function(specifier){var f=newFormat(specifier+="",formats);f.toString=function(){return specifier};return f},parse:function(specifier){var p=newParse(specifier+="",localDate);p.toString=function(){return specifier};return p},utcFormat:function(specifier){var f=newFormat(specifier+="",utcFormats);f.toString=function(){return specifier};return f},utcParse:function(specifier){var p=newParse(specifier,utcDate);p.toString=function(){return specifier};return p}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;function pad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?new Array(width-length+1).join(fill)+string:string)}function requote(s){return s.replace(requoteRe,"\\$&")}function formatRe(names){return new RegExp("^(?:"+names.map(requote).join("|")+")","i")}function formatLookup(names){var map={},i=-1,n=names.length;while(++i<n)map[names[i].toLowerCase()]=i;return map}function parseWeekdayNumber(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.w=+n[0],i+n[0].length):-1}function parseWeekNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.U=+n[0],i+n[0].length):-1}function parseWeekNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.W=+n[0],i+n[0].length):-1}function parseFullYear(d,string,i){var n=numberRe.exec(string.slice(i,i+4));return n?(d.y=+n[0],i+n[0].length):-1}function parseYear(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.y=+n[0]+(+n[0]>68?1900:2e3),i+n[0].length):-1}function parseZone(d,string,i){var n=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(string.slice(i,i+6));return n?(d.Z=n[1]?0:-(n[2]+(n[3]||"00")),i+n[0].length):-1}function parseMonthNumber(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.m=n[0]-1,i+n[0].length):-1}function parseDayOfMonth(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.d=+n[0],i+n[0].length):-1}function parseDayOfYear(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.m=0,d.d=+n[0],i+n[0].length):-1}function parseHour24(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.H=+n[0],i+n[0].length):-1}function parseMinutes(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.M=+n[0],i+n[0].length):-1}function parseSeconds(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.S=+n[0],i+n[0].length):-1}function parseMilliseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.L=+n[0],i+n[0].length):-1}function parseLiteralPercent(d,string,i){var n=percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function formatDayOfMonth(d,p){return pad(d.getDate(),p,2)}function formatHour24(d,p){return pad(d.getHours(),p,2)}function formatHour12(d,p){return pad(d.getHours()%12||12,p,2)}function formatDayOfYear(d,p){return pad(1+__WEBPACK_IMPORTED_MODULE_0_d3_time__["a"].count(Object(__WEBPACK_IMPORTED_MODULE_0_d3_time__["j"])(d),d),p,3)}function formatMilliseconds(d,p){return pad(d.getMilliseconds(),p,3)}function formatMonthNumber(d,p){return pad(d.getMonth()+1,p,2)}function formatMinutes(d,p){return pad(d.getMinutes(),p,2)}function formatSeconds(d,p){return pad(d.getSeconds(),p,2)}function formatWeekNumberSunday(d,p){return pad(__WEBPACK_IMPORTED_MODULE_0_d3_time__["h"].count(Object(__WEBPACK_IMPORTED_MODULE_0_d3_time__["j"])(d),d),p,2)}function formatWeekdayNumber(d){return d.getDay()}function formatWeekNumberMonday(d,p){return pad(__WEBPACK_IMPORTED_MODULE_0_d3_time__["e"].count(Object(__WEBPACK_IMPORTED_MODULE_0_d3_time__["j"])(d),d),p,2)}function formatYear(d,p){return pad(d.getFullYear()%100,p,2)}function formatFullYear(d,p){return pad(d.getFullYear()%1e4,p,4)}function formatZone(d){var z=d.getTimezoneOffset();return(z>0?"-":(z*=-1,"+"))+pad(z/60|0,"0",2)+pad(z%60,"0",2)}function formatUTCDayOfMonth(d,p){return pad(d.getUTCDate(),p,2)}function formatUTCHour24(d,p){return pad(d.getUTCHours(),p,2)}function formatUTCHour12(d,p){return pad(d.getUTCHours()%12||12,p,2)}function formatUTCDayOfYear(d,p){return pad(1+__WEBPACK_IMPORTED_MODULE_0_d3_time__["k"].count(Object(__WEBPACK_IMPORTED_MODULE_0_d3_time__["t"])(d),d),p,3)}function formatUTCMilliseconds(d,p){return pad(d.getUTCMilliseconds(),p,3)}function formatUTCMonthNumber(d,p){return pad(d.getUTCMonth()+1,p,2)}function formatUTCMinutes(d,p){return pad(d.getUTCMinutes(),p,2)}function formatUTCSeconds(d,p){return pad(d.getUTCSeconds(),p,2)}function formatUTCWeekNumberSunday(d,p){return pad(__WEBPACK_IMPORTED_MODULE_0_d3_time__["r"].count(Object(__WEBPACK_IMPORTED_MODULE_0_d3_time__["t"])(d),d),p,2)}function formatUTCWeekdayNumber(d){return d.getUTCDay()}function formatUTCWeekNumberMonday(d,p){return pad(__WEBPACK_IMPORTED_MODULE_0_d3_time__["o"].count(Object(__WEBPACK_IMPORTED_MODULE_0_d3_time__["t"])(d),d),p,2)}function formatUTCYear(d,p){return pad(d.getUTCFullYear()%100,p,2)}function formatUTCFullYear(d,p){return pad(d.getUTCFullYear()%1e4,p,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return isoSpecifier});var __WEBPACK_IMPORTED_MODULE_0__defaultLocale__=__webpack_require__(769);var isoSpecifier="%Y-%m-%dT%H:%M:%S.%LZ";function formatIsoNative(date){return date.toISOString()}var formatIso=Date.prototype.toISOString?formatIsoNative:Object(__WEBPACK_IMPORTED_MODULE_0__defaultLocale__["b"])(isoSpecifier);var _unused_webpack_default_export=formatIso},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var time_1=__webpack_require__(109);var components_1=__webpack_require__(466);var formatter_1=__webpack_require__(186);var base_visualization_1=__webpack_require__(746);var two_dimensional_data_loader_1=__webpack_require__(757);var cell_info_1=__webpack_require__(805);var selection_controller_1=__webpack_require__(918);__webpack_require__(919);var TwoDimensionalBase=function(_super){tslib_1.__extends(TwoDimensionalBase,_super);function TwoDimensionalBase(){var _this=_super.call(this)||this;_this.selectionPadding=0;_this.state={};_this._selectionController=new selection_controller_1.SelectionController(_this);return _this}TwoDimensionalBase.prototype.precalculate=function(props,datasetLoad){var _this=this;if(datasetLoad===void 0){datasetLoad=null}var newState=two_dimensional_data_loader_1.TwoDimensionalDataLoader.precalculate(props,datasetLoad,this.minColor,this.maxColor);newState.selectionInfos=this._selectionController.getSelections(props.essence,datasetLoad,newState.xIndices,newState.yIndices);if(!newState.datasetLoad)newState.datasetLoad=this.state.datasetLoad;this.setState(newState,function(){return _this.calculateSize()})};TwoDimensionalBase.prototype.makeQuery=function(essence,timekeeper){return two_dimensional_data_loader_1.TwoDimensionalDataLoader.makeQuery(essence,timekeeper)};TwoDimensionalBase.prototype.colorize=function(value){var _a=this.state,negativeColorScale=_a.negativeColorScale,positiveColorScale=_a.positiveColorScale;if(value>=-1&&value<=1)return"#ffffff";if(value>1)return String(positiveColorScale(value));return String(negativeColorScale(-value))};TwoDimensionalBase.prototype.componentDidUpdate=function(){var _a=this.state,componentYOffset=_a.componentYOffset,componentXOffset=_a.componentXOffset;var node=ReactDOM.findDOMNode(this._scroller);if(!node)return;var rect=node.getBoundingClientRect();if(componentYOffset!==rect.top||componentXOffset!==rect.left){this.setState({componentYOffset:rect.top,componentXOffset:rect.left})}};TwoDimensionalBase.prototype.componentWillReceiveProps=function(nextProps){_super.prototype.componentWillReceiveProps.call(this,nextProps);var _a=this.state,xIndices=_a.xIndices,yIndices=_a.yIndices,datasetLoad=_a.datasetLoad;if(nextProps.essence&&xIndices&&yIndices){this.setState({selectionInfos:this._selectionController.getSelections(nextProps.essence,datasetLoad,xIndices,yIndices)})}};TwoDimensionalBase.prototype.getLayout=function(){throw new Error("This function should be overriden")};TwoDimensionalBase.prototype.onMouseMove=function(x,y,part){var selectionInfos=this.state.selectionInfos;if(!selectionInfos.isEmpty()||!this.isInteractionAuthorized(part)){this.setState({hoverInfo:null});return}var _a=this.getLayout().getCellPosition({x:x,y:y}),rowIndex=_a.rowIndex,columnIndex=_a.columnIndex;this.setState({hoverInfo:new cell_info_1.CellInfo({x:columnIndex,y:rowIndex})})};TwoDimensionalBase.prototype.onClick=function(x,y,part,event){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var datasetLoad=this.state.datasetLoad;if(!clicker.changeHighlight)return;if(!this.isInteractionAuthorized(part))return;this.setState({hoverInfo:null});var _b=this.getLayout().getCellPosition({x:x,y:y}),rowIndex=_b.rowIndex,columnIndex=_b.columnIndex;var _c=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesDatasets(datasetLoad.dataset),xDataset=_c.xDataset,yDataset=_c.yDataset;var _d=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesFields(essence),xField=_d.xField,yField=_d.yField;var flatDatum={__nest:rowIndex===-1||columnIndex===-1?1:2};if(columnIndex>-1)flatDatum[xField]=xDataset.data[columnIndex].v;if(rowIndex>-1)flatDatum[yField]=yDataset.data[rowIndex].v;this._selectionController.handleSelect(columnIndex,rowIndex,flatDatum,event)};TwoDimensionalBase.prototype.isInteractionAuthorized=function(part){return part===caladan_1.Scroller.BODY};TwoDimensionalBase.prototype.getTimeTickFormatter=function(dimension){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;var axisRange=essence.getSpecificFilter(timekeeper).getExtent(dimension.name);if(!axisRange)return function(value){return time_1.formatTimeRange(value,essence.timezone,time_1.DisplayYear.NEVER)};return function(value){var tick=time_1.formatAxisBasedOnRange(value.midpoint(),axisRange,essence.timezone);return time_1.isBoundaryTick(tick)?tick.boundary+" - "+tick.value:tick}};TwoDimensionalBase.prototype.renderBottomGutter=function(xDataset){return null};TwoDimensionalBase.prototype.renderTopGutter=function(xDataset){return null};TwoDimensionalBase.prototype.renderTopLeftCorner=function(){var _a=this.props,essence=_a.essence,isThumbnail=_a.isThumbnail;var datasetLoad=this.state.datasetLoad;if(isThumbnail)return null;return React.createElement(components_1.VisMeasureLabel,{measure:essence.getEffectiveMeasures()[0],datum:datasetLoad.dataset.data[0]})};TwoDimensionalBase.prototype.renderBodyInternal=function(xDataset,yDataset){var bodyElements;var body=this.renderBody(xDataset,yDataset);if(body){if(Array.isArray(body)){bodyElements=body}else{bodyElements=[React.cloneElement(body,{key:"body"})]}}return bodyElements.concat(this.renderSelectionBorders())};TwoDimensionalBase.prototype.renderBody=function(xDataset,yDataset){return null};TwoDimensionalBase.prototype.renderLeftGutter=function(yDataset){return null};TwoDimensionalBase.prototype.renderSelectionBorders=function(){var _this=this;var _a=this.state,selectionInfos=_a.selectionInfos,scrollTop=_a.scrollTop,scrollLeft=_a.scrollLeft;var layout=this.getLayout();return selectionInfos.simplify().cells.filter(function(s){return!s.isFull()}).map(function(s,i){var left=s.x*layout.columnWidth;var width=s.xSpan*layout.columnWidth;var top=s.y*layout.rowHeight;var height=s.ySpan*layout.rowHeight;if(!_this.isCellVisible(s))return null;var style={position:"absolute",left:left-_this.selectionPadding,top:top-_this.selectionPadding,width:width+_this.selectionPadding*2,height:height+_this.selectionPadding*2};return React.createElement("div",{key:"highlight-"+i,className:"selection-highlight",style:style})})};TwoDimensionalBase.prototype.renderFullSelectionBorders=function(){var _this=this;var _a=this.state,selectionInfos=_a.selectionInfos,scrollTop=_a.scrollTop,scrollLeft=_a.scrollLeft,stage=_a.stage;var layout=this.getLayout();return selectionInfos.simplify().cells.filter(function(s){return s.isFull()}).map(function(s,i){if(!_this.isCellVisible(s))return null;var left=0;var top=0;var height=0;var width=0;if(s.x===-1){top=s.y*layout.rowHeight+layout.top-(scrollTop||0);height=s.ySpan*layout.rowHeight;width=stage.width}else if(s.y===-1){left=s.x*layout.columnWidth+layout.left-(scrollLeft||0);width=s.xSpan*layout.columnWidth;height=stage.height}var style={position:"absolute",left:left-_this.selectionPadding,top:top-_this.selectionPadding,width:width+_this.selectionPadding*2,height:height+_this.selectionPadding*2};return React.createElement("div",{key:"highlight-"+i,className:"selection-highlight",style:style})})};TwoDimensionalBase.prototype.isCellVisible=function(cell){var _a=this.state,stage=_a.stage,scrollLeft=_a.scrollLeft,scrollTop=_a.scrollTop;var layout=this.getLayout();var _b=layout.getAbsolutePosition(cell,-scrollLeft,-scrollTop),left=_b.left,top=_b.top;var height=cell.ySpan*layout.rowHeight;var width=cell.xSpan*layout.columnWidth;if(cell.x!==-1&&(left+width<layout.left||left>stage.width))return false;if(cell.y!==-1&&(top+height<layout.top||top>stage.height))return false;return true};TwoDimensionalBase.prototype.renderHoverBubble=function(hoverInfo){var essence=this.props.essence;var _a=this.state,cells=_a.cells,scrollLeft=_a.scrollLeft,scrollTop=_a.scrollTop,componentXOffset=_a.componentXOffset,componentYOffset=_a.componentYOffset,datasetLoad=_a.datasetLoad,stage=_a.stage;if(!this.isCellVisible(hoverInfo))return null;var layout=this.getLayout();var _b=layout.getAbsolutePosition(hoverInfo,hoverInfo.x>-1?-scrollLeft:0,hoverInfo.y>-1?-scrollTop:0),left=_b.left,top=_b.top;var _c=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesFields(essence),xField=_c.xField,yField=_c.yField;var format=function(v){return formatter_1.formatValue(v,essence.timezone,time_1.DisplayYear.NEVER)};var datum=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getCell(cells,hoverInfo.x,hoverInfo.y);if(!datum)return null;var segmentLabel="";var measureLabel="";if(hoverInfo.x===-1){segmentLabel=format(datum[yField])}else if(hoverInfo.y===-1){segmentLabel=format(datum[xField])}else{segmentLabel=format(datum[yField])+", "+format(datum[xField]);measureLabel=essence.getEffectiveMeasures()[0].formatDatum(datum)}return React.createElement(components_1.SegmentBubble,{top:top+componentYOffset,left:left+componentXOffset+layout.columnWidth*hoverInfo.xSpan/2,segmentLabel:segmentLabel,measureLabel:measureLabel})};TwoDimensionalBase.prototype.renderSelectionBubble=function(){var _this=this;var _a=this.props,essence=_a.essence,clicker=_a.clicker,openRawDataModal=_a.openRawDataModal;var _b=this.state,selectionInfos=_b.selectionInfos,selectionMode=_b.selectionMode;if(selectionInfos.isEmpty())return null;var bubble=this.renderHoverBubble(selectionInfos.getMiddle());if(!bubble)return null;var newProps={dimensions:essence.getSplitDimensions(),clicker:clicker,openRawDataModal:openRawDataModal,toggleSelectionMode:function(){return _this.toggleSelectionMode()},selectionMode:selectionMode,onClose:function(){return _this.setState({selectionInfos:new cell_info_1.CellInfos})}};if(selectionInfos.isMultiple())newProps.segmentLabel=selectionInfos.length+" selections";return React.cloneElement(bubble,newProps)};TwoDimensionalBase.prototype.renderInternals=function(){var _this=this;var _a=this.state,datasetLoad=_a.datasetLoad,stage=_a.stage,hoverInfo=_a.hoverInfo;if(!datasetLoad||datasetLoad.loading)return null;var _b=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesDatasets(datasetLoad.dataset),xDataset=_b.xDataset,yDataset=_b.yDataset;return React.createElement("div",{className:"internals two-dimensional-base"},React.createElement(caladan_1.Scroller,{layout:this.getLayout().toScrollerLayout(stage),ref:function(s){return _this._scroller=s},topGutter:this.renderTopGutter(xDataset),bottomGutter:this.renderBottomGutter(xDataset),topLeftCorner:this.renderTopLeftCorner(),leftGutter:this.renderLeftGutter(yDataset),body:this.renderBodyInternal(xDataset,yDataset),overlay:this.renderFullSelectionBorders(),onScroll:function(top,left){return _this.setState({scrollLeft:left,scrollTop:top})},onClick:function(x,y,part,event){return _this.onClick(x,y,part,event)},onMouseMove:function(x,y,part){return _this.onMouseMove(x,y,part)},onMouseLeave:function(){return _this.setState({hoverInfo:null})}}),this.renderSelectionBubble(),hoverInfo?this.renderHoverBubble(hoverInfo):null)};return TwoDimensionalBase}(base_visualization_1.BaseVisualization);exports.TwoDimensionalBase=TwoDimensionalBase},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var immutable_class_1=__webpack_require__(7);var CellInfo=function(_super){tslib_1.__extends(CellInfo,_super);function CellInfo(parameters){var _this=_super.call(this,parameters)||this;if(isNaN(parameters.measureIndex))_this.measureIndex=0;if(isNaN(parameters.xSpan))_this.xSpan=1;if(isNaN(parameters.ySpan))_this.ySpan=1;return _this}CellInfo.isCellInfo=function(candidate){return candidate instanceof CellInfo};CellInfo.fromJS=function(parameters){return new CellInfo(immutable_class_1.BaseImmutable.jsToValue(CellInfo.PROPERTIES,parameters))};CellInfo.prototype.contains=function(coordinates){var x=coordinates.x,y=coordinates.y,measureIndex=coordinates.measureIndex;if(!isNaN(measureIndex)&&this.measureIndex!==measureIndex)return false;var withinX=x>=this.x&&x<this.x+this.xSpan||this.x===-1;var withinY=y>=this.y&&y<this.y+this.ySpan||this.y===-1;return withinX&&withinY};CellInfo.prototype.isFull=function(){return this.x===-1||this.y===-1};CellInfo.PROPERTIES=[{name:"x"},{name:"y"},{name:"xSpan",defaultValue:1},{name:"ySpan",defaultValue:1},{name:"measureIndex",defaultValue:0}];return CellInfo}(immutable_class_1.BaseImmutable);exports.CellInfo=CellInfo;immutable_class_1.BaseImmutable.finalize(CellInfo);var CellInfos=function(_super){tslib_1.__extends(CellInfos,_super);function CellInfos(parameters){return _super.call(this,parameters||{cells:[]})||this}CellInfos.isCellInfos=function(candidate){return candidate instanceof CellInfos};CellInfos.fromJS=function(parameters){return new CellInfos(immutable_class_1.BaseImmutable.jsToValue(CellInfos.PROPERTIES,parameters))};CellInfos.fromIndices=function(xIndices,yIndices){var cells=[];xIndices.forEach(function(x){return yIndices.forEach(function(y){return cells.push(CellInfo.fromJS({y:y,x:x}))})});return CellInfos.fromJS({cells:cells})};CellInfos.prototype.equals=function(other){return CellInfos.isCellInfos(other)&&immutable_class_1.immutableArraysEqual(this.cells,other.cells)};CellInfos.prototype.simplify=function(){var cells=this.cells;if(cells.length<2)return this;var simplifiedCells=[];cells.sort(function(a,b){if(a.x!==b.x)return a.x-b.x;return a.y-b.y});cells.forEach(function(_a){var y=_a.y,x=_a.x,measureIndex=_a.measureIndex;var foundNeighbour=false;simplifiedCells.forEach(function(s){if(y===s.y-1){s.y--;s.ySpan++;foundNeighbour=true}else if(y===s.y+s.ySpan){s.ySpan++;foundNeighbour=true}else if(x===s.x-1){s.x--;s.xSpan++;foundNeighbour=true}else if(x===s.x+s.xSpan){s.xSpan++;foundNeighbour=true}if(foundNeighbour)return});if(!foundNeighbour)simplifiedCells.push({x:x,xSpan:1,y:y,ySpan:1,measureIndex:measureIndex})});return CellInfos.fromJS({cells:simplifiedCells})};CellInfos.prototype.contains=function(coordinates){return this.cells.some(function(cell){return cell.contains(coordinates)})};CellInfos.prototype.isEmpty=function(){return this.cells.length===0};CellInfos.prototype.hasFullCells=function(){return this.cells.some(function(cell){return cell.isFull()})};CellInfos.prototype.add=function(cellInfo){var value=this.valueOf();value.cells.push(cellInfo);return new CellInfos(value)};CellInfos.prototype.isMultiple=function(){return this.cells.length>1};Object.defineProperty(CellInfos.prototype,"length",{get:function(){return this.cells.length},enumerable:true,configurable:true});CellInfos.prototype.getMiddle=function(){var minRow=Number.POSITIVE_INFINITY;var maxRow=Number.NEGATIVE_INFINITY;var minColumn=Number.POSITIVE_INFINITY;var maxColumn=Number.NEGATIVE_INFINITY;this.cells.forEach(function(s){minRow=Math.min(minRow,s.y);minColumn=Math.min(minColumn,s.x);maxRow=Math.max(maxRow,s.y);maxColumn=Math.max(maxColumn,s.x)});return CellInfo.fromJS({y:minRow,x:minColumn,ySpan:maxRow-minRow+1,measureIndex:this.cells[0].measureIndex,xSpan:maxColumn-minColumn+1})};CellInfos.PROPERTIES=[{name:"cells",immutableClassArray:CellInfo}];return CellInfos}(immutable_class_1.BaseImmutable);exports.CellInfos=CellInfos;immutable_class_1.BaseImmutable.finalize(CellInfos)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);__webpack_require__(807);var ExpiredModal=function(_super){tslib_1.__extends(ExpiredModal,_super);function ExpiredModal(){return _super.call(this)||this}ExpiredModal.prototype.render=function(){return React.createElement(caladan_1.Modal,{className:"expired-modal",title:"Pivot Expired",mandatory:true},React.createElement("div",null,React.createElement("p",null,"Your evaluation license for Pivot has expired. Pivot is available as part of Imply. Please contact Imply (",React.createElement("a",{href:"mailto:sales@imply.io"},"sales@imply.io"),") for subscription information.")))};return ExpiredModal}(React.Component);exports.ExpiredModal=ExpiredModal},function(module,exports,__webpack_require__){var content=__webpack_require__(808);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./expired-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./expired-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".expired-modal p{margin-bottom:14px;line-height:20px}.expired-modal p:last-child{margin-bottom:0}.expired-modal a{color:#1ea3e6;cursor:pointer}.expired-modal a:hover{text-decoration:underline}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var strings_1=__webpack_require__(17);__webpack_require__(810);var WelcomeModal=function(_super){tslib_1.__extends(WelcomeModal,_super);function WelcomeModal(){return _super.call(this)||this}WelcomeModal.prototype.render=function(){var _a=this.props,version=_a.version,onClose=_a.onClose;return React.createElement(caladan_1.Modal,{className:"welcome-modal",title:"Welcome to Pivot!",onClose:onClose},React.createElement("p",null,"You have connected to an evaluation server which will expire in 30 days. If you already have a license, please install it now. To obtain a license, contact ",React.createElement("a",{href:"mailto:sales@imply.io"},"sales@imply.io"),"."),React.createElement("p",null,"We hope you enjoy your trial!"),React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{type:"primary",onClick:onClose,title:strings_1.STRINGS.close})))};return WelcomeModal}(React.Component);exports.WelcomeModal=WelcomeModal},function(module,exports,__webpack_require__){var content=__webpack_require__(811);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./welcome-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./welcome-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".expired-modal p{margin-bottom:14px;line-height:20px}.expired-modal p:last-child{margin-bottom:0}.expired-modal a{color:#1ea3e6;cursor:pointer}.expired-modal a:hover{text-decoration:underline}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(813);var React=__webpack_require__(1);var Darkout=function(_super){tslib_1.__extends(Darkout,_super);function Darkout(){return _super.call(this)||this}Darkout.prototype.render=function(){var stage=this.props.stage;return React.createElement("div",{className:"darkout"},React.createElement("div",{className:"part",style:{top:0,left:0,right:0,height:stage.y}}),React.createElement("div",{className:"part",style:{top:stage.y,height:stage.height,left:0,width:stage.x}}),React.createElement("div",{className:"part",style:{top:stage.y,height:stage.height,left:stage.x+stage.width,right:0}}),React.createElement("div",{className:"part",style:{bottom:0,left:0,right:0,top:stage.y+stage.height}}))};return Darkout}(React.Component);exports.Darkout=Darkout},function(module,exports,__webpack_require__){var content=__webpack_require__(814);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./darkout.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./darkout.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".darkout .part{position:absolute;pointer-events:none;background:black;opacity:0.2}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var build_1=__webpack_require__(8);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var filter_tile_1=__webpack_require__(469);var cube_view_1=__webpack_require__(771);var collection_header_bar_1=__webpack_require__(937);var collection_options_1=__webpack_require__(940);var dashboard_layout_1=__webpack_require__(943);__webpack_require__(955);var CollectionView=function(_super){tslib_1.__extends(CollectionView,_super);function CollectionView(){var _this=_super.call(this)||this;_this.state={scrolled:false,editionMode:"reorganize"};_this.clicker={changeInstance:function(instance){var collectionEssence=_this.props.collectionEssence;_this.props.onEssenceChange(collectionEssence.changeInstance(instance))},changeTimezone:function(timezone){var collectionEssence=_this.props.collectionEssence;_this.props.onEssenceChange(collectionEssence.changeTimezone(timezone))},changeFilter:function(filter){var collectionEssence=_this.props.collectionEssence;_this.props.onEssenceChange(collectionEssence.changeFilter(filter))},changeHighlightFor:function(highlightOwner,highlight){var collectionEssence=_this.props.collectionEssence;_this.props.onEssenceChange(collectionEssence.changeHighlightFor(highlightOwner,highlight))},acceptHighlight:function(){var collectionEssence=_this.props.collectionEssence;_this.props.onEssenceChange(collectionEssence.acceptHighlight())},dropHighlight:function(){var collectionEssence=_this.props.collectionEssence;_this.props.onEssenceChange(collectionEssence.dropHighlight())},invertHighlight:function(){var collectionEssence=_this.props.collectionEssence;if(!collectionEssence.canInvertHighlight())return false;_this.props.onEssenceChange(collectionEssence.invertHighlight());return true},acceptInvertedHighlight:function(){var collectionEssence=_this.props.collectionEssence;if(collectionEssence.canInvertHighlight()){_this.props.onEssenceChange(collectionEssence.invertHighlight().acceptHighlight())}}};return _this}CollectionView.prototype.componentWillMount=function(){var collectionEssence=this.props.collectionEssence;if(!collectionEssence)return;var collection=collectionEssence.actualCollection;if(collection){this.setState({currentCollection:collection})}};CollectionView.prototype.componentDidMount=function(){var _a=this.props,timekeeper=_a.timekeeper,controller=_a.controller,collectionEssence=_a.collectionEssence;var tiles=collectionEssence.actualCollection.tiles.filter(function(t){return!t.isBlank()});if(!tiles.length)return;var dataCube=tiles[0].getDataCube();if(dataCube&&dataCube.refreshNeeded(timekeeper)){setTimeout(function(){return controller.refreshMaxTime(dataCube)},9)}};CollectionView.prototype.componentWillReceiveProps=function(nextProps){var collectionEditController=this.props.collectionEditController;var currentCollection=this.state.currentCollection;var newState={};var hasChanged=false;if(nextProps.collectionEssence&&(!currentCollection||collectionEditController&&!nextProps.collectionEditController)){var collection=nextProps.collectionEssence.actualCollection;newState.currentCollection=collection;hasChanged=true}if(!!nextProps.collectionEditController!==!!collectionEditController){newState.editionMode="reorganize";hasChanged=true}if(hasChanged)this.setState(newState)};CollectionView.prototype.onSuperviseDataCube=function(supervisor){var _this=this;this.setState({cubeViewSupervisor:{title:supervisor.title,essence:supervisor.essence,saveLabel:supervisor.saveLabel,onCancel:function(){_this.setState({cubeViewSupervisor:null});supervisor.onCancel()},onSave:function(newEssence){_this.setState({cubeViewSupervisor:null});supervisor.onSave(newEssence)}}})};CollectionView.prototype.onScroll=function(){var scrolled=this.state.scrolled;var newScrolled=ReactDOM.findDOMNode(this.layout).scrollTop!==0;if(scrolled===newScrolled)return;this.setState({scrolled:newScrolled})};CollectionView.prototype.isDuplicate=function(){var collectionEssence=this.props.collectionEssence;var currentCollection=this.state.currentCollection;return Boolean(currentCollection&&currentCollection.name!==collectionEssence.collection)};CollectionView.prototype.getBackGoer=function(){var _a=this.props,controller=_a.controller,collectionEssence=_a.collectionEssence;var currentCollection=this.state.currentCollection;return{label:"Back to dashboard",fn:function(){return controller.openCollection(currentCollection,collectionEssence)}}};CollectionView.prototype.createTile=function(dataCube){var _this=this;var _a=this.props,collectionEditController=_a.collectionEditController,controller=_a.controller;var currentCollection=this.state.currentCollection;this.onSuperviseDataCube({title:strings_1.STRINGS.addToDashboard,saveLabel:strings_1.STRINGS.add,essence:models_1.Essence.fromDataCube(dataCube,{visualizations:models_1.MANIFESTS}),onCancel:function(){},onSave:function(newEssence){var name=build_1.StringUtils.generateAvailableName({isAvailable:function(name){return!currentCollection.getCollectionTile(name)}});var newCollection=currentCollection.addOrUpdateTile(models_1.CollectionTile.fromEssence(name,newEssence));if(collectionEditController){_this.setState({currentCollection:newCollection})}else{controller.editCollection(newCollection,"update")}}})};CollectionView.prototype.renderHeaderBar=function(){var _this=this;var _a=this.props,controller=_a.controller,collectionEssence=_a.collectionEssence,timekeeper=_a.timekeeper,updatingTimekeeper=_a.updatingTimekeeper,user=_a.user,customization=_a.customization,stateful=_a.stateful,collectionEditController=_a.collectionEditController,dataCubes=_a.dataCubes;var _b=this.state,currentCollection=_b.currentCollection,editionMode=_b.editionMode;var onChange=!!collectionEditController?function(newCollection){return _this.setState({currentCollection:newCollection})}:null;var essence=collectionEssence.getEssence(models_1.MANIFESTS);var moreButton={label:editionMode==="more"?strings_1.STRINGS.arrangeTiles:strings_1.STRINGS.dashboardOptions,onClick:function(){return _this.setState({editionMode:editionMode==="more"?"reorganize":"more"})}};return React.createElement(collection_header_bar_1.CollectionHeaderBar,{controller:controller,clicker:this.clicker,collectionEssence:collectionEssence,timekeeper:timekeeper,user:user,stateful:stateful,onNavClick:controller.openSideDrawer,customization:customization,collection:currentCollection,onCollectionChange:onChange,dataCubes:dataCubes,isDuplicate:this.isDuplicate(),moreButton:moreButton,onNewTile:function(d){return _this.createTile(d)},onRefreshMaxTime:function(){return essence?controller.refreshMaxTime(essence.actualDataCube):null},updatingTimekeeper:updatingTimekeeper,collectionEditController:collectionEditController})};CollectionView.prototype.renderEditionContent=function(){var _this=this;var _a=this.props,collectionEditController=_a.collectionEditController,timekeeper=_a.timekeeper,collectionEssence=_a.collectionEssence,controller=_a.controller,customization=_a.customization,dataCubes=_a.dataCubes,settings=_a.settings,user=_a.user;var _b=this.state,editionMode=_b.editionMode,currentCollection=_b.currentCollection;if(editionMode==="reorganize"){return[React.createElement("div",{className:"filter-tile dummy",key:"filter-tile"},React.createElement("div",{className:"placeholder"},"Common filter")),React.createElement(dashboard_layout_1.DashboardLayout,{key:"layout",ref:function(e){return _this.layout=e},collection:currentCollection,collectionEssence:collectionEssence,timekeeper:timekeeper,clicker:this.clicker,controller:controller,onSuperviseDataCube:function(s){return _this.onSuperviseDataCube(s)},onCollectionChange:function(c){return _this.setState({currentCollection:c})},onScroll:function(){return _this.onScroll()},customization:customization,dataCubes:dataCubes,goBack:this.getBackGoer()})]}return React.createElement(collection_options_1.CollectionOptions,{settings:settings,user:user,customization:customization,applicationController:controller,collection:currentCollection,onChange:function(c){return _this.setState({currentCollection:c})},isDuplicate:collectionEditController.editMode==="duplicate"})};CollectionView.prototype.renderContent=function(){var _this=this;var _a=this.props,collectionEssence=_a.collectionEssence,timekeeper=_a.timekeeper,customization=_a.customization,dataCubes=_a.dataCubes,controller=_a.controller;var currentCollection=this.state.currentCollection;var essence=collectionEssence.getEssence(models_1.MANIFESTS);return[essence?React.createElement(filter_tile_1.FilterTile,{key:"filter-tile",clicker:this.clicker,essence:essence,timekeeper:timekeeper,deltaSourceFilter:currentCollection.getDeltaSourceFilter(),customization:customization}):React.createElement("div",{className:"filter-tile dummy",key:"filter-tile"}),React.createElement(dashboard_layout_1.DashboardLayout,{key:"layout",ref:function(e){return _this.layout=e},collection:currentCollection,collectionEssence:collectionEssence,timekeeper:timekeeper,clicker:this.clicker,controller:controller,onSuperviseDataCube:function(s){return _this.onSuperviseDataCube(s)},onScroll:function(){return _this.onScroll()},customization:customization,dataCubes:dataCubes,goBack:this.getBackGoer()})]};CollectionView.prototype.renderSupervisedCube=function(){var _this=this;var _a=this.props,settings=_a.settings,controller=_a.controller,user=_a.user,timekeeper=_a.timekeeper,updatingTimekeeper=_a.updatingTimekeeper,customization=_a.customization;var cubeViewSupervisor=this.state.cubeViewSupervisor;var onEssenceChange=function(newEssence){cubeViewSupervisor.essence=newEssence;_this.setState({cubeViewSupervisor:cubeViewSupervisor})};return React.createElement(cube_view_1.CubeView,{settings:settings,essence:cubeViewSupervisor.essence,onEssenceChange:onEssenceChange,controller:controller,user:user,timekeeper:timekeeper,updatingTimekeeper:updatingTimekeeper,customization:customization,supervisor:cubeViewSupervisor,stateful:true})};CollectionView.prototype.render=function(){var _this=this;var collectionEditController=this.props.collectionEditController;var _a=this.state,currentCollection=_a.currentCollection,scrolled=_a.scrolled,cubeViewSupervisor=_a.cubeViewSupervisor;if(!currentCollection)return null;if(cubeViewSupervisor)return this.renderSupervisedCube();return React.createElement("div",{ref:function(c){return _this.componentDOM=c},className:classNames("collection-view",{scrolled:scrolled})},this.renderHeaderBar(),collectionEditController?this.renderEditionContent():this.renderContent())};return CollectionView}(React.Component);exports.CollectionView=CollectionView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var chronoshift_1=__webpack_require__(23);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var strings_1=__webpack_require__(17);var general_1=__webpack_require__(43);var components_1=__webpack_require__(466);var download_1=__webpack_require__(471);var formatter_1=__webpack_require__(186);var query_runner_1=__webpack_require__(73);var sizing_1=__webpack_require__(817);__webpack_require__(818);var HEADER_HEIGHT=30;var ROW_HEIGHT=30;var TIME_COL_WIDTH=180;var BOOLEAN_COL_WIDTH=100;var NUMBER_COL_WIDTH=100;var DEFAULT_COL_WIDTH=200;function getColumnWidth(attribute){switch(attribute.type){case"BOOLEAN":return BOOLEAN_COL_WIDTH;case"NUMBER":return NUMBER_COL_WIDTH;case"TIME":return TIME_COL_WIDTH;default:return DEFAULT_COL_WIDTH}}function classFromAttribute(attribute){return classNames(String(attribute.type).toLowerCase().replace(/\//g,"-"),{unsplitable:attribute.getUnsplitable()})}var RawDataModal=function(_super){tslib_1.__extends(RawDataModal,_super);function RawDataModal(){var _this=_super.call(this)||this;_this.state={loading:false,dataset:null,scrollLeft:0,scrollTop:0,error:null,stage:null};_this.globalResizeListener=_this.globalResizeListener.bind(_this);return _this}RawDataModal.prototype.componentDidMount=function(){this.mounted=true;var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;this.fetchData(essence,timekeeper);this.globalResizeListener()};RawDataModal.prototype.componentWillUnmount=function(){this.mounted=false};RawDataModal.prototype.fetchData=function(essence,timekeeper){var _this=this;var customization=this.props.customization;var dataCube=essence.dataCube;var dimensions=essence.getDimensions();var $main=plywood_1.$("main");var query=$main.filter(essence.getSpecificFilterWithHighlight(timekeeper).toExpression(dimensions)).limit(customization.getRawDataLimit());this.setState({loading:true});query_runner_1.QueryRunner.fetch("raw-data-modal",dataCube,essence.instance,query,essence.timezone,true).then(function(dataset){if(!_this.mounted)return;_this.setState({dataset:dataset,loading:false})},function(error){if(error.canceled)return;if(!_this.mounted)return;_this.setState({error:error,loading:false})})};RawDataModal.prototype.globalResizeListener=function(){var table=this.refs.table;var tableDOM=ReactDOM.findDOMNode(table);if(!tableDOM)return;this.setState({stage:beltful_1.Stage.fromClientRect(tableDOM.getBoundingClientRect())})};RawDataModal.prototype.onScroll=function(scrollTop,scrollLeft){this.setState({scrollLeft:scrollLeft,scrollTop:scrollTop})};RawDataModal.prototype.getStringifiedFilters=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;return essence.getSpecificFilterWithHighlight(timekeeper).clauses.map(function(clause,i){var dimension=essence.getDimension(clause.dimension);if(!dimension)return null;var evaluatedClause=dimension.getKind()==="time"?essence.evaluateClause(clause,timekeeper):clause;return formatter_1.formatFilterClause(dimension,evaluatedClause,essence.timezone)})};RawDataModal.prototype.renderFilters=function(){var customization=this.props.customization;var limitLabel="First "+customization.getRawDataLimit()+" events matching";var filters=this.getStringifiedFilters().map(function(filter,i){return React.createElement("li",{className:"filter",key:i},filter)});return[React.createElement("li",{className:"limit",key:"limit"},limitLabel)].concat(filters)};RawDataModal.prototype.renderHeader=function(){var essence=this.props.essence;var dataset=this.state.dataset;if(!dataset)return null;return dataset.attributes.map(function(attribute,i){var name=attribute.name;var width=getColumnWidth(attribute);var style={width:width};var key=name;return React.createElement("div",{className:classNames("header-cell",classFromAttribute(attribute)),style:style,key:i},React.createElement("div",{className:"title-wrap"},general_1.makeTitle(key)))})};RawDataModal.prototype.getVisibleIndices=function(rowCount,height){var scrollTop=this.state.scrollTop;return[Math.max(0,Math.floor(scrollTop/ROW_HEIGHT)),Math.min(rowCount,Math.ceil((scrollTop+height)/ROW_HEIGHT))]};RawDataModal.prototype.renderRows=function(){var _a=this.state,dataset=_a.dataset,scrollLeft=_a.scrollLeft,stage=_a.stage;if(!dataset)return null;var rawData=dataset.data;var attributes=dataset.attributes;var _b=this.getVisibleIndices(rawData.length,stage.height),firstRowToShow=_b[0],lastRowToShow=_b[1];var rows=rawData.slice(firstRowToShow,lastRowToShow);var attributeWidths=attributes.map(getColumnWidth);var _c=sizing_1.getVisibleSegments(attributeWidths,scrollLeft,stage.width),startIndex=_c.startIndex,shownColumns=_c.shownColumns;var leftOffset=general_1.arraySum(attributeWidths.slice(0,startIndex));attributes=attributes.slice(startIndex,startIndex+shownColumns);var rowY=firstRowToShow*ROW_HEIGHT;return rows.map(function(datum,i){var cols=[];attributes.forEach(function(attribute){var name=attribute.name;var value=datum[name];var colStyle={width:getColumnWidth(attribute)};var displayValue=value;if(chronoshift_1.isDate(datum[name])){displayValue=datum[name].toISOString()}cols.push(React.createElement("div",{className:classNames("cell",classFromAttribute(attribute)),key:name,style:colStyle},React.createElement("span",{className:"cell-value"},String(displayValue))))});var rowStyle={top:rowY,left:leftOffset};rowY+=ROW_HEIGHT;return React.createElement("div",{className:"row",style:rowStyle,key:i},cols)})};RawDataModal.prototype.render=function(){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,onClose=_a.onClose;var _b=this.state,dataset=_b.dataset,loading=_b.loading,error=_b.error;var actualDataCube=essence.actualDataCube;var specialTimeDimension=actualDataCube.getSpecialTimeDimensionObject();var filtersString=essence.getSpecificFilterWithHighlight(timekeeper).getFileString(specialTimeDimension?specialTimeDimension.name:null);var scrollerLayout={bodyWidth:dataset?general_1.arraySum(dataset.attributes.map(getColumnWidth)):0,bodyHeight:(dataset?dataset.data.length:0)*ROW_HEIGHT,top:HEADER_HEIGHT,right:0,bottom:0,left:0};return React.createElement(caladan_1.Modal,{className:"raw-data-modal",title:strings_1.STRINGS.segmentRawData,onClose:onClose},React.createElement("div",{className:"content"},React.createElement("ul",{className:"filters"},this.renderFilters()),React.createElement(caladan_1.Scroller,{ref:"table",layout:scrollerLayout,topGutter:this.renderHeader(),body:this.renderRows(),onScroll:this.onScroll.bind(this)}),error?React.createElement(components_1.QueryError,{error:error}):null,loading?React.createElement(caladan_1.Loader,null):null,React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{type:"primary",className:"close",onClick:onClose,title:strings_1.STRINGS.close}),React.createElement(caladan_1.Button,{type:"secondary",className:"download",onClick:function(){return download_1.download(dataset,download_1.makeFileName(actualDataCube.name,filtersString,"raw"),"csv")},title:strings_1.STRINGS.download,disabled:Boolean(loading||error)}))))};return RawDataModal}(React.Component);exports.RawDataModal=RawDataModal},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function getVisibleSegments(segmentWidths,offset,visibleSize){var startIndex=0;var shownColumns=0;var curWidth=0;for(var i=0;i<segmentWidths.length;i++){var segmentWidth=segmentWidths[i];var afterWidth=curWidth+segmentWidth;if(afterWidth<offset){startIndex++}else if(curWidth<offset+visibleSize){shownColumns++}curWidth=afterWidth}return{startIndex:startIndex,shownColumns:shownColumns}}exports.getVisibleSegments=getVisibleSegments},function(module,exports,__webpack_require__){var content=__webpack_require__(819);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./raw-data-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./raw-data-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".raw-data-modal .content{position:absolute;top:60px;bottom:0;left:0;right:0;left:18px;right:18px;overflow:hidden}.raw-data-modal .content .filters{position:absolute;top:0;bottom:0;left:0;right:0;white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;height:30px;color:#999}.raw-data-modal .content .filters .limit,.raw-data-modal .content .filters .filter{font-size:13px;height:30px;display:inline}.raw-data-modal .content .filters .filter:not(:last-child)::after{content:'; '}.raw-data-modal .content .scroller{position:absolute;top:30px;bottom:66px;left:0;right:0;border:1px solid #dedede;cursor:auto}.raw-data-modal .content .scroller .row{height:30px;position:absolute;border-bottom:1px solid #dedede}.raw-data-modal .content .scroller .header-cell,.raw-data-modal .content .scroller .cell{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;display:inline-block;height:100%;border-right:1px solid #dedede;padding-left:6px;padding-right:6px;padding-top:8px}.raw-data-modal .content .scroller .header-cell.unsplitable,.raw-data-modal .content .scroller .cell.unsplitable{background:#f5f5f5}.raw-data-modal .content .scroller .header-cell{background:#f5f5f5;height:30px;border-bottom:1px solid #dedede}.raw-data-modal .content .scroller .header-cell .title-wrap{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;display:inline-block;width:100%;height:100%}.raw-data-modal .content .loader,.raw-data-modal .content .query-error{position:absolute;top:0;bottom:0;left:0;right:0}.raw-data-modal .content .button-bar{position:absolute;left:0;right:0;bottom:18px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var strings_1=__webpack_require__(17);var query_runner_1=__webpack_require__(73);__webpack_require__(821);var MonitorModal=function(_super){tslib_1.__extends(MonitorModal,_super);function MonitorModal(){var _this=_super.call(this)||this;_this.state={};return _this}MonitorModal.prototype.toggleMonitoring=function(){var isMonitoring=!query_runner_1.QueryRunner.getMonitorState();query_runner_1.QueryRunner.setMonitorState(isMonitoring);this.setState({isMonitoring:isMonitoring})};MonitorModal.prototype.render=function(){var _this=this;var onClose=this.props.onClose;var isMonitoring=query_runner_1.QueryRunner.getMonitorState();var queriesElement;if(isMonitoring){var queryText=query_runner_1.QueryRunner.trackedQueries.map(function(_a){var successful=_a.successful,queries=_a.queries,taken=_a.taken;var queriesStr=queries.map(function(q){if(!q.engine||!q.query)return null;if(q.engine==="druidsql"&&typeof q.query.query==="string"){return q.query.query}else{return JSON.stringify(q.query,null,2)}}).filter(Boolean).join("\n\n");var txt=queries.length>1?queries.length+" queries":"1 query";return"--- Group of "+txt+" "+(successful?"executed":"failed")+" in "+taken+"ms ---\n\n"+queriesStr}).join("\n\n\n");queriesElement=React.createElement("textarea",{className:"queries",readOnly:true,value:queryText||"Query monitoring is enabled but no queries have been logged yet."})}else{queriesElement=React.createElement("div",{className:"queries disabled"},React.createElement("span",null,"Query monitoring is disabled, please enable it and make some queries."))}return React.createElement(caladan_1.Modal,{className:"monitor-modal",title:"Monitor queries",onClose:onClose},React.createElement("div",{className:"content"},queriesElement,React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{type:"primary",className:"toggle-monitor",onClick:function(){return _this.toggleMonitoring()},title:isMonitoring?"Disable monitoring":"Enable monitoring"}),React.createElement(caladan_1.Button,{type:"secondary",className:"close",onClick:onClose,title:strings_1.STRINGS.close}))))};return MonitorModal}(React.Component);exports.MonitorModal=MonitorModal},function(module,exports,__webpack_require__){var content=__webpack_require__(822);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./monitor-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./monitor-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".monitor-modal .modal-window{height:100%;width:800px}.monitor-modal .content{position:absolute;top:60px;bottom:0;left:0;right:0;left:18px;right:18px;overflow:hidden}.monitor-modal .content .queries{position:absolute;width:100%;bottom:60px;top:0}.monitor-modal .content textarea{outline:0;resize:none}.monitor-modal .content .disabled{border:1px solid gray;font-size:14px;text-align:center;overflow:hidden}.monitor-modal .content .disabled span{display:inline-block;margin-top:120px}.monitor-modal .content .button-bar{position:absolute;left:0;right:0;bottom:18px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var d3_array_1=__webpack_require__(742);var d3_scale_1=__webpack_require__(753);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var models_1=__webpack_require__(19);var time_1=__webpack_require__(109);var components_1=__webpack_require__(466);var constants_1=__webpack_require__(52);var formatter_1=__webpack_require__(186);var base_visualization_1=__webpack_require__(746);var bar_coordinates_1=__webpack_require__(901);var pad_dataset_load_1=__webpack_require__(902);__webpack_require__(903);var CHART_TOP_PADDING=10;var MIN_CHART_HEIGHT=70;var MAX_STEP_WIDTH=140;var MIN_STEP_WIDTH=20;var BARS_MIN_PAD_LEFT=30;var BARS_MIN_PAD_RIGHT=6;var HOVER_BUBBLE_V_OFFSET=8;var X_AXIS_MIN_HEIGHT=40;var X_AXIS_MAX_HEIGHT=90;var X_AXIS_SIZE_RATIO=.15;var Y_AXIS_MIN_WIDTH=40;var Y_AXIS_MAX_WIDTH=68;var Y_AXIS_SIZE_RATIO=.15;var BarChart=function(_super){tslib_1.__extends(BarChart,_super);function BarChart(){var _this=_super.call(this)||this;_this.coordinatesCache=[];return _this}BarChart.prototype.getDefaultState=function(){var s=_super.prototype.getDefaultState.call(this);s.hoverInfo=null;return s};BarChart.prototype.getBottomPadding=function(){var canShowAxes=this.state.canShowAxes;if(canShowAxes)return 0;return 8};BarChart.prototype.componentDidUpdate=function(){var _a=this.state,scrollerYPosition=_a.scrollerYPosition,scrollerXPosition=_a.scrollerXPosition;var node=ReactDOM.findDOMNode(this.refs["scroller"]);if(!node)return;var rect=node.getBoundingClientRect();if(scrollerYPosition!==rect.top||scrollerXPosition!==rect.left){this.setState({scrollerYPosition:rect.top,scrollerXPosition:rect.left})}};BarChart.prototype.calculateMousePosition=function(x,y){var essence=this.props.essence;x=x-constants_1.VIS_H_PADDING;var measures=essence.getEffectiveMeasures();var chartStage=this.getSingleChartStage();var chartHeight=this.getOuterChartHeight(chartStage);if(y>=chartHeight*measures.length)return null;if(x>=chartStage.width)return null;var xScale=this.getPrimaryXScale();var chartIndex=Math.floor(y/chartHeight);var chartCoordinates=this.getBarsCoordinates(chartIndex,xScale);var _a=this.findBarCoordinatesForX(x,chartCoordinates),indices=_a.indices,coordinates=_a.coordinates;return{datum:this.findFlatDatumForIndices(indices),chartIndex:chartIndex,coordinates:coordinates,indexWithinSplit:indices[indices.length-1]}};BarChart.prototype.findFlatDatumForIndices=function(indices){var essence=this.props.essence;var datasetLoad=this.state.datasetLoad;var splits=essence.getEffectiveSplits();var mySplitDataset=datasetLoad.dataset.data[0][constants_1.SPLIT];var flatDatum={__nest:indices.length};var currentData=mySplitDataset;indices.forEach(function(datumIndex,i){var datum=currentData.data[datumIndex];flatDatum[splits.get(i).dimension]=datum[splits.get(i).dimension];currentData=datum[constants_1.SPLIT]});return flatDatum};BarChart.prototype.findBarCoordinatesForX=function(x,coordinates,currentIndices){if(currentIndices===void 0){currentIndices=[]}for(var i=0;i<coordinates.length;i++){if(coordinates[i].isXWithin(x)){currentIndices.push(i);if(coordinates[i].hasChildren()){return this.findBarCoordinatesForX(x,coordinates[i].children,currentIndices)}else{return{indices:currentIndices,coordinates:coordinates[i]}}}}return{indices:[],coordinates:null}};BarChart.prototype.onScrollerScroll=function(scrollTop,scrollLeft){this.setState({hoverInfo:null,scrollLeft:scrollLeft,scrollTop:scrollTop})};BarChart.prototype.onLimitReached=function(limit){var _a=this.props,essence=_a.essence,clicker=_a.clicker;if(window.toInfinityAndBeyond&&limit===caladan_1.Scroller.RIGHT_LIMIT){var split=essence.getEffectiveSplits().get(0);var limit_1=split.limitAction.value;var newSplit=split.changeLimitAction(plywood_1.Expression._.limit(limit_1+50));clicker.changeSplit(newSplit,models_1.VisStrategy.UnfairGame)}};BarChart.prototype.onMouseMove=function(x,y){this.setState({hoverInfo:this.calculateMousePosition(x,y)})};BarChart.prototype.onMouseLeave=function(){this.setState({hoverInfo:null})};BarChart.prototype.handleMultiSelect=function(selectionInfo){var chartIndex=selectionInfo.chartIndex,datum=selectionInfo.datum;var _a=this.props,essence=_a.essence,clicker=_a.clicker;var splits=essence.getConstrainedSplits();var rowHighlight=base_visualization_1.BaseVisualization.getMultiFilter(splits,essence.highlight.delta,datum);if(!rowHighlight){clicker.dropHighlight()}else{this.setState({selectionInfo:selectionInfo});clicker.changeHighlight(new models_1.Highlight({measure:essence.getEffectiveMeasures()[chartIndex].name,delta:rowHighlight}))}};BarChart.prototype.handleSimpleSelect=function(selectionInfo){var chartIndex=selectionInfo.chartIndex,datum=selectionInfo.datum;var _a=this.props,essence=_a.essence,clicker=_a.clicker;var splits=essence.getConstrainedSplits();var rowHighlight=base_visualization_1.BaseVisualization.getFilterFromDatum(splits,selectionInfo.datum);if(rowHighlight.equals(essence.highlight.delta)){clicker.dropHighlight();this.setState({selectionInfo:null})}else{this.setState({selectionInfo:selectionInfo});clicker.changeHighlight(new models_1.Highlight({measure:essence.getEffectiveMeasures()[chartIndex].name,delta:rowHighlight}))}};BarChart.prototype.handleNewSelect=function(selectionInfo){var chartIndex=selectionInfo.chartIndex,datum=selectionInfo.datum;var _a=this.props,essence=_a.essence,clicker=_a.clicker;var splits=essence.getConstrainedSplits();this.setState({selectionInfo:selectionInfo});clicker.changeHighlight(new models_1.Highlight({measure:essence.getEffectiveMeasures()[chartIndex].name,delta:base_visualization_1.BaseVisualization.getFilterFromDatum(splits,selectionInfo.datum)}))};BarChart.prototype.onClick=function(x,y,part,event){var _a=this.props,essence=_a.essence,clicker=_a.clicker;var measures=essence.getEffectiveMeasures();if(!clicker.changeHighlight||!clicker.dropHighlight)return;var selectionInfo=this.calculateMousePosition(x,y);if(!selectionInfo)return;if(!selectionInfo.coordinates){clicker.dropHighlight();this.setState({selectionInfo:null});return}if(essence.hasHighlight(measures[selectionInfo.chartIndex].name)){if(this.isMultiSelectEvent(event)){this.handleMultiSelect(selectionInfo)}else{this.handleSimpleSelect(selectionInfo)}}else{this.handleNewSelect(selectionInfo)}};BarChart.prototype.getYExtent=function(data,measure){var measureName=measure.name;var getY=function(d){return d[measureName]};return d3_array_1.extent(data,getY)};BarChart.prototype.getYScale=function(measure,yAxisStage){var essence=this.props.essence;var flatData=this.state.flatData;var splits=essence.getConstrainedSplits();var splitLength=splits.length();var leafData=flatData.filter(function(d){return d["__nest"]===splitLength-1});var extentY=this.getYExtent(leafData,measure);return d3_scale_1.scaleLinear().domain([Math.min(extentY[0]*1.1,0),Math.max(extentY[1]*1.1,0)]).range([yAxisStage.height,yAxisStage.y])};BarChart.prototype.hasValidYExtent=function(measure,data){var _a=this.getYExtent(data,measure),yMin=_a[0],yMax=_a[1];return!isNaN(yMin)&&!isNaN(yMax)};BarChart.prototype.getXAxisHeight=function(){if(!this.state.canShowAxes)return 0;var stage=this.state.stage;return Math.min(X_AXIS_MAX_HEIGHT,Math.max(X_AXIS_MIN_HEIGHT,stage.height*X_AXIS_SIZE_RATIO))};BarChart.prototype.getYAxisWidth=function(){if(!this.state.canShowAxes)return 0;var stage=this.state.stage;return Math.min(Y_AXIS_MAX_WIDTH,Math.max(Y_AXIS_MIN_WIDTH,stage.width*Y_AXIS_SIZE_RATIO))};BarChart.prototype.getSingleChartStage=function(){var essence=this.props.essence;var stage=this.state.stage;var xScale=this.getPrimaryXScale();var xTicks=xScale.domain();var width=xTicks.length>0?Math.round(xScale(xTicks[xTicks.length-1]))+xScale.bandwidth():0;var measures=essence.getEffectiveMeasures();var availableHeight=stage.height-this.getXAxisHeight();var height=Math.max(MIN_CHART_HEIGHT,Math.floor(availableHeight/measures.length));return new beltful_1.Stage({x:constants_1.VIS_H_PADDING,y:CHART_TOP_PADDING,width:Math.max(width,stage.width-this.getYAxisWidth()-constants_1.VIS_H_PADDING),height:height-CHART_TOP_PADDING-this.getBottomPadding()})};BarChart.prototype.getOuterChartHeight=function(chartStage){return chartStage.height+CHART_TOP_PADDING+this.getBottomPadding()};BarChart.prototype.getAxisStages=function(chartStage){var _a=this.props,essence=_a.essence,isThumbnail=_a.isThumbnail;var stage=this.state.stage;var xHeight=Math.max(stage.height-(CHART_TOP_PADDING+this.getBottomPadding()+chartStage.height)*essence.getEffectiveMeasures().length,this.getXAxisHeight());return{xAxisStage:new beltful_1.Stage({x:chartStage.x,y:0,height:xHeight,width:chartStage.width}),yAxisStage:new beltful_1.Stage({x:0,y:chartStage.y,height:chartStage.height,width:this.getYAxisWidth()+constants_1.VIS_H_PADDING})}};BarChart.prototype.getScrollerLayout=function(chartStage,xAxisStage,yAxisStage){var _a=this.props,essence=_a.essence,noScroll=_a.noScroll;var stage=this.state.stage;var measures=essence.getEffectiveMeasures();var oneChartHeight=this.getOuterChartHeight(chartStage);return{bodyWidth:noScroll?stage.width-yAxisStage.width:chartStage.width,bodyHeight:noScroll?stage.height-xAxisStage.height:oneChartHeight*measures.length-this.getBottomPadding(),top:0,right:yAxisStage.width,bottom:xAxisStage.height,left:0}};BarChart.prototype.getBubbleLeftOffset=function(x){var _a=this.state,scrollLeft=_a.scrollLeft,scrollerXPosition=_a.scrollerXPosition;return scrollerXPosition+x-scrollLeft+constants_1.VIS_H_PADDING};BarChart.prototype.getBubbleTopOffset=function(y,chartIndex,chartStage){var _a=this.state,scrollTop=_a.scrollTop,scrollerYPosition=_a.scrollerYPosition;var oneChartHeight=this.getOuterChartHeight(chartStage);var chartsAboveMe=oneChartHeight*chartIndex;return chartsAboveMe-scrollTop+scrollerYPosition+y-HOVER_BUBBLE_V_OFFSET+CHART_TOP_PADDING};BarChart.prototype.xTooLeft=function(x){var scrollerXPosition=this.state.scrollerXPosition;return x<=scrollerXPosition};BarChart.prototype.xTooRight=function(x){var _a=this.state,stage=_a.stage,scrollerXPosition=_a.scrollerXPosition;return x>scrollerXPosition+stage.width};BarChart.prototype.yTooHigh=function(y){var scrollerYPosition=this.state.scrollerYPosition;return y<=scrollerYPosition};BarChart.prototype.yTooLow=function(y){var _a=this.state,stage=_a.stage,scrollerYPosition=_a.scrollerYPosition;return y>scrollerYPosition+stage.height-this.getXAxisHeight()};BarChart.prototype.canShowBubble=function(leftOffset,topOffset){return!(this.yTooHigh(topOffset)||this.yTooLow(topOffset)||this.xTooLeft(leftOffset)||this.xTooRight(leftOffset))};BarChart.prototype.onBubbleClose=function(){this.setState({selectionInfo:null})};BarChart.prototype.renderHoverBubble=function(hoverInfo){var essence=this.props.essence;var stage=this.state.stage;var chartStage=this.getSingleChartStage();var datum=hoverInfo.datum,chartIndex=hoverInfo.chartIndex,coordinates=hoverInfo.coordinates;var measure=essence.getEffectiveMeasures()[chartIndex];var leftOffset=this.getBubbleLeftOffset(coordinates.middleX);var topOffset=this.getBubbleTopOffset(coordinates.y,chartIndex,chartStage);if(!this.canShowBubble(leftOffset,topOffset))return null;return React.createElement(components_1.SegmentBubble,{top:topOffset,left:leftOffset,segmentLabel:this.labelizeInfos([hoverInfo]),measureLabel:measure.formatDatum(datum)})};BarChart.prototype.isSelected=function(datum,measure){var essence=this.props.essence;var splits=essence.getConstrainedSplits();if(essence.hasHighlight(measure.name)){return base_visualization_1.BaseVisualization.isDatumSelected(essence.highlight.delta,splits,datum)}return false};BarChart.prototype.isFaded=function(){var essence=this.props.essence;return essence.hasHighlight()};BarChart.prototype.hasAnySelectionGoingOn=function(){return this.props.essence.hasHighlight()};BarChart.prototype.isHovered=function(datum,chartIndex){var essence=this.props.essence;var hoverInfo=this.state.hoverInfo;var splits=essence.getConstrainedSplits();if(this.hasAnySelectionGoingOn())return false;if(!hoverInfo)return false;if(!hoverInfo.datum)return false;if(hoverInfo.chartIndex!==chartIndex)return false;var hoverFilter=base_visualization_1.BaseVisualization.getFilterFromDatum(splits,hoverInfo.datum);var potentialFilter=base_visualization_1.BaseVisualization.getFilterFromDatum(splits,datum);return hoverFilter&&potentialFilter&&potentialFilter.equals(hoverFilter)};BarChart.prototype.renderBars=function(data,measure,chartIndex,chartStage,xAxisStage,coordinates,splitIndex,path){var _this=this;if(splitIndex===void 0){splitIndex=0}if(path===void 0){path=[]}var essence=this.props.essence;var bars=[];var selectedBars=[];var splits=essence.getConstrainedSplits();var dimension=splits.get(splitIndex).dimension;var splitLength=splits.length();data.forEach(function(d,i){var segmentValue=d[dimension];var subPath=path.concat(d);var bar;var bubble=null;var subCoordinates=coordinates[i];if(splitIndex<splitLength-1){var subRender=_this.renderBars(d[constants_1.SPLIT].data,measure,chartIndex,chartStage,xAxisStage,subCoordinates.children,splitIndex+1,subPath);bar=subRender.bars;selectedBars=selectedBars.concat(subRender.selectedBars)}else{var flatDatum=base_visualization_1.BaseVisualization.flatDatumForPath(essence.getEffectiveSplits(),subPath);flatDatum[measure.name]=d[measure.name];var bubbleInfo={chartIndex:chartIndex,datum:flatDatum,indexWithinSplit:i,coordinates:subCoordinates};var isHovered=_this.isHovered(flatDatum,chartIndex);if(isHovered){bubble=_this.renderHoverBubble(bubbleInfo)}var selected=_this.isSelected(flatDatum,measure);var faded=_this.isFaded();if(selected)selectedBars.push(bubbleInfo);bar=React.createElement("g",{className:classNames("bar",{selected:selected,"not-selected":!selected&&faded,isHovered:isHovered}),key:String(segmentValue),transform:"translate("+Math.round(subCoordinates.x)+", 0)"},subCoordinates.renderBar("background"),bubble)}bars.push(bar)});return{bars:bars,selectedBars:selectedBars}};BarChart.prototype.renderTimeXAxisTicks=function(data,coordinates,xAxisStage){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;var splits=essence.getConstrainedSplits();var split=splits.get(0);var dimension=split.dimension;var axisRange=essence.getSpecificFilter(timekeeper).getExtent(dimension);var labelize=function(value){var tick=time_1.formatAxisBasedOnRange(value.midpoint(),axisRange,essence.timezone);return time_1.isBoundaryTick(tick)?tick.boundary:tick};return data.map(function(d,i){var segmentValueStr=labelize(d[dimension]);var coordinate=coordinates[i];return React.createElement("div",{className:"slanty-label continuous",key:i,style:{right:xAxisStage.width-coordinate.middleX}},segmentValueStr)})};BarChart.prototype.renderContinuousXAxisTicks=function(data,coordinates,xAxisStage){var essence=this.props.essence;var splits=essence.getConstrainedSplits();var split=splits.get(0);var dimension=split.dimension;var labels=[];var lastIndex=data.length-1;var ascending=split.sortAction.direction===plywood_1.SortExpression.ASCENDING;var leftThing=ascending?"start":"end";var rightThing=ascending?"end":"start";data.forEach(function(d,i){var segmentValue=d[dimension];var segmentValueStr=String(plywood_1.Range.isRange(segmentValue)?segmentValue[leftThing]:"");var coordinate=coordinates[i];labels.push(React.createElement("div",{className:"slanty-label continuous",key:i,style:{right:xAxisStage.width-coordinate.x}},segmentValueStr));if(i===lastIndex){segmentValueStr=String(plywood_1.Range.isRange(segmentValue)?segmentValue[rightThing]:"");labels.push(React.createElement("div",{className:"slanty-label continuous",key:"last-one",style:{right:xAxisStage.width-(coordinate.x+coordinate.width)}},segmentValueStr))}});return labels};BarChart.prototype.renderXAxis=function(data,coordinates,xAxisStage){var essence=this.props.essence;var canShowAxes=this.state.canShowAxes;var xScale=this.getPrimaryXScale();var xTicks=xScale.domain();if(!canShowAxes)return null;var splits=essence.getConstrainedSplits();var split=splits.get(0);var dimension=split.dimension;var labels=[];if(split.isBucketed()){labels=essence.getDimension(dimension).isTime()?this.renderTimeXAxisTicks(data,coordinates,xAxisStage):this.renderContinuousXAxisTicks(data,coordinates,xAxisStage)}else{data.forEach(function(d,i){var segmentValueStr=String(d[dimension]);var coordinate=coordinates[i];labels.push(React.createElement("div",{className:"slanty-label categorical",key:segmentValueStr,style:{right:xAxisStage.width-coordinate.middleX}},segmentValueStr))})}return React.createElement("div",{className:"x-axis",style:{width:xAxisStage.width}},React.createElement("svg",{style:xAxisStage.getWidthHeight(),viewBox:xAxisStage.getViewBox()},React.createElement(components_1.BucketMarks,{stage:xAxisStage,ticks:xTicks,scale:xScale})),labels)};BarChart.prototype.getYAxisStuff=function(dataset,measure,chartStage,chartIndex){var canShowAxes=this.state.canShowAxes;var yAxisStage=this.getAxisStages(chartStage).yAxisStage;var yScale=this.getYScale(measure,yAxisStage);var yTicks=yScale.ticks(chartStage.height<200?3:5);var yGridLines=React.createElement(components_1.GridLines,{orientation:"horizontal",scale:yScale,ticks:yTicks,stage:chartStage});var axisStage=yAxisStage.changeY(yAxisStage.y+(chartStage.height+CHART_TOP_PADDING+this.getBottomPadding())*chartIndex);var yAxis=canShowAxes?React.createElement(components_1.VerticalAxis,{key:measure.name,stage:axisStage,ticks:yTicks,scale:yScale,measure:measure,hideZero:true}):null;return{yGridLines:yGridLines,yAxis:yAxis,yScale:yScale}};BarChart.prototype.isChartVisible=function(chartIndex,xAxisStage){var _a=this.state,stage=_a.stage,scrollTop=_a.scrollTop;var chartStage=this.getSingleChartStage();var chartHeight=this.getOuterChartHeight(chartStage);var topY=chartIndex*chartHeight;var viewPortHeight=stage.height-xAxisStage.height;var hiddenAtBottom=topY-scrollTop>=viewPortHeight;var bottomY=topY+chartHeight;var hiddenAtTop=bottomY<scrollTop;return!hiddenAtTop&&!hiddenAtBottom};BarChart.prototype.renderChart=function(dataset,coordinates,measures,chartIndex,chartStage,getX){var isThumbnail=this.props.isThumbnail;var measure=measures[chartIndex];var mySplitDataset=dataset.data[0][constants_1.SPLIT];var measureLabel=isThumbnail?measures.length>1?React.createElement("div",{className:"vis-measure-label"},measure.title):null:React.createElement(components_1.VisMeasureLabel,{measure:measure,datum:dataset.data[0]});if(!this.hasValidYExtent(measure,mySplitDataset.data)){return{chart:React.createElement("div",{className:"measure-bar-chart",key:measure.name,style:{width:chartStage.width}},React.createElement("svg",{style:chartStage.getWidthHeight(0,this.getBottomPadding()),viewBox:chartStage.getViewBox(0,this.getBottomPadding())}),measureLabel),yAxis:null,selectedBars:[]}}var xAxisStage=this.getAxisStages(chartStage).xAxisStage;var _a=this.getYAxisStuff(mySplitDataset,measure,chartStage,chartIndex),yAxis=_a.yAxis,yGridLines=_a.yGridLines;var bars;var selectedBars=[];if(this.isChartVisible(chartIndex,xAxisStage)){var renderedChart=this.renderBars(mySplitDataset.data,measure,chartIndex,chartStage,xAxisStage,coordinates);bars=renderedChart.bars;selectedBars=selectedBars.concat(renderedChart.selectedBars)}var chart=React.createElement("div",{className:"measure-bar-chart",key:measure.name,style:{width:chartStage.width}},React.createElement("svg",{style:chartStage.getWidthHeight(0,this.getBottomPadding()),viewBox:chartStage.getViewBox(0,this.getBottomPadding())},yGridLines,React.createElement("g",{className:"bars",transform:chartStage.getTransform()},bars)),measureLabel);return{chart:chart,yAxis:yAxis,selectedBars:selectedBars}};BarChart.prototype.precalculate=function(props,datasetLoad){if(datasetLoad===void 0){datasetLoad=null}var registerDownloadableDataset=props.registerDownloadableDataset,essence=props.essence;var splits=essence.getConstrainedSplits();var dimension=essence.getDimension(splits.get(0).dimension);var dimensionKind=dimension.getKind();var measures=essence.getEffectiveMeasures();this.coordinatesCache=[];var existingDatasetLoad=this.state.datasetLoad;var newState={};if(datasetLoad){if(dimensionKind==="number"){datasetLoad=pad_dataset_load_1.padDatasetLoad(datasetLoad,dimension,measures)}if(datasetLoad.loading)datasetLoad.dataset=existingDatasetLoad.dataset;newState.datasetLoad=datasetLoad}else{var stateDatasetLoad=this.state.datasetLoad;if(dimensionKind==="number"){datasetLoad=pad_dataset_load_1.padDatasetLoad(stateDatasetLoad,dimension,measures)}else{datasetLoad=stateDatasetLoad}}var dataset=datasetLoad.dataset;if(dataset&&splits.length()){var firstSplitDataSet=dataset.data[0][constants_1.SPLIT];if(registerDownloadableDataset)registerDownloadableDataset(dataset);var flatData=firstSplitDataSet.flatten({order:"preorder",nestingName:"__nest"}).data;var maxima=splits.toArray().map(function(){return 0});this.maxNumberOfLeaves(firstSplitDataSet.data,maxima,0);newState.maxNumberOfLeaves=maxima;newState.flatData=flatData}this.setState(newState)};BarChart.prototype.maxNumberOfLeaves=function(data,maxima,level){maxima[level]=Math.max(maxima[level],data.length);if(data[0]&&data[0][constants_1.SPLIT]!==undefined){var n=data.length;for(var i=0;i<n;i++){this.maxNumberOfLeaves(data[i][constants_1.SPLIT].data,maxima,level+1)}}};BarChart.prototype.getPrimaryXScale=function(){var _a=this.state,datasetLoad=_a.datasetLoad,maxNumberOfLeaves=_a.maxNumberOfLeaves;var data=datasetLoad.dataset.data[0][constants_1.SPLIT].data;var essence=this.props.essence;var splits=essence.getConstrainedSplits();var dimension=splits.get(0).dimension;var getX=function(d){return d[dimension]};var _b=this.getXValues(maxNumberOfLeaves),usedWidth=_b.usedWidth,padLeft=_b.padLeft;return d3_scale_1.scaleBand().domain(data.map(getX)).range([padLeft,padLeft+usedWidth])};BarChart.prototype.getXValues=function(maxNumberOfLeaves){var essence=this.props.essence;var stage=this.state.stage;var overallWidth=stage.width-constants_1.VIS_H_PADDING*2-this.getYAxisWidth();var numPrimarySteps=maxNumberOfLeaves[0];var minStepWidth=MIN_STEP_WIDTH*maxNumberOfLeaves.slice(1).reduce(function(a,b){return a*b},1);var maxAvailableWidth=overallWidth-BARS_MIN_PAD_LEFT-BARS_MIN_PAD_RIGHT;var stepWidth;if(minStepWidth*numPrimarySteps<maxAvailableWidth){stepWidth=Math.max(Math.min(maxAvailableWidth/numPrimarySteps,MAX_STEP_WIDTH*essence.getConstrainedSplits().length()),MIN_STEP_WIDTH)}else{stepWidth=minStepWidth}var usedWidth=stepWidth*maxNumberOfLeaves[0];var padLeft=Math.max(BARS_MIN_PAD_LEFT,(overallWidth-usedWidth)/2);return{padLeft:padLeft,usedWidth:usedWidth}};BarChart.prototype.onResize=function(){this.coordinatesCache=[]};BarChart.prototype.getBarsCoordinates=function(chartIndex,xScale){if(!!this.coordinatesCache[chartIndex]){return this.coordinatesCache[chartIndex]}var essence=this.props.essence;var datasetLoad=this.state.datasetLoad;var splits=essence.getConstrainedSplits();var measure=essence.getEffectiveMeasures()[chartIndex];var dataset=datasetLoad.dataset.data[0][constants_1.SPLIT];var dimension=splits.get(0).dimension;var chartStage=this.getSingleChartStage();var yScale=this.getYAxisStuff(dataset,measure,chartStage,chartIndex).yScale;this.coordinatesCache[chartIndex]=this.getSubCoordinates(dataset.data,measure,chartStage,function(d){return d[dimension]},xScale,yScale);return this.coordinatesCache[chartIndex]};BarChart.prototype.getSubCoordinates=function(data,measure,chartStage,getX,xScale,scaleY,splitIndex){var _this=this;if(splitIndex===void 0){splitIndex=1}var essence=this.props.essence;var maxNumberOfLeaves=this.state.maxNumberOfLeaves;var splits=essence.getConstrainedSplits();var coordinates=data.map(function(d,i){var x=xScale(getX(d,i));var y=scaleY(d[measure.name]);var h=scaleY(0)-y;var children=[];var coordinate=new bar_coordinates_1.BarCoordinates({x:x,y:h>=0?y:scaleY(0),height:Math.round(Math.abs(h)),width:xScale.bandwidth(),children:children});if(splitIndex<splits.length()){var subDataset=d[constants_1.SPLIT];if(subDataset instanceof plywood_1.Dataset){var subData=subDataset.data;var subStage=new beltful_1.Stage({x:x,y:chartStage.y,width:coordinate.barWidth,height:chartStage.height});var subGetX=function(d,i){return String(i)};var subxScale=d3_scale_1.scaleBand().domain(d3_array_1.range(0,maxNumberOfLeaves[splitIndex]).map(String)).range([x+coordinate.barOffset,x+subStage.width]);coordinate.children=_this.getSubCoordinates(subData,measure,subStage,subGetX,subxScale,scaleY,splitIndex+1)}}return coordinate});return coordinates};BarChart.prototype.renderRightGutter=function(measures,yAxisStage,yAxes){var yAxesStage=yAxisStage.changeHeight((yAxisStage.height+CHART_TOP_PADDING+this.getBottomPadding())*measures.length);return React.createElement("svg",{style:yAxesStage.getWidthHeight(),viewBox:yAxesStage.getViewBox()},yAxes)};BarChart.prototype.labelizeInfos=function(selections){if(selections.length>1)return selections.length+" selections";var essence=this.props.essence;var timezone=essence.timezone;var splits=essence.getConstrainedSplits();var info=selections[0];var dimension=splits.get(info.datum["__nest"]-1).dimension;var segmentValue=info.datum[dimension];return formatter_1.formatValue(segmentValue,timezone,time_1.DisplayYear.NEVER)};BarChart.prototype.renderSelectionBubble=function(selections){var _this=this;var _a=this.props,essence=_a.essence,clicker=_a.clicker,openRawDataModal=_a.openRawDataModal;var selectionMode=this.state.selectionMode;if(!selections||!selections.length)return null;var chartStage=this.getSingleChartStage();var _b=selections[0],datum=_b.datum,chartIndex=_b.chartIndex;var coordinates=selections.map(function(s){return s.coordinates}).reduce(bar_coordinates_1.BarCoordinates.reduce);var splitDimensions=essence.getSplitDimensions();var measure=essence.getEffectiveMeasures()[chartIndex];var leftOffset=this.getBubbleLeftOffset(coordinates.middleX);var topOffset=this.getBubbleTopOffset(coordinates.y,chartIndex,chartStage);if(!this.canShowBubble(leftOffset,topOffset)){return null}return React.createElement(components_1.SegmentBubble,{left:leftOffset,top:topOffset,dimensions:splitDimensions,segmentLabel:this.labelizeInfos(selections),measureLabel:selections.length===1?measure.formatDatum(datum):null,clicker:clicker,openRawDataModal:openRawDataModal,onClose:this.onBubbleClose.bind(this),toggleSelectionMode:function(){return _this.toggleSelectionMode()},selectionMode:selectionMode})};BarChart.prototype.renderOverlay=function(selections){var _this=this;if(!selections||!selections.length)return null;var chartStage=this.getSingleChartStage();var chartIndex=selections[0].chartIndex;var coordinates=[];var last;selections.forEach(function(s){if(last&&last.indexWithinSplit+1===s.indexWithinSplit){coordinates[coordinates.length-1]=coordinates[coordinates.length-1].merge(s.coordinates)}else{coordinates.push(s.coordinates)}last=s});var highlights=coordinates.map(function(coordinate,i){return coordinate.renderHighlight(chartStage.x,chartStage.y+_this.getOuterChartHeight(chartStage)*chartIndex,"selection-highlight",""+i)});return React.createElement("div",{className:"selection-highlight-container",key:chartIndex},highlights)};BarChart.prototype.renderInternals=function(){var _this=this;var _a=this.props,essence=_a.essence,noScroll=_a.noScroll;var _b=this.state,stage=_b.stage,datasetLoad=_b.datasetLoad;var splits=essence.getConstrainedSplits();var dimension=splits.get(0).dimension;var scrollerLayout;var measureCharts=[];var xAxis;var rightGutter;var overlay;var selections=[];if(datasetLoad.dataset&&splits.length()){var xScale_1=this.getPrimaryXScale();var yAxes_1=[];var measures_1=essence.getEffectiveMeasures();var getX_1=function(d){return d[dimension]};var chartStage_1=this.getSingleChartStage();var _c=this.getAxisStages(chartStage_1),xAxisStage=_c.xAxisStage,yAxisStage=_c.yAxisStage;xAxis=this.renderXAxis(datasetLoad.dataset.data[0][constants_1.SPLIT].data,this.getBarsCoordinates(0,xScale_1),xAxisStage);measures_1.forEach(function(measure,chartIndex){var coordinates=_this.getBarsCoordinates(chartIndex,xScale_1);var _a=_this.renderChart(datasetLoad.dataset,coordinates,measures_1,chartIndex,chartStage_1,getX_1),yAxis=_a.yAxis,chart=_a.chart,selectedBars=_a.selectedBars;measureCharts.push(chart);yAxes_1.push(yAxis);selections=selections.concat(selectedBars)});scrollerLayout=this.getScrollerLayout(chartStage_1,xAxisStage,yAxisStage);rightGutter=this.renderRightGutter(measures_1,chartStage_1,yAxes_1);measureCharts.push(this.renderOverlay(selections))}return React.createElement("div",{className:classNames("internals measure-bar-charts",{"no-scroll":noScroll}),style:{maxHeight:stage.height}},React.createElement(caladan_1.Scroller,{layout:scrollerLayout,ref:"scroller",bottomGutter:xAxis,rightGutter:rightGutter,bottomRightCorner:React.createElement("div",null),body:measureCharts,onMouseMove:this.onMouseMove.bind(this),onMouseLeave:this.onMouseLeave.bind(this),onClick:this.onClick.bind(this),onScroll:this.onScrollerScroll.bind(this),onLimitReached:this.onLimitReached.bind(this)}),this.renderSelectionBubble(selections))};BarChart.visName=models_1.BAR_CHART_MANIFEST.name;return BarChart}(base_visualization_1.BaseVisualization);exports.BarChart=BarChart},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__pairs__=__webpack_require__(774);__webpack_exports__["a"]=function(values0,values1,reduce){var n0=values0.length,n1=values1.length,values=new Array(n0*n1),i0,i1,i,value0;if(reduce==null)reduce=__WEBPACK_IMPORTED_MODULE_0__pairs__["b"];for(i0=i=0;i0<n0;++i0){for(value0=values0[i0],i1=0;i1<n1;++i1,++i){values[i]=reduce(value0,values1[i1])}}return values}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__array__=__webpack_require__(778);var __WEBPACK_IMPORTED_MODULE_1__bisect__=__webpack_require__(772);var __WEBPACK_IMPORTED_MODULE_2__constant__=__webpack_require__(827);var __WEBPACK_IMPORTED_MODULE_3__extent__=__webpack_require__(777);var __WEBPACK_IMPORTED_MODULE_4__identity__=__webpack_require__(828);var __WEBPACK_IMPORTED_MODULE_5__range__=__webpack_require__(779);var __WEBPACK_IMPORTED_MODULE_6__ticks__=__webpack_require__(780);var __WEBPACK_IMPORTED_MODULE_7__threshold_sturges__=__webpack_require__(781);__webpack_exports__["a"]=function(){var value=__WEBPACK_IMPORTED_MODULE_4__identity__["a"],domain=__WEBPACK_IMPORTED_MODULE_3__extent__["a"],threshold=__WEBPACK_IMPORTED_MODULE_7__threshold_sturges__["a"];function histogram(data){var i,n=data.length,x,values=new Array(n);for(i=0;i<n;++i){values[i]=value(data[i],i,data)}var xz=domain(values),x0=xz[0],x1=xz[1],tz=threshold(values,x0,x1);if(!Array.isArray(tz)){tz=Object(__WEBPACK_IMPORTED_MODULE_6__ticks__["c"])(x0,x1,tz);tz=Object(__WEBPACK_IMPORTED_MODULE_5__range__["a"])(Math.ceil(x0/tz)*tz,Math.floor(x1/tz)*tz,tz)}var m=tz.length;while(tz[0]<=x0)tz.shift(),--m;while(tz[m-1]>x1)tz.pop(),--m;var bins=new Array(m+1),bin;for(i=0;i<=m;++i){bin=bins[i]=[];bin.x0=i>0?tz[i-1]:x0;bin.x1=i<m?tz[i]:x1}for(i=0;i<n;++i){x=values[i];if(x0<=x&&x<=x1){bins[Object(__WEBPACK_IMPORTED_MODULE_1__bisect__["c"])(tz,x,0,m)].push(data[i])}}return bins}histogram.value=function(_){return arguments.length?(value=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_2__constant__["a"])(_),histogram):value};histogram.domain=function(_){return arguments.length?(domain=typeof _==="function"?_:Object(__WEBPACK_IMPORTED_MODULE_2__constant__["a"])([_[0],_[1]]),histogram):domain};histogram.thresholds=function(_){return arguments.length?(threshold=typeof _==="function"?_:Array.isArray(_)?Object(__WEBPACK_IMPORTED_MODULE_2__constant__["a"])(__WEBPACK_IMPORTED_MODULE_0__array__["b"].call(_)):Object(__WEBPACK_IMPORTED_MODULE_2__constant__["a"])(_),histogram):threshold};return histogram}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x){return function(){return x}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x){return x}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__array__=__webpack_require__(778);var __WEBPACK_IMPORTED_MODULE_1__ascending__=__webpack_require__(747);var __WEBPACK_IMPORTED_MODULE_2__number__=__webpack_require__(748);var __WEBPACK_IMPORTED_MODULE_3__quantile__=__webpack_require__(760);__webpack_exports__["a"]=function(values,min,max){values=__WEBPACK_IMPORTED_MODULE_0__array__["a"].call(values,__WEBPACK_IMPORTED_MODULE_2__number__["a"]).sort(__WEBPACK_IMPORTED_MODULE_1__ascending__["a"]);return Math.ceil((max-min)/(2*(Object(__WEBPACK_IMPORTED_MODULE_3__quantile__["a"])(values,.75)-Object(__WEBPACK_IMPORTED_MODULE_3__quantile__["a"])(values,.25))*Math.pow(values.length,-1/3)))}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__deviation__=__webpack_require__(775);__webpack_exports__["a"]=function(values,min,max){return Math.ceil((max-min)/(3.5*Object(__WEBPACK_IMPORTED_MODULE_0__deviation__["a"])(values)*Math.pow(values.length,-1/3)))}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(values,valueof){var n=values.length,i=-1,value,max;if(valueof==null){while(++i<n){if((value=values[i])!=null&&value>=value){max=value;while(++i<n){if((value=values[i])!=null&&value>max){max=value}}}}}else{while(++i<n){if((value=valueof(values[i],i,values))!=null&&value>=value){max=value;while(++i<n){if((value=valueof(values[i],i,values))!=null&&value>max){max=value}}}}}return max}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__number__=__webpack_require__(748);__webpack_exports__["a"]=function(values,valueof){var n=values.length,m=n,i=-1,value,sum=0;if(valueof==null){while(++i<n){if(!isNaN(value=Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(values[i])))sum+=value;else--m}}else{while(++i<n){if(!isNaN(value=Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(valueof(values[i],i,values))))sum+=value;else--m}}if(m)return sum/m}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__ascending__=__webpack_require__(747);var __WEBPACK_IMPORTED_MODULE_1__number__=__webpack_require__(748);var __WEBPACK_IMPORTED_MODULE_2__quantile__=__webpack_require__(760);__webpack_exports__["a"]=function(values,valueof){var n=values.length,i=-1,value,numbers=[];if(valueof==null){while(++i<n){if(!isNaN(value=Object(__WEBPACK_IMPORTED_MODULE_1__number__["a"])(values[i]))){numbers.push(value)}}}else{while(++i<n){if(!isNaN(value=Object(__WEBPACK_IMPORTED_MODULE_1__number__["a"])(valueof(values[i],i,values)))){numbers.push(value)}}}return Object(__WEBPACK_IMPORTED_MODULE_2__quantile__["a"])(numbers.sort(__WEBPACK_IMPORTED_MODULE_0__ascending__["a"]),.5)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(arrays){var n=arrays.length,m,i=-1,j=0,merged,array;while(++i<n)j+=arrays[i].length;merged=new Array(j);while(--n>=0){array=arrays[n];m=array.length;while(--m>=0){merged[--j]=array[m]}}return merged}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(array,indexes){var i=indexes.length,permutes=new Array(i);while(i--)permutes[i]=array[indexes[i]];return permutes}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__ascending__=__webpack_require__(747);__webpack_exports__["a"]=function(values,compare){if(!(n=values.length))return;var n,i=0,j=0,xi,xj=values[j];if(compare==null)compare=__WEBPACK_IMPORTED_MODULE_0__ascending__["a"];while(++i<n){if(compare(xi=values[i],xj)<0||compare(xj,xj)!==0){xj=xi,j=i}}if(compare(xj,xj)===0)return j}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(array,i0,i1){var m=(i1==null?array.length:i1)-(i0=i0==null?0:+i0),t,i;while(m){i=Math.random()*m--|0;t=array[m+i0];array[m+i0]=array[i+i0];array[i+i0]=t}return array}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(values,valueof){var n=values.length,i=-1,value,sum=0;if(valueof==null){while(++i<n){if(value=+values[i])sum+=value}}else{while(++i<n){if(value=+valueof(values[i],i,values))sum+=value}}return sum}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__transpose__=__webpack_require__(783);__webpack_exports__["a"]=function(){return Object(__WEBPACK_IMPORTED_MODULE_0__transpose__["a"])(arguments)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=band;__webpack_exports__["b"]=point;var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1__ordinal__=__webpack_require__(784);function band(){var scale=Object(__WEBPACK_IMPORTED_MODULE_1__ordinal__["a"])().unknown(undefined),domain=scale.domain,ordinalRange=scale.range,range=[0,1],step,bandwidth,round=false,paddingInner=0,paddingOuter=0,align=.5;delete scale.unknown;function rescale(){var n=domain().length,reverse=range[1]<range[0],start=range[reverse-0],stop=range[1-reverse];step=(stop-start)/Math.max(1,n-paddingInner+paddingOuter*2);if(round)step=Math.floor(step);start+=(stop-start-step*(n-paddingInner))*align;bandwidth=step*(1-paddingInner);if(round)start=Math.round(start),bandwidth=Math.round(bandwidth);var values=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["range"])(n).map(function(i){return start+step*i});return ordinalRange(reverse?values.reverse():values)}scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()};scale.range=function(_){return arguments.length?(range=[+_[0],+_[1]],rescale()):range.slice()};scale.rangeRound=function(_){return range=[+_[0],+_[1]],round=true,rescale()};scale.bandwidth=function(){return bandwidth};scale.step=function(){return step};scale.round=function(_){return arguments.length?(round=!!_,rescale()):round};scale.padding=function(_){return arguments.length?(paddingInner=paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingInner};scale.paddingInner=function(_){return arguments.length?(paddingInner=Math.max(0,Math.min(1,_)),rescale()):paddingInner};scale.paddingOuter=function(_){return arguments.length?(paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingOuter};scale.align=function(_){return arguments.length?(align=Math.max(0,Math.min(1,_)),rescale()):align};scale.copy=function(){return band().domain(domain()).range(range).round(round).paddingInner(paddingInner).paddingOuter(paddingOuter).align(align)};return rescale()}function pointish(scale){var copy=scale.copy;scale.padding=scale.paddingOuter;delete scale.paddingInner;delete scale.paddingOuter;scale.copy=function(){return pointish(copy())};return scale}function point(){return pointish(band().paddingInner(1))}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__src_nest__=__webpack_require__(842);var __WEBPACK_IMPORTED_MODULE_1__src_set__=__webpack_require__(843);var __WEBPACK_IMPORTED_MODULE_2__src_map__=__webpack_require__(761);__webpack_require__.d(__webpack_exports__,"a",function(){return __WEBPACK_IMPORTED_MODULE_2__src_map__["a"]});var __WEBPACK_IMPORTED_MODULE_3__src_keys__=__webpack_require__(844);var __WEBPACK_IMPORTED_MODULE_4__src_values__=__webpack_require__(845);var __WEBPACK_IMPORTED_MODULE_5__src_entries__=__webpack_require__(846)},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__map__=__webpack_require__(761);var _unused_webpack_default_export=function(){var keys=[],sortKeys=[],sortValues,rollup,nest;function apply(array,depth,createResult,setResult){if(depth>=keys.length){if(sortValues!=null)array.sort(sortValues);return rollup!=null?rollup(array):array}var i=-1,n=array.length,key=keys[depth++],keyValue,value,valuesByKey=Object(__WEBPACK_IMPORTED_MODULE_0__map__["a"])(),values,result=createResult();while(++i<n){if(values=valuesByKey.get(keyValue=key(value=array[i])+"")){values.push(value)}else{valuesByKey.set(keyValue,[value])}}valuesByKey.each(function(values,key){setResult(result,key,apply(values,depth,createResult,setResult))});return result}function entries(map,depth){if(++depth>keys.length)return map;var array,sortKey=sortKeys[depth-1];if(rollup!=null&&depth>=keys.length)array=map.entries();else array=[],map.each(function(v,k){array.push({key:k,values:entries(v,depth)})});return sortKey!=null?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}return nest={object:function(array){return apply(array,0,createObject,setObject)},map:function(array){return apply(array,0,createMap,setMap)},entries:function(array){return entries(apply(array,0,createMap,setMap),0)},key:function(d){keys.push(d);return nest},sortKeys:function(order){sortKeys[keys.length-1]=order;return nest},sortValues:function(order){sortValues=order;return nest},rollup:function(f){rollup=f;return nest}}};function createObject(){return{}}function setObject(object,key,value){object[key]=value}function createMap(){return Object(__WEBPACK_IMPORTED_MODULE_0__map__["a"])()}function setMap(map,key,value){map.set(key,value)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__map__=__webpack_require__(761);function Set(){}var proto=__WEBPACK_IMPORTED_MODULE_0__map__["a"].prototype;Set.prototype=set.prototype={constructor:Set,has:proto.has,add:function(value){value+="";this[__WEBPACK_IMPORTED_MODULE_0__map__["b"]+value]=value;return this},remove:proto.remove,clear:proto.clear,values:proto.keys,size:proto.size,empty:proto.empty,each:proto.each};function set(object,f){var set=new Set;if(object instanceof Set)object.each(function(value){set.add(value)});else if(object){var i=-1,n=object.length;if(f==null)while(++i<n)set.add(object[i]);else while(++i<n)set.add(f(object[i],i,object))}return set}var _unused_webpack_default_export=set},function(module,__webpack_exports__,__webpack_require__){"use strict";var _unused_webpack_default_export=function(map){var keys=[];for(var key in map)keys.push(key);return keys}},function(module,__webpack_exports__,__webpack_require__){"use strict";var _unused_webpack_default_export=function(map){var values=[];for(var key in map)values.push(map[key]);return values}},function(module,__webpack_exports__,__webpack_require__){"use strict";var _unused_webpack_default_export=function(map){var entries=[];for(var key in map)entries.push({key:key,value:map[key]});return entries}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=identity;var __WEBPACK_IMPORTED_MODULE_0__array__=__webpack_require__(745);var __WEBPACK_IMPORTED_MODULE_1__linear__=__webpack_require__(749);var __WEBPACK_IMPORTED_MODULE_2__number__=__webpack_require__(793);function identity(){var domain=[0,1];function scale(x){return+x}scale.invert=scale;scale.domain=scale.range=function(_){return arguments.length?(domain=__WEBPACK_IMPORTED_MODULE_0__array__["a"].call(_,__WEBPACK_IMPORTED_MODULE_2__number__["a"]),scale):domain.slice()};scale.copy=function(){return identity().domain(domain)};return Object(__WEBPACK_IMPORTED_MODULE_1__linear__["b"])(scale)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=lab;__webpack_exports__["b"]=hcl;var __WEBPACK_IMPORTED_MODULE_0__define__=__webpack_require__(764);var __WEBPACK_IMPORTED_MODULE_1__color__=__webpack_require__(763);var __WEBPACK_IMPORTED_MODULE_2__math__=__webpack_require__(785);var Kn=18,Xn=.95047,Yn=1,Zn=1.08883,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1;function labConvert(o){if(o instanceof Lab)return new Lab(o.l,o.a,o.b,o.opacity);if(o instanceof Hcl){var h=o.h*__WEBPACK_IMPORTED_MODULE_2__math__["a"];return new Lab(o.l,Math.cos(h)*o.c,Math.sin(h)*o.c,o.opacity)}if(!(o instanceof __WEBPACK_IMPORTED_MODULE_1__color__["b"]))o=Object(__WEBPACK_IMPORTED_MODULE_1__color__["h"])(o);var b=rgb2xyz(o.r),a=rgb2xyz(o.g),l=rgb2xyz(o.b),x=xyz2lab((.4124564*b+.3575761*a+.1804375*l)/Xn),y=xyz2lab((.2126729*b+.7151522*a+.072175*l)/Yn),z=xyz2lab((.0193339*b+.119192*a+.9503041*l)/Zn);return new Lab(116*y-16,500*(x-y),200*(y-z),o.opacity)}function lab(l,a,b,opacity){return arguments.length===1?labConvert(l):new Lab(l,a,b,opacity==null?1:opacity)}function Lab(l,a,b,opacity){this.l=+l;this.a=+a;this.b=+b;this.opacity=+opacity}Object(__WEBPACK_IMPORTED_MODULE_0__define__["a"])(Lab,lab,Object(__WEBPACK_IMPORTED_MODULE_0__define__["b"])(__WEBPACK_IMPORTED_MODULE_1__color__["a"],{brighter:function(k){return new Lab(this.l+Kn*(k==null?1:k),this.a,this.b,this.opacity)},darker:function(k){return new Lab(this.l-Kn*(k==null?1:k),this.a,this.b,this.opacity)},rgb:function(){var y=(this.l+16)/116,x=isNaN(this.a)?y:y+this.a/500,z=isNaN(this.b)?y:y-this.b/200;y=Yn*lab2xyz(y);x=Xn*lab2xyz(x);z=Zn*lab2xyz(z);return new __WEBPACK_IMPORTED_MODULE_1__color__["b"](xyz2rgb(3.2404542*x-1.5371385*y-.4985314*z),xyz2rgb(-.969266*x+1.8760108*y+.041556*z),xyz2rgb(.0556434*x-.2040259*y+1.0572252*z),this.opacity)}}));function xyz2lab(t){return t>t3?Math.pow(t,1/3):t/t2+t0}function lab2xyz(t){return t>t1?t*t*t:t2*(t-t0)}function xyz2rgb(x){return 255*(x<=.0031308?12.92*x:1.055*Math.pow(x,1/2.4)-.055)}function rgb2xyz(x){return(x/=255)<=.04045?x/12.92:Math.pow((x+.055)/1.055,2.4)}function hclConvert(o){if(o instanceof Hcl)return new Hcl(o.h,o.c,o.l,o.opacity);if(!(o instanceof Lab))o=labConvert(o);var h=Math.atan2(o.b,o.a)*__WEBPACK_IMPORTED_MODULE_2__math__["b"];return new Hcl(h<0?h+360:h,Math.sqrt(o.a*o.a+o.b*o.b),o.l,o.opacity)}function hcl(h,c,l,opacity){return arguments.length===1?hclConvert(h):new Hcl(h,c,l,opacity==null?1:opacity)}function Hcl(h,c,l,opacity){this.h=+h;this.c=+c;this.l=+l;this.opacity=+opacity}Object(__WEBPACK_IMPORTED_MODULE_0__define__["a"])(Hcl,hcl,Object(__WEBPACK_IMPORTED_MODULE_0__define__["b"])(__WEBPACK_IMPORTED_MODULE_1__color__["a"],{brighter:function(k){return new Hcl(this.h,this.c,this.l+Kn*(k==null?1:k),this.opacity)},darker:function(k){return new Hcl(this.h,this.c,this.l-Kn*(k==null?1:k),this.opacity)},rgb:function(){return labConvert(this).rgb()}}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=cubehelix;var __WEBPACK_IMPORTED_MODULE_0__define__=__webpack_require__(764);var __WEBPACK_IMPORTED_MODULE_1__color__=__webpack_require__(763);var __WEBPACK_IMPORTED_MODULE_2__math__=__webpack_require__(785);var A=-.14861,B=+1.78277,C=-.29227,D=-.90649,E=+1.97294,ED=E*D,EB=E*B,BC_DA=B*C-D*A;function cubehelixConvert(o){if(o instanceof Cubehelix)return new Cubehelix(o.h,o.s,o.l,o.opacity);if(!(o instanceof __WEBPACK_IMPORTED_MODULE_1__color__["b"]))o=Object(__WEBPACK_IMPORTED_MODULE_1__color__["h"])(o);var r=o.r/255,g=o.g/255,b=o.b/255,l=(BC_DA*b+ED*r-EB*g)/(BC_DA+ED-EB),bl=b-l,k=(E*(g-l)-C*bl)/D,s=Math.sqrt(k*k+bl*bl)/(E*l*(1-l)),h=s?Math.atan2(k,bl)*__WEBPACK_IMPORTED_MODULE_2__math__["b"]-120:NaN;return new Cubehelix(h<0?h+360:h,s,l,o.opacity)}function cubehelix(h,s,l,opacity){return arguments.length===1?cubehelixConvert(h):new Cubehelix(h,s,l,opacity==null?1:opacity)}function Cubehelix(h,s,l,opacity){this.h=+h;this.s=+s;this.l=+l;this.opacity=+opacity}Object(__WEBPACK_IMPORTED_MODULE_0__define__["a"])(Cubehelix,cubehelix,Object(__WEBPACK_IMPORTED_MODULE_0__define__["b"])(__WEBPACK_IMPORTED_MODULE_1__color__["a"],{brighter:function(k){k=k==null?__WEBPACK_IMPORTED_MODULE_1__color__["c"]:Math.pow(__WEBPACK_IMPORTED_MODULE_1__color__["c"],k);return new Cubehelix(this.h,this.s,this.l*k,this.opacity)},darker:function(k){k=k==null?__WEBPACK_IMPORTED_MODULE_1__color__["d"]:Math.pow(__WEBPACK_IMPORTED_MODULE_1__color__["d"],k);return new Cubehelix(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=isNaN(this.h)?0:(this.h+120)*__WEBPACK_IMPORTED_MODULE_2__math__["a"],l=+this.l,a=isNaN(this.s)?0:this.s*l*(1-l),cosh=Math.cos(h),sinh=Math.sin(h);return new __WEBPACK_IMPORTED_MODULE_1__color__["b"](255*(l+a*(A*cosh+B*sinh)),255*(l+a*(C*cosh+D*sinh)),255*(l+a*(E*cosh)),this.opacity)}}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(a,b){return a=+a,b-=a,function(t){return Math.round(a+b*t)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__number__=__webpack_require__(754);var __WEBPACK_IMPORTED_MODULE_1__parse__=__webpack_require__(852);function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}function translate(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(xa,xb)},{i:i-2,x:Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(ya,yb)})}else if(xb||yb){s.push("translate("+xb+pxComma+yb+pxParen)}}function rotate(a,b,s,q){if(a!==b){if(a-b>180)b+=360;else if(b-a>180)a+=360;q.push({i:s.push(pop(s)+"rotate(",null,degParen)-2,x:Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(a,b)})}else if(b){s.push(pop(s)+"rotate("+b+degParen)}}function skewX(a,b,s,q){if(a!==b){q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(a,b)})}else if(b){s.push(pop(s)+"skewX("+b+degParen)}}function scale(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(xa,xb)},{i:i-2,x:Object(__WEBPACK_IMPORTED_MODULE_0__number__["a"])(ya,yb)})}else if(xb!==1||yb!==1){s.push(pop(s)+"scale("+xb+","+yb+")")}}return function(a,b){var s=[],q=[];a=parse(a),b=parse(b);translate(a.translateX,a.translateY,b.translateX,b.translateY,s,q);rotate(a.rotate,b.rotate,s,q);skewX(a.skewX,b.skewX,s,q);scale(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q);a=b=null;return function(t){var i=-1,n=q.length,o;while(++i<n)s[(o=q[i]).i]=o.x(t);return s.join("")}}}var interpolateTransformCss=interpolateTransform(__WEBPACK_IMPORTED_MODULE_1__parse__["a"],"px, ","px)","deg)");var interpolateTransformSvg=interpolateTransform(__WEBPACK_IMPORTED_MODULE_1__parse__["b"],", ",")",")")},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=parseCss;__webpack_exports__["b"]=parseSvg;var __WEBPACK_IMPORTED_MODULE_0__decompose__=__webpack_require__(853);var cssNode,cssRoot,cssView,svgNode;function parseCss(value){if(value==="none")return __WEBPACK_IMPORTED_MODULE_0__decompose__["b"];if(!cssNode)cssNode=document.createElement("DIV"),cssRoot=document.documentElement,cssView=document.defaultView;cssNode.style.transform=value;value=cssView.getComputedStyle(cssRoot.appendChild(cssNode),null).getPropertyValue("transform");cssRoot.removeChild(cssNode);value=value.slice(7,-1).split(",");return Object(__WEBPACK_IMPORTED_MODULE_0__decompose__["a"])(+value[0],+value[1],+value[2],+value[3],+value[4],+value[5])}function parseSvg(value){if(value==null)return __WEBPACK_IMPORTED_MODULE_0__decompose__["b"];if(!svgNode)svgNode=document.createElementNS("http://www.w3.org/2000/svg","g");svgNode.setAttribute("transform",value);if(!(value=svgNode.transform.baseVal.consolidate()))return __WEBPACK_IMPORTED_MODULE_0__decompose__["b"];value=value.matrix;return Object(__WEBPACK_IMPORTED_MODULE_0__decompose__["a"])(value.a,value.b,value.c,value.d,value.e,value.f)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return identity});var degrees=180/Math.PI;var identity={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};__webpack_exports__["a"]=function(a,b,c,d,e,f){var scaleX,scaleY,skewX;if(scaleX=Math.sqrt(a*a+b*b))a/=scaleX,b/=scaleX;if(skewX=a*c+b*d)c-=a*skewX,d-=b*skewX;if(scaleY=Math.sqrt(c*c+d*d))c/=scaleY,d/=scaleY,skewX/=scaleY;if(a*d<b*c)a=-a,b=-b,skewX=-skewX,scaleX=-scaleX;return{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX:scaleX,scaleY:scaleY}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var rho=Math.SQRT2,rho2=2,rho4=4,epsilon2=1e-12;function cosh(x){return((x=Math.exp(x))+1/x)/2}function sinh(x){return((x=Math.exp(x))-1/x)/2}function tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}var _unused_webpack_default_export=function(p0,p1){var ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy,i,S;if(d2<epsilon2){S=Math.log(w1/w0)/rho;i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(rho*t*S)]}}else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+rho4*d2)/(2*w0*rho2*d1),b1=(w1*w1-w0*w0-rho4*d2)/(2*w1*rho2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/rho;i=function(t){var s=t*S,coshr0=cosh(r0),u=w0/(rho2*d1)*(coshr0*tanh(rho*s+r0)-sinh(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/cosh(rho*s+r0)]}}i.duration=S*1e3;return i}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_color__=__webpack_require__(744);var __WEBPACK_IMPORTED_MODULE_1__color__=__webpack_require__(751);function hsl(hue){return function(start,end){var h=hue((start=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["d"])(start)).h,(end=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["d"])(end)).h),s=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.s,end.s),l=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.l,end.l),opacity=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.opacity,end.opacity);return function(t){start.h=h(t);start.s=s(t);start.l=l(t);start.opacity=opacity(t);return start+""}}}var _unused_webpack_default_export=hsl(__WEBPACK_IMPORTED_MODULE_1__color__["c"]);var hslLong=hsl(__WEBPACK_IMPORTED_MODULE_1__color__["a"])},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_color__=__webpack_require__(744);var __WEBPACK_IMPORTED_MODULE_1__color__=__webpack_require__(751);function lab(start,end){var l=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])((start=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["e"])(start)).l,(end=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["e"])(end)).l),a=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.a,end.a),b=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.b,end.b),opacity=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.opacity,end.opacity);return function(t){start.l=l(t);start.a=a(t);start.b=b(t);start.opacity=opacity(t);return start+""}}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_color__=__webpack_require__(744);var __WEBPACK_IMPORTED_MODULE_1__color__=__webpack_require__(751);function hcl(hue){return function(start,end){var h=hue((start=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["c"])(start)).h,(end=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["c"])(end)).h),c=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.c,end.c),l=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.l,end.l),opacity=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.opacity,end.opacity);return function(t){start.h=h(t);start.c=c(t);start.l=l(t);start.opacity=opacity(t);return start+""}}}var _unused_webpack_default_export=hcl(__WEBPACK_IMPORTED_MODULE_1__color__["c"]);var hclLong=hcl(__WEBPACK_IMPORTED_MODULE_1__color__["a"])},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return cubehelixLong});var __WEBPACK_IMPORTED_MODULE_0_d3_color__=__webpack_require__(744);var __WEBPACK_IMPORTED_MODULE_1__color__=__webpack_require__(751);function cubehelix(hue){return function cubehelixGamma(y){y=+y;function cubehelix(start,end){var h=hue((start=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])(start)).h,(end=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])(end)).h),s=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.s,end.s),l=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.l,end.l),opacity=Object(__WEBPACK_IMPORTED_MODULE_1__color__["a"])(start.opacity,end.opacity);return function(t){start.h=h(t);start.s=s(t);start.l=l(Math.pow(t,y));start.opacity=opacity(t);return start+""}}cubehelix.gamma=cubehelixGamma;return cubehelix}(1)}var _unused_webpack_default_export=cubehelix(__WEBPACK_IMPORTED_MODULE_1__color__["c"]);var cubehelixLong=cubehelix(__WEBPACK_IMPORTED_MODULE_1__color__["a"])},function(module,__webpack_exports__,__webpack_require__){"use strict";var _unused_webpack_default_export=function(interpolator,n){var samples=new Array(n);for(var i=0;i<n;++i)samples[i]=interpolator(i/(n-1));return samples}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1_d3_format__=__webpack_require__(794);__webpack_exports__["a"]=function(domain,count,specifier){var start=domain[0],stop=domain[domain.length-1],step=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["tickStep"])(start,stop,count==null?10:count),precision;specifier=Object(__WEBPACK_IMPORTED_MODULE_1_d3_format__["c"])(specifier==null?",f":specifier);switch(specifier.type){case"s":{var value=Math.max(Math.abs(start),Math.abs(stop));if(specifier.precision==null&&!isNaN(precision=Object(__WEBPACK_IMPORTED_MODULE_1_d3_format__["e"])(step,value)))specifier.precision=precision;return Object(__WEBPACK_IMPORTED_MODULE_1_d3_format__["b"])(specifier,value)}case"":case"e":case"g":case"p":case"r":{if(specifier.precision==null&&!isNaN(precision=Object(__WEBPACK_IMPORTED_MODULE_1_d3_format__["f"])(step,Math.max(Math.abs(start),Math.abs(stop)))))specifier.precision=precision-(specifier.type==="e");break}case"f":case"%":{if(specifier.precision==null&&!isNaN(precision=Object(__WEBPACK_IMPORTED_MODULE_1_d3_format__["d"])(step)))specifier.precision=precision-(specifier.type==="%")*2;break}}return Object(__WEBPACK_IMPORTED_MODULE_1_d3_format__["a"])(specifier)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return format});__webpack_require__.d(__webpack_exports__,"b",function(){return formatPrefix});var __WEBPACK_IMPORTED_MODULE_0__locale__=__webpack_require__(795);var locale;var format;var formatPrefix;defaultLocale({decimal:".",thousands:",",grouping:[3],currency:["$",""]});function defaultLocale(definition){locale=Object(__WEBPACK_IMPORTED_MODULE_0__locale__["a"])(definition);format=locale.format;formatPrefix=locale.formatPrefix;return locale}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(grouping,thousands){return function(value,width){var i=value.length,t=[],j=0,g=grouping[0],length=0;while(i>0&&g>0){if(length+g+1>width)g=Math.max(1,width-length);t.push(value.substring(i-=g,i+g));if((length+=g+1)>width)break;g=grouping[j=(j+1)%grouping.length]}return t.reverse().join(thousands)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(numerals){return function(value){return value.replace(/[0-9]/g,function(i){return numerals[+i]})}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x,p){x=x.toPrecision(p);out:for(var n=x.length,i=1,i0=-1,i1;i<n;++i){switch(x[i]){case".":i0=i1=i;break;case"0":if(i0===0)i0=i;i1=i;break;case"e":break out;default:if(i0>0)i0=0;break}}return i0>0?x.slice(0,i0)+x.slice(i1+1):x}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__formatDecimal__=__webpack_require__(767);__webpack_exports__["a"]=function(x,p){var d=Object(__WEBPACK_IMPORTED_MODULE_0__formatDecimal__["a"])(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1];return exponent<0?"0."+new Array(-exponent).join("0")+coefficient:coefficient.length>exponent+1?coefficient.slice(0,exponent+1)+"."+coefficient.slice(exponent+1):coefficient+new Array(exponent-coefficient.length+2).join("0")}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=function(x){return x}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__exponent__=__webpack_require__(756);__webpack_exports__["a"]=function(step){return Math.max(0,-Object(__WEBPACK_IMPORTED_MODULE_0__exponent__["a"])(Math.abs(step)))}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__exponent__=__webpack_require__(756);__webpack_exports__["a"]=function(step,value){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Object(__WEBPACK_IMPORTED_MODULE_0__exponent__["a"])(value)/3)))*3-Object(__WEBPACK_IMPORTED_MODULE_0__exponent__["a"])(Math.abs(step)))}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__exponent__=__webpack_require__(756);__webpack_exports__["a"]=function(step,max){step=Math.abs(step),max=Math.abs(max)-step;return Math.max(0,Object(__WEBPACK_IMPORTED_MODULE_0__exponent__["a"])(max)-Object(__WEBPACK_IMPORTED_MODULE_0__exponent__["a"])(step))+1}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=log;var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1_d3_format__=__webpack_require__(794);var __WEBPACK_IMPORTED_MODULE_2__constant__=__webpack_require__(766);var __WEBPACK_IMPORTED_MODULE_3__nice__=__webpack_require__(799);var __WEBPACK_IMPORTED_MODULE_4__continuous__=__webpack_require__(755);function deinterpolate(a,b){return(b=Math.log(b/a))?function(x){return Math.log(x/a)/b}:Object(__WEBPACK_IMPORTED_MODULE_2__constant__["a"])(b)}function reinterpolate(a,b){return a<0?function(t){return-Math.pow(-b,t)*Math.pow(-a,1-t)}:function(t){return Math.pow(b,t)*Math.pow(a,1-t)}}function pow10(x){return isFinite(x)?+("1e"+x):x<0?0:x}function powp(base){return base===10?pow10:base===Math.E?Math.exp:function(x){return Math.pow(base,x)}}function logp(base){return base===Math.E?Math.log:base===10&&Math.log10||base===2&&Math.log2||(base=Math.log(base),function(x){return Math.log(x)/base})}function reflect(f){return function(x){return-f(-x)}}function log(){var scale=Object(__WEBPACK_IMPORTED_MODULE_4__continuous__["b"])(deinterpolate,reinterpolate).domain([1,10]),domain=scale.domain,base=10,logs=logp(10),pows=powp(10);function rescale(){logs=logp(base),pows=powp(base);if(domain()[0]<0)logs=reflect(logs),pows=reflect(pows);return scale}scale.base=function(_){return arguments.length?(base=+_,rescale()):base};scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()};scale.ticks=function(count){var d=domain(),u=d[0],v=d[d.length-1],r;if(r=v<u)i=u,u=v,v=i;var i=logs(u),j=logs(v),p,k,t,n=count==null?10:+count,z=[];if(!(base%1)&&j-i<n){i=Math.round(i)-1,j=Math.round(j)+1;if(u>0)for(;i<j;++i){for(k=1,p=pows(i);k<base;++k){t=p*k;if(t<u)continue;if(t>v)break;z.push(t)}}else for(;i<j;++i){for(k=base-1,p=pows(i);k>=1;--k){t=p*k;if(t<u)continue;if(t>v)break;z.push(t)}}}else{z=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["ticks"])(i,j,Math.min(j-i,n)).map(pows)}return r?z.reverse():z};scale.tickFormat=function(count,specifier){if(specifier==null)specifier=base===10?".0e":",";if(typeof specifier!=="function")specifier=Object(__WEBPACK_IMPORTED_MODULE_1_d3_format__["a"])(specifier);if(count===Infinity)return specifier;if(count==null)count=10;var k=Math.max(1,base*count/scale.ticks().length);return function(d){var i=d/pows(Math.round(logs(d)));if(i*base<base-.5)i*=base;return i<=k?specifier(d):""}};scale.nice=function(){return domain(Object(__WEBPACK_IMPORTED_MODULE_3__nice__["a"])(domain(),{floor:function(x){return pows(Math.floor(logs(x)))},ceil:function(x){return pows(Math.ceil(logs(x)))}}))};scale.copy=function(){return Object(__WEBPACK_IMPORTED_MODULE_4__continuous__["a"])(scale,log().base(base))};return scale}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=pow;__webpack_exports__["b"]=sqrt;var __WEBPACK_IMPORTED_MODULE_0__constant__=__webpack_require__(766);var __WEBPACK_IMPORTED_MODULE_1__linear__=__webpack_require__(749);var __WEBPACK_IMPORTED_MODULE_2__continuous__=__webpack_require__(755);function raise(x,exponent){return x<0?-Math.pow(-x,exponent):Math.pow(x,exponent)}function pow(){var exponent=1,scale=Object(__WEBPACK_IMPORTED_MODULE_2__continuous__["b"])(deinterpolate,reinterpolate),domain=scale.domain;function deinterpolate(a,b){return(b=raise(b,exponent)-(a=raise(a,exponent)))?function(x){return(raise(x,exponent)-a)/b}:Object(__WEBPACK_IMPORTED_MODULE_0__constant__["a"])(b)}function reinterpolate(a,b){b=raise(b,exponent)-(a=raise(a,exponent));return function(t){return raise(a+b*t,1/exponent)}}scale.exponent=function(_){return arguments.length?(exponent=+_,domain(domain())):exponent};scale.copy=function(){return Object(__WEBPACK_IMPORTED_MODULE_2__continuous__["a"])(scale,pow().exponent(exponent))};return Object(__WEBPACK_IMPORTED_MODULE_1__linear__["b"])(scale)}function sqrt(){return pow().exponent(.5)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=quantile;var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1__array__=__webpack_require__(745);function quantile(){var domain=[],range=[],thresholds=[];function rescale(){var i=0,n=Math.max(1,range.length);thresholds=new Array(n-1);while(++i<n)thresholds[i-1]=Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["quantile"])(domain,i/n);return scale}function scale(x){if(!isNaN(x=+x))return range[Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["bisect"])(thresholds,x)]}scale.invertExtent=function(y){var i=range.indexOf(y);return i<0?[NaN,NaN]:[i>0?thresholds[i-1]:domain[0],i<thresholds.length?thresholds[i]:domain[domain.length-1]]};scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[];for(var i=0,n=_.length,d;i<n;++i)if(d=_[i],d!=null&&!isNaN(d=+d))domain.push(d);domain.sort(__WEBPACK_IMPORTED_MODULE_0_d3_array__["ascending"]);return rescale()};scale.range=function(_){return arguments.length?(range=__WEBPACK_IMPORTED_MODULE_1__array__["b"].call(_),rescale()):range.slice()};scale.quantiles=function(){return thresholds.slice()};scale.copy=function(){return quantile().domain(domain).range(range)};return scale}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=quantize;var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1__array__=__webpack_require__(745);var __WEBPACK_IMPORTED_MODULE_2__linear__=__webpack_require__(749);function quantize(){var x0=0,x1=1,n=1,domain=[.5],range=[0,1];function scale(x){if(x<=x)return range[Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["bisect"])(domain,x,0,n)]}function rescale(){var i=-1;domain=new Array(n);while(++i<n)domain[i]=((i+1)*x1-(i-n)*x0)/(n+1);return scale}scale.domain=function(_){return arguments.length?(x0=+_[0],x1=+_[1],rescale()):[x0,x1]};scale.range=function(_){return arguments.length?(n=(range=__WEBPACK_IMPORTED_MODULE_1__array__["b"].call(_)).length-1,rescale()):range.slice()};scale.invertExtent=function(y){var i=range.indexOf(y);return i<0?[NaN,NaN]:i<1?[x0,domain[0]]:i>=n?[domain[n-1],x1]:[domain[i-1],domain[i]]};scale.copy=function(){return quantize().domain([x0,x1]).range(range)};return Object(__WEBPACK_IMPORTED_MODULE_2__linear__["b"])(scale)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=threshold;var __WEBPACK_IMPORTED_MODULE_0_d3_array__=__webpack_require__(742);var __WEBPACK_IMPORTED_MODULE_1__array__=__webpack_require__(745);function threshold(){var domain=[.5],range=[0,1],n=1;function scale(x){if(x<=x)return range[Object(__WEBPACK_IMPORTED_MODULE_0_d3_array__["bisect"])(domain,x,0,n)]}scale.domain=function(_){return arguments.length?(domain=__WEBPACK_IMPORTED_MODULE_1__array__["b"].call(_),n=Math.min(domain.length,range.length-1),scale):domain.slice()};scale.range=function(_){return arguments.length?(range=__WEBPACK_IMPORTED_MODULE_1__array__["b"].call(_),n=Math.min(domain.length,range.length-1),scale):range.slice()};scale.invertExtent=function(y){var i=range.indexOf(y);return[domain[i-1],domain[i]]};scale.copy=function(){return threshold().domain(domain).range(range)};return scale}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var millisecond=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(){},function(date,step){date.setTime(+date+step)},function(start,end){return end-start});millisecond.every=function(k){k=Math.floor(k);if(!isFinite(k)||!(k>0))return null;if(!(k>1))return millisecond;return Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setTime(Math.floor(date/k)*k)},function(date,step){date.setTime(+date+step*k)},function(start,end){return(end-start)/k})};__webpack_exports__["a"]=millisecond;var milliseconds=millisecond.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);var second=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setTime(Math.floor(date/__WEBPACK_IMPORTED_MODULE_1__duration__["d"])*__WEBPACK_IMPORTED_MODULE_1__duration__["d"])},function(date,step){date.setTime(+date+step*__WEBPACK_IMPORTED_MODULE_1__duration__["d"])},function(start,end){return(end-start)/__WEBPACK_IMPORTED_MODULE_1__duration__["d"]},function(date){return date.getUTCSeconds()});__webpack_exports__["a"]=second;var seconds=second.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);var minute=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setTime(Math.floor(date/__WEBPACK_IMPORTED_MODULE_1__duration__["c"])*__WEBPACK_IMPORTED_MODULE_1__duration__["c"])},function(date,step){date.setTime(+date+step*__WEBPACK_IMPORTED_MODULE_1__duration__["c"])},function(start,end){return(end-start)/__WEBPACK_IMPORTED_MODULE_1__duration__["c"]},function(date){return date.getMinutes()});__webpack_exports__["a"]=minute;var minutes=minute.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);var hour=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){var offset=date.getTimezoneOffset()*__WEBPACK_IMPORTED_MODULE_1__duration__["c"]%__WEBPACK_IMPORTED_MODULE_1__duration__["b"];if(offset<0)offset+=__WEBPACK_IMPORTED_MODULE_1__duration__["b"];date.setTime(Math.floor((+date-offset)/__WEBPACK_IMPORTED_MODULE_1__duration__["b"])*__WEBPACK_IMPORTED_MODULE_1__duration__["b"]+offset)},function(date,step){date.setTime(+date+step*__WEBPACK_IMPORTED_MODULE_1__duration__["b"])},function(start,end){return(end-start)/__WEBPACK_IMPORTED_MODULE_1__duration__["b"]},function(date){return date.getHours()});__webpack_exports__["a"]=hour;var hours=hour.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);var day=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*__WEBPACK_IMPORTED_MODULE_1__duration__["c"])/__WEBPACK_IMPORTED_MODULE_1__duration__["a"]},function(date){return date.getDate()-1});__webpack_exports__["a"]=day;var days=day.range},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return sunday});__webpack_require__.d(__webpack_exports__,"a",function(){return monday});var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);function weekday(i){return Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setDate(date.getDate()-(date.getDay()+7-i)%7);date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+step*7)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*__WEBPACK_IMPORTED_MODULE_1__duration__["c"])/__WEBPACK_IMPORTED_MODULE_1__duration__["e"]})}var sunday=weekday(0);var monday=weekday(1);var tuesday=weekday(2);var wednesday=weekday(3);var thursday=weekday(4);var friday=weekday(5);var saturday=weekday(6);var sundays=sunday.range;var mondays=monday.range;var tuesdays=tuesday.range;var wednesdays=wednesday.range;var thursdays=thursday.range;var fridays=friday.range;var saturdays=saturday.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var month=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setDate(1);date.setHours(0,0,0,0)},function(date,step){date.setMonth(date.getMonth()+step)},function(start,end){return end.getMonth()-start.getMonth()+(end.getFullYear()-start.getFullYear())*12},function(date){return date.getMonth()});__webpack_exports__["a"]=month;var months=month.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var year=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setMonth(0,1);date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step)},function(start,end){return end.getFullYear()-start.getFullYear()},function(date){return date.getFullYear()});year.every=function(k){return!isFinite(k=Math.floor(k))||!(k>0)?null:Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setFullYear(Math.floor(date.getFullYear()/k)*k);date.setMonth(0,1);date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step*k)})};__webpack_exports__["a"]=year;var years=year.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);var utcMinute=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setUTCSeconds(0,0)},function(date,step){date.setTime(+date+step*__WEBPACK_IMPORTED_MODULE_1__duration__["c"])},function(start,end){return(end-start)/__WEBPACK_IMPORTED_MODULE_1__duration__["c"]},function(date){return date.getUTCMinutes()});__webpack_exports__["a"]=utcMinute;var utcMinutes=utcMinute.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);var utcHour=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setUTCMinutes(0,0,0)},function(date,step){date.setTime(+date+step*__WEBPACK_IMPORTED_MODULE_1__duration__["b"])},function(start,end){return(end-start)/__WEBPACK_IMPORTED_MODULE_1__duration__["b"]},function(date){return date.getUTCHours()});__webpack_exports__["a"]=utcHour;var utcHours=utcHour.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);var utcDay=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+step)},function(start,end){return(end-start)/__WEBPACK_IMPORTED_MODULE_1__duration__["a"]},function(date){return date.getUTCDate()-1});__webpack_exports__["a"]=utcDay;var utcDays=utcDay.range},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return utcSunday});__webpack_require__.d(__webpack_exports__,"a",function(){return utcMonday});var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var __WEBPACK_IMPORTED_MODULE_1__duration__=__webpack_require__(743);function utcWeekday(i){return Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setUTCDate(date.getUTCDate()-(date.getUTCDay()+7-i)%7);date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+step*7)},function(start,end){return(end-start)/__WEBPACK_IMPORTED_MODULE_1__duration__["e"]})}var utcSunday=utcWeekday(0);var utcMonday=utcWeekday(1);var utcTuesday=utcWeekday(2);var utcWednesday=utcWeekday(3);var utcThursday=utcWeekday(4);var utcFriday=utcWeekday(5);var utcSaturday=utcWeekday(6);var utcSundays=utcSunday.range;var utcMondays=utcMonday.range;var utcTuesdays=utcTuesday.range;var utcWednesdays=utcWednesday.range;var utcThursdays=utcThursday.range;var utcFridays=utcFriday.range;var utcSaturdays=utcSaturday.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var utcMonth=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setUTCDate(1);date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCMonth(date.getUTCMonth()+step)},function(start,end){return end.getUTCMonth()-start.getUTCMonth()+(end.getUTCFullYear()-start.getUTCFullYear())*12},function(date){return date.getUTCMonth()});__webpack_exports__["a"]=utcMonth;var utcMonths=utcMonth.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__interval__=__webpack_require__(741);var utcYear=Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setUTCMonth(0,1);date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step)},function(start,end){return end.getUTCFullYear()-start.getUTCFullYear()},function(date){return date.getUTCFullYear()});utcYear.every=function(k){return!isFinite(k=Math.floor(k))||!(k>0)?null:Object(__WEBPACK_IMPORTED_MODULE_0__interval__["a"])(function(date){date.setUTCFullYear(Math.floor(date.getUTCFullYear()/k)*k);date.setUTCMonth(0,1);date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step*k)})};__webpack_exports__["a"]=utcYear;var utcYears=utcYear.range},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__isoFormat__=__webpack_require__(803);var __WEBPACK_IMPORTED_MODULE_1__defaultLocale__=__webpack_require__(769);function parseIsoNative(string){var date=new Date(string);return isNaN(date)?null:date}var parseIso=+new Date("2000-01-01T00:00:00.000Z")?parseIsoNative:Object(__WEBPACK_IMPORTED_MODULE_1__defaultLocale__["c"])(__WEBPACK_IMPORTED_MODULE_0__isoFormat__["a"]);var _unused_webpack_default_export=parseIso},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__time__=__webpack_require__(800);var __WEBPACK_IMPORTED_MODULE_1_d3_time_format__=__webpack_require__(801);var __WEBPACK_IMPORTED_MODULE_2_d3_time__=__webpack_require__(768);__webpack_exports__["a"]=function(){return Object(__WEBPACK_IMPORTED_MODULE_0__time__["a"])(__WEBPACK_IMPORTED_MODULE_2_d3_time__["t"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["p"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["s"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["k"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["l"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["n"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["q"],__WEBPACK_IMPORTED_MODULE_2_d3_time__["m"],__WEBPACK_IMPORTED_MODULE_1_d3_time_format__["b"]).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__colors__=__webpack_require__(752);__webpack_exports__["a"]=Object(__WEBPACK_IMPORTED_MODULE_0__colors__["a"])("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf")},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__colors__=__webpack_require__(752);__webpack_exports__["a"]=Object(__WEBPACK_IMPORTED_MODULE_0__colors__["a"])("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6")},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__colors__=__webpack_require__(752);__webpack_exports__["a"]=Object(__WEBPACK_IMPORTED_MODULE_0__colors__["a"])("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9")},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__colors__=__webpack_require__(752);__webpack_exports__["a"]=Object(__WEBPACK_IMPORTED_MODULE_0__colors__["a"])("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5")},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_d3_color__=__webpack_require__(744);var __WEBPACK_IMPORTED_MODULE_1_d3_interpolate__=__webpack_require__(750);__webpack_exports__["a"]=Object(__WEBPACK_IMPORTED_MODULE_1_d3_interpolate__["b"])(Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])(300,.5,0),Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])(-240,.5,1))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return warm});__webpack_require__.d(__webpack_exports__,"a",function(){return cool});var __WEBPACK_IMPORTED_MODULE_0_d3_color__=__webpack_require__(744);var __WEBPACK_IMPORTED_MODULE_1_d3_interpolate__=__webpack_require__(750);var warm=Object(__WEBPACK_IMPORTED_MODULE_1_d3_interpolate__["b"])(Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])(-100,.75,.35),Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])(80,1.5,.8));var cool=Object(__WEBPACK_IMPORTED_MODULE_1_d3_interpolate__["b"])(Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])(260,.75,.35),Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])(80,1.5,.8));var rainbow=Object(__WEBPACK_IMPORTED_MODULE_0_d3_color__["b"])();__webpack_exports__["b"]=function(t){if(t<0||t>1)t-=Math.floor(t);var ts=Math.abs(t-.5);rainbow.h=360*t-100;rainbow.s=1.5-1.5*ts;rainbow.l=.8-.9*ts;return rainbow+""}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return magma});__webpack_require__.d(__webpack_exports__,"b",function(){return inferno});__webpack_require__.d(__webpack_exports__,"d",function(){return plasma});var __WEBPACK_IMPORTED_MODULE_0__colors__=__webpack_require__(752);function ramp(range){var n=range.length;return function(t){return range[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}__webpack_exports__["a"]=ramp(Object(__WEBPACK_IMPORTED_MODULE_0__colors__["a"])("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var magma=ramp(Object(__WEBPACK_IMPORTED_MODULE_0__colors__["a"])("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf"));var inferno=ramp(Object(__WEBPACK_IMPORTED_MODULE_0__colors__["a"])("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4"));var plasma=ramp(Object(__WEBPACK_IMPORTED_MODULE_0__colors__["a"])("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=sequential;var __WEBPACK_IMPORTED_MODULE_0__linear__=__webpack_require__(749);function sequential(interpolator){var x0=0,x1=1,clamp=false;function scale(x){var t=(x-x0)/(x1-x0);return interpolator(clamp?Math.max(0,Math.min(1,t)):t)}scale.domain=function(_){return arguments.length?(x0=+_[0],x1=+_[1],scale):[x0,x1]};scale.clamp=function(_){return arguments.length?(clamp=!!_,scale):clamp};scale.interpolator=function(_){return arguments.length?(interpolator=_,scale):interpolator};scale.copy=function(){return sequential(interpolator).domain([x0,x1]).clamp(clamp)};return Object(__WEBPACK_IMPORTED_MODULE_0__linear__["b"])(scale)}},function(module,exports,__webpack_require__){var content=__webpack_require__(900);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./base-visualization.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./base-visualization.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".base-visualization{position:absolute;top:0;bottom:0;left:0;right:0;overflow:hidden}.base-visualization .internals{position:absolute;top:0;bottom:0;left:0;right:0;overflow:auto}.base-visualization .loader,.base-visualization .query-error{position:absolute;top:0;bottom:0;left:0;right:0}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var React=__webpack_require__(1);var BAR_PROPORTION=.8;var SELECTION_PAD=4;var BarCoordinates=function(){function BarCoordinates(parameters){this.x=parameters.x;this.y=parameters.y;this.height=parameters.height;this.width=isNaN(parameters.width)?0:parameters.width;this.children=parameters.children;this._hitboxMin=this.x-this.barOffset;this._hitboxMax=this.x+this.barWidth+this.barOffset*2}BarCoordinates.reduce=function(previous,current){return previous?previous.merge(current):current};Object.defineProperty(BarCoordinates.prototype,"barWidth",{get:function(){return Math.max(this.width*BAR_PROPORTION,0)},enumerable:true,configurable:true});Object.defineProperty(BarCoordinates.prototype,"barOffset",{get:function(){return(this.width-this.barWidth)/2},enumerable:true,configurable:true});BarCoordinates.prototype.isXWithin=function(x){return x>=this._hitboxMin&&x<=this._hitboxMax};BarCoordinates.prototype.renderBar=function(className){return React.createElement("rect",{className:className,width:Math.round(this.barWidth),height:Math.round(Math.abs(this.height)),x:this.barOffset,y:Math.round(this.y)})};BarCoordinates.prototype.renderHighlight=function(left,top,className,key){var _a=this,height=_a.height,y=_a.y,x=_a.x,barOffset=_a.barOffset,width=_a.width;var leftOffset=Math.round(x)-SELECTION_PAD+left;var topOffset=Math.round(y)-SELECTION_PAD+top;var style={left:leftOffset,top:topOffset,width:width+SELECTION_PAD*2,height:Math.abs(height)+SELECTION_PAD*2};return React.createElement("div",{className:className,style:style,key:key})};BarCoordinates.prototype.merge=function(other){var x=Math.min(this.x,other.x);var rightMost=this.x+this.width>other.x+other.width?this:other;var leftMost=this.x<other.x?this:other;return new BarCoordinates({x:x,width:rightMost.x+rightMost.width-leftMost.x,height:Math.max(this.height,other.height),y:Math.min(this.y,other.y),children:this.children.concat(other.children)})};BarCoordinates.prototype.hasChildren=function(){return this.children.length>0};Object.defineProperty(BarCoordinates.prototype,"middleX",{get:function(){return this.x+this.barWidth*.5+this.barOffset},enumerable:true,configurable:true});return BarCoordinates}();exports.BarCoordinates=BarCoordinates},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var plywood_1=__webpack_require__(14);var constants_1=__webpack_require__(52);var MAX_FILLERS=200;function padDataset(originalDataset,dimension,measures){var data=originalDataset.data[0][constants_1.SPLIT].data;if(!data.length)return originalDataset;var dimensionName=dimension.name;var firstBucket=data[0][dimensionName];if(!firstBucket)return originalDataset;var start=Number(firstBucket.start);var end=Number(firstBucket.end);var size=end-start;var i=start;var fillers=0;var filledData=[];for(var _i=0,data_1=data;_i<data_1.length;_i++){var d=data_1[_i];var segmentValue=d[dimensionName];var segmentStart=segmentValue.start;var _loop_1=function(){var filledDatum={};filledDatum[dimensionName]=plywood_1.NumberRange.fromJS({start:i,end:i+size});measures.forEach(function(m){filledDatum[m.name]=0});if(d[constants_1.SPLIT]){filledDatum[constants_1.SPLIT]=new plywood_1.Dataset({data:[],attributes:[]})}filledData.push(filledDatum);fillers++;i+=size};while(i<segmentStart&&fillers<MAX_FILLERS){_loop_1()}filledData.push(d);i+=size}var value=originalDataset.valueOf();value.data[0][constants_1.SPLIT].data=filledData;return new plywood_1.Dataset(value)}function padDatasetLoad(datasetLoad,dimension,measures){var originalDataset=datasetLoad.dataset;var newDataset=originalDataset?padDataset(originalDataset,dimension,measures):null;datasetLoad.dataset=newDataset;return datasetLoad}exports.padDatasetLoad=padDatasetLoad},function(module,exports,__webpack_require__){var content=__webpack_require__(904);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./bar-chart.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./bar-chart.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".bar-chart .measure-bar-charts{overflow-x:hidden;overflow-y:auto}.bar-chart .scroller{position:relative;height:100%}.bar-chart .scroller .bottom-shadow{opacity:0}.bar-chart .scroller .bottom-right-corner{background-color:white}.bar-chart .selection-highlight-container{position:absolute;top:0px}.bar-chart .selection-highlight-container .selection-highlight{position:absolute;pointer-events:none;border:1px dashed #1ea3e6}.bar-chart .vertical-axis .border{stroke-width:0}.bar-chart .x-axis{stroke:#ccc;stroke-width:1px}.bar-chart .x-axis .slanty-labels{position:absolute;overflow:hidden}.bar-chart .x-axis .slanty-label{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;position:absolute;width:100px;height:20px;-webkit-transform:rotate(-43deg);-ms-transform:rotate(-43deg);transform:rotate(-43deg);-webkit-transform-origin:right top;-ms-transform-origin:right top;transform-origin:right top;text-align:right;cursor:default;overflow:hidden;font-size:12px}.bar-chart .x-axis .slanty-label.categorical{top:3px}.bar-chart .x-axis .slanty-label.continuous{top:6px}.bar-chart .measure-bar-chart::after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;border-bottom:1px solid #ccc;border-right:1px solid #ccc}.bar-chart .measure-bar-chart:first-child::after{top:10px}.bar-chart .measure-bar-chart .vis-measure-label{position:absolute;left:12px;top:12px}.bar-chart .measure-bar-chart .vis-bottom{pointer-events:none;stroke:#ccc}.bar-chart .measure-bar-chart g.bars g.bar.not-selected{fill-opacity:0.5}.bar-chart .measure-bar-chart g.bars g.bar.hover{fill-opacity:0.9}.bar-chart .measure-bar-chart g.bars g.bar>rect.background{pointer-events:none;fill:#1ea3e6}.bar-chart .measure-bar-chart g.bars g.bar>rect.mouse-event-target{fill:#fff;fill-opacity:0.001}.bar-chart .measure-bar-chart .mask{fill:#fff}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var plywood_1=__webpack_require__(14);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var models_1=__webpack_require__(19);var components_1=__webpack_require__(466);var constants_1=__webpack_require__(52);var base_visualization_1=__webpack_require__(746);__webpack_require__(906);var HOVER_BUBBLE_V_OFFSET=-7;var $MAIN=plywood_1.$("main");var AVG_LAT="#int_avg_lat";var AVG_LON="#int_avg_lon";var GeoMarkerWrapper=function(_super){tslib_1.__extends(GeoMarkerWrapper,_super);function GeoMarkerWrapper(){return _super.call(this)||this}GeoMarkerWrapper.prototype.render=function(){return React.cloneElement(React.Children.only(this.props.children),this.props)};return GeoMarkerWrapper}(React.Component);exports.GeoMarkerWrapper=GeoMarkerWrapper;var Geo=function(_super){tslib_1.__extends(Geo,_super);function Geo(){return _super.call(this)||this}Geo.prototype.queryExtra=function(query,splitIndex,essence,timekeeper){if(splitIndex<0)return null;var latitudeLongitudeDimension=essence.actualDataCube.getLatitudeLongitudeDimensions();if(!latitudeLongitudeDimension)return null;var latitude=latitudeLongitudeDimension.latitude,longitude=latitudeLongitudeDimension.longitude;return query.apply(AVG_LAT,$MAIN.average(plywood_1.$(latitude.name))).apply(AVG_LON,$MAIN.average(plywood_1.$(longitude.name)))};Geo.prototype.getDefaultState=function(){return _super.prototype.getDefaultState.call(this)};Geo.prototype.componentDidUpdate=function(){var _a=this.state,containerYPosition=_a.containerYPosition,containerXPosition=_a.containerXPosition;var node=ReactDOM.findDOMNode(this.container);if(!node)return;var rect=node.getBoundingClientRect();if(containerYPosition!==rect.top||containerXPosition!==rect.left){this.setState({containerYPosition:rect.top,containerXPosition:rect.left})}};Geo.prototype.canRenderMarkers=function(essence,datasetLoad){if(!datasetLoad||!essence)return false;var dataset=datasetLoad.dataset;if(!dataset)return false;if(!dataset.data[0][constants_1.SPLIT].data)return false;return true};Geo.prototype.isSelected=function(essence,d){var highlightDelta=this.hasHighlightOnThisMap(essence)?essence.highlight.delta:null;if(!highlightDelta)return false;var splits=essence.getEffectiveSplits();var flatDatum=base_visualization_1.BaseVisualization.flatDatumForPath(splits,[d]);return base_visualization_1.BaseVisualization.isDatumInFilter(highlightDelta,splits,flatDatum)};Geo.prototype.generateMarkers=function(){var _this=this;var essence=this.props.essence;var datasetLoad=this.state.datasetLoad;var splits=essence.getConstrainedSplits();if(!this.canRenderMarkers(essence,datasetLoad))return{};var firstDimension=essence.getDimension(splits.get(0).dimension);var dimensionName=firstDimension.name;var valueField=essence.getEffectiveMeasures()[0].name;var converter=firstDimension.getCoordinatesConverter();var data=datasetLoad.dataset.data[0][constants_1.SPLIT].data;var markers=[];var unknowns=[];data.forEach(function(d){var segmentCode=d[dimensionName];var segmentValue=d[valueField];var fillOpacity=1;var isSelected=false;if(_this.hasHighlightOnThisMap(essence)){isSelected=_this.isSelected(essence,d);fillOpacity=isSelected?1:.5}if(converter){var geoInfo=converter(segmentCode);if(geoInfo){markers.push({label:geoInfo.label,latLng:{lat:geoInfo.latitude,lng:geoInfo.longitude},value:segmentValue,data:d,additionalOptions:{fillOpacity:fillOpacity},outerCircle:isSelected})}else{unknowns.push({label:segmentCode,latLng:{lat:NaN,lng:NaN},value:segmentValue,data:d,additionalOptions:{fillOpacity:fillOpacity}})}}else{if(segmentCode){markers.push({label:String(segmentCode),latLng:{lat:Number(d[AVG_LAT]),lng:Number(d[AVG_LON])},value:segmentValue,data:d,additionalOptions:{fillOpacity:fillOpacity},outerCircle:isSelected})}else{unknowns.push({label:segmentCode,latLng:{lat:NaN,lng:NaN},value:segmentValue,data:d,additionalOptions:{fillOpacity:fillOpacity}})}}});return{markers:markers,unknowns:unknowns}};Geo.prototype.precalculate=function(props,datasetLoad){if(datasetLoad===void 0){datasetLoad=null}if(!datasetLoad)return;this.setState({datasetLoad:datasetLoad,selections:[]})};Geo.prototype.onMapAppear=function(markers){var _this=this;var essence=this.props.essence;var splits=essence.getConstrainedSplits();if(!markers)return;if(!this.hasHighlightOnThisMap(essence))return;this.setState({selections:markers.filter(function(m){return _this.isSelected(essence,base_visualization_1.BaseVisualization.flatDatumForPath(splits,[m.data]))})})};Geo.prototype.hasHighlightOnThisMap=function(essence){return essence.hasHighlight()};Geo.prototype.handleMultiSelect=function(marker){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var selections=this.state.selections;var splits=essence.getConstrainedSplits();var flatDatum=base_visualization_1.BaseVisualization.flatDatumForPath(splits,[marker.data]);if(base_visualization_1.BaseVisualization.isDatumInFilter(essence.highlight.delta,splits,flatDatum)){selections=selections.filter(function(s){return s.data!==marker.data})}else{selections.push(marker)}if(selections.length===0){clicker.dropHighlight()}else{var filter=base_visualization_1.BaseVisualization.toggleDatumInFilter(essence.highlight.delta,splits,flatDatum);clicker.changeHighlight(new models_1.Highlight({measure:null,delta:filter}))}this.setState({selections:selections})};Geo.prototype.handleSingleSelect=function(marker){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var splits=essence.getConstrainedSplits();var flatDatum=base_visualization_1.BaseVisualization.flatDatumForPath(splits,[marker.data]);var filter=base_visualization_1.BaseVisualization.getFilterFromDatum(splits,flatDatum);if(!filter)return;if(this.hasHighlightOnThisMap(essence)){if(filter.equals(essence.highlight.delta)){clicker.dropHighlight();return}}this.setState({selections:[marker]});clicker.changeHighlight(new models_1.Highlight({measure:null,delta:filter}))};Geo.prototype.onMarkerClick=function(marker,event){var _a=this.props,clicker=_a.clicker,essence=_a.essence;if(!clicker.dropHighlight||!clicker.changeHighlight)return;if(this.isMultiSelectEvent(event)&&this.hasHighlightOnThisMap(essence)){this.handleMultiSelect(marker)}else{this.handleSingleSelect(marker)}};Geo.prototype.clearHighlight=function(){var _a=this.props,clicker=_a.clicker,essence=_a.essence;if(this.hasHighlightOnThisMap(essence)){clicker.dropHighlight();this.hideBubble()}};Geo.prototype.showBubble=function(marker){var essence=this.props.essence;if(this.hasHighlightOnThisMap(essence))return;this.setState({selections:[marker]})};Geo.prototype.hideBubble=function(){var essence=this.props.essence;if(this.hasHighlightOnThisMap(essence))return;this.setState({selections:[]})};Geo.prototype.renderBubble=function(){var _this=this;var _a=this.props,clicker=_a.clicker,openRawDataModal=_a.openRawDataModal,essence=_a.essence;var _b=this.state,selections=_b.selections,containerYPosition=_b.containerYPosition,containerXPosition=_b.containerXPosition,selectionMode=_b.selectionMode;var splitDimensions=essence.getSplitDimensions();var _c=caladan_1.MarkerMap.geoMidPoint(selections.map(function(m){return m.latLng})),lat=_c.lat,lng=_c.lng;var n=selections.length;var segmentLabel=n>1?n+" selections":selections[0].label;var measureLabel=n>1?null:String(selections[0].value);var sticky=this.hasHighlightOnThisMap(essence);var onMouseLeave=function(){if(!sticky)_this.hideBubble()};return React.createElement(GeoMarkerWrapper,{position:[lat,lng],offset:[-containerXPosition,-containerYPosition-HOVER_BUBBLE_V_OFFSET]},React.createElement(components_1.SegmentBubble,{segmentLabel:segmentLabel,measureLabel:measureLabel,onMouseLeave:onMouseLeave,onClose:this.hideBubble.bind(this),dimensions:sticky?splitDimensions:undefined,clicker:sticky?clicker:undefined,openRawDataModal:sticky?openRawDataModal:undefined,toggleSelectionMode:sticky?function(){return _this.toggleSelectionMode()}:undefined,selectionMode:selectionMode}))};Geo.prototype.renderMeasureLabel=function(){var _a=this.props,isThumbnail=_a.isThumbnail,essence=_a.essence;var datasetLoad=this.state.datasetLoad;var datum=datasetLoad.dataset.data[0];var measure=essence.getEffectiveMeasures()[0];return isThumbnail?null:React.createElement(components_1.VisMeasureLabel,{measure:measure,datum:datum})};Geo.prototype.renderUnknownsLabel=function(unknowns){if(!unknowns||!unknowns.length)return null;var n=unknowns.length;var title=unknowns.map(function(m){return'"'+m.label+'"'}).join(", ");return React.createElement("div",{className:"unknowns-label",title:title},n+" value"+(n>1?"s":"")+" can't be shown")};Geo.prototype.renderInternals=function(){var _this=this;var _a=this.props,noScroll=_a.noScroll,isThumbnail=_a.isThumbnail;var selections=this.state.selections;var _b=this.generateMarkers(),markers=_b.markers,unknowns=_b.unknowns;if(!markers)return null;return React.createElement("div",{className:classNames("internals geo-inner",{thumbnail:isThumbnail})},React.createElement(caladan_1.MarkerMap,{ref:function(container){return _this.container=container},disableMouseWheel:noScroll,markers:markers,onMarkerOver:this.showBubble.bind(this),onMarkerOut:this.hideBubble.bind(this),onMarkerClick:this.onMarkerClick.bind(this),onMapClick:this.clearHighlight.bind(this),onAppear:this.onMapAppear.bind(this,markers)},selections.length>=1?this.renderBubble():null),this.renderMeasureLabel(),isThumbnail?null:this.renderUnknownsLabel(unknowns))};Geo.visName=models_1.GEO_MANIFEST.name;return Geo}(base_visualization_1.BaseVisualization);exports.Geo=Geo},function(module,exports,__webpack_require__){var content=__webpack_require__(907);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./geo.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./geo.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".geo .internals .vis-measure-label{position:absolute;left:16px;top:12px;font-weight:600;text-shadow:0 0 2px #fff}.geo .internals .unknowns-label{position:absolute;right:16px;bottom:12px;font-weight:600;text-shadow:0 0 2px #fff}.geo .internals:not(.thumbnail) .marker-map .buttons{top:40px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var d3_array_1=__webpack_require__(742);var d3_scale_1=__webpack_require__(753);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var models_1=__webpack_require__(19);var time_1=__webpack_require__(109);var components_1=__webpack_require__(466);var constants_1=__webpack_require__(52);var formatter_1=__webpack_require__(186);var base_visualization_1=__webpack_require__(746);var highlighter_1=__webpack_require__(909);__webpack_require__(912);var V_GAP=36;var THUMBNAIL_V_GAP=6;var X_AXIS_HEIGHT=40;var Y_AXIS_WIDTH=68;var MIN_CHART_HEIGHT=70;var HOVER_BUBBLE_V_OFFSET=-7;var HOVER_MULTI_BUBBLE_V_OFFSET=-8;var MAX_HOVER_DIST=50;var MAX_ASPECT_RATIO=1;var floatFormat=function(f){return f.toFixed(1)};function findClosest(data,dragDate,scaleX,continuousDimension){var closestDatum=null;var minDist=Infinity;for(var _i=0,data_1=data;_i<data_1.length;_i++){var datum=data_1[_i];var continuousSegmentValue=datum[continuousDimension.name];if(!continuousSegmentValue||!plywood_1.Range.isRange(continuousSegmentValue))continue;var mid=continuousSegmentValue.midpoint();var dist=Math.abs(mid.valueOf()-dragDate.valueOf());var distPx=Math.abs(scaleX(mid)-scaleX(dragDate));if((!closestDatum||dist<minDist)&&distPx<MAX_HOVER_DIST){closestDatum=datum;minDist=dist}}return closestDatum}function roundTo(v,roundTo){return Math.round(Math.floor(v/roundTo))*roundTo}function getLineChartTicksNumber(dimension,range){var _a=range,start=_a.start,end=_a.end;var tick=dimension.getBucketedBy().getRecommendationForRange(range,9);var unit=tick.expression.size;var values=[];var iter=Math.round(start*unit)/unit;while(iter<=end){values.push(iter);iter+=unit}return values}function getLineChartTicksDuration(dimension,range,timezone){var start=range.start,end=range.end;var tick=dimension.getBucketedBy().getRecommendationForRange(range,9);return tick.expression.duration.materialize(start,end,timezone)}var LineChart=function(_super){tslib_1.__extends(LineChart,_super);function LineChart(){var _this=_super.call(this)||this;_this._dragging=false;_this._hasDragged=false;return _this}LineChart.prototype.getDefaultState=function(){var s=_super.prototype.getDefaultState.call(this);s.selections=[];s.hoverRange=null;return s};LineChart.prototype.componentDidUpdate=function(){var _a=this.state,containerYPosition=_a.containerYPosition,containerXPosition=_a.containerXPosition;var node=ReactDOM.findDOMNode(this.refs["container"]);if(!node)return;var rect=node.getBoundingClientRect();if(containerYPosition!==rect.top||containerXPosition!==rect.left){this.setState({containerYPosition:rect.top,containerXPosition:rect.left})}};LineChart.prototype.getMyEventX=function(e){var myDOM=ReactDOM.findDOMNode(this);var rect=myDOM.getBoundingClientRect();return beltful_1.EventUtils.getXFromEvent(e)-(rect.left+constants_1.VIS_H_PADDING)};LineChart.prototype.onMouseDown=function(measure,event){var clicker=this.props.clicker;var selections=this.state.selections;var _scaleX=this._scaleX;if(!_scaleX||!clicker.dropHighlight||!clicker.changeHighlight)return;this._dragging=true;var dragStartValue=_scaleX.invert(this.getMyEventX(event));if(this.isMultiSelectEvent(event)){selections.push({dragStartValue:dragStartValue,dragRange:plywood_1.Range.fromJS({start:dragStartValue,end:dragStartValue})})}else{if(!!this.existingSelectionforValue(dragStartValue)){selections=[];clicker.dropHighlight()}else{selections=[{dragStartValue:dragStartValue,dragRange:plywood_1.Range.fromJS({start:dragStartValue,end:dragStartValue})}]}}this.setState({selections:selections,dragOnMeasure:measure})};LineChart.prototype.existingSelectionforValue=function(value){var selections=this.state.selections;return selections.filter(function(s){return s.dragRange.contains(value)})[0]};LineChart.prototype.onMouseMove=function(dataset,measure,scaleX,e){var essence=this.props.essence;var _a=this.state,continuousDimension=_a.continuousDimension,hoverRange=_a.hoverRange,hoverMeasure=_a.hoverMeasure;if(!dataset)return;if(essence.hasHighlight())return;var splitLength=essence.getConstrainedSplits().length();var myDOM=ReactDOM.findDOMNode(this);var rect=myDOM.getBoundingClientRect();var dragDate=scaleX.invert(beltful_1.EventUtils.getXFromEvent(e)-(rect.left+constants_1.VIS_H_PADDING));var closestDatum;if(splitLength>1){var flatData=dataset.flatten();closestDatum=findClosest(flatData.data,dragDate,scaleX,continuousDimension)}else{closestDatum=findClosest(dataset.data,dragDate,scaleX,continuousDimension)}var currentHoverRange=closestDatum?closestDatum[continuousDimension.name]:null;if(!hoverRange||!immutable_class_1.immutableEqual(hoverRange,currentHoverRange)||measure!==hoverMeasure){this.setState({hoverRange:currentHoverRange,hoverMeasure:measure})}};LineChart.prototype.getLastDragRange=function(e){var _a=this.state,selections=_a.selections,axisRange=_a.axisRange;var _scaleX=this._scaleX;var _b=selections[selections.length-1],dragRange=_b.dragRange,dragStartValue=_b.dragStartValue;var dragEndValue=_scaleX.invert(this.getMyEventX(e));var rangeJS=null;if(dragStartValue.valueOf()===dragEndValue.valueOf()){dragEndValue=plywood_1.TimeRange.isTimeRange(axisRange)?new Date(dragEndValue.valueOf()+1):dragEndValue+1}if(dragStartValue<dragEndValue){rangeJS={start:dragStartValue,end:dragEndValue}}else{rangeJS={start:dragEndValue,end:dragStartValue}}return plywood_1.Range.fromJS(rangeJS).intersect(axisRange)};LineChart.prototype.floorRange=function(dragRange){var essence=this.props.essence;var timezone=essence.timezone;var splits=essence.getConstrainedSplits();var continuousSplit=splits.last();if(!continuousSplit.bucketAction)return dragRange;if(plywood_1.TimeRange.isTimeRange(dragRange)){var timeBucketAction=continuousSplit.bucketAction;var duration=timeBucketAction.duration;return plywood_1.TimeRange.fromJS({start:duration.floor(dragRange.start,timezone),end:duration.shift(duration.floor(dragRange.end,timezone),timezone,1)})}else{var numberBucketAction=continuousSplit.bucketAction;var bucketSize=numberBucketAction.size;var startFloored=roundTo(dragRange.start,bucketSize);var endFloored=roundTo(dragRange.end,bucketSize);if(endFloored-startFloored<bucketSize){endFloored+=bucketSize}return plywood_1.NumberRange.fromJS({start:startFloored,end:endFloored})}};LineChart.prototype.globalMouseMoveListener=function(e){var selections=this.state.selections;if(selections.length===0||!this._dragging)return;this._hasDragged=true;var dragRange=this.getLastDragRange(e);selections[selections.length-1].dragRange=dragRange;this.setState({selections:selections})};LineChart.prototype.handleSingleClickSelection=function(e){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var _b=this.state,selections=_b.selections,dragOnMeasure=_b.dragOnMeasure,continuousDimension=_b.continuousDimension;var newRange=this.getLastDragRange(e);var overlappingSelection=selections.filter(function(s,i){return i!==selections.length-1}).filter(function(s){return s.dragRange.contains(newRange.start)})[0];if(overlappingSelection){selections=selections.filter(function(s){return s!==overlappingSelection});selections.pop()}else{selections[selections.length-1].dragRange=this.floorRange(newRange)}if(selections.length===0){clicker.dropHighlight()}else{clicker.changeHighlight(new models_1.Highlight({measure:dragOnMeasure.name,delta:models_1.Filter.fromClause(new models_1.FilterClause({dimension:continuousDimension.name,values:plywood_1.Set.fromJS(this.simplifySelections(selections))}))}))}};LineChart.prototype.simplifySelections=function(selections){var ranges=[];var lastRange;selections.sort(function(a,b){return a.dragRange.compare(b.dragRange)}).forEach(function(_a){var dragRange=_a.dragRange;if(!lastRange){lastRange=dragRange}else{if(lastRange.mergeable(dragRange)){lastRange=lastRange.union(dragRange)}else{ranges.push(lastRange);lastRange=dragRange}}});if(lastRange)ranges.push(lastRange);return ranges};LineChart.prototype.globalMouseUpListener=function(e){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var _b=this.state,continuousDimension=_b.continuousDimension,selections=_b.selections,dragOnMeasure=_b.dragOnMeasure;if(!this._dragging||selections.length===0)return;this._dragging=false;if(!this._hasDragged){this.handleSingleClickSelection(e)}else{selections[selections.length-1].dragRange=this.floorRange(this.getLastDragRange(e));clicker.changeHighlight(new models_1.Highlight({measure:dragOnMeasure.name,delta:models_1.Filter.fromClause(new models_1.FilterClause({dimension:continuousDimension.name,values:plywood_1.Set.fromJS(this.simplifySelections(selections))}))}))}this._hasDragged=false};LineChart.prototype.globalEscapeListener=function(e){var _a=this.props,essence=_a.essence,clicker=_a.clicker;if(essence.hasHighlight()){clicker.dropHighlight();this.resetDrag()}};LineChart.prototype.resetDrag=function(){this.setState({selections:[],dragOnMeasure:null})};LineChart.prototype.onMouseLeave=function(measure,e){var hoverMeasure=this.state.hoverMeasure;if(hoverMeasure===measure){this.setState({hoverRange:null,hoverMeasure:null})}};LineChart.prototype.renderHighlighter=function(){var selections=this.state.selections;return React.createElement(highlighter_1.Highlighter,{ranges:selections.map(function(s){return s.dragRange}),scaleX:this._scaleX})};LineChart.prototype.getColors=function(){var essence=this.props.essence;var customColors=this.state.customColors;var colors=essence.getEffectiveColors();if(colors&&colors.isLimitMode()){colors=customColors}return colors};LineChart.prototype.renderHoverBubble=function(topOffset,dataset,measure){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var _b=this.state,containerYPosition=_b.containerYPosition,containerXPosition=_b.containerXPosition,scrollTop=_b.scrollTop;var _c=this.state,hoverRange=_c.hoverRange,continuousDimension=_c.continuousDimension;var timezone=essence.timezone;var colors=this.getColors();var leftOffset=containerXPosition+constants_1.VIS_H_PADDING+this._scaleX(hoverRange.midpoint());var segmentLabel=formatter_1.formatValue(hoverRange,timezone,time_1.DisplayYear.NEVER);if(colors){var categoryDimension_1=essence.getConstrainedSplits().get(0).dimension;var hoverDatums_1=dataset.data.map(function(d){var ds=d[constants_1.SPLIT];return ds instanceof plywood_1.Dataset?ds.findDatumByAttribute(continuousDimension.name,hoverRange):null});var colorEntries=dataset.data.map(function(d,i){var segment=d[categoryDimension_1];var hoverDatum=hoverDatums_1[i];if(!hoverDatum)return null;return{color:colors.getColor(segment),segmentLabel:String(segment),measureLabel:measure.formatDatum(hoverDatum)}}).filter(Boolean);return React.createElement(components_1.ColorSegmentBubble,{left:leftOffset,top:topOffset+HOVER_MULTI_BUBBLE_V_OFFSET,segmentLabel:segmentLabel,colorEntries:colorEntries})}else{var hoverDatum=dataset.findDatumByAttribute(continuousDimension.name,hoverRange);if(!hoverDatum)return null;var segmentLabel_1=formatter_1.formatValue(hoverRange,timezone,time_1.DisplayYear.NEVER);return React.createElement(components_1.SegmentBubble,{left:leftOffset,top:topOffset+HOVER_BUBBLE_V_OFFSET,segmentLabel:segmentLabel_1,measureLabel:measure.formatDatum(hoverDatum)})}};LineChart.prototype.getChartVGap=function(chartStage){return chartStage.height>150?V_GAP:THUMBNAIL_V_GAP};LineChart.prototype.getBubbleTopOffset=function(chartIndex,chartStage,scaleY,extentY){var _a=this.state,stage=_a.stage,scrollTop=_a.scrollTop,containerYPosition=_a.containerYPosition;var topOffset=chartStage.height*chartIndex+scaleY(extentY[1])+this.getChartVGap(chartStage)-scrollTop;if(topOffset<0)topOffset=0;if(topOffset>stage.height-X_AXIS_HEIGHT)topOffset=stage.height-X_AXIS_HEIGHT;topOffset+=containerYPosition;return topOffset};LineChart.prototype.renderMultipleSelectionBubble=function(topOffset){var _this=this;var _a=this.props,clicker=_a.clicker,openRawDataModal=_a.openRawDataModal;var _b=this.state,containerXPosition=_b.containerXPosition,selections=_b.selections,selectionMode=_b.selectionMode;var range=selections[0].dragRange;selections.forEach(function(s){return range=range.extend(s.dragRange)});return React.createElement(components_1.SegmentBubble,{left:containerXPosition+constants_1.VIS_H_PADDING+this._scaleX(range.midpoint()),top:topOffset+HOVER_BUBBLE_V_OFFSET,segmentLabel:selections.length+" selections",clicker:clicker,openRawDataModal:openRawDataModal,toggleSelectionMode:function(){return _this.toggleSelectionMode()},selectionMode:selectionMode})};LineChart.prototype.renderChartBubble=function(dataset,chartIndex,containerStage,chartStage,extentY,scaleY){var _this=this;var _a=this.props,clicker=_a.clicker,essence=_a.essence,openRawDataModal=_a.openRawDataModal;var selectionMode=this.state.selectionMode;var timezone=essence.timezone;var _b=this.state,stage=_b.stage,containerYPosition=_b.containerYPosition,containerXPosition=_b.containerXPosition,scrollTop=_b.scrollTop,selections=_b.selections,dragOnMeasure=_b.dragOnMeasure,hoverRange=_b.hoverRange,hoverMeasure=_b.hoverMeasure,continuousDimension=_b.continuousDimension,customColors=_b.customColors;var measure=essence.getEffectiveMeasures()[chartIndex];if(dragOnMeasure!==measure&&hoverMeasure!==measure)return null;var topOffset=this.getBubbleTopOffset(chartIndex,chartStage,scaleY,extentY);if(selections.length===0){return hoverRange?this.renderHoverBubble(topOffset,dataset,measure):null}if(selections.length>1){return this.renderMultipleSelectionBubble(topOffset)}var dragRange=selections[0].dragRange;var colors=this.getColors();if(colors){var categoryDimension_2=essence.getConstrainedSplits().get(0).dimension;var hoverDatums_2=dataset.data.map(function(d){return d[constants_1.SPLIT].findDatumByAttribute(continuousDimension.name,dragRange)});var colorEntries=dataset.data.map(function(d,i){var segment=d[categoryDimension_2];var hoverDatum=hoverDatums_2[i];if(!hoverDatum)return null;return{color:colors.getColor(segment),segmentLabel:String(segment),measureLabel:measure.formatDatum(hoverDatum)}}).filter(Boolean);return React.createElement(components_1.ColorSegmentBubble,{left:containerXPosition+constants_1.VIS_H_PADDING+this._scaleX(dragRange.end),top:topOffset+HOVER_MULTI_BUBBLE_V_OFFSET,segmentLabel:formatter_1.formatValue(dragRange,timezone,time_1.DisplayYear.NEVER),colorEntries:colorEntries,clicker:clicker})}else{var highlightDatum=dataset.findDatumByAttribute(continuousDimension.name,dragRange);return React.createElement(components_1.SegmentBubble,{left:containerXPosition+constants_1.VIS_H_PADDING+this._scaleX(dragRange.midpoint()),top:topOffset+HOVER_BUBBLE_V_OFFSET,segmentLabel:formatter_1.formatValue(dragRange,timezone,time_1.DisplayYear.NEVER),measureLabel:highlightDatum?measure.formatDatum(highlightDatum):null,clicker:clicker,openRawDataModal:openRawDataModal,toggleSelectionMode:function(){return _this.toggleSelectionMode()},selectionMode:selectionMode})}};LineChart.prototype.getYAxisWidth=function(){return this.state.canShowAxes?Y_AXIS_WIDTH:0};LineChart.prototype.renderChart=function(dataset,chartIndex,containerStage,chartStage){var _this=this;var _a=this.props,essence=_a.essence,isThumbnail=_a.isThumbnail;var _b=this.state,hoverRange=_b.hoverRange,hoverMeasure=_b.hoverMeasure,selections=_b.selections,xTicks=_b.xTicks,continuousDimension=_b.continuousDimension,customColors=_b.customColors;var measures=essence.getEffectiveMeasures();var measure=measures[chartIndex];var splits=essence.getConstrainedSplits();var splitLength=splits.length();var colors=essence.getEffectiveColors();if(colors&&colors.isLimitMode()){colors=customColors}var vGap=this.getChartVGap(chartStage);var lineStage=chartStage.within({top:vGap,right:this.getYAxisWidth(),bottom:1});var yAxisStage=chartStage.within({top:vGap,left:lineStage.width,bottom:1});var measureName=measure.name;var getX=function(d){return d[continuousDimension.name]};var getY=function(d){return d[measureName]};var myDatum=dataset.data[0];var mySplitDataset=myDatum[constants_1.SPLIT];var extentY=null;if(splitLength===1){extentY=d3_array_1.extent(mySplitDataset.data,getY)}else{var minY_1=0;var maxY_1=0;mySplitDataset.data.forEach(function(datum){var subDataset=datum[constants_1.SPLIT];if(subDataset){var tempExtentY=d3_array_1.extent(subDataset.data,getY);minY_1=Math.min(tempExtentY[0],minY_1);maxY_1=Math.max(tempExtentY[1],maxY_1)}});extentY=[minY_1,maxY_1]}var horizontalGridLines;var chartLines;var verticalAxis;var bubble;if(!isNaN(extentY[0])&&!isNaN(extentY[1])){var scaleY_1=d3_scale_1.scaleLinear().domain([Math.min(extentY[0]*1.1,0),Math.max(extentY[1]*1.1,0)]).range([lineStage.height,0]);var yTicks=scaleY_1.ticks(chartStage.height<200?3:5);var crossesZero=extentY[0]<0&&extentY[1]>0;if(!crossesZero)yTicks=yTicks.filter(function(n){return n!==0});horizontalGridLines=React.createElement(components_1.GridLines,{orientation:"horizontal",scale:scaleY_1,ticks:yTicks,stage:lineStage});verticalAxis=React.createElement(components_1.VerticalAxis,{stage:yAxisStage,ticks:yTicks,scale:scaleY_1,measure:measure});if(splitLength===1){chartLines=[];chartLines.push(React.createElement(components_1.ChartLine,{key:"single",dataset:mySplitDataset,getX:getX,getY:getY,scaleX:this._scaleX,scaleY:scaleY_1,stage:lineStage,showArea:true,hoverRange:!selections.length&&hoverMeasure===measure?hoverRange:null,color:"default"}))}else{var categoryDimension_3=essence.getConstrainedSplits().get(0).dimension;chartLines=mySplitDataset.data.map(function(datum,i){var segment=datum[categoryDimension_3];var subDataset=datum[constants_1.SPLIT];if(!subDataset)return null;return React.createElement(components_1.ChartLine,{key:"single"+i,dataset:subDataset,getX:getX,getY:getY,scaleX:_this._scaleX,scaleY:scaleY_1,stage:lineStage,showArea:false,hoverRange:!selections.length&&hoverMeasure===measure?hoverRange:null,color:colors?colors.getColor(segment):null})})}bubble=this.renderChartBubble(mySplitDataset,chartIndex,containerStage,chartStage,extentY,scaleY_1)}return React.createElement("div",{className:"measure-line-chart",key:measureName,onMouseDown:this.onMouseDown.bind(this,measure),onMouseMove:this.onMouseMove.bind(this,mySplitDataset,measure,this._scaleX),onMouseLeave:this.onMouseLeave.bind(this,measure)},React.createElement("svg",{style:chartStage.getWidthHeight(),viewBox:chartStage.getViewBox()},horizontalGridLines,React.createElement(components_1.GridLines,{orientation:"vertical",scale:this._scaleX,ticks:xTicks,stage:lineStage}),chartLines,verticalAxis,React.createElement("line",{className:"vis-bottom",x1:"0",y1:chartStage.height-.5,x2:chartStage.width,y2:chartStage.height-.5})),isThumbnail?measures.length>1?React.createElement("div",{className:"vis-measure-label"},measure.title):null:React.createElement(components_1.VisMeasureLabel,{measure:measure,datum:myDatum}),this.renderHighlighter(),bubble)};LineChart.prototype.getSelectionsFromEssence=function(essence){if(!essence||!essence.hasHighlight())return[];return essence.getSingleHighlightSet().elements.map(function(r){return{dragRange:r}})};LineChart.prototype.precalculate=function(props,datasetLoad){if(datasetLoad===void 0){datasetLoad=null}var registerDownloadableDataset=props.registerDownloadableDataset,registerCustomColors=props.registerCustomColors,essence=props.essence,timekeeper=props.timekeeper;var timezone=essence.timezone;var splits=essence.getConstrainedSplits();var colors=essence.getEffectiveColors();var existingDatasetLoad=this.state.datasetLoad;var newState={};newState.selections=this.getSelectionsFromEssence(essence);newState.dragOnMeasure=essence.getHighlightEffectiveMeasure();if(datasetLoad){if(datasetLoad.loading)datasetLoad.dataset=existingDatasetLoad.dataset;newState.datasetLoad=datasetLoad}else{datasetLoad=this.state.datasetLoad}if(splits.length()){var dataset=datasetLoad.dataset;if(dataset){if(registerDownloadableDataset)registerDownloadableDataset(dataset);var firstSplitValues=dataset.data[0][constants_1.SPLIT];if(colors&&colors.isLimitMode()&&firstSplitValues){var firstDim_1=splits.get(0).dimension;var newCustomColors=models_1.Colors.fromValues(firstDim_1,firstSplitValues.data.map(function(d){return d[firstDim_1]}));if(!newCustomColors.equals(this.state.customColors)){newState.customColors=newCustomColors;if(registerCustomColors)registerCustomColors(newCustomColors)}}}var continuousSplit=splits.length()===1?splits.get(0):splits.get(1);var continuousDimension=essence.getDimension(continuousSplit.dimension);if(continuousDimension){newState.continuousDimension=continuousDimension;var axisRange_1=this.getXAxisRange(dataset,continuousDimension);var filterRange=essence.getSpecificFilter(timekeeper).getExtent(continuousDimension.name);if(axisRange_1&&filterRange&&filterRange.isFinite()){axisRange_1=axisRange_1.extend(filterRange)}if(axisRange_1){newState.axisRange=axisRange_1;var domain=[axisRange_1.start,axisRange_1.end];var scaleFn=null;var labelFn=null;var ticks=null;if(continuousDimension.isTime()){scaleFn=d3_scale_1.scaleTime();labelFn=function(d){return time_1.formatAxisBasedOnRange(d,axisRange_1,timezone)};ticks=getLineChartTicksDuration(continuousDimension,axisRange_1,timezone)}else{scaleFn=d3_scale_1.scaleLinear();labelFn=floatFormat;ticks=getLineChartTicksNumber(continuousDimension,axisRange_1)}this._scaleX=scaleFn.domain(domain);this.setScaleXDomain(this.state.stage,this._scaleX);newState.xTicks=ticks;newState.tickFormatter=labelFn}}}this.setState(newState)};LineChart.prototype.getXAxisRange=function(dataset,continuousDimension){var _this=this;if(!dataset)return null;var key=continuousDimension.name;var firstDatum=dataset.data[0];var ranges;if(firstDatum[constants_1.SPLIT]){ranges=dataset.data.map(function(d){return _this.getXAxisRange(d[constants_1.SPLIT],continuousDimension)})}else{ranges=dataset.data.map(function(d){return d[key]})}return ranges.reduce(function(a,b){return a&&b?a.extend(b):a||b})};LineChart.prototype.hideBubble=function(){var _a=this.state,hoverRange=_a.hoverRange,hoverMeasure=_a.hoverMeasure;if(!hoverRange||!hoverMeasure)return;this.setState({hoverRange:null,hoverMeasure:null})};LineChart.prototype.onScroll=function(){var node=ReactDOM.findDOMNode(this.refs["container"]);if(!node)return;var _a=this.state,scrollTop=_a.scrollTop,scrollLeft=_a.scrollLeft;if(node.scrollTop!==scrollTop||node.scrollLeft!==scrollLeft){this.setState({hoverRange:null,hoverMeasure:null,scrollLeft:node.scrollLeft,scrollTop:node.scrollTop})}};LineChart.prototype.getXAxisHeight=function(){return this.state.canShowAxes?X_AXIS_HEIGHT:8};LineChart.prototype.renderXAxis=function(chartStage){if(!this.state.canShowAxes)return null;var _a=this.state,xTicks=_a.xTicks,tickFormatter=_a.tickFormatter;var xAxisHeight=this.getXAxisHeight();var xAxisStage=beltful_1.Stage.fromSize(chartStage.width,xAxisHeight);return React.createElement("svg",{className:"bottom-axis",width:xAxisStage.width,height:xAxisStage.height},React.createElement(components_1.LineChartAxis,{stage:xAxisStage,ticks:xTicks,tickFormatter:tickFormatter,scale:this._scaleX}))};LineChart.prototype.setScaleXDomain=function(stage,scale){if(!stage||!scale)return;scale.range([0,stage.width-constants_1.VIS_H_PADDING*2-this.getYAxisWidth()])};LineChart.prototype.beforeSizeUpdate=function(newStage){this.setScaleXDomain(newStage,this._scaleX)};LineChart.prototype.getChartStage=function(){var essence=this.props.essence;var stage=this.state.stage;var xAxisHeight=this.getXAxisHeight();var measures=essence.getEffectiveMeasures();var chartWidth=stage.width-constants_1.VIS_H_PADDING*2;var chartHeight=Math.max(MIN_CHART_HEIGHT,Math.floor(Math.min(chartWidth/MAX_ASPECT_RATIO,(stage.height-xAxisHeight)/measures.length)));return new beltful_1.Stage({x:constants_1.VIS_H_PADDING,y:0,width:chartWidth,height:chartHeight})};LineChart.prototype.renderInternals=function(){var _this=this;var _a=this.props,essence=_a.essence,noScroll=_a.noScroll;var _b=this.state,stage=_b.stage,datasetLoad=_b.datasetLoad,axisRange=_b.axisRange;var splits=essence.getConstrainedSplits();var measureCharts;var bottomAxis;if(datasetLoad.dataset&&splits.length()&&axisRange){var chartStage_1=this.getChartStage();measureCharts=essence.getEffectiveMeasures().map(function(measure,chartIndex){return _this.renderChart(datasetLoad.dataset,chartIndex,stage,chartStage_1)});bottomAxis=this.renderXAxis(chartStage_1)}var measureChartsStyle={maxHeight:stage.height-this.getXAxisHeight()};return React.createElement("div",{className:"internals line-chart-inner"},React.createElement(caladan_1.GlobalEventListener,{scroll:this.onScroll.bind(this)}),React.createElement("div",{style:measureChartsStyle,className:classNames("measure-line-charts",{"no-scroll":noScroll}),ref:"container"},measureCharts),bottomAxis)};LineChart.visName=models_1.LINE_CHART_MANIFEST.name;return LineChart}(base_visualization_1.BaseVisualization);exports.LineChart=LineChart},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);__webpack_require__(910);var Highlighter=function(_super){tslib_1.__extends(Highlighter,_super);function Highlighter(){return _super.call(this)||this}Highlighter.prototype.renderRange=function(from,to,i){if(from===to)return null;var style={width:to-from,left:from};return React.createElement("div",{key:"range-"+i,className:"frame",style:style})};Highlighter.prototype.renderBlank=function(from,to,i){if(from===to)return null;var style={width:to-from,left:from};return React.createElement("div",{key:"blank-"+i,className:"whiteout",style:style})};Highlighter.prototype.render=function(){var _this=this;var _a=this.props,ranges=_a.ranges,scaleX=_a.scaleX;var x=scaleX;if(!ranges)return null;ranges=ranges.sort(function(a,b){return a.compare(b)}).filter(function(r){return r.start!=r.end});if(!ranges.length)return null;var elements=[];var lastX=0;ranges.forEach(function(r,i){if(!r)return;elements.push(_this.renderBlank(lastX,x(r.start),i));elements.push(_this.renderRange(x(r.start),x(r.end),i));lastX=x(r.end)});elements.push(React.createElement("div",{key:"whiteout",className:"whiteout",style:{left:lastX,right:0}}));return React.createElement("div",{className:"highlighter"},elements)};return Highlighter}(React.Component);exports.Highlighter=Highlighter},function(module,exports,__webpack_require__){var content=__webpack_require__(911);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./highlighter.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./highlighter.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".highlighter{pointer-events:none}.highlighter .frame{position:absolute;height:100%;border:1px dashed #168bc5;border-radius:2px;z-index:1}.highlighter .frame .highlight-controls{position:absolute;right:-33px}.highlighter .whiteout{position:absolute;height:100%;background:#fff;opacity:0.5}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(913);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./line-chart.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./line-chart.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".line-chart .internals{overflow:hidden}.line-chart .internals .measure-line-charts{overflow-x:hidden;overflow-y:auto;padding-left:10px}.line-chart .internals .measure-line-charts.no-scroll{overflow:hidden}.line-chart .internals .measure-line-chart .vis-measure-label{position:absolute;left:6px;top:12px}.line-chart .internals .measure-line-chart .vis-bottom{pointer-events:none;stroke:#ccc}.line-chart .internals .measure-line-chart .highlighter{position:absolute;top:0;bottom:0;left:0;right:0}.line-chart .internals .measure-line-chart:nth-child(n+2) .highlighter .frame{border-top:0}.line-chart .internals .bottom-axis{padding-left:10px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var d3_array_1=__webpack_require__(742);var d3_scale_1=__webpack_require__(753);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var models_1=__webpack_require__(19);var segment_bubble_1=__webpack_require__(472);var formatter_1=__webpack_require__(186);var base_visualization_1=__webpack_require__(746);var grid_layout_1=__webpack_require__(770);__webpack_require__(915);var HEADER_HEIGHT=38;var MAX_SEGMENT_WIDTH=350;var MIN_SEGMENT_WIDTH=100;var SEGMENT_RATIO=.3;var INDENT_WIDTH=25;var MEASURE_WIDTH=130;var ROW_HEIGHT=30;var PADDING_LEFT=10;var PADDING_RIGHT=10;var HIGHLIGHT_BUBBLE_V_OFFSET=-4;var Table=function(_super){tslib_1.__extends(Table,_super);function Table(){return _super.call(this)||this}Table.prototype.getDefaultState=function(){var s=_super.prototype.getDefaultState.call(this);s.flatData=null;s.hoverRow=null;s.selectedRows=[];return s};Table.prototype.getSegmentWidth=function(){var stage=this.state.stage;return Math.max(Math.min(stage.width*SEGMENT_RATIO,MAX_SEGMENT_WIDTH),MIN_SEGMENT_WIDTH)};Table.prototype.getMeasureForX=function(x){var essence=this.props.essence;var measureIndex=Math.floor((x-this.getSegmentWidth())/this.getIdealMeasureWidth(essence));return essence.getEffectiveMeasures()[measureIndex]||null};Table.prototype.getDatumForY=function(y){var flatData=this.state.flatData;var rowIndex=Math.floor((y-HEADER_HEIGHT)/ROW_HEIGHT);return flatData?flatData[rowIndex]:null};Table.prototype.sortOn=function(expression){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var splits=essence.getConstrainedSplits();if(!clicker.changeSplits)return;var commonSort=splits.getCommonSort();var myDescending=commonSort&&commonSort.expression.equals(expression)&&commonSort.direction===plywood_1.SortExpression.DESCENDING;clicker.changeSplits(splits.changeSortActionFromNormalized(plywood_1.Expression._.sort(expression,myDescending?plywood_1.SortExpression.ASCENDING:plywood_1.SortExpression.DESCENDING)),models_1.VisStrategy.KeepAlways)};Table.prototype.handleMultiSelect=function(row){var _a=this.props,essence=_a.essence,clicker=_a.clicker;var splits=essence.getConstrainedSplits();var rowHighlight=base_visualization_1.BaseVisualization.getMultiFilter(splits,essence.highlight.delta,row);if(!rowHighlight){clicker.dropHighlight()}else{clicker.changeHighlight(new models_1.Highlight({measure:null,delta:rowHighlight}))}};Table.prototype.onClick=function(x,y,part,event){var _a=this.props,clicker=_a.clicker,essence=_a.essence;var splits=essence.getConstrainedSplits();if(part===caladan_1.Scroller.TOP_LEFT_CORNER){this.sortOn(plywood_1.$(models_1.SplitCombine.SORT_ON_DIMENSION_PLACEHOLDER))}else if(part===caladan_1.Scroller.TOP_GUTTER){this.sortOn(plywood_1.$(this.getMeasureForX(x).name))}else if(part===caladan_1.Scroller.BODY||part===caladan_1.Scroller.LEFT_GUTTER){if(!clicker.dropHighlight||!clicker.changeHighlight)return;var row=this.getDatumForY(y);if(!row)return;var rowHighlight=void 0;if(essence.hasHighlight()&&this.isMultiSelectEvent(event)){this.handleMultiSelect(row)}else{rowHighlight=base_visualization_1.BaseVisualization.getFilterFromDatum(splits,row)}if(!rowHighlight)return;if(essence.hasHighlight()){if(rowHighlight.equals(essence.highlight.delta)){clicker.dropHighlight();return}}clicker.changeHighlight(new models_1.Highlight({measure:null,delta:rowHighlight}))}};Table.prototype.onMouseMove=function(x,y,part){var newMeasure;var newDatum;if(part===caladan_1.Scroller.TOP_LEFT_CORNER||part===caladan_1.Scroller.TOP_GUTTER){newMeasure=this.getMeasureForX(x)}else if(part===caladan_1.Scroller.BODY||part===caladan_1.Scroller.LEFT_GUTTER){newDatum=this.getDatumForY(y)}this.changeStateIfNecessary({hoverMeasure:newMeasure,hoverRow:newDatum})};Table.prototype.changeStateIfNecessary=function(newState){var hasChanged=false;for(var key in newState){if(newState[key]!==this.state[key])hasChanged=true}if(hasChanged)this.setState(newState)};Table.prototype.onMouseLeave=function(){var _a=this.state,hoverMeasure=_a.hoverMeasure,hoverRow=_a.hoverRow;if(hoverMeasure||hoverRow){this.setState({hoverMeasure:null,hoverRow:null})}};Table.prototype.precalculate=function(props,datasetLoad){if(datasetLoad===void 0){datasetLoad=null}var registerDownloadableDataset=props.registerDownloadableDataset,essence=props.essence,isThumbnail=props.isThumbnail;var splits=essence.getConstrainedSplits();var existingDatasetLoad=this.state.datasetLoad;var newState={};if(datasetLoad){if(datasetLoad.loading)datasetLoad.dataset=existingDatasetLoad.dataset;newState.datasetLoad=datasetLoad}else{datasetLoad=this.state.datasetLoad}var dataset=datasetLoad.dataset;if(dataset&&splits.length()){if(registerDownloadableDataset)registerDownloadableDataset(dataset);var flatData=dataset.flatten({order:"preorder",nestingName:"__nest"}).data;if(isThumbnail&&flatData.length){flatData.shift()}newState.flatData=flatData;newState.selectedRows=this.precalculateSelection(newState.flatData,essence)}this.setState(newState)};Table.prototype.precalculateSelection=function(flatData,essence){var _this=this;if(!flatData||!essence)return[];var timezone=essence.timezone;var splits=essence.getConstrainedSplits();var selectedRows=[];flatData.forEach(function(d,i){var nest=d["__nest"];if(nest===0)return;var selected=_this.checkSelection(essence,d).selected;if(selected){var split=splits.get(nest-1);if(!split)return;selectedRows.push({y:i*ROW_HEIGHT,index:i,datum:d,segmentLabel:formatter_1.formatValue(d[split.dimension],timezone),dimension:essence.getDimension(split.dimension)})}});return selectedRows};Table.prototype.getScalesForColumns=function(essence,flatData){var measuresArray=essence.getEffectiveMeasures();var splits=essence.getConstrainedSplits();var splitLength=splits.length();return measuresArray.map(function(measure){var measureValues=flatData.filter(function(d){return d["__nest"]===splitLength}).map(function(d){return Math.abs(d[measure.name])});measureValues.push(0);return d3_scale_1.scaleLinear().domain(d3_array_1.extent(measureValues)).range([0,100])})};Table.prototype.getFormattersFromMeasures=function(essence,flatData){var measuresArray=essence.getEffectiveMeasures();return measuresArray.map(function(measure){var measureName=measure.name;var measureValues=flatData.map(function(d){return d[measureName]});return formatter_1.formatterFromData(measureValues,measure.getFormat())})};Table.prototype.getIdealMeasureWidth=function(essence){var availableWidth=this.state.stage.width-this.getSegmentWidth()-PADDING_RIGHT-PADDING_LEFT;var columnsCount=essence.getEffectiveMeasures().length;return columnsCount*MEASURE_WIDTH>=availableWidth?MEASURE_WIDTH:availableWidth/columnsCount};Table.prototype.makeMeasuresRenderer=function(essence,formatters,hScales){var measuresArray=essence.getEffectiveMeasures();var idealWidth=this.getIdealMeasureWidth(essence);var splits=essence.getConstrainedSplits();var splitLength=splits.length();var isSingleMeasure=measuresArray.length===1;var className=classNames("measure",{"all-alone":!!isSingleMeasure});return function(datum){return measuresArray.map(function(measure,i){var measureValue=datum[measure.name];var measureValueStr=formatters[i](measureValue);var background=null;if(datum["__nest"]===splitLength){var backgroundWidth=hScales[i](Math.abs(measureValue));background=React.createElement("div",{className:"background-container"},React.createElement("div",{className:classNames("background",measureValue>=0?"positive":"negative"),style:{width:backgroundWidth+"%"}}))}return React.createElement("div",{className:className,key:measure.name,style:{width:idealWidth}},background,React.createElement("div",{className:"label"},measureValueStr))})}};Table.prototype.renderHeaderColumns=function(essence,hoverMeasure,measureWidth){var splits=essence.getConstrainedSplits();var commonSort=splits.getCommonSort();var commonSortName=commonSort?commonSort.expression.name:null;var sortArrowIcon=commonSort?React.createElement(caladan_1.SvgIcon,{svg:Icons.SORT_ARROW,className:"sort-arrow "+commonSort.direction}):null;return essence.getEffectiveMeasures().map(function(measure,i){var amISorted=commonSortName===measure.name;return React.createElement("div",{className:classNames("measure-name",{hover:measure===hoverMeasure,sorted:amISorted}),key:measure.name,style:{width:measureWidth}},React.createElement("div",{className:"title-wrap"},measure.title),amISorted?sortArrowIcon:null)})};Table.prototype.renderCornerSortArrow=function(essence){var splits=essence.getConstrainedSplits();var commonSort=splits.getCommonSort();if(!commonSort)return null;if(commonSort.refName()===models_1.SplitCombine.SORT_ON_DIMENSION_PLACEHOLDER){return React.createElement(caladan_1.SvgIcon,{svg:Icons.SORT_ARROW,className:"sort-arrow "+commonSort.direction})}return null};Table.prototype.onSimpleScroll=function(scrollTop,scrollLeft){this.setState({scrollLeft:scrollLeft,scrollTop:scrollTop})};Table.prototype.onLimitReached=function(limit){var _a=this.props,essence=_a.essence,clicker=_a.clicker;if(window.toInfinityAndBeyond&&limit===caladan_1.Scroller.BOTTOM_LIMIT){var split=essence.getEffectiveSplits().get(0);var limit_1=split.limitAction.value;var newSplit=split.changeLimitAction(plywood_1.Expression._.limit(limit_1+50));clicker.changeSplit(newSplit,models_1.VisStrategy.UnfairGame)}};Table.prototype.getLayout=function(){var _a=this.props,noScroll=_a.noScroll,essence=_a.essence;var flatData=this.state.flatData;return new grid_layout_1.GridLayout({columns:essence.getEffectiveMeasures().length,rows:flatData?flatData.length:0,rowHeight:ROW_HEIGHT,columnWidth:this.getIdealMeasureWidth(essence),left:this.getSegmentWidth(),top:HEADER_HEIGHT,paddingBottom:50}).change("scrollable",!noScroll)};Table.prototype.checkSelection=function(essence,datum){var splits=essence.getConstrainedSplits();if(!essence.hasHighlight())return{selected:false,selectedClass:""};var highlightDelta=essence.highlight.delta;if(!highlightDelta)return{selected:false,selectedClass:""};var filter=base_visualization_1.BaseVisualization.getFilterFromDatum(splits,datum);if(!filter)return{selected:false,selectedClass:"not-selected"};var selected=base_visualization_1.BaseVisualization.isDatumSelected(highlightDelta,splits,datum);return{selected:selected,selectedClass:selected?"selected":"not-selected"}};Table.prototype.scrollIntoView=function(rowIndex){var stage=this.state.stage;var eventContainer=ReactDOM.findDOMNode(this._scroller).getElementsByClassName("event-container")[0];eventContainer.scrollTop=rowIndex*ROW_HEIGHT-stage.height/2+HEADER_HEIGHT};Table.prototype.renderHighlightBubble=function(){var _this=this;var _a=this.props,clicker=_a.clicker,openRawDataModal=_a.openRawDataModal;var _b=this.state,scrollTop=_b.scrollTop,selectedRows=_b.selectedRows,stage=_b.stage,selectionMode=_b.selectionMode;var row=selectedRows.sort(function(a,b){return a.y-b.y})[0];if(!row)return null;var n=selectedRows.length;var label=n>1?n+" selections":row.segmentLabel;var apparentY=row.y-scrollTop-HIGHLIGHT_BUBBLE_V_OFFSET;var selectionIsUp=apparentY<0;var selectionIsDown=apparentY>stage.height-HEADER_HEIGHT;if(selectionIsDown||selectionIsUp){return segment_bubble_1.SegmentBubble.getTinyIndicator({left:stage.x+stage.width/2,top:stage.y+HEADER_HEIGHT+(selectionIsUp?0:stage.height-HEADER_HEIGHT),direction:selectionIsUp?"down":"up",label:label,onClick:this.scrollIntoView.bind(this,row.index)})}return React.createElement(segment_bubble_1.SegmentBubble,{left:stage.x+stage.width/2,top:stage.y+HEADER_HEIGHT+row.y-scrollTop-HIGHLIGHT_BUBBLE_V_OFFSET,segmentLabel:label,dimensions:[row.dimension],clicker:clicker,openRawDataModal:openRawDataModal,toggleSelectionMode:function(){return _this.toggleSelectionMode()},selectionMode:selectionMode})};Table.prototype.renderHighlighters=function(){var _a=this.state,scrollTop=_a.scrollTop,selectedRows=_a.selectedRows;if(selectedRows.length===0)return[];var nest=selectedRows[0].datum["__nest"];var left=Math.max(0,nest-1)*INDENT_WIDTH;var spans=[];var lastRow;selectedRows.forEach(function(row){if(lastRow&&lastRow.index+1===row.index){spans[spans.length-1].height+=ROW_HEIGHT}else{spans.push({y:row.y,height:ROW_HEIGHT})}lastRow=row});return spans.map(function(span,i){return React.createElement("div",{className:"highlighter",key:"highlight-"+i,style:{top:span.y-scrollTop,left:left,height:span.height}})})};Table.prototype.renderInternals=function(){var _this=this;var _a=this.props,clicker=_a.clicker,essence=_a.essence;var _b=this.state,flatData=_b.flatData,scrollTop=_b.scrollTop,scrollLeft=_b.scrollLeft,hoverMeasure=_b.hoverMeasure,hoverRow=_b.hoverRow,stage=_b.stage;var timezone=essence.timezone;var splits=essence.getConstrainedSplits();var idealWidth=this.getIdealMeasureWidth(essence);var headerColumns=this.renderHeaderColumns(essence,hoverMeasure,idealWidth);var rowWidth=idealWidth*headerColumns.length;var segments=[];var rows=[];if(flatData){var formatters=this.getFormattersFromMeasures(essence,flatData);var hScales=this.getScalesForColumns(essence,flatData);var yBounds=this.getLayout().getVisibleIndices({scrollLeft:scrollLeft,scrollTop:scrollTop},stage).yBounds;var measuresRenderer=this.makeMeasuresRenderer(essence,formatters,hScales);var rowY=yBounds.from*ROW_HEIGHT;for(var i=yBounds.from;i<yBounds.to;i++){var d=flatData[i];var nest=d["__nest"];var split=nest>0?splits.get(nest-1):null;var dimension=split?split.dimension:null;var segmentValue=dimension?d[dimension]:"";var segmentLabel=nest?formatter_1.formatValue(segmentValue,timezone):"Total";var left=Math.max(0,nest-1)*INDENT_WIDTH;var segmentStyle={left:left,width:this.getSegmentWidth()-left,top:rowY};var hoverClass=d===hoverRow?"hover":null;var selectedClass=this.checkSelection(essence,d).selectedClass;var nestClass="nest"+nest;segments.push(React.createElement("div",{className:classNames("segment",nestClass,selectedClass,hoverClass),key:"_"+i,style:segmentStyle},segmentLabel));rows.push(React.createElement("div",{className:classNames("row",nestClass,selectedClass,hoverClass),key:"_"+i,style:{top:rowY,width:rowWidth}},measuresRenderer(d)));rowY+=ROW_HEIGHT}}var segmentLabels=React.createElement("div",{className:"segment-labels"},segments);var overlay=React.createElement("div",{className:"highlight-cont"},this.renderHighlighters());var corner=React.createElement("div",{className:"corner"},React.createElement("div",{className:"corner-wrap"},splits.getTitle(essence.getDimensions())),this.renderCornerSortArrow(essence));return React.createElement("div",{className:"internals table-inner"},React.createElement(caladan_1.Scroller,{ref:function(scroller){return _this._scroller=scroller},layout:this.getLayout().toScrollerLayout(stage),topGutter:headerColumns,leftGutter:segmentLabels,topLeftCorner:corner,body:rows,overlay:overlay,onClick:function(x,y,part,e){return _this.onClick(x,y,part,e)},onMouseMove:function(x,y,part){return _this.onMouseMove(x,y,part)},onMouseLeave:function(){return _this.onMouseLeave()},onScroll:function(scrollTop,scrollLeft){return _this.onSimpleScroll(scrollTop,scrollLeft)},onLimitReached:function(limit){return _this.onLimitReached(limit)}}),this.renderHighlightBubble())};Table.visName=models_1.TABLE_MANIFEST.name;return Table}(base_visualization_1.BaseVisualization);exports.Table=Table},function(module,exports,__webpack_require__){var content=__webpack_require__(916);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./table.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./table.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".table{left:10px}.table .scroller{position:absolute;top:0;bottom:0;left:0;right:0}.table .scroller .measure-name{background-color:#fff;border-bottom:1px solid #e6e6e6;padding-top:12px;white-space:nowrap;padding-left:10px;display:inline-block;width:130px;height:100%}.table .scroller .measure-name>.title-wrap{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;display:inline-block;height:100%;padding-left:4px;max-width:100%}.table .scroller .measure-name.sorted>.title-wrap{max-width:calc(100% - 15px)}.table .scroller .measure-name>.sort-arrow{width:8px;right:-4px}.table .scroller .measure-name>.sort-arrow.ascending{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.table .scroller.has-top-shadow .measure-name,.table .scroller.has-top-shadow .corner{border-bottom:0}.table .scroller .row{position:absolute;height:30px;border-bottom:1px solid #e6e6e6;left:0;white-space:nowrap}.table .scroller .row.hover{background:#e3f4fc}.table .scroller .row.selected{background:#e3f4fc}.table .scroller .row.not-selected{color:#a6a6a6}.table .scroller .row>.measure{white-space:nowrap;padding-left:10px;overflow:hidden;padding-top:8px;display:inline-block;width:130px;height:calc(100% + 2px);margin-top:-1px}.table .scroller .row>.measure.all-alone{width:100%}.table .scroller .row>.measure>.background-container{position:absolute;top:0;left:10px;right:0;bottom:0}.table .scroller .row>.measure>.background-container>.background{height:100%}.table .scroller .row>.measure>.background-container>.background.negative{background-color:rgba(255,110,26,0.2);border-top:1px solid #ebcebd;border-bottom:1px solid #ebcebd}.table .scroller .row>.measure>.background-container>.background.positive{background-color:rgba(30,163,230,0.2);border-top:1px solid #b8d7e3;border-bottom:1px solid #b8d7e3}.table .scroller .row>.measure>.label{padding-left:4px}.table .scroller .highlight-cont{position:absolute;left:0;right:0;top:38px;bottom:0;overflow:hidden}.table .scroller .highlight-cont .highlighter{position:absolute;right:0;height:31px;margin-top:-1px;border:1px solid #e3f4fc}.table .scroller .highlight-cont .highlighter::after{position:absolute;top:-1px;bottom:-1px;left:-1px;right:-1px;content:'';border:1px dashed #168bc5}.table .scroller .left-gutter,.table .scroller .top-left-corner{background-color:#fff;border-top-left-radius:2px;border-bottom-left-radius:2px}.table .scroller .corner{position:absolute;background-color:#fff;left:0;top:0;width:100%;height:38px;overflow:hidden;padding:12px 0 0 6px;border-bottom:1px solid #e6e6e6}.table .scroller .corner>.corner-wrap{display:inline-block;max-width:calc(100% - 10px)}.table .scroller .corner .sort-arrow{width:8px;right:-4px}.table .scroller .corner .sort-arrow.ascending{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.table .scroller .segment-labels .segment{position:absolute;height:30px;border-bottom:1px solid #e6e6e6;left:0;background-color:#fff;white-space:nowrap;padding-left:6px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;padding-top:8px}.table .scroller .segment-labels .segment.hover{background:#e3f4fc}.table .scroller .segment-labels .segment.selected{background:#e3f4fc}.table .scroller .segment-labels .segment.not-selected{color:#a6a6a6}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var two_dimensional_data_loader_1=__webpack_require__(757);var grid_layout_1=__webpack_require__(770);var two_dimensional_base_1=__webpack_require__(804);__webpack_require__(921);var LEFT_GUTTER_WIDTH=150;var BOTTOM_GUTTER_HEIGHT=100;var TOP_GUTTER_HEIGHT=30;var MIN_TILE_HEIGHT=20;var MIN_TILE_WIDTH=20;var THUMBNAIL_MIN_TILE_HEIGHT=2;var THUMBNAIL_MIN_TILE_WIDTH=2;var X_LABEL_WIDTH=100;var PADDING=20;var Heatmap=function(_super){tslib_1.__extends(Heatmap,_super);function Heatmap(){var _this=_super.call(this)||this;_this.minColor="#e67320";_this.maxColor="#006088";_this.state={};return _this}Heatmap.prototype.getLayout=function(){var isThumbnail=this.props.isThumbnail;var _a=this.state,stage=_a.stage,datasetLoad=_a.datasetLoad,canShowAxes=_a.canShowAxes;var minWidth=canShowAxes?MIN_TILE_WIDTH:THUMBNAIL_MIN_TILE_WIDTH;var minHeight=canShowAxes?MIN_TILE_HEIGHT:THUMBNAIL_MIN_TILE_HEIGHT;var _b=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesDatasets(datasetLoad.dataset),xDataset=_b.xDataset,yDataset=_b.yDataset;var layout=new grid_layout_1.GridLayout({bottom:canShowAxes?BOTTOM_GUTTER_HEIGHT:0,top:isThumbnail?0:canShowAxes?TOP_GUTTER_HEIGHT:0,left:canShowAxes?LEFT_GUTTER_WIDTH:0,paddingTop:PADDING,paddingRight:PADDING,paddingLeft:PADDING,rows:yDataset.data.length,columns:xDataset.data.length});var _c=layout.getIdealCellSize(stage),width=_c.width,height=_c.height;layout=layout.change("rowHeight",Math.floor(Math.max(height,minHeight))).change("columnWidth",Math.floor(Math.max(width,minWidth)));return layout};Heatmap.prototype.renderBottomGutter=function(xDataset){var essence=this.props.essence;var scrollLeft=this.state.scrollLeft;var layout=this.getLayout();var xDimension=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesDimensions(essence).xDimension;var formatter=xDimension.isTime()?this.getTimeTickFormatter(xDimension):String;var firstVisibleTick=Math.floor((scrollLeft+layout.columnWidth/2)/layout.columnWidth);return xDataset.data.map(function(datum,i){if(i<firstVisibleTick)return null;var style={position:"absolute",width:X_LABEL_WIDTH,left:layout.columnWidth*(i+.5)-X_LABEL_WIDTH};return React.createElement("div",{className:"x-tick",key:i,style:style},formatter(datum["v"]))}).filter(Boolean)};Heatmap.prototype.renderTopGutter=function(){return React.createElement("div",null)};Heatmap.prototype.renderLeftGutter=function(yDataset){var essence=this.props.essence;var _a=this.state,yIndices=_a.yIndices,selectionInfos=_a.selectionInfos;var layout=this.getLayout();var yDimension=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesDimensions(essence).yDimension;var formatter=yDimension.isTime()?this.getTimeTickFormatter(yDimension):String;return yDataset.data.map(function(d,i){var y=yIndices[d.v];var style={top:y*layout.rowHeight,height:layout.rowHeight,width:layout.left};return React.createElement("div",{key:i,style:style,className:"y-tick"},formatter(d["v"]))})};Heatmap.prototype.renderBody=function(){var _this=this;var essence=this.props.essence;var _a=this.state,selectionInfos=_a.selectionInfos,xIndices=_a.xIndices,yIndices=_a.yIndices,datasetLoad=_a.datasetLoad;var _b=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesFields(essence),xField=_b.xField,yField=_b.yField;var measure=essence.getEffectiveMeasures()[0];var layout=this.getLayout();var body=layout.getBodySize();var alphaFn=function(info){var selected=selectionInfos&&selectionInfos.contains({y:info.rowIndex,x:info.columnIndex});var faded=selectionInfos.length&&!selected;return faded?.5:1};var tiles=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getCellsData(datasetLoad).map(function(datum,i){return{rowIndex:yIndices[String(datum[yField])],columnIndex:xIndices[String(datum[xField])],datum:datum,color:String(_this.colorize(datum[measure.name]))}});var MyColorMap=caladan_1.ColorMap.specialize();return React.createElement(MyColorMap,{alpha:alphaFn,tileHeight:layout.rowHeight,tileWidth:layout.columnWidth,height:body.height,width:body.width,tiles:tiles})};Heatmap.visName=models_1.HEATMAP_MANIFEST.name;return Heatmap}(two_dimensional_base_1.TwoDimensionalBase);exports.Heatmap=Heatmap},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var immutable_class_1=__webpack_require__(7);var base_visualization_1=__webpack_require__(746);var two_dimensional_data_loader_1=__webpack_require__(757);var cell_info_1=__webpack_require__(805);var models_1=__webpack_require__(19);var SelectionController=function(){function SelectionController(component){this.component=component}SelectionController.prototype.setState=function(state,callback){return this.component.setState.call(this.component,state,callback)};SelectionController.prototype.getSelections=function(essence,datasetLoad,xIndices,yIndices){var measure=essence.getEffectiveMeasures()[0];if(!essence.highlight||!xIndices||!yIndices)return new cell_info_1.CellInfos;var _a=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesFields(essence),xField=_a.xField,yField=_a.yField;var selectedXIndices=[-1];var selectedYIndices=[-1];var filter=essence.highlight.delta;filter.clauses.forEach(function(clause){if(clause.dimension===xField){selectedXIndices=clause.values.elements.map(function(e){return xIndices[e]}).filter(function(i){return i!==undefined})}else if(clause.dimension===yField){selectedYIndices=clause.values.elements.map(function(e){return yIndices[e]}).filter(function(i){return i!==undefined})}});return cell_info_1.CellInfos.fromIndices(selectedXIndices,selectedYIndices)};SelectionController.prototype.handleSelect=function(columnIndex,rowIndex,flatDatum,event){var essence=this.component.props.essence;var selectionInfos=this.component.state.selectionInfos;this.setState({hoverInfo:null});var splits=essence.getConstrainedSplits();if(columnIndex===-1){splits=models_1.Splits.fromJS([splits.get(0).toJS()])}else if(rowIndex===-1){splits=models_1.Splits.fromJS([splits.get(1).toJS()])}if(columnIndex>-1&&rowIndex>-1&&selectionInfos.hasFullCells()){this.handleSingleSelect(flatDatum,splits)}else if(this.component.isMultiSelectEvent(event)&&essence.highlight){this.handleMultiSelect(flatDatum,splits)}else{this.handleSingleSelect(flatDatum,splits)}};SelectionController.prototype.flipFilter=function(filter){return filter?filter.changeClauses([filter.clauses[1],filter.clauses[0]]):undefined};SelectionController.prototype.handleMultiSelect=function(flatDatum,splits){var _a=this.component.props,clicker=_a.clicker,essence=_a.essence;var measure=essence.getEffectiveMeasures()[0];var delta=essence.highlight.delta;var firstSplitSelection=immutable_class_1.generalEqual(delta.clauses[0].values.elements[0],flatDatum[splits.get(0).dimension]);var filter;if(!firstSplitSelection&&splits.length()>1){splits=new models_1.Splits([splits.get(1),splits.get(0)]);filter=this.flipFilter(delta);filter=base_visualization_1.BaseVisualization.getMultiFilter(splits,filter,flatDatum);filter=this.flipFilter(filter)}else{filter=base_visualization_1.BaseVisualization.getMultiFilter(splits,delta,flatDatum)}if(!filter){clicker.dropHighlight()}else{clicker.changeHighlight(new models_1.Highlight({measure:measure.name,delta:filter}))}};SelectionController.prototype.handleSingleSelect=function(flatDatum,splits){var _a=this.component.props,clicker=_a.clicker,essence=_a.essence;var measure=essence.getEffectiveMeasures()[0];var filter=base_visualization_1.BaseVisualization.getFilterFromDatum(splits,flatDatum);if(!filter)return;if(essence.hasHighlight(measure.name)){if(filter.equals(essence.highlight.delta)){clicker.dropHighlight();return}}clicker.changeHighlight(new models_1.Highlight({measure:measure.name,delta:filter}))};return SelectionController}();exports.SelectionController=SelectionController},function(module,exports,__webpack_require__){var content=__webpack_require__(920);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./two-dimensional-base.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./two-dimensional-base.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".two-dimensional-base.no-scroll{overflow:hidden}.two-dimensional-base .scroller{position:relative;height:100%}.two-dimensional-base .scroller .left-gutter,.two-dimensional-base .scroller .top-gutter,.two-dimensional-base .scroller .top-left-corner{background-color:white}.two-dimensional-base .scroller .bottom-gutter{overflow:visible;background-color:white;z-index:1}.two-dimensional-base .selection-highlight{pointer-events:none;border:1px dashed #1ea3e6}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(922);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./heatmap.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./heatmap.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".heatmap .vis-measure-label{padding-left:16px;padding-top:12px}.heatmap .x-tick,.heatmap .y-tick{position:absolute;text-align:right;-o-text-overflow:ellipsis;text-overflow:ellipsis;overflow:hidden}.heatmap .x-tick{height:20px;-webkit-transform:rotate(-45deg);-ms-transform:rotate(-45deg);transform:rotate(-45deg);top:40px;margin-left:20px}.heatmap .y-tick{-webkit-transform:translate(0, 20%);-ms-transform:translate(0, 20%);transform:translate(0, 20%);padding-left:15px;padding-right:10px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(924);var React=__webpack_require__(1);var classNames=__webpack_require__(4);var caladan_1=__webpack_require__(10);var models_1=__webpack_require__(19);var two_dimensional_data_loader_1=__webpack_require__(757);var grid_layout_1=__webpack_require__(770);var two_dimensional_base_1=__webpack_require__(804);var HEADER_HEIGHT=38;var MAX_SEGMENT_WIDTH=300;var MIN_SEGMENT_WIDTH=50;var ROW_HEIGHT=30;var Grid=function(_super){tslib_1.__extends(Grid,_super);function Grid(){var _this=_super.call(this)||this;_this.state={};return _this}Grid.prototype.isInteractionAuthorized=function(part){return[caladan_1.Scroller.BODY,caladan_1.Scroller.TOP_GUTTER,caladan_1.Scroller.LEFT_GUTTER].indexOf(part)>-1};Grid.prototype.getColumnWidth=function(){return 100};Grid.prototype.getLeftGutterWidth=function(){var stage=this.state.stage;return Math.round(Math.max(Math.min(stage.width*.2,MAX_SEGMENT_WIDTH),MIN_SEGMENT_WIDTH))};Grid.prototype.getLayout=function(){var noScroll=this.props.noScroll;var _a=this.state,xIndices=_a.xIndices,yIndices=_a.yIndices;return new grid_layout_1.GridLayout({columns:Object.keys(xIndices).length,rows:Object.keys(yIndices).length,rowHeight:ROW_HEIGHT,columnWidth:this.getColumnWidth(),left:this.getLeftGutterWidth(),top:HEADER_HEIGHT,paddingBottom:20,paddingRight:20}).change("scrollable",!noScroll)};Grid.prototype.renderTopGutter=function(xDataset){var essence=this.props.essence;var columnWidth=this.getColumnWidth();var _a=this.state,xIndices=_a.xIndices,selectionInfos=_a.selectionInfos;var xDimension=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesDimensions(essence).xDimension;var formatter=xDimension.isTime()?this.getTimeTickFormatter(xDimension):String;return xDataset.data.map(function(d,i){var x=xIndices[d.v];var style={left:x*columnWidth,width:columnWidth,height:HEADER_HEIGHT};var selected=selectionInfos.contains({x:x,y:-1});var faded=!selectionInfos.isEmpty()&&!selected;return React.createElement("div",{key:i,style:style,className:classNames("x-split-value",{faded:faded,selected:selected})},formatter(d.v))})};Grid.prototype.renderLeftGutter=function(yDataset){var essence=this.props.essence;var _a=this.state,yIndices=_a.yIndices,selectionInfos=_a.selectionInfos;var leftGutterWidth=this.getLeftGutterWidth();var yDimension=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesDimensions(essence).yDimension;var formatter=yDimension.isTime()?this.getTimeTickFormatter(yDimension):String;return yDataset.data.map(function(d,i){var y=yIndices[d.v];var style={top:y*ROW_HEIGHT,height:ROW_HEIGHT,width:leftGutterWidth};var selected=selectionInfos.contains({x:-1,y:y});var faded=!selectionInfos.isEmpty()&&!selected;return React.createElement("div",{key:i,style:style,className:classNames("y-split-value",{faded:faded,selected:selected})},formatter(d.v))})};Grid.prototype.renderGrid=function(xDataset,yDataset){var columnWidth=this.getColumnWidth();var vLines=xDataset.data.map(function(x,i){return React.createElement("div",{key:"v-"+i,className:"grid-line vertical",style:{left:i*columnWidth}})});var hLines=yDataset.data.map(function(y,i){return React.createElement("div",{key:"h-"+i,className:"grid-line horizontal",style:{top:(i+1)*ROW_HEIGHT-1}})});return hLines.concat(vLines)};Grid.prototype.renderBody=function(xDataset,yDataset){var _this=this;var essence=this.props.essence;var _a=this.state,datasetLoad=_a.datasetLoad,scrollTop=_a.scrollTop,scrollLeft=_a.scrollLeft,stage=_a.stage;var layout=this.getLayout();var isVisible=layout.getVisibilityChecker({scrollTop:scrollTop,scrollLeft:scrollLeft},stage);var _b=this.state,xIndices=_b.xIndices,yIndices=_b.yIndices,selectionInfos=_b.selectionInfos;var _c=two_dimensional_data_loader_1.TwoDimensionalDataLoader.getAxesFields(essence),xField=_c.xField,yField=_c.yField;var valueField=essence.getEffectiveMeasures()[0].name;var cells=[];two_dimensional_data_loader_1.TwoDimensionalDataLoader.getCellsData(datasetLoad).forEach(function(d,i){var x=xIndices[d[xField]];var y=yIndices[d[yField]];if(!isVisible(x,y))return;var style={top:y*layout.rowHeight,left:x*layout.columnWidth,backgroundColor:_this.colorize(d[valueField]),width:layout.columnWidth,height:layout.rowHeight};var selected=selectionInfos.contains({x:x,y:y});var faded=!selectionInfos.isEmpty()&&!selected;cells.push(React.createElement("div",{className:classNames("cell",{faded:faded,selected:selected}),key:i,style:style},d[valueField]))});return cells.concat(this.renderGrid(xDataset,yDataset))};Grid.visName=models_1.GRID_MANIFEST.name;return Grid}(two_dimensional_base_1.TwoDimensionalBase);exports.Grid=Grid},function(module,exports,__webpack_require__){var content=__webpack_require__(925);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./grid.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./grid.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".grid{margin-left:10px}.grid .x-split-value,.grid .y-split-value,.grid .cell{color:#000;position:absolute;padding:8px 0 0 8px;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.grid .x-split-value.selected,.grid .y-split-value.selected,.grid .cell.selected{color:#000}.grid .x-split-value.faded,.grid .y-split-value.faded,.grid .cell.faded{color:#999}.grid .top-left-corner,.grid .y-split-value{border-bottom:1px solid #e6e6e6}.grid .x-split-value{border-left:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6}.grid .grid-line{position:absolute}.grid .grid-line.vertical{border-left:1px solid #e6e6e6;top:0;bottom:0}.grid .grid-line.horizontal{border-bottom:1px solid #e6e6e6;left:0;right:0}.grid .vis-measure-label{padding-left:8px;padding-top:12px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var base_visualization_1=__webpack_require__(746);__webpack_require__(927);var PADDING_H=60;var TOTAL_WIDTH=176;var Totals=function(_super){tslib_1.__extends(Totals,_super);function Totals(){return _super.call(this)||this}Totals.prototype.componentWillReceiveProps=function(nextProps){this.precalculate(nextProps);var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper;var nextEssence=nextProps.essence;var nextTimekeeper=nextProps.timekeeper;if(nextEssence.differentDataCube(essence)||nextEssence.differentSpecificFilter(essence,timekeeper,nextTimekeeper)||nextEssence.newEffectiveMeasures(essence)){this.fetchData(nextEssence,nextTimekeeper)}};Totals.prototype.makeQuery=function(essence,timekeeper){var dimensions=essence.getDimensions();var query=plywood_1.ply().apply("main",plywood_1.$("main").filter(essence.getSpecificFilter(timekeeper).toExpression(dimensions)));essence.getEffectiveMeasures().forEach(function(measure){query=query.performAction(measure.toApplyAction(0))});return query};Totals.prototype.precalculate=function(props,datasetLoad){if(datasetLoad===void 0){datasetLoad=null}var registerDownloadableDataset=props.registerDownloadableDataset;var existingDatasetLoad=this.state.datasetLoad;var newState={};if(datasetLoad){if(datasetLoad.loading)datasetLoad.dataset=existingDatasetLoad.dataset;newState.datasetLoad=datasetLoad}else{datasetLoad=existingDatasetLoad}var dataset=datasetLoad.dataset;if(dataset){if(registerDownloadableDataset)registerDownloadableDataset(dataset)}this.setState(newState)};Totals.prototype.getGeneratedLayout=function(){var essence=this.props.essence;var layout={wrapped:false,columns:0};if(!this._totalsContainer)return layout;var children=Array.from(this._totalsContainer.children);var measures=essence.getEffectiveMeasures();var lastTop=0;for(var i=0;i<measures.length;i++){var c=children[i];if(!c)break;var rect=c.getBoundingClientRect();if(i===0)lastTop=rect.top;if(lastTop!==rect.top){layout.wrapped=true;layout.columns=i;break}}if(!layout.wrapped)layout.columns=children.length;return layout};Totals.prototype.componentDidUpdate=function(){var generatedLayout=this.state.generatedLayout;var newLayout=this.getGeneratedLayout();if(!generatedLayout||(generatedLayout.wrapped!==newLayout.wrapped||generatedLayout.columns!==newLayout.columns)){this.setState({generatedLayout:newLayout})}};Totals.prototype.renderInternals=function(){var _this=this;var _a=this.props,essence=_a.essence,noScroll=_a.noScroll;var _b=this.state,stage=_b.stage,datasetLoad=_b.datasetLoad,generatedLayout=_b.generatedLayout;var myDatum=datasetLoad.dataset?datasetLoad.dataset.data[0]:null;var measures=essence.getEffectiveMeasures();var single=measures.length===1;var small=stage.height<100||stage.width<200;var totals=measures.map(function(measure){return React.createElement("div",{className:classNames("total",{single:single,small:small}),key:measure.name},React.createElement("div",{className:"measure-name"},measure.title),React.createElement("div",{className:"measure-value"},myDatum?measure.formatDatum(myDatum):"-"))});if(generatedLayout&&generatedLayout.wrapped){for(var i=0;i<generatedLayout.columns;i++){totals.push(React.createElement("div",{className:"total",key:totals.length}))}}return React.createElement("div",{className:classNames("internals",{"no-scroll":noScroll})},React.createElement("div",{className:classNames("total-container",{small:stage.height<400}),ref:function(c){return _this._totalsContainer=c}},totals))};Totals.visName=models_1.TOTALS_MANIFEST.name;return Totals}(base_visualization_1.BaseVisualization);exports.Totals=Totals},function(module,exports,__webpack_require__){var content=__webpack_require__(928);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./totals.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./totals.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".totals .internals.no-scroll{overflow:hidden}.totals .total-container{position:absolute;height:100%;min-height:-webkit-min-content;min-height:-moz-min-content;min-height:min-content;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-line-pack:start;align-content:flex-start;padding-top:80px}.totals .total-container.small{padding-top:0px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-line-pack:center;align-content:center}@media only screen and (max-width: 1080px){.totals .total-container{padding-top:0px;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-line-pack:center;align-content:center}}.totals .total{-webkit-box-flex:0;-ms-flex:0 1 176px;flex:0 1 176px;text-align:center;margin-top:8px;margin-bottom:8px;font-size:30px}.totals .total.small{font-size:22px}.totals .total .measure-name{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;width:100%;cursor:default;font-size:0.5em;padding-bottom:8px;color:#999}.totals .total .measure-value{width:100%;cursor:default;font-size:1em}.totals .total.single{width:100%}.totals .total.single .measure-name{font-size:0.7em;padding-bottom:11px}.totals .total.single .measure-value{font-size:1.5em}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var immutable_class_1=__webpack_require__(7);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var components_1=__webpack_require__(466);var options_menu_1=__webpack_require__(467);var description_icon_1=__webpack_require__(470);var strings_1=__webpack_require__(17);var collection_tile_1=__webpack_require__(385);__webpack_require__(930);var CubeHeaderBar=function(_super){tslib_1.__extends(CubeHeaderBar,_super);function CubeHeaderBar(){var _this=_super.call(this)||this;_this.state={animating:false};return _this}CubeHeaderBar.prototype.componentDidMount=function(){this.mounted=true;var actualDataCube=this.props.essence.actualDataCube;this.setAutoRefreshFromDataCube(actualDataCube)};CubeHeaderBar.prototype.componentWillReceiveProps=function(nextProps){var _this=this;if(this.props.essence.dataCube!==nextProps.essence.dataCube){this.setAutoRefreshFromDataCube(nextProps.essence.actualDataCube)}if(!this.props.updatingTimekeeper&&nextProps.updatingTimekeeper){this.setState({animating:true});setTimeout(function(){if(!_this.mounted)return;_this.setState({animating:false})},1e3)}};CubeHeaderBar.prototype.componentWillUnmount=function(){this.mounted=false;this.clearTimerIfExists()};CubeHeaderBar.prototype.setAutoRefreshFromDataCube=function(dataCube){if(dataCube.getRefreshTimeWith()!=="query")return;this.setAutoRefreshRate(dataCube.getDefaultRefreshRate())};CubeHeaderBar.prototype.setAutoRefreshRate=function(rate){var autoRefreshRate=this.state.autoRefreshRate;if(immutable_class_1.immutableEqual(autoRefreshRate,rate))return;this.clearTimerIfExists();var onRefreshMaxTime=this.props.onRefreshMaxTime;if(onRefreshMaxTime&&rate){this.autoRefreshTimer=setInterval(function(){onRefreshMaxTime()},rate.getCanonicalLength())}this.setState({autoRefreshRate:rate})};CubeHeaderBar.prototype.clearTimerIfExists=function(){if(this.autoRefreshTimer){clearInterval(this.autoRefreshTimer);this.autoRefreshTimer=null}};CubeHeaderBar.prototype.renderAddToCollectionMenu=function(target){var _a=this.props,settings=_a.settings,controller=_a.controller,essence=_a.essence;var addToNew=function(){var newCollection=new models_1.Collection({name:beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!settings.getCollection(name)}}),tiles:[collection_tile_1.CollectionTile.fromEssence("t01",essence)],title:"New dashboard"});controller.editCollection(newCollection,"create")};var addToExisting=function(collection){var newTileName=beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!collection.getCollectionTile(name)}});var newTile=collection_tile_1.CollectionTile.fromEssence(newTileName,essence);controller.editCollection(collection.addOrUpdateTile(newTile),"update")};return React.createElement(caladan_1.BubbleMenu,{className:"add-to-collection-menu",direction:"down",stage:beltful_1.Stage.fromSize(200,200),openOn:target},React.createElement("ul",{className:"bubble-list"},React.createElement("div",{className:"item new-dashboard",onClick:addToNew},React.createElement("div",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.DASHBOARD})),React.createElement("div",{className:"item-title"},strings_1.STRINGS.addToNewDashboard)),settings.collections.length?React.createElement("li",{className:"label"},strings_1.STRINGS.addToExisting+":"):null,settings.collections.map(function(c){return React.createElement("li",{key:c.name,className:"existing",onClick:function(){return addToExisting(c)}},c.title)})))};CubeHeaderBar.prototype.renderHilukMenu=function(target){var _a=this.props,essence=_a.essence,timekeeper=_a.timekeeper,getLongUrl=_a.getLongUrl,customization=_a.customization,getDownloadableDataset=_a.getDownloadableDataset;var externalViews=null;if(customization&&customization.externalViews){externalViews=customization.externalViews}return React.createElement(components_1.HilukMenu,{essence:essence,timekeeper:timekeeper,openOn:target,getLongUrl:getLongUrl,externalViews:externalViews,getDownloadableDataset:getDownloadableDataset})};CubeHeaderBar.prototype.renderUserMenu=function(target){var _a=this.props,user=_a.user,customization=_a.customization,stateful=_a.stateful;var canEdit=user&&user.canAccessSettings()&&stateful&&customization.getSettingsMode()!==models_1.Customization.SETTINGS_MODE_SUPPRESSED;return React.createElement(components_1.UserMenu,{showSettings:canEdit,openOn:target,user:user,customization:customization})};CubeHeaderBar.prototype.renderOptionsMenu=function(target){var _this=this;var _a=this.props,clicker=_a.clicker,customization=_a.customization,essence=_a.essence,openRawDataModal=_a.openRawDataModal,openMonitorModal=_a.openMonitorModal,timekeeper=_a.timekeeper,onRefreshMaxTime=_a.onRefreshMaxTime;var autoRefreshRate=this.state.autoRefreshRate;var setAutoRefreshRate=null;var refreshText=null;if(essence.hasSpecialTimeDimension()){setAutoRefreshRate=function(rate){return _this.setAutoRefreshRate(rate)};refreshText=essence.updatedText(timekeeper)}return React.createElement(options_menu_1.OptionsMenu,{timezone:essence.timezone,customization:customization,changeTimezone:clicker.changeTimezone,autoRefreshRate:autoRefreshRate,setAutoRefreshRate:setAutoRefreshRate,onRefreshMaxTime:onRefreshMaxTime,refreshText:refreshText,openOn:target,openRawDataModal:openRawDataModal,openMonitorModal:openMonitorModal})};CubeHeaderBar.prototype.getLeftChildren=function(){var _a=this.props,controller=_a.controller,essence=_a.essence,clicker=_a.clicker;var actualDataCube=essence.actualDataCube;var items=[{id:"menu-icon",className:"menu-icon",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.MENU}),onClick:controller.openSideDrawer},{id:"title",className:"title",content:actualDataCube.title,onClick:controller.openSideDrawer}];if(actualDataCube.instances){var InstanceDropdown=caladan_1.Dropdown.specialize();items.push(React.createElement(InstanceDropdown,{key:"instances",className:"instances",items:actualDataCube.instances.getValues(),selectedItem:essence.instance,renderItem:function(p){return p},onSelect:function(instance){return clicker.changeInstance(instance)}}))}if(actualDataCube.description){items.push(React.createElement(description_icon_1.DescriptionIcon,{key:"icon",description:actualDataCube.description}))}return items};CubeHeaderBar.prototype.getRightChildren=function(){var _this=this;var _a=this.props,controller=_a.controller,user=_a.user,onEditClick=_a.onEditClick,stateful=_a.stateful,goBack=_a.goBack;var animating=this.state.animating;var items=[];if(animating){items.push({id:"auto-refresh",className:classNames("icon-button","auto-refresh","refreshing"),content:React.createElement(caladan_1.SvgIcon,{className:"auto-refresh-icon",svg:Icons.FULL_REFRESH}),tooltip:"Refreshing"})}if(goBack){items.push({id:"button-group",className:"button-group",content:[React.createElement(caladan_1.Button,{key:"go-back",className:"go-back cancel",title:goBack.label,type:"secondary",onClick:function(){return goBack.fn()}})]})}if(stateful){items.push({id:"add-to-collection",className:"icon-button add-to-collection",content:React.createElement(caladan_1.SvgIcon,{className:"add-to-collection",svg:Icons.ADD_TO_COLLECTION}),renderMenu:function(target){return _this.renderAddToCollectionMenu(target)},tooltip:"Add to collection"})}items.push({id:"hiluk",className:"icon-button hiluk",content:React.createElement(caladan_1.SvgIcon,{className:"hiluk-icon",svg:Icons.FULL_HILUK}),renderMenu:function(target){return _this.renderHilukMenu(target)},tooltip:"Share link"},{id:"toggles",className:"icon-button toggles",content:React.createElement(caladan_1.SvgIcon,{className:"toggles-icon",svg:Icons.TOGGLES}),renderMenu:function(target){return _this.renderOptionsMenu(target)},tooltip:"Cube options"});if(stateful){items.push({id:"edit",className:"icon-button edit",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_EDIT}),onClick:onEditClick,tooltip:"Edit this cube"})}items.push({id:"user-button",className:"icon-button user",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_PROFILE}),renderMenu:function(target){return _this.renderUserMenu(target)},tooltip:"Me"});return items};CubeHeaderBar.prototype.render=function(){var _a=this.props,essence=_a.essence,customization=_a.customization;return React.createElement(caladan_1.HeaderBar,{className:"cube-header-bar",style:{background:customization.getPreferredTheme(essence.actualDataCube.theme).mainColor},leftChildren:this.getLeftChildren(),rightChildren:this.getRightChildren()})};return CubeHeaderBar}(React.Component);exports.CubeHeaderBar=CubeHeaderBar},function(module,exports,__webpack_require__){var content=__webpack_require__(931);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./cube-header-bar.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./cube-header-bar.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".add-to-collection-menu.bubble-menu ul.bubble-list{overflow:auto;height:100%}.add-to-collection-menu.bubble-menu ul.bubble-list .item{height:30px;padding:5px 0;cursor:pointer}.add-to-collection-menu.bubble-menu ul.bubble-list .item:hover{background-color:rgba(30,163,230,0.12)}.add-to-collection-menu.bubble-menu ul.bubble-list .item .icon{position:absolute;width:19px;height:19px;padding:0;left:10px}.add-to-collection-menu.bubble-menu ul.bubble-list .item .icon svg{width:19px;fill:#1ea3e6}.add-to-collection-menu.bubble-menu ul.bubble-list .item .item-title{position:absolute;font-weight:bold;left:35px;right:10px;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;line-height:20px;color:#1ea3e6}.cube-header-bar .instances{display:inline-block;font-size:14px;font-weight:600;margin-top:6px}.cube-header-bar .instances .selected-item{background:none;border:none;-webkit-box-shadow:none;box-shadow:none;opacity:0.7;padding-left:6px}.cube-header-bar .instances .selected-item.active{opacity:1}.cube-header-bar .instances .dropdown-menu{color:#1ea3e6;width:auto;font-size:13px;min-width:160px;max-width:350px}.cube-header-bar .instances::before{content:':';position:absolute;top:8px;left:-2px}.cube-header-bar .instances .caret-icon{fill:#ffffff}.cube-header-bar .instances:hover .selected-item{opacity:1}.cube-header-bar .refreshing svg{-webkit-animation-name:rotate;animation-name:rotate;-webkit-animation-duration:1s;animation-duration:1s}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.add-to-collection-menu.bubble-menu ul.bubble-list li{cursor:pointer}.add-to-collection-menu.bubble-menu ul.bubble-list li.label{cursor:default;pointer-events:none;color:#bababa}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var React=__webpack_require__(1);var options_menu_1=__webpack_require__(467);var strings_1=__webpack_require__(17);__webpack_require__(933);var SupervisedCubeHeaderBar=function(_super){tslib_1.__extends(SupervisedCubeHeaderBar,_super);function SupervisedCubeHeaderBar(){var _this=_super.call(this)||this;_this.state={};return _this}SupervisedCubeHeaderBar.prototype.renderOptionsMenu=function(target){var _a=this.props,clicker=_a.clicker,customization=_a.customization,essence=_a.essence;return React.createElement(options_menu_1.OptionsMenu,{timezone:essence.timezone,customization:customization,changeTimezone:clicker.changeTimezone,openOn:target})};SupervisedCubeHeaderBar.prototype.render=function(){var _a=this.props,supervisor=_a.supervisor,customization=_a.customization,essence=_a.essence;var leftChildren=[{id:"title",className:"title",content:supervisor.title}];var rightChildren=[{id:"toggles",className:"icon-button toggles",content:React.createElement(caladan_1.SvgIcon,{className:"toggles-icon",svg:Icons.TOGGLES}),renderMenu:this.renderOptionsMenu.bind(this),tooltip:"Cube options"},{id:"button-group",className:"button-group",content:[React.createElement(caladan_1.Button,{key:"cancel",className:"cancel",title:strings_1.STRINGS.cancel,type:"secondary",onClick:supervisor.onCancel}),React.createElement(caladan_1.Button,{key:"save",className:"save",title:supervisor.saveLabel||strings_1.STRINGS.save,type:"primary",onClick:function(){return supervisor.onSave(essence)}})]}];return React.createElement(caladan_1.HeaderBar,{className:"supervised-cube-header-bar",style:{background:customization.getPreferredTheme(essence.actualDataCube.theme).mainColor},leftChildren:leftChildren,rightChildren:rightChildren})};return SupervisedCubeHeaderBar}(React.Component);exports.SupervisedCubeHeaderBar=SupervisedCubeHeaderBar},function(module,exports,__webpack_require__){var content=__webpack_require__(934);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./supervised-cube-header-bar.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./supervised-cube-header-bar.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".supervised-cube-header-bar .left-bar .title{cursor:default;font-size:14px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(936);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./cube-view.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./cube-view.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".cube-view .center-panel .center-main .visualization{background:#fff}.cube-view .cube-header-bar,.cube-view .supervised-cube-header-bar{position:absolute;top:0;left:0;right:0;height:42px}.cube-view .container{position:absolute;top:42px;bottom:0;left:0;right:0}.cube-view .dimension-measure-panel{position:absolute;top:10px;bottom:10px;left:10px}@media only screen and (max-width: 1080px){.cube-view .dimension-measure-panel{top:0;bottom:0;left:0;font-size:0.9em}}.cube-view .dimension-measure-panel>*{position:absolute;left:0;right:0}.cube-view .dimension-measure-panel .dimension-list-tile{top:0;border-radius:2px 2px 0 0}.cube-view .dimension-measure-panel .resize-handle svg{display:none}.cube-view .dimension-measure-panel .resize-handle.top{margin-top:0}.cube-view .dimension-measure-panel .measures-tile{margin-top:1px;bottom:0;border-radius:0 0 2px 2px}.cube-view .center-panel{position:absolute;top:10px;bottom:10px}@media only screen and (max-width: 1080px){.cube-view .center-panel{top:0;bottom:0}}.cube-view .center-panel .center-top-bar{position:absolute;top:0;left:0;right:0;height:73px}.cube-view .center-panel .center-top-bar .filter-split-section{position:absolute;top:0;bottom:0;left:0;right:79px}.cube-view .center-panel .center-top-bar .filter-tile,.cube-view .center-panel .center-top-bar .split-tile{height:36px}.cube-view .center-panel .center-top-bar .filter-tile{margin-bottom:1px;border-radius:2px 0 0 0}.cube-view .center-panel .center-top-bar .split-tile{border-radius:0 0 0 2px}.cube-view .center-panel .center-top-bar .vis-selector{position:absolute;top:0;bottom:0;right:0;width:78px;border-radius:0 2px 2px 0}.cube-view .center-panel .center-main{position:absolute;top:78px;bottom:0;left:0;right:0}@media only screen and (max-width: 1080px){.cube-view .center-panel .center-main{position:absolute;top:74px;bottom:0;left:0;right:0}}.cube-view .center-panel .center-main .visualization{position:absolute;top:0;bottom:0;left:0;right:0;border-radius:2px}.cube-view .center-panel .center-main .manual-fallback{position:absolute;top:0;bottom:0;left:0;right:0}.cube-view .center-panel .center-main .drop-indicator{position:absolute;top:0;bottom:0;left:0;right:0;z-index:9}.cube-view .center-panel .center-main .drag-mask{position:absolute;top:0;bottom:0;left:0;right:0;z-index:10}.cube-view .pinboard-panel{position:absolute;top:10px;bottom:10px;right:10px}@media only screen and (max-width: 1080px){.cube-view .pinboard-panel{top:0;bottom:0;right:0}}.cube-view .pinboard-panel .pinboard-measure-tile:first-child,.cube-view .pinboard-panel .dimension-tile:first-child,.cube-view .pinboard-panel .placeholder-tile:first-child{border-radius:2px 2px 0 0}.cube-view .pinboard-panel .pinboard-measure-tile:last-child,.cube-view .pinboard-panel .dimension-tile:last-child,.cube-view .pinboard-panel .placeholder-tile:last-child{border-radius:0 0 2px 2px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var immutable_class_1=__webpack_require__(7);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var components_1=__webpack_require__(466);var options_menu_1=__webpack_require__(467);__webpack_require__(938);var CollectionHeaderBar=function(_super){tslib_1.__extends(CollectionHeaderBar,_super);function CollectionHeaderBar(){var _this=_super.call(this)||this;_this.state={animating:false};return _this}CollectionHeaderBar.prototype.componentDidMount=function(){this.mounted=true;var collectionEssence=this.props.collectionEssence;if(collectionEssence&&collectionEssence.commonDataCube){this.setAutoRefreshFromDataCube(collectionEssence.commonDataCube)}};CollectionHeaderBar.prototype.componentWillReceiveProps=function(nextProps){var _this=this;if(!this.props.updatingTimekeeper&&nextProps.updatingTimekeeper){this.setState({animating:true});setTimeout(function(){if(!_this.mounted)return;_this.setState({animating:false})},1e3)}};CollectionHeaderBar.prototype.componentWillUnmount=function(){this.mounted=false;this.clearTimerIfExists()};CollectionHeaderBar.prototype.setAutoRefreshFromDataCube=function(dataCube){if(dataCube.getRefreshTimeWith()!=="query")return;this.setAutoRefreshRate(dataCube.getDefaultRefreshRate())};CollectionHeaderBar.prototype.setAutoRefreshRate=function(rate){var autoRefreshRate=this.state.autoRefreshRate;if(immutable_class_1.immutableEqual(autoRefreshRate,rate))return;this.clearTimerIfExists();var onRefreshMaxTime=this.props.onRefreshMaxTime;if(onRefreshMaxTime&&rate){this.autoRefreshTimer=setInterval(function(){onRefreshMaxTime()},rate.getCanonicalLength())}this.setState({autoRefreshRate:rate})};CollectionHeaderBar.prototype.clearTimerIfExists=function(){if(this.autoRefreshTimer){clearInterval(this.autoRefreshTimer);this.autoRefreshTimer=null}};CollectionHeaderBar.prototype.getSaveButtonTitle=function(){var _a=this.props,isDuplicate=_a.isDuplicate,collectionEditController=_a.collectionEditController;if(isDuplicate)return strings_1.STRINGS.saveDuplicate;return collectionEditController.editMode==="update"?"Save":"Create"};CollectionHeaderBar.prototype.onTitleChange=function(e){var _a=this.props,collection=_a.collection,collectionEditController=_a.collectionEditController,onCollectionChange=_a.onCollectionChange;if(!collectionEditController)return;var value=e.target.value;onCollectionChange(collection.changeTitle(value))};CollectionHeaderBar.prototype.renderUserMenu=function(target){var _a=this.props,user=_a.user,customization=_a.customization;var canEdit=user&&user.canAccessSettings()&&customization.getSettingsMode()!==models_1.Customization.SETTINGS_MODE_SUPPRESSED;return React.createElement(components_1.UserMenu,{showSettings:canEdit,customization:customization,openOn:target,user:user})};CollectionHeaderBar.prototype.renderOptionsMenu=function(target){var _this=this;var _a=this.props,clicker=_a.clicker,customization=_a.customization,collectionEssence=_a.collectionEssence,timekeeper=_a.timekeeper,onRefreshMaxTime=_a.onRefreshMaxTime;var autoRefreshRate=this.state.autoRefreshRate;var setAutoRefreshRate=null;var refreshText=null;if(collectionEssence.hasSpecialTimeDimension()){setAutoRefreshRate=function(rate){return _this.setAutoRefreshRate(rate)};refreshText=collectionEssence.updatedText(timekeeper)}return React.createElement(options_menu_1.OptionsMenu,{timezone:collectionEssence.timezone,customization:customization,changeTimezone:clicker.changeTimezone,autoRefreshRate:autoRefreshRate,setAutoRefreshRate:setAutoRefreshRate,onRefreshMaxTime:onRefreshMaxTime,refreshText:refreshText,openOn:target})};CollectionHeaderBar.prototype.renderTitle=function(){var _a=this.props,collection=_a.collection,collectionEditController=_a.collectionEditController;return React.createElement("div",{className:classNames("title-cont",{editing:Boolean(collectionEditController)})},React.createElement("span",{className:"static"},collection.getTitle()),collectionEditController?React.createElement("input",{className:"edit",value:collection.getTitle(),onChange:this.onTitleChange.bind(this)}):null)};CollectionHeaderBar.prototype.getLeftChildren=function(){var _a=this.props,onNavClick=_a.onNavClick,collectionEditController=_a.collectionEditController,collection=_a.collection,collectionEssence=_a.collectionEssence,clicker=_a.clicker;var items=[{id:"menu-icon",className:"menu-icon",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.MENU}),onClick:onNavClick},{id:"title",className:"title-wrapper",content:this.renderTitle(),onClick:collectionEditController?null:onNavClick}];if(!collectionEssence)return items;if(collectionEssence.commonDataCube&&collectionEssence.commonDataCube.instances){var InstanceDropdown=caladan_1.Dropdown.specialize();items.push(React.createElement(InstanceDropdown,{key:"instances",className:"instances",items:collectionEssence.commonDataCube.instances.getValues(),selectedItem:collectionEssence.instance,renderItem:function(p){return p},onSelect:function(instance){return clicker.changeInstance(instance)}}))}if(collection.description){items.push(React.createElement(components_1.DescriptionIcon,{key:"icon",description:collection.description}))}return items};CollectionHeaderBar.prototype.renderAddMenu=function(target){var _a=this.props,dataCubes=_a.dataCubes,onNewTile=_a.onNewTile;var items=dataCubes.map(function(dataCube){return React.createElement("li",{className:"data-cube",key:dataCube.name,onClick:function(){return onNewTile(dataCube)}},dataCube.title)});return React.createElement(caladan_1.BubbleMenu,{className:"add-menu",direction:"down",stage:beltful_1.Stage.fromSize(200,200),openOn:target},React.createElement("div",{className:"bubble-list-title"},strings_1.STRINGS.addFromDataCube,":"),React.createElement("ul",{className:"bubble-list"},items))};CollectionHeaderBar.prototype.getRightChildren=function(){var _this=this;var _a=this.props,controller=_a.controller,user=_a.user,collectionEditController=_a.collectionEditController,collection=_a.collection,onNewTile=_a.onNewTile,moreButton=_a.moreButton,stateful=_a.stateful;var animating=this.state.animating;var items=[];var addButton={id:"add-item",className:"icon-button add",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_ADD_FRAMED}),tooltip:"Add a tile",renderMenu:function(target){return _this.renderAddMenu(target)}};if(collectionEditController){if(stateful&&onNewTile)items.push(addButton);items.push({id:"button-group",className:"button-group",content:[React.createElement(caladan_1.Button,{key:"more",className:"more",title:moreButton.label,type:"secondary",onClick:moreButton.onClick}),React.createElement(caladan_1.Button,{key:"cancel",className:"cancel",title:"Cancel",type:"secondary",onClick:collectionEditController.onCancel}),React.createElement(caladan_1.Button,{key:"save",className:"save",title:this.getSaveButtonTitle(),type:"primary",onClick:function(){return collectionEditController.onSave(collection)}})]})}else{if(animating){items.push({id:"auto-refresh",className:classNames("icon-button","auto-refresh","refreshing"),content:React.createElement(caladan_1.SvgIcon,{className:"auto-refresh-icon",svg:Icons.FULL_REFRESH}),tooltip:"Refreshing"})}if(stateful&&onNewTile)items.push(addButton);items.push({id:"toggles",className:"icon-button toggles",content:React.createElement(caladan_1.SvgIcon,{className:"toggles-icon",svg:Icons.TOGGLES}),renderMenu:function(target){return _this.renderOptionsMenu(target)},tooltip:"Dashboard options"});if(stateful){items.push({id:"edit-collection",className:"icon-button edit",tooltip:"Edit this collection",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_EDIT}),onClick:function(){return controller.editCollection(collection,"update")}})}items.push({id:"user-button",className:"icon-button user",tooltip:"Me",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_PROFILE}),renderMenu:this.renderUserMenu.bind(this)})}return items};CollectionHeaderBar.prototype.render=function(){var _a=this.props,customization=_a.customization,collection=_a.collection;return React.createElement(caladan_1.HeaderBar,{className:"collection-header-bar",style:{background:customization.getPreferredTheme(collection.theme).mainColor},leftChildren:this.getLeftChildren(),rightChildren:this.getRightChildren()})};return CollectionHeaderBar}(React.Component);exports.CollectionHeaderBar=CollectionHeaderBar},function(module,exports,__webpack_require__){var content=__webpack_require__(939);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./collection-header-bar.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./collection-header-bar.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".collection-header-bar .title-wrapper{display:inline-block;padding:0 2px 0 4px}.collection-header-bar .title-cont{display:inline-block;font-size:14px;line-height:18px;margin-top:12px;font-weight:600}.collection-header-bar .title-cont.editing{cursor:text}.collection-header-bar .title-cont.editing .static{opacity:0.001}.collection-header-bar .title-cont input{position:absolute;left:0;top:0;width:100%;height:100%;padding:0;color:#fff;border-bottom:1px dashed #fff;background:none;font-weight:inherit}.collection-header-bar .instances{display:inline-block;font-size:14px;font-weight:600;margin-top:6px}.collection-header-bar .instances .selected-item{background:none;border:none;-webkit-box-shadow:none;box-shadow:none;opacity:0.7;padding-left:6px}.collection-header-bar .instances .selected-item.active{opacity:1}.collection-header-bar .instances .dropdown-menu{color:#1ea3e6;width:auto;font-size:13px;min-width:160px;max-width:350px}.collection-header-bar .instances::before{content:':';position:absolute;top:8px;left:-2px}.collection-header-bar .instances .caret-icon{fill:#ffffff}.collection-header-bar .instances:hover .selected-item{opacity:1}.collection-header-bar .description-icon{display:inline-block;height:100%}.collection-header-bar .description{opacity:0.62;display:inline-block;padding:11px 5px}.collection-header-bar .description:hover{opacity:0.85}.collection-header-bar .description svg{fill:#fff}.collection-header-bar .refreshing svg{-webkit-animation-name:rotate;animation-name:rotate;-webkit-animation-duration:1s;animation-duration:1s}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(941);var React=__webpack_require__(1);var filesaver=__webpack_require__(468);var caladan_1=__webpack_require__(10);var beltful_1=__webpack_require__(8);var Icons=__webpack_require__(11);var immutable_ui_1=__webpack_require__(104);var strings_1=__webpack_require__(17);var components_1=__webpack_require__(466);var index_1=__webpack_require__(19);var MY_LABELS=index_1.LABELS.COLLECTION;var CollectionOptions=function(_super){tslib_1.__extends(CollectionOptions,_super);function CollectionOptions(){var _this=_super.call(this)||this;_this.tabs=[{label:"General",value:"general",icon:Icons.FULL_SETTINGS,render:function(){return _this.renderGeneral()}},{label:"Sharing",value:"sharing",icon:Icons.USER_GROUP,render:function(){return _this.renderSharing()}}];_this.formGrid=(new caladan_1.Grid).setColumns([{width:60},{width:40,vAlign:"top"}]);_this.state={};_this.formDelegate=new immutable_ui_1.ImmutableFormDelegate(_this);_this.formDelegate.onAnyChange(function(collection,valid,path,error){_this.props.onChange(collection,valid,path,error)});return _this}CollectionOptions.prototype.initFromProps=function(props){this.setState({newInstance:props.collection})};CollectionOptions.prototype.componentWillReceiveProps=function(nextprops){this.initFromProps(nextprops)};CollectionOptions.prototype.componentDidMount=function(){this.initFromProps(this.props)};CollectionOptions.prototype.onDuplicate=function(){var _a=this.props,settings=_a.settings,applicationController=_a.applicationController,user=_a.user;var newInstance=this.state.newInstance;var newName=beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!settings.getCollection(name)}});applicationController.editCollection(newInstance.makeDuplicate(newName,user),"duplicate")};CollectionOptions.prototype.onExport=function(){var newInstance=this.state.newInstance;var blob=new Blob([JSON.stringify(newInstance,null,2)],{type:"application/json;charset=utf-8"});filesaver.saveAs(blob,"collection-"+newInstance.title+".json",true)};CollectionOptions.prototype.renderMore=function(){return null};CollectionOptions.prototype.onDelete=function(){var _a=this.props,applicationController=_a.applicationController,settings=_a.settings;var newInstance=this.state.newInstance;caladan_1.Notifier.handleRemoval("collection",function(){applicationController.goHome();applicationController.updateSettings(settings.deleteCollection(newInstance.name)).then(function(){caladan_1.Notifier.success("Dashboard deleted")},function(e){caladan_1.Notifier.failure("Woops","Something bad happened");throw e})},newInstance.title)};CollectionOptions.prototype.renderGeneral=function(){var _this=this;var _a=this.props,customization=_a.customization,isDuplicate=_a.isDuplicate;var _b=this.state,newInstance=_b.newInstance,errors=_b.errors;var makeLabel=caladan_1.FormLabel.simpleGenerator(MY_LABELS,errors);var makeTextInput=immutable_ui_1.ImmutableTextInput.simpleGenerator(newInstance,this.formDelegate.onChange,MY_LABELS,errors);var makeDropdownInput=immutable_ui_1.ImmutableDropdown.simpleGenerator(newInstance,this.formDelegate.onChange,MY_LABELS,errors);var enforceTimeFilterOptions=[{value:false,label:"Do not force a time filter"},{value:true,label:"Always force a time filter"}];var commonDataCube=newInstance.getCommonDataCube();var hasSpecialTimeDimension=Boolean(commonDataCube&&commonDataCube.getSpecialTimeDimensionObject());var themes=index_1.Theme.themes.map(function(t){return{label:t,value:t}});return React.createElement("div",{className:"form general"},this.formGrid.row([caladan_1.FormLabel.dumbLabel(MY_LABELS["title"].label),makeTextInput("title",/.*/,true)],[]),this.formGrid.row([caladan_1.FormLabel.dumbLabel(MY_LABELS["description"].label),makeTextInput("description")],[]),customization.getIndividualThemes()==="allow"?this.formGrid.row([makeLabel("theme"),makeDropdownInput("theme",themes)],React.createElement(caladan_1.InfoSpot,{sourceIds:["theme"]})):null,hasSpecialTimeDimension?this.formGrid.row([makeLabel("enforceTimeFilter"),makeDropdownInput("enforceTimeFilter",enforceTimeFilterOptions)],React.createElement(caladan_1.InfoSpot,{sourceIds:["enforceTimeFilter"]})):null,isDuplicate?null:React.createElement("div",{className:"buttons"},caladan_1.FormLabel.dumbLabel("Dashboard actions"),React.createElement(caladan_1.Button,{type:"secondary-warn",onClick:function(){return _this.onDelete()},title:strings_1.STRINGS.delete}),React.createElement(caladan_1.Button,{type:"secondary",onClick:function(){return _this.onDuplicate()},title:strings_1.STRINGS.duplicate}),React.createElement(caladan_1.Button,{type:"secondary",onClick:function(){return _this.onExport()},title:strings_1.STRINGS.export})))};CollectionOptions.prototype.renderSharing=function(){var _this=this;var _a=this.props,settings=_a.settings,user=_a.user;var newInstance=this.state.newInstance;var onAccessChange=function(v,propName){return _this.formDelegate.onChange(newInstance.change(propName,v),true,propName,undefined)};return React.createElement("div",{className:"form general"},React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-50 h-padded top"},caladan_1.FormLabel.dumbLabel(MY_LABELS["readAccess"].label),React.createElement(components_1.AccessListEditor,{value:newInstance.getReadAccess(),user:user,availableUsers:settings.getUsers(),onChange:function(v){return onAccessChange(v,"readAccess")},accessLabel:"view"})),React.createElement("div",{className:"grid-col-50 h-padded top"},caladan_1.FormLabel.dumbLabel(MY_LABELS["modifyAccess"].label),React.createElement(components_1.AccessListEditor,{value:newInstance.getModifyAccess(),user:user,availableUsers:settings.getUsers(),onChange:function(v){return onAccessChange(v,"modifyAccess")},accessLabel:"modify"}))))};CollectionOptions.prototype.render=function(){var _a=this.props,customization=_a.customization,settings=_a.settings;var newInstance=this.state.newInstance;if(!newInstance)return null;var theme=customization.getPreferredTheme(newInstance.theme);var myTabs=settings.hasUsers()?this.tabs:this.tabs.filter(function(tab){return tab.value!=="sharing"});return React.createElement(components_1.FlatModal,{className:"collection-options",tabs:myTabs,theme:theme})};return CollectionOptions}(React.Component);exports.CollectionOptions=CollectionOptions},function(module,exports,__webpack_require__){var content=__webpack_require__(942);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./collection-options.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./collection-options.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".collection-options{margin-top:10px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var collection_tile_card_1=__webpack_require__(944);var units_panel_1=__webpack_require__(947);var collection_tile_wrapper_1=__webpack_require__(950);__webpack_require__(953);var MIN_UNIT_WIDTH=40;var MAX_UNIT_WIDTH=200;var MIN_UNIT_HEIGHT=40;var MAX_UNIT_HEIGHT=100;var GAP=10;var DashboardLayout=function(_super){tslib_1.__extends(DashboardLayout,_super);function DashboardLayout(){var _this=_super.call(this)||this;_this.state={visibleUnits:{start:0,end:Number.POSITIVE_INFINITY}};return _this}DashboardLayout.prototype.componentDidMount=function(){this.calculateSize(this.props)};DashboardLayout.prototype.componentWillReceiveProps=function(nextProps){var newState=this.getNewStateForSize(nextProps);this.setState(newState)};DashboardLayout.prototype.calculateSize=function(props){this.setState(this.getNewStateForSize(props))};DashboardLayout.prototype.getNewStateForSize=function(props){var collection=props.collection,onCollectionChange=props.onCollectionChange;if(!this.containerDOM||!collection)return{};var containerStage=beltful_1.Stage.fromClientRect(this.containerDOM.getBoundingClientRect());var unitSize=this.getUnitSize(collection,containerStage);var visibleUnits=this.getVisibleUnits(unitSize);return{containerStage:containerStage,visibleUnits:visibleUnits,unitSize:unitSize,cardsStage:this.getCardsStage(collection,containerStage,!!onCollectionChange)}};DashboardLayout.prototype.getSize=function(collection,editingMode){var editHeight=200;var tiles=collection.getTiles().slice();if(collection&&tiles.length>0){var _a=tiles.sort(function(a,b){return b.position.y-a.position.y})[0].getPosition(),y=_a.y,height=_a.height;var _b=tiles.sort(function(a,b){return b.position.x-a.position.x})[0].getPosition(),x=_b.x,width=_b.width;return{width:Math.max(24,x+width),height:Math.max(editingMode?editHeight:12,y+height)}}return{width:24,height:editingMode?editHeight:12}};DashboardLayout.prototype.getUnitSize=function(collection,containerStage){var _a=this.getSize(collection,false),width=_a.width,height=_a.height;return{width:beltful_1.NumberUtils.clamp((containerStage.width-GAP)/width,MIN_UNIT_WIDTH,MAX_UNIT_WIDTH),height:beltful_1.NumberUtils.clamp((containerStage.height-GAP)/height,MIN_UNIT_HEIGHT,MAX_UNIT_HEIGHT)}};DashboardLayout.prototype.getCardsStage=function(collection,containerStage,editingMode){var unit=this.getUnitSize(collection,containerStage);var _a=this.getSize(collection,editingMode),width=_a.width,height=_a.height;var totalWidth=unit.width*width+GAP;var totalHeight=unit.height*height+GAP;return beltful_1.Stage.fromJS({x:Math.max(0,(containerStage.width-totalWidth)/2),y:Math.max(0,(containerStage.height-totalHeight)/2),width:totalWidth,height:totalHeight})};DashboardLayout.prototype.positionToScreen=function(position){var unitSize=this.state.unitSize;return new beltful_1.Stage({x:position.x*unitSize.width+GAP,y:position.y*unitSize.height+GAP,width:position.width*unitSize.width-GAP,height:position.height*unitSize.height-GAP})};DashboardLayout.prototype.screenToPosition=function(position,round){if(round===void 0){round=true}var unitSize=this.state.unitSize;var newStageValue={x:(position.x-GAP)/unitSize.width,y:(position.y-GAP)/unitSize.height,width:(position.width+GAP)/unitSize.width,height:(position.height+GAP)/unitSize.height};if(round)return this.roundStage(new beltful_1.Stage(newStageValue));return new beltful_1.Stage(newStageValue)};DashboardLayout.prototype.roundStage=function(stage){if(!stage)return null;var x=stage.x,y=stage.y,width=stage.width,height=stage.height;var newStage=stage.changeMany({x:Math.round(x),y:Math.round(y),width:width%.5===0?Math.floor(width):Math.round(width),height:height%.5===0?Math.floor(height):Math.round(height)});return newStage};DashboardLayout.prototype.isPositionValid=function(position,tileToIgnore){var _a=this.props,collection=_a.collection,onCollectionChange=_a.onCollectionChange;var size=this.getSize(collection,!!onCollectionChange);if(window.freeAsAFry)return true;if(position.x<0)return false;if(position.y<0)return false;if(position.x+position.width>size.width)return false;if(position.y+position.height>size.height)return false;if(tileToIgnore){return collection.tiles.every(function(t){return tileToIgnore.name===t.name||!t.position.overlapsWith(position)})}return!collection.tiles.some(function(t){return t.position.overlapsWith(position)})};DashboardLayout.prototype.onTileChange=function(newTile){var _a=this.props,onCollectionChange=_a.onCollectionChange,collection=_a.collection;if(!onCollectionChange)return;onCollectionChange(collection.addOrUpdateTile(newTile))};DashboardLayout.prototype.onTileDelete=function(tileName){var _a=this.props,onCollectionChange=_a.onCollectionChange,collection=_a.collection;if(!onCollectionChange)return;onCollectionChange(collection.deleteTile(tileName))};DashboardLayout.prototype.onTileDuplicate=function(tileName){var _a=this.props,onCollectionChange=_a.onCollectionChange,collection=_a.collection;if(!onCollectionChange)return;onCollectionChange(collection.duplicateTile(tileName))};DashboardLayout.prototype.changePosition=function(tile,position){var _a=this.props,collection=_a.collection,onCollectionChange=_a.onCollectionChange;onCollectionChange(collection.addOrUpdateTile(tile.changePosition(position)))};DashboardLayout.prototype.renderUnits=function(){var _this=this;var _a=this.props,collection=_a.collection,onCollectionChange=_a.onCollectionChange;var _b=this.state,unitSize=_b.unitSize,tileGhost=_b.tileGhost,visibleUnits=_b.visibleUnits;if(!onCollectionChange||!collection)return null;var _c=this.getSize(collection,!!onCollectionChange),width=_c.width,height=_c.height;var onCreationEnd=function(stage){if(stage.width===1&&stage.height===1)return;var newTile=models_1.CollectionTile.generateBlank(collection.getAvailableName()).changePosition(stage);onCollectionChange(collection.addOrUpdateTile(newTile))};var ghostPosition=tileGhost?this.screenToPosition(tileGhost.position):null;var highlight=ghostPosition&&this.isPositionValid(ghostPosition,tileGhost.tile)?ghostPosition:null;return React.createElement(units_panel_1.UnitsPanel,{width:width,height:height,screenToPosition:function(stage){return _this.screenToPosition(stage)},positionToScreen:function(stage){return _this.positionToScreen(stage)},isPositionValid:function(stage){return _this.isPositionValid(_this.screenToPosition(stage))},onCreationEnd:onCreationEnd,highlight:highlight,startRow:visibleUnits.start,endRow:visibleUnits.end})};DashboardLayout.prototype.previewPosition=function(tile,position){var tileGhost=this.state.tileGhost;if(tileGhost&&tileGhost.position.equals(position))return;this.setState({tileGhost:{tile:tile,position:position}})};DashboardLayout.prototype.renderTile=function(tile){var _this=this;var _a=this.props,onCollectionChange=_a.onCollectionChange,dataCubes=_a.dataCubes,timekeeper=_a.timekeeper,collectionEssence=_a.collectionEssence,clicker=_a.clicker,controller=_a.controller,onSuperviseDataCube=_a.onSuperviseDataCube,goBack=_a.goBack;var editing=Boolean(onCollectionChange);var onEnd=function(newPosition){newPosition=_this.screenToPosition(newPosition);_this.setState({tileGhost:undefined},_this.isPositionValid(newPosition,tile)?function(){return _this.changePosition(tile,newPosition)}:null)};return React.createElement(collection_tile_wrapper_1.CollectionTileWrapper,{position:this.positionToScreen(tile.getPosition()),key:tile.name,enabled:editing,onStart:function(stage){return _this.previewPosition(tile,stage)},onUpdate:function(stage){return _this.previewPosition(tile,stage)},onEnd:onEnd},React.createElement(collection_tile_card_1.CollectionTileCard,{tile:tile,availableDataCubes:dataCubes,collectionEssence:collectionEssence,timekeeper:timekeeper,clicker:clicker,controller:controller,onSuperviseDataCube:onSuperviseDataCube,onTileChange:function(newTile){return _this.onTileChange(newTile)},onTileDelete:function(){return _this.onTileDelete(tile.name)},onTileDuplicate:function(){return _this.onTileDuplicate(tile.name)},isThumbnail:true,editing:editing,noScroll:editing,goBack:goBack}))};DashboardLayout.prototype.renderCards=function(){var _this=this;var collection=this.props.collection;if(!collection)return null;return collection.tiles.map(function(tile){return _this.renderTile(tile)})};DashboardLayout.prototype.renderEmpty=function(){return React.createElement("div",{className:"dashboard-layout empty"},React.createElement("div",{className:"container"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_COLLECTION}),React.createElement("div",{className:"placeholder"},strings_1.STRINGS.noTilesInThisDashboard)))};DashboardLayout.prototype.getVisibleUnits=function(unitSize){var rect=this.containerDOM.getBoundingClientRect();var start=Math.floor(this.containerDOM.scrollTop/unitSize.height);var end=start+Math.ceil(rect.height/unitSize.height);return{start:start,end:end}};DashboardLayout.prototype.updateVisibleUnits=function(unitSize){if(!this.containerDOM)return;var visibleUnits=this.state.visibleUnits;var _a=this.getVisibleUnits(unitSize),start=_a.start,end=_a.end;if(start!==visibleUnits.start||end!==visibleUnits.end){this.setState({visibleUnits:{start:start,end:end}})}};DashboardLayout.prototype.renderGhost=function(){var tileGhost=this.state.tileGhost;if(!tileGhost)return null;return React.createElement("div",{className:classNames("tile-ghost",{invalid:!this.isPositionValid(this.screenToPosition(tileGhost.position),tileGhost.tile)}),style:tileGhost.position.getLeftTopWidthHeight()})};DashboardLayout.prototype.render=function(){var _this=this;var _a=this.props,collection=_a.collection,onCollectionChange=_a.onCollectionChange,customization=_a.customization,onScroll=_a.onScroll;var _b=this.state,containerStage=_b.containerStage,unitSize=_b.unitSize;if(!containerStage)return React.createElement("div",{className:"dashboard-layout",ref:function(e){return _this.containerDOM=e}});if(!onCollectionChange&&!collection.tiles.length)return this.renderEmpty();return React.createElement("div",{className:"dashboard-layout",ref:function(e){return _this.containerDOM=e},style:{background:customization.getPreferredTheme(collection.theme).backgroundColor},onScroll:function(){_this.updateVisibleUnits(unitSize);if(onScroll)onScroll()}},React.createElement(caladan_1.GlobalEventListener,{resize:function(){return _this.calculateSize(_this.props)}}),this.renderUnits(),this.renderCards(),this.renderGhost())};return DashboardLayout}(React.Component);exports.DashboardLayout=DashboardLayout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var beltful_1=__webpack_require__(8);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var components_1=__webpack_require__(466);var visualizations_1=__webpack_require__(759);__webpack_require__(945);var CollectionTileCard=function(_super){tslib_1.__extends(CollectionTileCard,_super);function CollectionTileCard(){var _this=_super.call(this)||this;_this.state={inViewport:false};return _this}CollectionTileCard.prototype.calculateSize=function(){var visComponent=this.visComponent;if(!visComponent)return;visComponent.calculateSize()};CollectionTileCard.prototype.onTitleChange=function(e){var _a=this.props,tile=_a.tile,onTileChange=_a.onTileChange;if(!onTileChange)return;var value=e.target.value;onTileChange(tile.changeTitle(value))};CollectionTileCard.prototype.saveDescriptionEdition=function(newDescription){var _a=this.props,tile=_a.tile,onTileChange=_a.onTileChange;if(!onTileChange)return;onTileChange(tile.changeDescription(newDescription));this.setState({descriptionModalOpen:false})};CollectionTileCard.prototype.checkVisibility=function(){if(this.state.inViewport)return;var rect=this._div.getBoundingClientRect();var visible=rect.top>=0&&rect.left>=0&&rect.top<=(window.innerHeight||document.documentElement.clientHeight)&&rect.left<=(window.innerWidth||document.documentElement.clientWidth);if(visible){this.setState({inViewport:visible})}};CollectionTileCard.prototype.componentDidMount=function(){this.checkVisibility()};CollectionTileCard.prototype.componentDidUpdate=function(){this.checkVisibility()};CollectionTileCard.prototype.renderContent=function(essence){var _this=this;var _a=this.props,tile=_a.tile,timekeeper=_a.timekeeper,clicker=_a.clicker,isThumbnail=_a.isThumbnail,noScroll=_a.noScroll;var inViewport=this.state.inViewport;if(tile.isBlank()){return React.createElement("div",{className:"blank-placeholder"},"Click ",React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_EDIT})," to add a visualization")}if(!tile.isReady()){return React.createElement("div",{className:"broken-placeholder"},"The data cube for this visualization does not exist or you do not have access")}var myClicker=Object.assign({changeHighlight:function(highlight){clicker.changeHighlightFor(tile.name,highlight)}},clicker);var visElement=null;if(inViewport&&essence.getVisResolve().proceedWithDimensions()){var visProps={ref:function(e){return _this.visComponent=e},clicker:myClicker,essence:essence,timekeeper:timekeeper,deviceSize:models_1.Device.getSize(),isThumbnail:isThumbnail,noScroll:noScroll};visElement=React.createElement(visualizations_1.getVisualizationComponent(essence.getVisualizationManifest()),visProps)}return visElement};CollectionTileCard.prototype.editVisualization=function(essence){var _this=this;var _a=this.props,tile=_a.tile,onSuperviseDataCube=_a.onSuperviseDataCube;onSuperviseDataCube({title:tile.title,essence:essence,onCancel:function(){},saveLabel:strings_1.STRINGS.save,onSave:function(newEssence){var _a=_this.props,tile=_a.tile,onTileChange=_a.onTileChange;var newTile=tile.changeMany({essence:newEssence,type:models_1.CollectionTile.TYPE_VISUALIZATION});onTileChange(newTile)}})};CollectionTileCard.prototype.renderEditRight=function(){var _this=this;var _a=this.props,tile=_a.tile,onTileDelete=_a.onTileDelete,onSuperviseDataCube=_a.onSuperviseDataCube,onTileDuplicate=_a.onTileDuplicate,onTileChange=_a.onTileChange,availableDataCubes=_a.availableDataCubes;var toggleHideTitle=function(){onTileChange(tile.changeTitleHidden(!tile.titleHidden))};var cubes=availableDataCubes.map(function(c){return{label:c.title,onClick:function(){return _this.editVisualization(models_1.Essence.fromDataCube(c,{visualizations:models_1.MANIFESTS}))}}});var dataCubePicker=React.createElement(caladan_1.BubbleButton,{className:"edit-button",svg:Icons.FULL_EDIT,type:"light",items:cubes,stage:beltful_1.Stage.fromJS({x:0,y:0,width:150,height:50})});var moreItems=[{label:"Edit description",onClick:function(){return _this.setState({descriptionModalOpen:true})}},{label:"Duplicate tile",onClick:onTileDuplicate},{label:tile.titleHidden?"Show title":"Hide title",onClick:toggleHideTitle}];return React.createElement("div",{className:"right"},React.createElement(caladan_1.BubbleButton,{className:"more-button",svg:Icons.FULL_MORE,type:"light",items:moreItems,stage:beltful_1.Stage.fromJS({x:0,y:0,width:150,height:50})}),tile.isVisualization()?React.createElement(caladan_1.Button,{className:"edit-button",type:"light",onClick:function(){return _this.editVisualization(tile.essence)},svg:Icons.FULL_EDIT}):null,tile.isBlank()?dataCubePicker:null,React.createElement(caladan_1.Button,{type:"light",className:"delete-button",onClick:onTileDelete,svg:Icons.FULL_DELETE}))};CollectionTileCard.prototype.renderDisplayRight=function(){var tile=this.props.tile;var buttons=[];if(tile.isVisualization()){buttons.push(React.createElement("div",{className:"expand-button",key:"expand"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_EXPAND})))}return React.createElement("div",{className:"right"},buttons)};CollectionTileCard.prototype.renderHeadBand=function(essence){var _a=this.props,goBack=_a.goBack,tile=_a.tile,editing=_a.editing,controller=_a.controller;if(tile.titleHidden&&!editing){if(tile.isBlank())return null;return React.createElement("div",{className:"expand-button",onClick:function(){return controller.openDataCube(essence.actualDataCube,essence,goBack)}},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_EXPAND}))}return React.createElement("div",{className:"headband",onClick:editing||tile.isBlank()?null:function(){return controller.openDataCube(essence.actualDataCube,essence,goBack)}},React.createElement("div",{className:"left"},React.createElement("div",{className:classNames("title",{editing:editing})},React.createElement("span",{className:"static"},tile.title),editing?React.createElement("input",{className:"edit",value:tile.title,onChange:this.onTitleChange.bind(this)}):null),React.createElement(components_1.DescriptionIcon,{description:tile.getDescription()})),editing?this.renderEditRight():this.renderDisplayRight())};CollectionTileCard.prototype.render=function(){var _this=this;var _a=this.props,tile=_a.tile,collectionEssence=_a.collectionEssence,timekeeper=_a.timekeeper,clicker=_a.clicker,editing=_a.editing,isThumbnail=_a.isThumbnail,noScroll=_a.noScroll,controller=_a.controller,goBack=_a.goBack;var _b=this.state,descriptionModalOpen=_b.descriptionModalOpen,inViewport=_b.inViewport;if(!tile)return null;var essence=collectionEssence.getTileEssence(tile);var classes={editing:editing,"title-hidden":tile.titleHidden};return React.createElement("div",{className:classNames("collection-tile-card",tile.type,classes),ref:function(r){return _this._div=r}},React.createElement(caladan_1.GlobalEventListener,{scroll:function(){return _this.checkVisibility()},resize:function(){return _this.checkVisibility()}}),React.createElement("div",{className:"content"},this.renderContent(essence)),this.renderHeadBand(essence),descriptionModalOpen?React.createElement(caladan_1.SingleValueModal,{className:"collection-tile-modal",title:"Edit description",value:"Description",cancel:function(){return _this.setState({descriptionModalOpen:false})},ok:function(newDescription){return _this.saveDescriptionEdition(newDescription)}}):null)};return CollectionTileCard}(React.Component);exports.CollectionTileCard=CollectionTileCard},function(module,exports,__webpack_require__){var content=__webpack_require__(946);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./collection-tile-card.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./collection-tile-card.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".collection-tile-card{background:#fff;border-radius:2px}.collection-tile-card.visualization .headband{cursor:pointer}.collection-tile-card.editing .headband{cursor:inherit}.collection-tile-card.editing .headband .left{right:100px}.collection-tile-card.editing:after{content:'';pointer-events:none;position:absolute;top:-1px;bottom:-1px;left:-1px;right:-1px;border:2px solid #1ea3e6;border-radius:2px}.collection-tile-card.editing .content{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.collection-tile-card.editing .content .blank-placeholder{opacity:1}.collection-tile-card.editing .headband{cursor:default}.collection-tile-card .expand-button,.collection-tile-card .edit-button,.collection-tile-card .delete-button,.collection-tile-card .more-button{display:inline-block;height:100%;cursor:pointer;width:31px}.collection-tile-card .expand-button:hover,.collection-tile-card .expand-button.active,.collection-tile-card .edit-button:hover,.collection-tile-card .edit-button.active,.collection-tile-card .delete-button:hover,.collection-tile-card .delete-button.active,.collection-tile-card .more-button:hover,.collection-tile-card .more-button.active{background-color:transparent}.collection-tile-card .expand-button:hover:after,.collection-tile-card .edit-button:hover:after,.collection-tile-card .delete-button:hover:after,.collection-tile-card .more-button:hover:after{content:'';pointer-events:none;position:absolute;top:3px;left:1px;width:29px;height:29px;border-radius:29px}.collection-tile-card .expand-button svg,.collection-tile-card .edit-button svg,.collection-tile-card .delete-button svg,.collection-tile-card .more-button svg{margin:8px 6px;width:19px}.collection-tile-card:hover .expand-button svg{fill:#666}.collection-tile-card .expand-button svg{fill:#bababa}.collection-tile-card .edit-button svg,.collection-tile-card .more-button svg{fill:#1ea3e6}.collection-tile-card .edit-button:hover:after,.collection-tile-card .more-button:hover:after{background:rgba(30,163,230,0.2)}.collection-tile-card .delete-button svg{fill:#e24c4c}.collection-tile-card .delete-button:hover:after{background:rgba(226,75,75,0.2)}.collection-tile-card .delete-button:hover svg{fill:#e24c4c}.collection-tile-card .headband{position:absolute;top:0;left:0;right:0;height:36px;border-bottom:1px solid #e6e6e6}.collection-tile-card .headband .left{position:absolute;left:16px;right:40px;height:100%;overflow:hidden}.collection-tile-card .headband .left .title{display:inline-block;color:#444;margin-top:8px;margin-right:5px;min-width:50px;height:18px;line-height:18px;overflow:hidden}.collection-tile-card .headband .left .title.editing{cursor:text}.collection-tile-card .headband .left .title.editing span{font-weight:600}.collection-tile-card .headband .left .title .static{padding-right:3px;white-space:nowrap}.collection-tile-card .headband .left .title input{position:absolute;left:0;top:0;width:100%;height:100%;padding:0;color:#1ea3e6;border-bottom:1px dashed #1ea3e6;font-weight:600}.collection-tile-card .headband .left .description-icon{display:inline-block;height:100%}.collection-tile-card .headband .left .description-icon svg{margin:8px 2px 0 2px;fill:#bababa}.collection-tile-card .headband .left .description-icon svg.open{fill:#666}.collection-tile-card .headband .right{position:absolute;right:9px;height:100%}.collection-tile-card .headband .left>.button,.collection-tile-card .headband .right>.button{padding-top:0px}.collection-tile-card .content{position:absolute;top:36px;bottom:0;left:0;right:0}.collection-tile-card .content .blank-placeholder,.collection-tile-card .content .broken-placeholder{position:absolute;left:50%;text-align:center;-webkit-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);transform:translate(-50%, -50%);top:50%;font-size:13px;line-height:18px;color:#bababa;font-style:italic}.collection-tile-card .content .blank-placeholder{opacity:0}.collection-tile-card .content .blank-placeholder svg{display:inline;width:19px;height:19px;margin-left:6px}.collection-tile-card .content .blank-placeholder svg path{fill:#bababa}.collection-tile-card.title-hidden .content{position:absolute;top:0;bottom:0;left:0;right:0}.collection-tile-card.title-hidden .expand-button{z-index:2;position:absolute;right:9px;height:31px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(948);var React=__webpack_require__(1);var classNames=__webpack_require__(4);var caladan_1=__webpack_require__(10);var beltful_1=__webpack_require__(8);var UnitsPanel=function(_super){tslib_1.__extends(UnitsPanel,_super);function UnitsPanel(){var _this=_super.call(this)||this;_this.state={};return _this}UnitsPanel.prototype.isUnitHighlighted=function(unitStage){var highlight=this.props.highlight;var creatingPosition=this.state.creatingPosition;if(highlight&&highlight.overlapsWith(unitStage))return true;if(!creatingPosition)return false;var creatingStage=this.getStageFromPoints(creatingPosition);return creatingStage.overlapsWith(unitStage)};UnitsPanel.prototype.startTileCreation=function(x,y){this.setState({creatingPosition:{start:{x:x,y:y},end:{x:x,y:y}}})};UnitsPanel.prototype.getStageFromPoints=function(position){var start=position.start,end=position.end;var _a=[start.x,end.x].sort(function(a,b){return a-b}),startX=_a[0],endX=_a[1];var _b=[start.y,end.y].sort(function(a,b){return a-b}),startY=_b[0],endY=_b[1];return beltful_1.Stage.fromJS({x:startX,y:startY,width:endX-startX+1,height:endY-startY+1})};UnitsPanel.prototype.updateTileCreation=function(x,y){var isPositionValid=this.props.isPositionValid;var creatingPosition=this.state.creatingPosition;if(!creatingPosition)return;creatingPosition.end={x:x,y:y};var stage=this.getStageFromPoints(creatingPosition);if(!isPositionValid(stage))return;this.setState({creatingPosition:creatingPosition})};UnitsPanel.prototype.stopTileCreation=function(){var onCreationEnd=this.props.onCreationEnd;var creatingPosition=this.state.creatingPosition;if(!creatingPosition)return;onCreationEnd(this.getStageFromPoints(creatingPosition));this.setState({creatingPosition:undefined})};UnitsPanel.prototype.getStageFromUnitDiv=function(div){var screenToPosition=this.props.screenToPosition;var _a=div.getBoundingClientRect(),width=_a.width,height=_a.height;return screenToPosition(beltful_1.Stage.fromJS({x:div.offsetLeft,y:div.offsetTop,width:width,height:height}))};UnitsPanel.prototype.onMouseDown=function(e){var _a=this.getStageFromUnitDiv(e.target),x=_a.x,y=_a.y;this.startTileCreation(x,y)};UnitsPanel.prototype.onMouseOver=function(e){var creatingPosition=this.state.creatingPosition;if(!creatingPosition)return;var _a=this.getStageFromUnitDiv(e.target),x=_a.x,y=_a.y;this.updateTileCreation(x,y)};UnitsPanel.prototype.render=function(){var _this=this;var _a=this.props,positionToScreen=_a.positionToScreen,width=_a.width,height=_a.height,startRow=_a.startRow,endRow=_a.endRow;var creatingPosition=this.state.creatingPosition;var units=[];for(var x=0;x<width;x++){for(var y=0;y<height;y++){if(y<startRow||y>endRow)continue;var unitPosition=beltful_1.Stage.fromJS({x:x,y:y,width:1,height:1});units.push(React.createElement("div",{className:classNames("unit",{highlighted:this.isUnitHighlighted(unitPosition)}),key:"unit-"+x+"-"+y,onMouseDown:function(e){return _this.onMouseDown(e)},onMouseOver:function(e){return _this.onMouseOver(e)},style:positionToScreen(unitPosition).getLeftTopWidthHeight()}))}}var bottomRightUnitStage=positionToScreen(beltful_1.Stage.fromJS({x:width-1,y:height-1,width:1,height:1}));var style={height:bottomRightUnitStage.y+bottomRightUnitStage.height,width:bottomRightUnitStage.x+bottomRightUnitStage.width};return React.createElement("div",{className:"units-panel",style:style},React.createElement(caladan_1.GlobalEventListener,{mouseUp:function(){return _this.stopTileCreation()}}),units)};UnitsPanel.defaultProps={startRow:0,endRow:Number.POSITIVE_INFINITY};return UnitsPanel}(React.Component);exports.UnitsPanel=UnitsPanel},function(module,exports,__webpack_require__){var content=__webpack_require__(949);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../../node_modules/css-loader/index.js!./units-panel.css",function(){var newContent=require("!!../../../../../../node_modules/css-loader/index.js!./units-panel.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".units-panel .unit{position:absolute;background:#000;opacity:0.05;text-align:center;padding-top:10px;border-radius:2px;cursor:pointer}.units-panel .unit.highlighted,.units-panel .unit:hover{background-color:#1ea3e6;opacity:0.5}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);__webpack_require__(951);var React=__webpack_require__(1);var caladan_1=__webpack_require__(10);function getX(e){return e.touches?e.touches.item(0).clientX:e.clientX}function getY(e){return e.touches?e.touches.item(0).clientY:e.clientY}var CollectionTileWrapper=function(_super){tslib_1.__extends(CollectionTileWrapper,_super);function CollectionTileWrapper(){var _this=_super.call(this)||this;_this.state={};return _this}CollectionTileWrapper.prototype.start=function(sides,e){var _a=this.props,onStart=_a.onStart,position=_a.position;this.startingPoint={x:getX(e),y:getY(e)};var left=sides.indexOf("left")>-1;var right=sides.indexOf("right")>-1;var top=sides.indexOf("top")>-1;var bottom=sides.indexOf("bottom")>-1;var move=sides.indexOf("move")>-1;this.transform=function(deltaX,deltaY,position){var x=position.x,y=position.y,width=position.width,height=position.height;var newPosition=position.changeMany({x:x+(left||move?deltaX:0),y:y+(top||move?deltaY:0),width:left?width-deltaX:right?width+deltaX:width,height:top?height-deltaY:bottom?height+deltaY:height});return newPosition};onStart(position)};CollectionTileWrapper.prototype.onMouseMove=function(e){if(!this.startingPoint)return;var _a=this.props,position=_a.position,onUpdate=_a.onUpdate;var deltaX=getX(e)-this.startingPoint.x;var deltaY=getY(e)-this.startingPoint.y;onUpdate(this.transform(deltaX,deltaY,position))};CollectionTileWrapper.prototype.renderHandles=function(){var _this=this;var enabled=this.props.enabled;return["left","right","top","bottom","top-right","top-left","bottom-right","bottom-left","move"].map(function(s){return React.createElement("div",{className:"edit-handle "+s,key:s,onMouseDown:function(e){return _this.start(s.split("-"),e)},onTouchStart:function(e){return _this.start(s.split("-"),e)}})})};CollectionTileWrapper.prototype.onMouseUp=function(e){if(!this.startingPoint)return;var _a=this.props,position=_a.position,onEnd=_a.onEnd;var deltaX=getX(e)-this.startingPoint.x;var deltaY=getY(e)-this.startingPoint.y;onEnd(this.transform(deltaX,deltaY,position));this.startingPoint=undefined;this.transform=undefined};CollectionTileWrapper.prototype.render=function(){var _this=this;var _a=this.props,children=_a.children,position=_a.position,enabled=_a.enabled;return React.createElement("div",{className:"collection-tile-wrapper",style:position.getLeftTopWidthHeight()},enabled?React.createElement(caladan_1.GlobalEventListener,{mouseMove:function(e){return _this.onMouseMove(e)},touchMove:function(e){return _this.onMouseMove(e)},mouseUp:function(e){return _this.onMouseUp(e)},touchEnd:function(e){return _this.onMouseUp(e)},touchCancel:function(e){return _this.onMouseUp(e)}}):null,children,enabled?this.renderHandles():null)};return CollectionTileWrapper}(React.Component);exports.CollectionTileWrapper=CollectionTileWrapper},function(module,exports,__webpack_require__){var content=__webpack_require__(952);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./collection-tile-wrapper.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./collection-tile-wrapper.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".collection-tile-wrapper .edit-handle{position:absolute}.collection-tile-wrapper .edit-handle.move{left:4px;right:4px;top:36px;bottom:4px;cursor:move}.collection-tile-wrapper .edit-handle.top{top:-4px;right:4px;left:4px;height:8px;cursor:ns-resize}.collection-tile-wrapper .edit-handle.top-left{top:-4px;left:-4px;width:8px;height:8px;cursor:nwse-resize}.collection-tile-wrapper .edit-handle.top-right{top:-4px;right:-4px;width:8px;height:8px;cursor:nesw-resize}.collection-tile-wrapper .edit-handle.left{top:4px;bottom:4px;left:-4px;width:8px;cursor:ew-resize}.collection-tile-wrapper .edit-handle.right{top:4px;right:-4px;bottom:4px;width:8px;cursor:ew-resize}.collection-tile-wrapper .edit-handle.bottom{right:4px;bottom:-4px;left:4px;height:8px;cursor:ns-resize}.collection-tile-wrapper .edit-handle.bottom-left{bottom:-4px;left:-4px;width:8px;height:8px;cursor:nesw-resize}.collection-tile-wrapper .edit-handle.bottom-right{right:-4px;bottom:-4px;width:8px;height:8px;cursor:nwse-resize}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(954);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./dashboard-layout.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./dashboard-layout.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".dashboard-layout{position:absolute;top:0;bottom:0;left:0;right:0;overflow:auto}.dashboard-layout.empty{height:100%;color:#bababa;text-align:center}.dashboard-layout.empty .container{position:absolute;left:50%;top:40%;-webkit-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);transform:translate(-50%, -50%)}.dashboard-layout.empty .container .svg-icon{width:60px;fill:#bababa}.dashboard-layout.empty .container .placeholder{font-size:16px;font-style:italic;margin-top:14px}.dashboard-layout .row-buttons{position:absolute;bottom:20px;left:20px}.dashboard-layout .row-buttons .modify-rows{display:inline-block;margin-right:10px;color:#1ea3e6;font-weight:600;line-height:19px;background:#fff;z-index:7;cursor:pointer;padding:8px 14px 8px 8px;border-radius:2px;-webkit-box-shadow:0 3px 10px 0 rgba(0,0,0,0.26),0 0 3px 0 rgba(0,0,0,0.16);box-shadow:0 3px 10px 0 rgba(0,0,0,0.26),0 0 3px 0 rgba(0,0,0,0.16)}.dashboard-layout .row-buttons .modify-rows svg{width:19px;fill:#1ea3e6;margin-right:3px}.dashboard-layout .row-buttons .modify-rows span{display:inline-block}.dashboard-layout .row-buttons .modify-rows.remove svg{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg)}.dashboard-layout .tile-ghost{position:absolute}.dashboard-layout .tile-ghost:after{content:'';position:absolute;top:-1px;bottom:-1px;left:-1px;right:-1px;border:2px solid #1ea3e6;border-radius:2px;background-color:rgba(30,163,230,0.23)}.dashboard-layout .tile-ghost.invalid:after{border-color:#e24c4c;background-color:rgba(226,76,76,0.22)}.dashboard-layout .collection-tile-wrapper{position:absolute;border-radius:2px}.dashboard-layout .collection-tile-wrapper.editing.invalid .collection-tile-card.editing:after{content:'';pointer-events:none;position:absolute;top:-1px;bottom:-1px;left:-1px;right:-1px;border:2px solid #e24c4c;border-radius:2px}.dashboard-layout .collection-tile-wrapper.positioning{z-index:5;-webkit-box-shadow:0 5px 7px -2px rgba(0,0,0,0.2);box-shadow:0 5px 7px -2px rgba(0,0,0,0.2)}.dashboard-layout .collection-tile-wrapper .collection-tile-card{position:absolute;top:0;bottom:0;left:0;right:0}.dashboard-layout .collection-tile-wrapper .edit-overlay{position:absolute;top:36px;bottom:1px;left:1px;right:1px;background:#fff;opacity:0.5}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(956);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./collection-view.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./collection-view.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".collection-view{position:absolute;top:0;bottom:0;left:0;right:0}.collection-view .header-bar{height:42px}.collection-view .filter-tile{position:absolute;top:42px;height:42px;left:0;right:0;background:#f0f0f0;z-index:1}.collection-view .filter-tile .title{padding-top:16px}.collection-view .filter-tile .items{top:3px;bottom:3px}.collection-view .filter-tile.dummy .placeholder{display:inline-block;height:100%;font-size:13px;color:#a6a6a6;padding:15px 7px 0 16px;cursor:default;font-style:italic}.collection-view .filter-tile.dummy .delete-icon{display:inline-block;height:100%;padding:11px 1px;cursor:pointer;width:31px}.collection-view .filter-tile.dummy .delete-icon svg{width:19px;margin-left:5px;fill:#aaa}.collection-view .filter-tile.dummy .delete-icon:hover:after{content:'';position:absolute;top:5px;left:0;width:31px;height:31px;border-radius:31px;background:black;opacity:0.1}.collection-view .filter-tile.dummy .delete-icon:hover svg{fill:#777}.collection-view .album-layout,.collection-view .dashboard-layout{position:absolute;top:84px;bottom:0;left:0;right:0}.collection-view .collection-items{display:-webkit-box;display:-ms-flexbox;display:flex;width:80%;margin:0 auto;-ms-flex-wrap:wrap;flex-wrap:wrap}.collection-view .collection-items .collection-tile-card{-webkit-box-flex:1;-ms-flex:1 0;flex:1 0;-ms-flex-preferred-size:50%;flex-basis:50%}.collection-view.scrolled .filter-tile{-webkit-box-shadow:0 3px 5px -2px rgba(0,0,0,0.3);box-shadow:0 3px 5px -2px rgba(0,0,0,0.3)}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var ajax_1=__webpack_require__(69);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var immutable_ui_1=__webpack_require__(104);var Icons=__webpack_require__(11);var filesaver=__webpack_require__(468);var chronoshift_1=__webpack_require__(23);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var components_1=__webpack_require__(466);var delegates_1=__webpack_require__(441);var attribute_modal_1=__webpack_require__(958);var dimension_modal_1=__webpack_require__(961);var measure_modal_1=__webpack_require__(964);var cube_edit_header_bar_1=__webpack_require__(967);var theme_1=__webpack_require__(176);__webpack_require__(968);var MY_LABELS=models_1.LABELS.DATA_CUBE;var CubeEditView=function(_super){tslib_1.__extends(CubeEditView,_super);function CubeEditView(){var _this=_super.call(this)||this;_this.tabs=[{label:"General",value:"general",render:function(){return _this.renderGeneral()},icon:Icons.FULL_SETTINGS},{label:"Dimensions",value:"dimensions",render:function(){return _this.renderDimensions()},icon:Icons.FULL_CUBE,noTitle:true},{label:"Measures",value:"measures",render:function(){return _this.renderMeasures()},icon:Icons.MEASURES,noTitle:true},{label:"Sharing",value:"sharing",icon:Icons.USER_GROUP,render:function(){return _this.renderSharing()}},{label:"Advanced",value:"advanced",render:function(){return _this.renderAdvanced()},icon:Icons.FULL_MORE}];_this.mounted=false;_this.formGrid=(new caladan_1.Grid).setColumns([{width:60},{width:40,vAlign:"top"}]);_this.state={};_this.formDelegate=new immutable_ui_1.ImmutableFormDelegate(_this);_this.loadingDelegate=new delegates_1.LoadingMessageDelegate(_this);_this.formDelegate.onAnyChange(function(){var _a=_this.props,dataCube=_a.dataCube,onSave=_a.onSave,onCancel=_a.onCancel;var newInstance=_this.state.newInstance;if(dataCube.equals(newInstance)){caladan_1.GateKeeper.forget()}else{caladan_1.GateKeeper.update({save:function(){return onSave(newInstance)},cancel:onCancel})}});return _this}CubeEditView.prototype.componentWillMount=function(){this.initFromProps(this.props)};CubeEditView.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};CubeEditView.prototype.fetchClustersSources=function(){var _this=this;this.loadingDelegate.start("Loading clusters...");ajax_1.Ajax.query({method:"POST",url:"$mount/cluster-sources",data:{}}).then(function(resp){if(!_this.mounted)return;_this.loadingDelegate.stop();if(!Array.isArray(resp.clusterSources))return;var clusterTypes={};var clusterSources=[];var _loop_1=function(clusterSource){clusterTypes[clusterSource.name]=clusterSource.type;var sources=clusterSource.sources;if(Array.isArray(sources)){clusterSources=clusterSources.concat(sources.map(function(source){return{clusterName:clusterSource.name,clusterTitle:clusterSource.title,source:source}}))}};for(var _i=0,_a=resp.clusterSources;_i<_a.length;_i++){var clusterSource=_a[_i];_loop_1(clusterSource)}_this.setState({clusterTypes:clusterTypes,clusterSources:clusterSources})},function(e){if(!_this.mounted)return;_this.loadingDelegate.stop();caladan_1.Notifier.failure("Sorry","There was a problem loading sources "+e.message)})};CubeEditView.prototype.fetchColumns=function(){var _this=this;var dataCube=this.props.dataCube;this.loadingDelegate.startNow("Loading columns...");ajax_1.Ajax.query({method:"POST",url:"$mount/attributes",data:{clusterName:dataCube.clusterName,source:dataCube.source}}).then(function(resp){if(!_this.mounted)return;_this.loadingDelegate.stop();_this.setState({availableColumns:plywood_1.AttributeInfo.fromJSs(resp.attributes)})},function(e){if(!_this.mounted)return;_this.loadingDelegate.stop()})};CubeEditView.prototype.componentDidMount=function(){this.mounted=true;this.fetchClustersSources();this.fetchColumns()};CubeEditView.prototype.componentWillUnmount=function(){this.mounted=false;caladan_1.GateKeeper.forget()};CubeEditView.prototype.initFromProps=function(props){var dataCube=props.dataCube;if(!dataCube)return;this.setState({newInstance:this.state.newInstance||new models_1.DataCube(props.dataCube.valueOf()),canSave:true,errors:{},modal:null})};CubeEditView.prototype.isDuplicate=function(){var editMode=this.props.editMode;return editMode==="duplicate"};CubeEditView.prototype.onDuplicate=function(){var _a=this.props,settings=_a.settings,user=_a.user;var newInstance=this.state.newInstance;var newName=beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!settings.getDataCube(name)}});this.setState({newInstance:newInstance.makeDuplicate(newName,user)})};CubeEditView.prototype.onExport=function(){var newInstance=this.state.newInstance;var blob=new Blob([JSON.stringify(newInstance,null,2)],{type:"application/json;charset=utf-8"});filesaver.saveAs(blob,"data-cube-"+newInstance.title+".json",true)};CubeEditView.prototype.renderGeneral=function(){var _this=this;var _a=this.props,customization=_a.customization,onDelete=_a.onDelete;var _b=this.state,newInstance=_b.newInstance,errors=_b.errors,clusterSources=_b.clusterSources;var makeLabel=caladan_1.FormLabel.simpleGenerator(MY_LABELS,errors);var makeTextInput=immutable_ui_1.ImmutableTextInput.simpleGenerator(newInstance,this.formDelegate.onChange,MY_LABELS,errors);var makeDropdownInput=immutable_ui_1.ImmutableDropdown.simpleGenerator(newInstance,this.formDelegate.onChange,MY_LABELS,errors);var timezones=customization.getTimezones().map(function(tz){return{label:tz.toString(),value:tz}});var themes=theme_1.Theme.themes.map(function(t){return{label:t,value:t}});var onClusterSourceChange=function(newInstance,valid){_this.setState({newInstance:newInstance,canSave:valid!=null?valid:true})};return React.createElement("div",{className:"form general"},this.formGrid.row([caladan_1.FormLabel.dumbLabel(MY_LABELS["title"].label),makeTextInput("title",/.*/,true)],[]),this.formGrid.row([caladan_1.FormLabel.dumbLabel(MY_LABELS["description"].label),makeTextInput("description")],[]),this.formGrid.row([makeLabel("source"),React.createElement(components_1.ClusterSourcePicker,{key:"cluster-source-picker",className:"input",dataCube:newInstance,clusterSources:clusterSources,onChange:onClusterSourceChange})],React.createElement(caladan_1.InfoSpot,{sourceIds:["source"]})),customization.getIndividualThemes()==="allow"?this.formGrid.row([makeLabel("theme"),makeDropdownInput("theme",themes)],React.createElement(caladan_1.InfoSpot,{sourceIds:["theme"]})):null,this.formGrid.row([makeLabel("defaultTimezone"),makeDropdownInput("defaultTimezone",timezones)],React.createElement(caladan_1.InfoSpot,{sourceIds:["defaultTimezone"]})),this.isDuplicate()?null:React.createElement("div",{className:"buttons"},caladan_1.FormLabel.dumbLabel("Data cube actions"),React.createElement(caladan_1.Button,{type:"warn",className:"secondary-warn",onClick:onDelete,title:strings_1.STRINGS.delete}),React.createElement(caladan_1.Button,{type:"secondary",onClick:function(){return _this.onDuplicate()},title:strings_1.STRINGS.duplicate}),React.createElement(caladan_1.Button,{type:"secondary",onClick:function(){return _this.onExport()},title:strings_1.STRINGS.export})))};CubeEditView.prototype.renderDimensions=function(){var _this=this;var _a=this.state,newInstance=_a.newInstance,availableColumns=_a.availableColumns;var onChange=function(newCube){_this.setState({newInstance:newCube})};var onDimensionsChange=function(newDimensions){onChange(newInstance.changeDimensions(newDimensions))};var getModal=function(item){return React.createElement(dimension_modal_1.DimensionModal,{availableColumns:availableColumns,suggestedDimensions:newInstance.getSuggestedDimensions(availableColumns||[]),dimension:item})};var getNewDimension=function(){return models_1.Dimension.fromJS({name:beltful_1.StringUtils.generateAvailableName({prefix:"d",minTokens:3,isAvailable:function(name){return!immutable_class_1.NamedArray.findByName(newInstance.dimensions,name)}}),title:"New dimension",formula:"$column"})};var getDimensionsRows=function(items){return items.map(function(dimension){var fromColumn=dimension.fromColumn();return{title:dimension.title,description:fromColumn?"Column: "+fromColumn:"Derived: "+dimension.formula,icon:dimension.getIcon()}})};var DimensionsList=immutable_ui_1.ImmutableList.specialize();return React.createElement(DimensionsList,{groupField:"group",label:strings_1.STRINGS.dimensions,className:"dimension-list",items:newInstance.dimensions,onChange:onDimensionsChange,getModal:getModal,getNewItem:getNewDimension,getRows:getDimensionsRows,preAddHook:newInstance.straightenDimensionName.bind(newInstance)})};CubeEditView.prototype.renderMeasures=function(){var _this=this;var _a=this.state,newInstance=_a.newInstance,availableColumns=_a.availableColumns;var onChange=function(newMeasures){var defaultSortMeasure=newInstance.defaultSortMeasure;if(defaultSortMeasure){if(!immutable_class_1.NamedArray.findByName(newMeasures,defaultSortMeasure)){newInstance=newInstance.changeDefaultSortMeasure(null)}}var newCube=newInstance.changeMeasures(newMeasures);_this.setState({newInstance:newCube})};var getModal=function(item){return React.createElement(measure_modal_1.MeasureModal,{availableColumns:availableColumns,suggestedMeasures:newInstance.getSuggestedMeasures(availableColumns),measure:item,validateFormula:newInstance.validateMeasureFormula.bind(newInstance)})};var getNewItem=function(){var numericDimension=immutable_class_1.SimpleArray.find(newInstance.dimensions,function(a){return a.type==="NUMBER"});var attr=numericDimension?numericDimension.name:"column";return models_1.Measure.fromJS({name:beltful_1.StringUtils.generateAvailableName({prefix:"m",minTokens:3,isAvailable:function(name){return!newInstance.getMeasure(name)}}),title:"New measure",formula:plywood_1.$("main").sum(plywood_1.$(attr)).toString()})};var getRows=function(items){return items.map(function(measure){return{title:measure.title,description:measure.formula+(measure.getTransform()==="none"?"":" [transform: "+measure.getTransform()+"]"),icon:Icons.MEASURES}})};var MeasuresList=immutable_ui_1.ImmutableList.specialize();return React.createElement(MeasuresList,{label:strings_1.STRINGS.measures,groupField:"group",className:"measure-list",items:newInstance.measures,onChange:onChange.bind(this),getModal:getModal,getNewItem:getNewItem,getRows:getRows,preAddHook:newInstance.straightenMeasureName.bind(newInstance)})};CubeEditView.prototype.renderSharing=function(){var _this=this;var _a=this.props,settings=_a.settings,user=_a.user;var newInstance=this.state.newInstance;var onAccessChange=function(v,propName){return _this.formDelegate.onChange(newInstance.change(propName,v),true,propName,undefined)};return React.createElement("div",{className:"form general"},React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-50 h-padded top"},caladan_1.FormLabel.dumbLabel(MY_LABELS["readAccess"].label),React.createElement(components_1.AccessListEditor,{value:newInstance.getReadAccess(),user:user,availableUsers:settings.getUsers(),onChange:function(v){return onAccessChange(v,"readAccess")},accessLabel:"view"})),React.createElement("div",{className:"grid-col-50 h-padded top"},caladan_1.FormLabel.dumbLabel(MY_LABELS["modifyAccess"].label),React.createElement(components_1.AccessListEditor,{value:newInstance.getModifyAccess(),user:user,availableUsers:settings.getUsers(),onChange:function(v){return onAccessChange(v,"modifyAccess")},accessLabel:"modify"}))))};CubeEditView.prototype.validateSubsetFormula=function(formula){if(formula==="")return true;var newInstance=this.state.newInstance;return newInstance.validateFilterFormula(formula)};CubeEditView.prototype.renderAdvanced=function(){var _this=this;var settings=this.props.settings;var _a=this.state,newInstance=_a.newInstance,errors=_a.errors,clusterTypes=_a.clusterTypes;var clusterType=newInstance.getClusterType(clusterTypes);var makeLabel=caladan_1.FormLabel.simpleGenerator(MY_LABELS,errors);var makeTextInput=immutable_ui_1.ImmutableTextInput.simpleGenerator(newInstance,this.formDelegate.onChange,MY_LABELS,errors);var makeDropdownInput=immutable_ui_1.ImmutableDropdown.simpleGenerator(newInstance,this.formDelegate.onChange,MY_LABELS,errors);var stringify=function(obj){var str=JSON.stringify(obj,null,2);return str==="{}"?"{\n\n}":str};var onChange=function(newCube){_this.setState({newInstance:newCube})};var onAttributesChange=function(attributes){onChange(newInstance.changeAttributes(attributes))};var getModal=function(item){return React.createElement(attribute_modal_1.AttributeModal,{clusterType:clusterType,attribute:item})};var getNewAttribute=function(){return plywood_1.AttributeInfo.fromJS({name:"column_name",type:"NULL"})};var getAttributeRows=function(items){return items.map(function(attribute){var type=attribute.type||"No Type";if(attribute.nativeType){type=type==="NULL"?attribute.nativeType:type+" ["+attribute.nativeType+"]"}return{title:attribute.name,description:type}})};var AttributesList=immutable_ui_1.ImmutableList.specialize();var arrayToString=function(value){return value?value.join(", "):null};var stringToArray=function(str){return str?str.split(/\s*,\s*/):null};var simpleArrayInput=function(pathName,validator){return makeTextInput(pathName,validator,false,{stringToValue:stringToArray,valueToString:arrayToString})};var validateFilter=function(filterString){if(filterString==="")return true;var filter=models_1.Filter.fromExpression(filterString);return filter.clauses.every(function(c){return Boolean(immutable_class_1.NamedArray.findIndexByName(newInstance.dimensions,c.dimension))})};var splitsToString=function(splits){return arrayToString(splits.splitCombines.map(function(s){return s.dimension}))};var stringToSplits=function(str){if(!str)return models_1.Splits.EMPTY;var combinesJSes=stringToArray(str).map(function(combineJS){return models_1.SplitCombine.fromJS(combineJS)});return models_1.Splits.fromJS(combinesJSes)};var validateDims=function(dimArray){if(dimArray==="")return true;stringToArray(dimArray).forEach(function(d){if(!immutable_class_1.NamedArray.findByName(newInstance.dimensions,d)){throw new Error("Could not find dimension "+d)}});return true};var validateMeasures=function(measureArray){if(measureArray==="")return true;stringToArray(measureArray).forEach(function(m){if(!newInstance.getMeasure(m)){throw new Error("Could not find measure "+m)}});return true};var timeDimensionNames=[{value:models_1.DataCube.NO_SPECIAL_TIME_DIMENSION,label:"None"}].concat(newInstance.getDimensions().map(function(d){if(d.getType()!=="TIME")return null;return{value:d.name,label:d.title}}).filter(Boolean));var measureNames=newInstance.getMeasures().map(function(m){return{value:m.name,label:m.title}});var enforceTimeFilterOptions=[{value:false,label:"Do not force a time filter"},{value:true,label:"Always force a time filter"}];var hasSpecialTimeDimension=Boolean(newInstance.getSpecialTimeDimensionObject());return React.createElement("div",{className:"form advanced"},this.formGrid.row([makeLabel("subsetFormula"),makeTextInput("subsetFormula",this.validateSubsetFormula.bind(this))],React.createElement(caladan_1.InfoSpot,{sourceIds:["subsetFormula"]})),this.formGrid.row([makeLabel("specialTimeDimension"),makeDropdownInput("specialTimeDimension",timeDimensionNames)],React.createElement(caladan_1.InfoSpot,{sourceIds:["specialTimeDimension"]})),hasSpecialTimeDimension?this.formGrid.row([makeLabel("enforceTimeFilter"),makeDropdownInput("enforceTimeFilter",enforceTimeFilterOptions)],React.createElement(caladan_1.InfoSpot,{sourceIds:["enforceTimeFilter"]})):null,hasSpecialTimeDimension&&newInstance.getEnforceTimeFilter()?this.formGrid.row([makeLabel("defaultDuration"),makeTextInput("defaultDuration",null,false,{stringToValue:function(s){return chronoshift_1.Duration.fromJS(s)},valueToString:function(v){return v.toJS()}})],React.createElement(caladan_1.InfoSpot,{sourceIds:["defaultDuration"]})):null,this.formGrid.row([makeLabel("instances"),makeTextInput("instances",null,false,{stringToValue:function(s){var p=JSON.parse(s);return p&&typeof p==="object"?models_1.Instances.fromJS(p):null},valueToString:function(v){return JSON.stringify(v)}})],React.createElement(caladan_1.InfoSpot,{sourceIds:["instances"]})),this.formGrid.row([makeLabel("defaultSortMeasure"),makeDropdownInput("defaultSortMeasure",measureNames)],React.createElement(caladan_1.InfoSpot,{sourceIds:["defaultSortMeasure"]})),this.formGrid.row([makeLabel("defaultSelectedMeasures"),simpleArrayInput("defaultSelectedMeasures",validateMeasures)],React.createElement(caladan_1.InfoSpot,{sourceIds:["defaultSelectedMeasures"]})),this.formGrid.row([makeLabel("defaultPinnedDimensions"),simpleArrayInput("defaultPinnedDimensions",validateDims)],React.createElement(caladan_1.InfoSpot,{sourceIds:["defaultPinnedDimensions"]})),this.formGrid.row([makeLabel("defaultRefreshRate"),makeTextInput("defaultRefreshRate",null,false,{stringToValue:function(s){return chronoshift_1.Duration.fromJS(s)},valueToString:function(v){return v.toJS()}})],React.createElement(caladan_1.InfoSpot,{sourceIds:["defaultRefreshRate"]})),this.formGrid.row([makeLabel("refreshTimeWith"),makeDropdownInput("refreshTimeWith",CubeEditView.REFRESH_TIME_WITH)],React.createElement(caladan_1.InfoSpot,{sourceIds:["refreshTimeWith"]})),this.formGrid.row([makeLabel("options"),React.createElement(immutable_ui_1.ImmutableTextInput,{type:"textarea",key:"input-options",instance:newInstance,path:"options",onChange:this.formDelegate.onChange,converters:{valueToString:function(value){return value?stringify(value):undefined},stringToValue:function(str){return str?JSON.parse(str):undefined}}})],React.createElement(caladan_1.InfoSpot,{sourceIds:["options"]})),React.createElement(AttributesList,{label:strings_1.STRINGS.specialColumns,className:"columns",items:newInstance.attributes,onChange:onAttributesChange,getModal:getModal,getNewItem:getNewAttribute,getRows:getAttributeRows,disableReordering:true}),this.formGrid.row([makeLabel("defaultFilter"),makeTextInput("defaultFilter",validateFilter,false,{valueToString:function(value){return value?JSON.stringify(value.toJS(),null,2):null},stringToValue:function(str){return str?models_1.Filter.fromJS(JSON.parse(str)):null}})],React.createElement(caladan_1.InfoSpot,{sourceIds:["defaultFilter"]})),this.formGrid.row([makeLabel("defaultSplits"),makeTextInput("defaultSplits",validateDims,false,{stringToValue:stringToSplits,valueToString:splitsToString})],React.createElement(caladan_1.InfoSpot,{sourceIds:["defaultSplits"]})))};CubeEditView.prototype.getTitle=function(){var editMode=this.props.editMode;var newInstance=this.state.newInstance;var lastBit=newInstance.title?": "+newInstance.title:"";return(editMode==="create"?strings_1.STRINGS.createNewDataCube:strings_1.STRINGS.editDataCube)+lastBit};CubeEditView.prototype.render=function(){var _a=this.props,settings=_a.settings,dataCube=_a.dataCube,user=_a.user,customization=_a.customization,controller=_a.controller,onCancel=_a.onCancel,onSave=_a.onSave;var _b=this.state,newInstance=_b.newInstance,modal=_b.modal;if(!newInstance||!dataCube)return null;var theme=customization.getPreferredTheme(newInstance.theme);var myTabs=settings.hasUsers()?this.tabs:this.tabs.filter(function(tab){return tab.value!=="sharing"});return React.createElement("div",{className:"cube-edit-view"},React.createElement(cube_edit_header_bar_1.CubeEditHeaderBar,{customization:customization,dataCube:newInstance,onNavClick:controller.openSideDrawer,onCancel:onCancel,onSave:function(){return onSave(newInstance)}}),React.createElement("div",{className:"cube-edit-content",style:{background:theme.backgroundColor}},React.createElement(components_1.FlatModal,{tabs:myTabs,theme:theme})),modal?modal.render.bind(this)():null)};CubeEditView.REFRESH_TIME_WITH=[{value:"query",label:"Query (default)"},{value:"predefined",label:"Predefined to latest time"}];return CubeEditView}(React.Component);exports.CubeEditView=CubeEditView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var immutable_ui_1=__webpack_require__(104);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var models=__webpack_require__(19);var strings_1=__webpack_require__(17);__webpack_require__(959);var LABELS=models.LABELS.ATTRIBUTE;function checkSpecialTimeAttribute(attributeInfo,isSpecialTimeAttribute){return!isSpecialTimeAttribute||attributeInfo.type==="TIME"}function toListItem(v){return{label:v,value:v}}var AttributeModal=function(_super){tslib_1.__extends(AttributeModal,_super);function AttributeModal(){var _this=_super.call(this)||this;_this.delegate=new immutable_ui_1.ImmutableFormDelegate(_this);return _this}AttributeModal.prototype.componentWillMount=function(){this.initFromProps(this.props)};AttributeModal.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};AttributeModal.prototype.initFromProps=function(props){if(props.attribute){this.setState({newInstance:props.attribute,canSave:props.mode==="create",errors:{},isSpecialTimeSelected:props.isSpecialTimeAttribute})}};AttributeModal.prototype.save=function(){var _a=this.props,onSave=_a.onSave,isSpecialTimeAttribute=_a.isSpecialTimeAttribute;var _b=this.state,canSave=_b.canSave,newInstance=_b.newInstance;var isSpecialTimeToggled=this.isSpecialTimeToggled();if(!canSave&&!isSpecialTimeToggled||!checkSpecialTimeAttribute(newInstance,isSpecialTimeAttribute))return;onSave(newInstance.changeType("NULL"),isSpecialTimeToggled)};AttributeModal.prototype.toggleSplittable=function(){var newInstance=this.state.newInstance;var toggled=newInstance.change("unsplitable",!newInstance.unsplitable);return this.delegate.onChange(toggled,true,"unsplitable",undefined)};AttributeModal.prototype.isSpecialTimeToggled=function(){var isSpecialTimeAttribute=this.props.isSpecialTimeAttribute;var isSpecialTimeSelected=this.state.isSpecialTimeSelected;return isSpecialTimeSelected!==isSpecialTimeAttribute};AttributeModal.prototype.toggleIsPrimary=function(){this.setState({isSpecialTimeSelected:!this.state.isSpecialTimeSelected})};AttributeModal.prototype.renderIsPrimaryCheckbox=function(){var _a=this.state,newInstance=_a.newInstance,isSpecialTimeSelected=_a.isSpecialTimeSelected;if(newInstance.type!=="TIME")return null;return React.createElement("div",{className:"row"},React.createElement(caladan_1.Checkbox,{onClick:this.toggleIsPrimary.bind(this),label:LABELS.isPrimary.label,selected:isSpecialTimeSelected,helpText:LABELS.isPrimary.description}))};AttributeModal.prototype.renderButtons=function(){var _a=this.props,attribute=_a.attribute,onClose=_a.onClose;var _b=this.state,newInstance=_b.newInstance,canSave=_b.canSave;var saveButtonDisabled=!canSave||attribute.equals(newInstance);return React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{className:"cancel",title:"Cancel",type:"secondary",onClick:onClose}),React.createElement(caladan_1.Button,{className:classNames("save",{disabled:saveButtonDisabled}),title:"OK",type:"primary",onClick:this.save.bind(this)}))};AttributeModal.prototype.render=function(){var _a=this.props,onClose=_a.onClose,mode=_a.mode,clusterType=_a.clusterType;var _b=this.state,newInstance=_b.newInstance,errors=_b.errors;if(!newInstance)return null;var unsplittable=newInstance.getUnsplitable();var makeLabel=caladan_1.FormLabel.simpleGenerator(LABELS,errors);var makeDropdownInput=immutable_ui_1.ImmutableDropdown.simpleGenerator(newInstance,this.delegate.onChange,LABELS,errors);var makeTextInput=immutable_ui_1.ImmutableTextInput.simpleGenerator(newInstance,this.delegate.onChange,LABELS,errors);var nativeTypes=AttributeModal.NATIVE_TYPES[clusterType]||AttributeModal.NATIVE_TYPES["druid"];return React.createElement(caladan_1.Modal,{className:"attribute-modal",title:mode==="create"?strings_1.STRINGS.createColumn:strings_1.STRINGS.editColumn,onClose:onClose,onEnter:this.save.bind(this)},React.createElement("form",null,makeLabel("name","name",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["name"]})),makeTextInput("name",/^.+$/,true),makeLabel("nativeType","nativeType",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["nativeType"]})),makeDropdownInput("nativeType",nativeTypes.map(toListItem)),React.createElement("div",{className:"row"},React.createElement(caladan_1.Checkbox,{onClick:this.toggleSplittable.bind(this),label:LABELS.unsplittable.label,helpText:LABELS.unsplittable.description,selected:unsplittable}))),this.renderButtons())};AttributeModal.NATIVE_TYPES={druid:["__time","LONG","FLOAT","STRING","hyperUnique","approximateHistogram","thetaSketch"],druidsql:["TIMESTAMP","DATE","VARCHAR","FLOAT","BIGINT"],mysql:["datetime","timestamp","varchar","int","bigint","decimal","float","double","tinyint"],postgress:["timestamp","character varying","integer","bigint","double precision","float","boolean"]};AttributeModal.defaultProps={mode:"edit"};return AttributeModal}(React.Component);exports.AttributeModal=AttributeModal},function(module,exports,__webpack_require__){var content=__webpack_require__(960);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./attribute-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./attribute-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".attribute-modal form{width:448px}.attribute-modal form.vertical>*{display:block}.attribute-modal form input{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.attribute-modal form input:hover{border-color:#b8b8b8}.attribute-modal form input:focus{border-color:#1ea3e6}.attribute-modal form input.error{border-color:#e24c4c}.attribute-modal form .dropdown .dropdown-label{margin-bottom:8px}.attribute-modal form input:not(.actionable),.attribute-modal form .input:not(.actionable),.attribute-modal form .checkbox:not(.actionable){margin-bottom:25px}.attribute-modal form textarea{height:120px;outline:none;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:13px;line-height:16px;padding:6px;margin-bottom:25px}.attribute-modal form .checkbox{height:20px;width:100%}.attribute-modal form .checkbox .label{position:absolute;left:25px;top:5px}.attribute-modal form{width:448px}.attribute-modal form.vertical>*{display:block}.attribute-modal form .dropdown .dropdown-label{margin-bottom:8px}.attribute-modal form input:not(.actionable),.attribute-modal form .input:not(.actionable),.attribute-modal form .checkbox:not(.actionable){margin-bottom:25px}.attribute-modal form textarea{height:120px;outline:none;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:13px;line-height:16px;padding:6px;margin-bottom:25px}.attribute-modal form .checkbox{height:20px;width:100%}.attribute-modal form .checkbox .label{position:absolute;left:25px;top:5px}.attribute-modal form input{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px}.attribute-modal form input:hover{border-color:#b8b8b8}.attribute-modal form input:focus{border-color:#1ea3e6}.attribute-modal form input.error{border-color:#e24c4c}.attribute-modal form input.disabled{pointer-events:none;background:#f2f2f2}.attribute-modal form{width:100%}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var immutable_ui_1=__webpack_require__(104);var classNames=__webpack_require__(4);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models=__webpack_require__(19);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);__webpack_require__(962);var LABELS=models.LABELS.DIMENSION;var DimensionModal=function(_super){tslib_1.__extends(DimensionModal,_super);function DimensionModal(){var _this=_super.call(this)||this;_this.tabs=[{label:"Simple dimension",value:"simple",render:_this.renderSimple},{label:"Custom dimension",value:"custom",render:_this.renderCustom},{label:"Suggestions",value:"suggestions",render:_this.renderSuggestions}];_this.state={selectedTab:_this.tabs[0].value};_this.delegate=new immutable_ui_1.ImmutableFormDelegate(_this);return _this}DimensionModal.prototype.initStateFromProps=function(props){var newState={};if(props.dimension){newState.newInstance=props.dimension;var isSimple=props.dimension.expression instanceof plywood_1.RefExpression;newState.selectedTab=this.tabs[isSimple?0:1].value;newState.showUrl=Boolean(props.dimension.url)}if(props.suggestedDimensions){newState.selectedSuggestions={};props.suggestedDimensions.forEach(function(d){return newState.selectedSuggestions[d.name]=true})}this.setState(newState)};DimensionModal.prototype.componentWillReceiveProps=function(nextProps){this.initStateFromProps(nextProps)};DimensionModal.prototype.componentDidMount=function(){this.initStateFromProps(this.props)};DimensionModal.prototype.save=function(){if(!this.state.canSave)return;this.props.onSave(this.state.newInstance)};DimensionModal.prototype.saveMany=function(dimensions){this.props.onSaveMany(dimensions)};DimensionModal.prototype.changeTab=function(value){var _this=this;var newInstance=this.state.newInstance;this.setState({selectedTab:value,newInstance:undefined},function(){return _this.setState({newInstance:newInstance})})};DimensionModal.prototype.verifyFormula=function(formula){if(formula==="")return true;var ex=plywood_1.Expression.parse(formula);var freeReferences=ex.getFreeReferences();if(freeReferences.length===0){throw new Error("can not have a constant formula, must have at least one attribute reference")}return true};DimensionModal.prototype.renderButtonGroup=function(){var _this=this;var _a=this.props,mode=_a.mode,suggestedDimensions=_a.suggestedDimensions;var selectedTab=this.state.selectedTab;var suggestionsLength=suggestedDimensions.length>9?"9+":String(suggestedDimensions.length);var items=this.tabs.filter(function(tab){return mode==="create"||tab.value!=="suggestions"}).map(function(tab){return{title:tab.label,className:tab.value,active:selectedTab===tab.value,onClick:_this.changeTab.bind(_this,tab.value),badge:tab.value==="suggestions"?suggestionsLength:undefined}});return React.createElement(caladan_1.ButtonGroup,{items:items,canHaveFocus:false})};DimensionModal.prototype.renderTabContent=function(generators){var selectedTab=this.state.selectedTab;var tab=this.tabs.filter(function(t){return t.value===selectedTab})[0];if(!tab)return null;return tab.render.call(this,generators)};DimensionModal.prototype.renderTypeSpecificInputs=function(generators){var _this=this;var _a=this.state,newInstance=_a.newInstance,showUrl=_a.showUrl;var label=generators.label,input=generators.input,dropdown=generators.dropdown;var elements=[];elements.push(label("comboType","comboType",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["comboType"]})));elements.push(dropdown("comboType",models_1.Dimension.COMBO_TYPES_NORMAL));if(newInstance.isContinuous()){elements.push(label("bucketingStrategy","bucketingStrategy",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["bucketingStrategy"]})));elements.push(dropdown("bucketingStrategy",models_1.Dimension.BUCKETING_STRATEGIES));if(newInstance.getBucketingStrategy()!=="neverBucket"){elements.push(label("granularities","granularities",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["granularities"]})));elements.push(React.cloneElement(input("granularities"),{converters:{valueToString:function(value){return value?value.map(function(v){return v.toString()}).join(", "):undefined},stringToValue:function(str){return str.split(/\s*,\s*/).map(function(g){return models_1.Granularity.fromJS(g)})}}}))}}if(newInstance.isGeo()){elements.push(label("geoEncoding","geoEncoding",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["geoEncoding"]})));elements.push(dropdown("geoEncoding",models_1.Dimension.GEO_ENCODINGS.map(function(e){return{label:e,value:e}})))}if(!newInstance.isContinuous()){if(showUrl){elements.push(label("url","url",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["url"]})));elements.push(input("url"))}else{elements.push(React.createElement("div",{className:"add-url",key:"add-url",onClick:function(){return _this.setState({showUrl:true})}},"Add URL"))}}return elements};DimensionModal.prototype.renderSimple=function(generators){var availableColumns=this.props.availableColumns;var _a=this.state,newInstance=_a.newInstance,errors=_a.errors;var label=generators.label,input=generators.input,dropdown=generators.dropdown;var columnSuggestions=(availableColumns||[]).map(function(attribute){return{label:attribute.name,value:attribute.name}});return React.createElement("form",{className:"general vertical"},label("title"),input("title",/.*/,true),label("column","column",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["column"]})),dropdown("column",columnSuggestions),this.renderTypeSpecificInputs(generators))};DimensionModal.prototype.renderCustom=function(generators){var label=generators.label,input=generators.input;return React.createElement("form",{className:"general vertical"},label("title"),input("title",/.*/,true),label("formula","formula",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["formula"]})),input("formula",this.verifyFormula.bind(this)),this.renderTypeSpecificInputs(generators))};DimensionModal.prototype.renderSuggestions=function(generators){var _this=this;var suggestedDimensions=this.props.suggestedDimensions;var selectedSuggestions=this.state.selectedSuggestions;if(suggestedDimensions.length===0){return React.createElement("div",{className:"suggestions"},React.createElement("div",{className:"items"},React.createElement("div",{className:"message"},strings_1.STRINGS.thereAreNoSuggestionsAtTheMoment)))}var none=function(){_this.setState({selectedSuggestions:{}})};var all=function(){var allSuggestions={};suggestedDimensions.forEach(function(_a){var name=_a.name;return allSuggestions[name]=true});_this.setState({selectedSuggestions:allSuggestions})};var toggle=function(name){selectedSuggestions[name]=!selectedSuggestions[name];_this.setState({selectedSuggestions:selectedSuggestions})};var items=suggestedDimensions.map(function(_a){var title=_a.title,name=_a.name;return React.createElement("div",{className:"row",key:name,onClick:toggle.bind(_this,name)},React.createElement(caladan_1.Checkbox,{label:title,selected:selectedSuggestions[name]}))});return React.createElement("div",{className:"suggestions"},React.createElement("div",{className:"buttons"},React.createElement(caladan_1.Button,{type:"light-action",onClick:all,title:"Select all"}),React.createElement(caladan_1.Button,{type:"light-action",onClick:none,title:"Select none"})),React.createElement("div",{className:"items"},items))};DimensionModal.prototype.renderSuggestionsButtons=function(){var _a=this.props,dimension=_a.dimension,onClose=_a.onClose,suggestedDimensions=_a.suggestedDimensions;var _b=this.state,selectedTab=_b.selectedTab,selectedSuggestions=_b.selectedSuggestions;var dimensionsToAdd=suggestedDimensions.filter(function(d){return selectedSuggestions[d.name]});var n=dimensionsToAdd.length;return React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{className:"cancel",title:"Cancel",type:"secondary",onClick:onClose}),n>0?React.createElement(caladan_1.Button,{className:classNames("save",{disabled:dimensionsToAdd.length<=0}),title:"Add "+n+" dimension"+(n>1?"s":""),type:"primary",onClick:this.saveMany.bind(this,dimensionsToAdd)}):null)};DimensionModal.prototype.renderButtons=function(){var _a=this.props,dimension=_a.dimension,onClose=_a.onClose;var _b=this.state,newInstance=_b.newInstance,canSave=_b.canSave,selectedTab=_b.selectedTab;if(selectedTab===this.tabs[2].value){return this.renderSuggestionsButtons()}var saveButtonDisabled=!canSave||dimension.equals(newInstance);return React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{className:"cancel",title:"Cancel",type:"secondary",onClick:onClose}),React.createElement(caladan_1.Button,{className:classNames("save",{disabled:saveButtonDisabled}),title:"OK",type:"primary",onClick:this.save.bind(this)}))};DimensionModal.prototype.render=function(){var _a=this.props,onClose=_a.onClose,mode=_a.mode;var _b=this.state,newInstance=_b.newInstance,errors=_b.errors;if(!newInstance)return null;var myLabels=LABELS;delete myLabels["title"].description;var generators={label:caladan_1.FormLabel.simpleGenerator(myLabels,errors),input:immutable_ui_1.ImmutableTextInput.simpleGenerator(newInstance,this.delegate.onChange,myLabels,errors),dropdown:immutable_ui_1.ImmutableDropdown.simpleGenerator(newInstance,this.delegate.onChange,myLabels,errors),checkbox:immutable_ui_1.ImmutableCheckbox.simpleGenerator(newInstance,this.delegate.onChange,myLabels,errors)};return React.createElement(caladan_1.Modal,{className:"dimension-modal",title:mode==="create"?strings_1.STRINGS.createDimension:strings_1.STRINGS.editDimension,onClose:onClose,onEnter:this.save.bind(this)},React.createElement("div",{className:"form general vertical"},this.renderButtonGroup(),this.renderTabContent(generators),this.renderButtons()))};return DimensionModal}(React.Component);exports.DimensionModal=DimensionModal},function(module,exports,__webpack_require__){var content=__webpack_require__(963);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./dimension-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./dimension-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".dimension-modal form{width:448px}.dimension-modal form.vertical>*{display:block}.dimension-modal form input{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.dimension-modal form input:hover{border-color:#b8b8b8}.dimension-modal form input:focus{border-color:#1ea3e6}.dimension-modal form input.error{border-color:#e24c4c}.dimension-modal form .dropdown .dropdown-label{margin-bottom:8px}.dimension-modal form input:not(.actionable),.dimension-modal form .input:not(.actionable),.dimension-modal form .checkbox:not(.actionable){margin-bottom:25px}.dimension-modal form textarea{height:120px;outline:none;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:13px;line-height:16px;padding:6px;margin-bottom:25px}.dimension-modal form .checkbox{height:20px;width:100%}.dimension-modal form .checkbox .label{position:absolute;left:25px;top:5px}.dimension-modal form{width:448px}.dimension-modal form.vertical>*{display:block}.dimension-modal form .dropdown .dropdown-label{margin-bottom:8px}.dimension-modal form input:not(.actionable),.dimension-modal form .input:not(.actionable),.dimension-modal form .checkbox:not(.actionable){margin-bottom:25px}.dimension-modal form textarea{height:120px;outline:none;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:13px;line-height:16px;padding:6px;margin-bottom:25px}.dimension-modal form .checkbox{height:20px;width:100%}.dimension-modal form .checkbox .label{position:absolute;left:25px;top:5px}.dimension-modal form input{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px}.dimension-modal form input:hover{border-color:#b8b8b8}.dimension-modal form input:focus{border-color:#1ea3e6}.dimension-modal form input.error{border-color:#e24c4c}.dimension-modal form input.disabled{pointer-events:none;background:#f2f2f2}.dimension-modal .suggestions .items{background:#f5f5f5;padding:10px 0;max-height:300px;overflow:auto}.dimension-modal .suggestions .items .message{padding:4px 10px;color:#999;font-style:italic}.dimension-modal .suggestions .items .row{padding-left:14px;padding-top:3px;height:27px;cursor:pointer;white-space:nowrap}.dimension-modal .suggestions .items .row .label{position:absolute;top:5px;left:24px}.dimension-modal .suggestions .items .row:hover{background:#eee}.dimension-modal form{width:100%}.dimension-modal form .dropdown.column+.light-action,.dimension-modal form input.column+.light-action{margin-top:-20px;margin-bottom:10px}.dimension-modal form .dropdown-menu{max-height:230px;overflow:auto}.dimension-modal .suggestions .items{margin-bottom:25px}.dimension-modal .suggestions .items .checkbox{margin-bottom:5px}.dimension-modal .add-url{display:inline-block;margin-bottom:25px;color:#1ea3e6;cursor:pointer}.dimension-modal .button-group{margin-bottom:20px}.dimension-modal .button-bar{text-align:right}.dimension-modal .modal{width:550px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var immutable_ui_1=__webpack_require__(104);var classNames=__webpack_require__(4);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var models_2=__webpack_require__(19);var strings_1=__webpack_require__(17);var components_1=__webpack_require__(466);var general_1=__webpack_require__(43);__webpack_require__(965);var MY_LABELS=models_1.LABELS.MEASURE;var MEASURE_TRANSFORMS=[{label:"None",value:"none"},{label:"Percent of parent segment",value:"percent-of-parent"},{label:"Percent of total",value:"percent-of-root"}];var MeasureModal=function(_super){tslib_1.__extends(MeasureModal,_super);function MeasureModal(){var _this=_super.call(this)||this;_this.tabs=[{label:"Simple measure",value:"simple",render:_this.renderSimple,enabled:function(mode){return true}},{label:"Custom measure",value:"custom",render:_this.renderCustom,enabled:function(mode){return true}},{label:"Suggestions",value:"suggestions",render:_this.renderSuggestions,enabled:function(mode){return mode==="create"}}];_this.state={selectedTab:_this.tabs[0].value};_this.delegate=new immutable_ui_1.ImmutableFormDelegate(_this);return _this}MeasureModal.prototype.initFromProps=function(props){var newState={canSave:props.mode==="create"};if(props.measure){newState.newInstance=props.measure;var simpleFormula=models_2.MeasureFormula.fromFormula(props.measure.formula);if(!simpleFormula||props.measure.getTransform()!=="none"){newState.selectedTab=this.tabs[1].value}}if(props.suggestedMeasures){newState.selectedSuggestions={};props.suggestedMeasures.forEach(function(d){return newState.selectedSuggestions[d.name]=true})}this.setState(newState)};MeasureModal.prototype.componentWillMount=function(){this.initFromProps(this.props)};MeasureModal.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};MeasureModal.prototype.save=function(){if(!this.state.canSave)return;this.props.onSave(this.state.newInstance)};MeasureModal.prototype.saveMany=function(measures){this.props.onSaveMany(measures)};MeasureModal.prototype.changeTab=function(value){var _this=this;var newInstance=this.state.newInstance;this.setState({selectedTab:value,newInstance:undefined},function(){return _this.setState({newInstance:newInstance})})};MeasureModal.prototype.renderButtonGroup=function(){var _this=this;var _a=this.props,mode=_a.mode,suggestedMeasures=_a.suggestedMeasures;var selectedTab=this.state.selectedTab;var suggestionsLength=suggestedMeasures.length>9?"9+":String(suggestedMeasures.length);var items=this.tabs.filter(function(tab){return tab.enabled(mode)}).map(function(tab){return{title:tab.label,className:tab.value,active:selectedTab===tab.value,onClick:_this.changeTab.bind(_this,tab.value),badge:tab.value==="suggestions"?suggestionsLength:undefined}});return React.createElement(caladan_1.ButtonGroup,{items:items,canHaveFocus:false})};MeasureModal.prototype.renderTabContent=function(){var _a=this.state,selectedTab=_a.selectedTab,newInstance=_a.newInstance,errors=_a.errors;var myLabels=MY_LABELS;delete myLabels["title"].description;var generators={label:caladan_1.FormLabel.simpleGenerator(myLabels,errors),input:immutable_ui_1.ImmutableTextInput.simpleGenerator(newInstance,this.delegate.onChange,myLabels,errors),dropdown:immutable_ui_1.ImmutableDropdown.simpleGenerator(newInstance,this.delegate.onChange,myLabels,errors)};var tab=this.tabs.filter(function(t){return t.value===selectedTab})[0];if(!tab)return null;return tab.render.call(this,generators)};MeasureModal.prototype.renderSimple=function(generators){var _this=this;var _a=this.props,validateFormula=_a.validateFormula,mode=_a.mode,availableColumns=_a.availableColumns;var _b=this.state,newInstance=_b.newInstance,errors=_b.errors;return React.createElement("div",{className:"general vertical form"},React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-70 h-padded"},generators.label("title"),generators.input("title",/^.+$/,true)),React.createElement("div",{className:"grid-col-30 h-padded"},generators.label("units","units",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["units"]})),generators.input("units"))),React.createElement(components_1.FormulaInput,{goToAdvanced:function(){return _this.changeTab(_this.tabs[1].value)},columns:availableColumns,measure:newInstance,onChange:this.delegate.onChange.bind(this)}))};MeasureModal.prototype.renderCustom=function(generators){var validateFormula=this.props.validateFormula;function validateFormat(){return true}return React.createElement("div",{className:"general vertical form"},React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-70 h-padded"},generators.label("title"),generators.input("title",/.*/,true)),React.createElement("div",{className:"grid-col-30 h-padded"},generators.label("units","units",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["units"]})),generators.input("units"))),React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-100"},generators.label("formula","formula",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["formula"]})),generators.input("formula",validateFormula))),React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-100"},generators.label("transform","transform",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["transform"]})),generators.dropdown("transform",MEASURE_TRANSFORMS))),React.createElement("div",{className:"grid-row"},React.createElement("div",{className:"grid-col-100"},generators.label("format","format",React.createElement(caladan_1.InfoSpot,{bubbly:true,sourceIds:["format"]})),generators.input("format",validateFormat))))};MeasureModal.prototype.renderSuggestions=function(){var _this=this;var suggestedMeasures=this.props.suggestedMeasures;var selectedSuggestions=this.state.selectedSuggestions;if(suggestedMeasures.length===0){return React.createElement("div",{className:"suggestions"},React.createElement("div",{className:"items"},React.createElement("div",{className:"message"},strings_1.STRINGS.thereAreNoSuggestionsAtTheMoment)))}var none=function(){_this.setState({selectedSuggestions:{}})};var all=function(){var allSuggestions={};suggestedMeasures.forEach(function(_a){var name=_a.name;return allSuggestions[name]=true});_this.setState({selectedSuggestions:allSuggestions})};var toggle=function(name){selectedSuggestions[name]=!selectedSuggestions[name];_this.setState({selectedSuggestions:selectedSuggestions})};var items=suggestedMeasures.map(function(_a){var title=_a.title,name=_a.name;return React.createElement("div",{className:"row",key:name,onClick:toggle.bind(_this,name)},React.createElement(caladan_1.Checkbox,{label:title,selected:selectedSuggestions[name]}))});return React.createElement("div",{className:"suggestions"},React.createElement("div",{className:"buttons"},React.createElement(caladan_1.Button,{type:"light-action",onClick:all,title:"Select all"}),React.createElement(caladan_1.Button,{type:"light-action",onClick:none,title:"Select none"})),React.createElement("div",{className:"items"},items))};MeasureModal.prototype.renderSuggestionsButtons=function(){var _a=this.props,onClose=_a.onClose,suggestedMeasures=_a.suggestedMeasures;var selectedSuggestions=this.state.selectedSuggestions;var measuresToAdd=suggestedMeasures.filter(function(d){return selectedSuggestions[d.name]});var n=measuresToAdd.length;return React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{className:"cancel",title:"Cancel",type:"secondary",onClick:onClose}),n>0?React.createElement(caladan_1.Button,{className:classNames("save",{disabled:measuresToAdd.length<=0}),title:"Add "+general_1.pluralIfNeeded(n,"measure"),type:"primary",onClick:this.saveMany.bind(this,measuresToAdd)}):null)};MeasureModal.prototype.renderButtons=function(){var _a=this.props,measure=_a.measure,onClose=_a.onClose;var _b=this.state,newInstance=_b.newInstance,canSave=_b.canSave,selectedTab=_b.selectedTab;if(selectedTab==="suggestions"){return this.renderSuggestionsButtons()}var saveButtonDisabled=!canSave||measure.equals(newInstance);return React.createElement("div",{className:"button-bar"},React.createElement(caladan_1.Button,{className:"cancel",title:"Cancel",type:"secondary",onClick:onClose}),React.createElement(caladan_1.Button,{className:classNames("save",{disabled:saveButtonDisabled}),title:"OK",type:"primary",onClick:this.save.bind(this)}))};MeasureModal.prototype.render=function(){var mode=this.props.mode;var newInstance=this.state.newInstance;if(!newInstance)return null;return React.createElement(caladan_1.Modal,{className:"measure-modal",title:mode==="create"?strings_1.STRINGS.createMeasure:strings_1.STRINGS.editMeasure,onClose:this.props.onClose,onEnter:this.save.bind(this)},this.renderButtonGroup(),this.renderTabContent(),this.renderButtons())};return MeasureModal}(React.Component);exports.MeasureModal=MeasureModal},function(module,exports,__webpack_require__){var content=__webpack_require__(966);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./measure-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./measure-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".measure-modal .suggestions .items{background:#f5f5f5;padding:10px 0;max-height:300px;overflow:auto}.measure-modal .suggestions .items .message{padding:4px 10px;color:#999;font-style:italic}.measure-modal .suggestions .items .row{padding-left:14px;padding-top:3px;height:27px;cursor:pointer;white-space:nowrap}.measure-modal .suggestions .items .row .label{position:absolute;top:5px;left:24px}.measure-modal .suggestions .items .row:hover{background:#eee}.measure-modal .form .grid-row{margin-bottom:10px}.measure-modal .suggestions .items{margin-bottom:25px}.measure-modal .suggestions .items .checkbox{margin-bottom:5px}.measure-modal .button-group{margin-bottom:20px}.measure-modal .button-bar{text-align:right;margin-top:30px}.measure-modal .modal{width:550px}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var React=__webpack_require__(1);var CubeEditHeaderBar=function(_super){tslib_1.__extends(CubeEditHeaderBar,_super);function CubeEditHeaderBar(){var _this=_super.call(this)||this;_this.state={};return _this}CubeEditHeaderBar.prototype.renderDescriptionBubble=function(target){var dataCube=this.props.dataCube;return React.createElement(caladan_1.BubbleMenu,{className:"description-menu",direction:"down",stage:beltful_1.Stage.fromSize(200,200),openOn:target},React.createElement("div",{className:"message"},dataCube.description||"No description"))};CubeEditHeaderBar.prototype.getRightChildren=function(){var _a=this.props,onSave=_a.onSave,onCancel=_a.onCancel;return[{id:"button-group",className:"button-group",content:[React.createElement(caladan_1.Button,{key:"cancel",className:"cancel",title:"Cancel",type:"secondary",onClick:onCancel}),React.createElement(caladan_1.Button,{key:"save",className:"save",title:"Save",type:"primary",onClick:onSave})]}]};CubeEditHeaderBar.prototype.render=function(){var _a=this.props,onNavClick=_a.onNavClick,dataCube=_a.dataCube,customization=_a.customization;var leftChildren=[{id:"menu-icon",className:"menu-icon",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.MENU}),onClick:onNavClick},{id:"title",className:"title",content:dataCube.title,onClick:onNavClick},dataCube.description?{id:"description",className:"description-icon",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.HELP_2}),renderMenu:this.renderDescriptionBubble.bind(this)}:null].filter(Boolean);return React.createElement(caladan_1.HeaderBar,{className:"cube-edit-header-bar",style:{background:customization.getPreferredTheme(dataCube.theme).mainColor},leftChildren:leftChildren,rightChildren:this.getRightChildren()})};return CubeEditHeaderBar}(React.Component);exports.CubeEditHeaderBar=CubeEditHeaderBar},function(module,exports,__webpack_require__){var content=__webpack_require__(969);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./cube-edit-view.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./cube-edit-view.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".cube-edit-view .dimension-list .list-title .actions .search-button .clearable-input,.cube-edit-view .measure-list .list-title .actions .search-button .clearable-input{background:#fff;border:1px solid #d1d1d1;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px 0 rgba(0,0,0,0.1);box-shadow:inset 0 1px 1px 0 rgba(0,0,0,0.1)}.cube-edit-view .header-bar{height:42px}.cube-edit-view .cube-edit-content{position:absolute;top:42px;bottom:0;left:0;right:0;padding:10px}.cube-edit-view .dimension-list,.cube-edit-view .measure-list{position:absolute;position:absolute;top:0;bottom:0;left:0;right:0}.cube-edit-view .dimension-list .list-title,.cube-edit-view .measure-list .list-title{width:initial;height:56px;padding-left:24px;padding-right:24px;padding-top:11px}.cube-edit-view .dimension-list .list-title .label,.cube-edit-view .measure-list .list-title .label{font-size:16px;text-transform:capitalize;color:#454545}.cube-edit-view .dimension-list .list-title .actions .search-button button,.cube-edit-view .measure-list .list-title .actions .search-button button{width:30px}.cube-edit-view .dimension-list .list-title .actions .search-button .clearable-input,.cube-edit-view .measure-list .list-title .actions .search-button .clearable-input{padding-left:6px;padding-right:22px;height:30px}.cube-edit-view .dimension-list .list-title .actions .search-button .clearable-input .clear,.cube-edit-view .measure-list .list-title .actions .search-button .clearable-input .clear{top:7px;right:6px}.cube-edit-view .dimension-list .simple-list,.cube-edit-view .measure-list .simple-list{padding-left:24px;padding-right:24px;top:56px}.cube-edit-view .dimension-list .simple-list .item,.cube-edit-view .measure-list .simple-list .item{width:initial}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var immutable_class_1=__webpack_require__(7);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var data_cube_seed_modal_1=__webpack_require__(971);var home_header_bar_1=__webpack_require__(974);var item_card_1=__webpack_require__(977);__webpack_require__(980);var HomeView=function(_super){tslib_1.__extends(HomeView,_super);function HomeView(){var _this=_super.call(this)||this;_this.state={scrolled:false};return _this}HomeView.prototype.renderDataCube=function(dataCube,multiLineSummary){if(multiLineSummary===void 0){multiLineSummary=false}var _a=this.props,toggleFavorite=_a.toggleFavorite,favorites=_a.favorites,user=_a.user,stateful=_a.stateful,settings=_a.settings,controller=_a.controller,customization=_a.customization;var searchText=this.state.searchText;var actions=[];if(stateful){if(dataCube.getModifyAccess().hasAccess(user)){actions.push({label:strings_1.STRINGS.edit,callback:function(){return controller.editDataCube(dataCube,"update")},className:"edit"})}actions.push({label:strings_1.STRINGS.duplicate,callback:function(){controller.editDataCube(settings.duplicateDataCube(dataCube,user),"duplicate")},className:"duplicate"});if(dataCube.getModifyAccess().hasAccess(user)){actions.push({label:strings_1.STRINGS.delete,callback:function(){caladan_1.Notifier.handleRemoval("data cube",function(){controller.updateSettings(settings.deleteDataCube(dataCube.name)).then(function(undo){caladan_1.Notifier.success("Data cube deleted")},function(e){caladan_1.Notifier.failure("Woops","Something bad happened")})},dataCube.title)},className:"delete"})}}var summaries=dataCube.getSummaries();if(!multiLineSummary){summaries=[summaries.join(", ")]}return React.createElement(item_card_1.ItemCard,{key:dataCube.name,icon:Icons.FULL_CUBE,title:dataCube.title,description:dataCube.description,summaries:summaries,color:customization.getPreferredTheme(dataCube.theme).mainColor,onClick:function(){return controller.openDataCube(dataCube)},actions:actions,isFavorite:settings.hasUsers()?favorites.indexOf(dataCube.name)>-1:false,toggleFavorite:settings.hasUsers()?function(){return toggleFavorite(dataCube.name)}:null,highlightText:searchText})};HomeView.prototype.renderDashboard=function(collection,multiLineSummary){if(multiLineSummary===void 0){multiLineSummary=false}var _a=this.props,toggleFavorite=_a.toggleFavorite,favorites=_a.favorites,stateful=_a.stateful,controller=_a.controller,settings=_a.settings,customization=_a.customization,user=_a.user;var searchText=this.state.searchText;var actions=[];if(stateful){if(collection.getModifyAccess().hasAccess(user)){actions.push({label:strings_1.STRINGS.edit,callback:function(){return controller.editCollection(collection,"update")},className:"edit"})}actions.push({label:strings_1.STRINGS.duplicate,callback:function(){controller.editCollection(settings.duplicateCollection(collection,user),"duplicate")},className:"duplicate"});if(collection.getModifyAccess().hasAccess(user)){actions.push({label:strings_1.STRINGS.delete,callback:function(){caladan_1.Notifier.handleRemoval("collection",function(){controller.updateSettings(settings.deleteCollection(collection.name)).then(function(){caladan_1.Notifier.success("Dashboard deleted")},function(e){caladan_1.Notifier.failure("Woops","Something bad happened");throw e})},collection.title)},className:"delete"})}}var summaries=collection.getSummaries();if(!multiLineSummary){summaries=[summaries.join(", ")]}return React.createElement(item_card_1.ItemCard,{key:collection.name,icon:Icons.DASHBOARD,title:collection.title,description:collection.description,summaries:summaries,color:customization.getPreferredTheme(collection.theme).mainColor,onClick:function(){return controller.openCollection(collection)},actions:actions,isFavorite:settings.hasUsers()?favorites.includes(collection.name):false,toggleFavorite:settings.hasUsers()?function(){return toggleFavorite(collection.name)}:null,highlightText:searchText})};HomeView.prototype.renderDataCubeSeedModal=function(){var _this=this;var _a=this.props,settings=_a.settings,controller=_a.controller,user=_a.user;return React.createElement(data_cube_seed_modal_1.DataCubeSeedModal,{user:user,dataCubes:settings.dataCubes,onCancel:function(){return _this.setState({showDataCubeSeedModal:false})},onNext:function(nextDataCube){return controller.editDataCube(nextDataCube,"create")}})};HomeView.prototype.isItemVisible=function(item){var searchText=this.state.searchText;if(!searchText)return true;var title=item.title.toLowerCase();var summary=item.getSummaries().join(" ").toLowerCase();return searchText.split(/\s+/).every(function(bit){bit=bit.toLowerCase();return title.includes(bit)||summary.includes(bit)})};HomeView.prototype.renderDataCubes=function(){var _this=this;var _a=this.props,settings=_a.settings,stateful=_a.stateful,customization=_a.customization;var dataCubes=settings.dataCubes;var color=customization.getEffectiveTheme().mainColor;var items=dataCubes.filter(function(d){return _this.isItemVisible(d)}).map(function(d){return _this.renderDataCube(d)});return React.createElement("div",{className:"data-cubes grid-col-50 top"},React.createElement("div",{className:"section-title"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FUTURA_DATA_CUBES})),React.createElement("div",{className:"items"},items,stateful?item_card_1.ItemCard.getAdder(strings_1.STRINGS.createNewDataCube,color,function(){return _this.setState({showDataCubeSeedModal:true})}):null))};HomeView.prototype.renderDashboards=function(){var _this=this;var _a=this.props,settings=_a.settings,stateful=_a.stateful,controller=_a.controller,customization=_a.customization,user=_a.user;var collections=settings.collections;if(!stateful&&collections.length===0)return null;var color=customization.getEffectiveTheme().mainColor;var items=collections.filter(function(c){return _this.isItemVisible(c)}).map(function(c){return _this.renderDashboard(c)});var onAdd=function(){var newCollection=new models_1.Collection({name:beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!settings.getCollection(name)}}),tiles:[],title:"New dashboard"}).initAccess(user);controller.editCollection(newCollection,"create")};return React.createElement("div",{className:"collections grid-col-50 top"},React.createElement("div",{className:"section-title"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FUTURA_DASHBOARDS})),React.createElement("div",{className:"items"},items,collections.length===0?item_card_1.ItemCard.getNoItemCard(Icons.DASHBOARD,strings_1.STRINGS.noDashboards):null,stateful?item_card_1.ItemCard.getAdder(strings_1.STRINGS.createNewDashboard,color,function(){return onAdd()}):null))};HomeView.prototype.onScroll=function(event){var scrolled=this.state.scrolled;var newScrolled=event.nativeEvent.target.scrollTop!==0;if(newScrolled!==scrolled){this.setState({scrolled:newScrolled})}};HomeView.prototype.renderFavorites=function(){var _this=this;var _a=this.props,settings=_a.settings,favorites=_a.favorites;var searchText=this.state.searchText;var collections=settings.collections,dataCubes=settings.dataCubes;if(!favorites.length)return null;var items=favorites.map(function(f){var item=immutable_class_1.NamedArray.findByName(collections,f);if(!item)item=immutable_class_1.NamedArray.findByName(dataCubes,f);if(!item)return null;if(searchText&&!item.title.toLowerCase().includes(searchText.toLowerCase()))return null;return models_1.DataCube.isDataCube(item)?_this.renderDataCube(item,true):_this.renderDashboard(item,true)}).filter(Boolean);if(items.length===0)return null;return React.createElement("div",{className:"favorites grid-col-100 top"},React.createElement("div",{className:"section-title"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FUTURA_FAVORITES})),React.createElement("div",{className:"items"},items))};HomeView.prototype.renderContainer=function(){var settings=this.props.settings;return React.createElement("div",{className:"container"},settings.hasUsers()?React.createElement("div",{className:"grid-row"},this.renderFavorites()):null,React.createElement("div",{className:"grid-row"},this.renderDataCubes(),this.renderDashboards()))};HomeView.prototype.renderEmpty=function(){var _this=this;var _a=this.props,controller=_a.controller,stateful=_a.stateful,settings=_a.settings;var action;if(stateful){action=settings.getNumClusters()?React.createElement("div",{className:"action"},"Please ",React.createElement("span",{className:"link",onClick:function(){return _this.setState({showDataCubeSeedModal:true})}},"add a data cube")):React.createElement("div",{className:"action"},"Please go to the ",React.createElement("span",{className:"link",onClick:function(){return controller.openSettings("clusters")}},"clusters settings"))}return React.createElement("div",{className:"container"},React.createElement("div",{className:"title"},React.createElement("div",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.DATA_CUBES})),React.createElement("div",{className:"label"},settings.getNumClusters()?strings_1.STRINGS.noDataCubes:strings_1.STRINGS.noClusters)),action)};HomeView.prototype.render=function(){var _this=this;var _a=this.props,user=_a.user,controller=_a.controller,customization=_a.customization,stateful=_a.stateful,settings=_a.settings,launcherHref=_a.launcherHref;var _b=this.state,showDataCubeSeedModal=_b.showDataCubeSeedModal,scrolled=_b.scrolled,searchText=_b.searchText;var onNewCollection=function(){var newCollection=new models_1.Collection({name:beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!settings.getCollection(name)}}),tiles:[],title:"New dashboard"});controller.editCollection(newCollection,"create")};var isEmpty=settings.dataCubes.length===0&&settings.collections.length===0;return React.createElement("div",{className:classNames("home-view",{scrolled:scrolled,"no-data":settings.dataCubes.length===0}),onScroll:this.onScroll.bind(this)},React.createElement(home_header_bar_1.HomeHeaderBar,{controller:controller,user:user,stateful:stateful,onNewDataCube:function(){return _this.setState({showDataCubeSeedModal:true})},onNewCollection:onNewCollection,customization:customization,launcherHref:launcherHref}),React.createElement("div",{className:"content"},React.createElement("div",{className:"search-box grid-row"},React.createElement("div",{className:"grid-col-fit-content"},React.createElement("div",{className:"search-icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_SEARCH}))),React.createElement(caladan_1.ClearableInput,{className:"grid-col-auto-expand",placeholder:"Search data cubes and dashboards",focusOnMount:true,value:searchText,onChange:function(searchText){return _this.setState({searchText:searchText})}})),isEmpty?this.renderEmpty():this.renderContainer()),showDataCubeSeedModal?this.renderDataCubeSeedModal():null)};HomeView.defaultProps={favorites:[]};return HomeView}(React.Component);exports.HomeView=HomeView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var ajax_1=__webpack_require__(69);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var components_1=__webpack_require__(466);var delegates_1=__webpack_require__(441);__webpack_require__(972);var DataCubeSeedModal=function(_super){tslib_1.__extends(DataCubeSeedModal,_super);function DataCubeSeedModal(){var _this=_super.call(this)||this;_this.mounted=false;_this.state={autoFill:true,clusterSources:[]};_this.loadingDelegate=new delegates_1.LoadingMessageDelegate(_this,500);return _this}DataCubeSeedModal.prototype.initFromProps=function(props){var dataCubes=props.dataCubes,user=props.user;this.setState({newInstance:models_1.DataCube.fromJS({name:beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!immutable_class_1.NamedArray.findByName(dataCubes,name)}}),clusterName:null,source:null,enforceTimeFilter:true}).initAccess(user)})};DataCubeSeedModal.prototype.componentWillMount=function(){this.initFromProps(this.props)};DataCubeSeedModal.prototype.componentWillReceiveProps=function(nextProps){this.initFromProps(nextProps)};DataCubeSeedModal.prototype.componentDidMount=function(){var _this=this;this.mounted=true;if(document.activeElement)document.activeElement.blur();this.loadingDelegate.start("Loading clusters...");ajax_1.Ajax.query({method:"POST",url:"$mount/cluster-sources",data:{}}).then(function(resp){if(!_this.mounted)return;var newInstance=_this.state.newInstance;_this.loadingDelegate.stop();if(!Array.isArray(resp.clusterSources))return;var clusterSources=[];var clusterTypes={};var _loop_1=function(clusterSource){clusterTypes[clusterSource.name]=clusterSource.type;var sources=clusterSource.sources;if(Array.isArray(sources)){clusterSources=clusterSources.concat(sources.map(function(source){return{clusterName:clusterSource.name,clusterTitle:clusterSource.title,source:source}}))}};for(var _i=0,_a=resp.clusterSources;_i<_a.length;_i++){var clusterSource=_a[_i];_loop_1(clusterSource)}var updatedInstance;if(clusterSources.length){var _b=clusterSources[0],clusterName=_b.clusterName,source=_b.source;updatedInstance=newInstance.change("clusterName",clusterName).change("source",source)}_this.setState({clusterSources:clusterSources,newInstance:updatedInstance})},function(e){if(!_this.mounted)return;_this.loadingDelegate.stop();caladan_1.Notifier.failure("Sorry","There was a problem loading sources: "+e.message)})};DataCubeSeedModal.prototype.componentWillUnmount=function(){this.mounted=false};DataCubeSeedModal.prototype.onNext=function(){var _this=this;var dataCubes=this.props.dataCubes;var _a=this.state,newInstance=_a.newInstance,autoFill=_a.autoFill;this.loadingDelegate.start("Creating data cube...");ajax_1.Ajax.query({method:"POST",url:"$mount/attributes",data:{clusterName:newInstance.clusterName,source:newInstance.source}}).then(function(resp){var finalInstance=newInstance.changeTitle(newInstance.guessTitle()).changeName(beltful_1.StringUtils.generateAvailableName({isAvailable:function(name){return!immutable_class_1.NamedArray.findByName(dataCubes,name)}}));var attributes=plywood_1.AttributeInfo.fromJSs(resp.attributes);if(autoFill){finalInstance=finalInstance.fillAllFromAttributes(attributes)}_this.loadingDelegate.stop();_this.props.onNext(finalInstance)},function(e){_this.loadingDelegate.stop();caladan_1.Notifier.failure("Woops","Could not get attributes: "+e.message)})};DataCubeSeedModal.prototype.toggleAutoFill=function(){this.setState({autoFill:!this.state.autoFill})};DataCubeSeedModal.prototype.onClusterSourceChange=function(newInstance){this.setState({newInstance:newInstance})};DataCubeSeedModal.prototype.render=function(){var onCancel=this.props.onCancel;var _a=this.state,newInstance=_a.newInstance,autoFill=_a.autoFill,clusterSources=_a.clusterSources,loadingMessage=_a.loadingMessage,isLoading=_a.isLoading;return React.createElement(caladan_1.Modal,{className:"data-cube-seed-modal",title:strings_1.STRINGS.createNewDataCube,onClose:this.props.onCancel,onEnter:this.onNext.bind(this),deaf:isLoading},React.createElement("form",null,caladan_1.FormLabel.dumbLabel("Source"),React.createElement(components_1.ClusterSourcePicker,{dataCube:newInstance,clusterSources:clusterSources,onChange:this.onClusterSourceChange.bind(this)}),React.createElement(caladan_1.Checkbox,{selected:autoFill,onClick:this.toggleAutoFill.bind(this),label:strings_1.STRINGS.autoFillDimensionsAndMeasures})),isLoading?React.createElement(caladan_1.LoadingBar,{label:loadingMessage}):React.createElement("div",{className:"button-bar right"},React.createElement(caladan_1.Button,{className:"cancel",title:"Cancel",type:"secondary",onClick:onCancel}),React.createElement(caladan_1.Button,{type:"primary",title:strings_1.STRINGS.next+": "+strings_1.STRINGS.configureDataCube,disabled:!newInstance||!newInstance.source,onClick:this.onNext.bind(this)})))};return DataCubeSeedModal}(React.Component);exports.DataCubeSeedModal=DataCubeSeedModal},function(module,exports,__webpack_require__){var content=__webpack_require__(973);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./data-cube-seed-modal.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./data-cube-seed-modal.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".data-cube-seed-modal form{width:448px}.data-cube-seed-modal form.vertical>*{display:block}.data-cube-seed-modal form input{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.data-cube-seed-modal form input:hover{border-color:#b8b8b8}.data-cube-seed-modal form input:focus{border-color:#1ea3e6}.data-cube-seed-modal form input.error{border-color:#e24c4c}.data-cube-seed-modal form .dropdown .dropdown-label{margin-bottom:8px}.data-cube-seed-modal form input:not(.actionable),.data-cube-seed-modal form .input:not(.actionable),.data-cube-seed-modal form .checkbox:not(.actionable){margin-bottom:25px}.data-cube-seed-modal form textarea{height:120px;outline:none;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:13px;line-height:16px;padding:6px;margin-bottom:25px}.data-cube-seed-modal form .checkbox{height:20px;width:100%}.data-cube-seed-modal form .checkbox .label{position:absolute;left:25px;top:5px}.data-cube-seed-modal form{width:448px}.data-cube-seed-modal form.vertical>*{display:block}.data-cube-seed-modal form .dropdown .dropdown-label{margin-bottom:8px}.data-cube-seed-modal form input:not(.actionable),.data-cube-seed-modal form .input:not(.actionable),.data-cube-seed-modal form .checkbox:not(.actionable){margin-bottom:25px}.data-cube-seed-modal form textarea{height:120px;outline:none;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace;font-size:13px;line-height:16px;padding:6px;margin-bottom:25px}.data-cube-seed-modal form .checkbox{height:20px;width:100%}.data-cube-seed-modal form .checkbox .label{position:absolute;left:25px;top:5px}.data-cube-seed-modal form input{border:1px solid #d4d4d4;border-radius:2px;-webkit-box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);box-shadow:inset 0 1px 1px rgba(0,0,0,0.13);padding-left:6px;padding-right:6px;width:100%;height:30px}.data-cube-seed-modal form input:hover{border-color:#b8b8b8}.data-cube-seed-modal form input:focus{border-color:#1ea3e6}.data-cube-seed-modal form input.error{border-color:#e24c4c}.data-cube-seed-modal form input.disabled{pointer-events:none;background:#f2f2f2}.data-cube-seed-modal form{width:100%}.data-cube-seed-modal form .checkbox{margin-top:25px}.data-cube-seed-modal form .checkbox.selected .checkbox-body{background:#1ea3e6}.data-cube-seed-modal form .checkbox .label{top:4px;text-transform:initial;color:#666;font-size:13px}.data-cube-seed-modal .loading-bar{margin-top:10px}.data-cube-seed-modal .button-bar{text-align:right}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var components_1=__webpack_require__(466);__webpack_require__(975);var HomeHeaderBar=function(_super){tslib_1.__extends(HomeHeaderBar,_super);function HomeHeaderBar(){var _this=_super.call(this)||this;_this.state={};return _this}HomeHeaderBar.prototype.renderUserMenu=function(target){var _a=this.props,user=_a.user,customization=_a.customization,stateful=_a.stateful;var canEdit=user&&user.canAccessSettings()&&stateful&&customization.getSettingsMode()!==models_1.Customization.SETTINGS_MODE_SUPPRESSED;return React.createElement(components_1.UserMenu,{showSettings:canEdit,openOn:target,user:user,customization:customization})};HomeHeaderBar.prototype.renderAddMenu=function(target){var _a=this.props,onNewCollection=_a.onNewCollection,onNewDataCube=_a.onNewDataCube,user=_a.user;var showDataCubeAdd=onNewDataCube&&user&&user.canAccessSettings();return React.createElement(caladan_1.BubbleMenu,{className:"add-menu from-home-view",direction:"down",stage:beltful_1.Stage.fromSize(200,200),openOn:target},React.createElement("ul",{className:"bubble-list"},showDataCubeAdd?React.createElement("div",{className:"item add-data-cube",onClick:onNewDataCube},React.createElement("div",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_CUBE})),React.createElement("div",{className:"item-title"},strings_1.STRINGS.newDataCube)):null,React.createElement("div",{className:"item add-dashboard",onClick:onNewCollection},React.createElement("div",{className:"icon"},React.createElement(caladan_1.SvgIcon,{svg:Icons.DASHBOARD})),React.createElement("div",{className:"item-title"},strings_1.STRINGS.newDashboard))))};HomeHeaderBar.prototype.render=function(){var _a=this.props,controller=_a.controller,user=_a.user,stateful=_a.stateful,customization=_a.customization,launcherHref=_a.launcherHref;var leftChildren=[{id:"menu-icon",className:"menu-icon",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.MENU}),onClick:controller.openSideDrawer},{id:"title",className:"svg-text-button title",content:customization.homeLogoSvg?React.createElement(caladan_1.SvgIcon,{key:"imply",svg:customization.homeLogoSvg}):[React.createElement(caladan_1.SvgIcon,{key:"imply",svg:Icons.FUTURA_IMPLY}),React.createElement(caladan_1.SvgIcon,{key:"pivot",className:"faded",svg:Icons.FUTURA_PIVOT})],onClick:controller.openSideDrawer}];var rightChildren=stateful?[{id:"add-item",className:"icon-button add",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_ADD_FRAMED}),tooltip:"New data cube or dashboard",renderMenu:this.renderAddMenu.bind(this)}]:[];if(launcherHref){rightChildren.push({id:"launcher-button",className:"icon-button launcher",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.LAUNCHER}),tooltip:"Imply home",onClick:function(){return window.location.href=launcherHref}})}rightChildren.push({id:"user-button",className:"icon-button user",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_PROFILE}),tooltip:"Me",renderMenu:this.renderUserMenu.bind(this)});return React.createElement(caladan_1.HeaderBar,{className:"home-header-bar",style:{background:customization.getEffectiveTheme().mainColor},leftChildren:leftChildren,rightChildren:rightChildren})};return HomeHeaderBar}(React.Component);exports.HomeHeaderBar=HomeHeaderBar},function(module,exports,__webpack_require__){var content=__webpack_require__(976);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./home-header-bar.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./home-header-bar.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".from-home-view.add-menu .bubble-list{overflow:auto;height:100%}.from-home-view.add-menu .bubble-list .item{height:30px;padding:5px 0;cursor:pointer}.from-home-view.add-menu .bubble-list .item:hover{background-color:rgba(30,163,230,0.12)}.from-home-view.add-menu .bubble-list .item .icon{position:absolute;width:19px;height:19px;padding:0;left:10px}.from-home-view.add-menu .bubble-list .item .icon svg{width:19px;fill:#1ea3e6}.from-home-view.add-menu .bubble-list .item .item-title{position:absolute;font-weight:bold;left:35px;right:10px;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;line-height:20px;color:#1ea3e6}.home-header-bar .title .primary{text-transform:lowercase}.home-header-bar .title .secondary{margin-left:4px;opacity:0.7}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var classNames=__webpack_require__(4);var components_1=__webpack_require__(466);__webpack_require__(978);var ItemCard=function(_super){tslib_1.__extends(ItemCard,_super);function ItemCard(){var _this=_super.call(this)||this;_this.state={};return _this}ItemCard.getNoItemCard=function(icon,title){return React.createElement("div",{className:"item-card empty-placeholder"},React.createElement("div",{className:"inner-container"},React.createElement(caladan_1.SvgIcon,{className:"view-icon",svg:icon}),React.createElement("div",{className:"text"},React.createElement("div",{className:"title"},title))))};ItemCard.getAdder=function(title,color,onClick){return React.createElement("div",{className:"item-card adder",onClick:onClick},React.createElement("div",{className:"inner-container"},React.createElement(caladan_1.SvgIcon,{className:"view-icon",svg:Icons.FULL_ADD,style:{fill:color}}),React.createElement("div",{className:"text"},React.createElement("div",{className:"title",style:{color:color}},title))))};ItemCard.prototype.renderMoreButton=function(){var actions=this.props.actions;var items=actions.map(function(_a,i){var label=_a.label,callback=_a.callback,className=_a.className;return{label:label,onClick:callback,className:className}});return React.createElement(caladan_1.BubbleButton,{className:"more-button",type:"light",svg:Icons.FULL_MORE,items:items,stage:beltful_1.Stage.fromSize(120,120)})};ItemCard.prototype.onClick=function(event){var disabled=this.props.disabled;if(beltful_1.DOMUtils.isInside(event.target,ReactDOM.findDOMNode(this._buttons)))return;if(disabled)return;this.props.onClick(event)};ItemCard.prototype.renderFavoriteButton=function(){var _a=this.props,toggleFavorite=_a.toggleFavorite,isFavorite=_a.isFavorite;if(!toggleFavorite)return null;return React.createElement(caladan_1.Button,{svg:isFavorite?Icons.FAVORITE_FULL:Icons.FAVORITE_EMPTY,type:"light",className:"favorite",onClick:toggleFavorite})};ItemCard.prototype.getText=function(){var _a=this.props,color=_a.color,title=_a.title,highlightText=_a.highlightText;return React.createElement("div",{className:"text"},React.createElement("div",{className:"title",style:{color:color},dangerouslySetInnerHTML:{__html:beltful_1.StringUtils.emphasizeText(title,highlightText)}}),this.getSummary())};ItemCard.prototype.getSummary=function(){var _a=this.props,summaries=_a.summaries,highlightText=_a.highlightText;return summaries.map(function(summary,i){return React.createElement("div",{key:i,className:"summary-line",dangerouslySetInnerHTML:{__html:beltful_1.StringUtils.emphasizeText(summary,highlightText)}})})};ItemCard.prototype.render=function(){var _this=this;var _a=this.props,description=_a.description,icon=_a.icon,color=_a.color,actions=_a.actions,disabled=_a.disabled;return React.createElement("div",{className:classNames("item-card",{disabled:disabled}),onClick:this.onClick.bind(this)},React.createElement("div",{className:"inner-container"},React.createElement(caladan_1.SvgIcon,{className:"view-icon",svg:icon,style:{fill:color}}),this.getText(),React.createElement("div",{className:"buttons",ref:function(r){return _this._buttons=r}},React.createElement(components_1.DescriptionIcon,{description:description}),this.renderFavoriteButton(),actions&&actions.length>0?this.renderMoreButton():null)))};return ItemCard}(React.Component);exports.ItemCard=ItemCard},function(module,exports,__webpack_require__){var content=__webpack_require__(979);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./item-card.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./item-card.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".item-card{width:280px;cursor:pointer}.item-card.disabled{cursor:default}.item-card .inner-container{background-color:#fff;width:100%;height:100%;padding:16px 16px;border-radius:2px;-webkit-transition:-webkit-box-shadow 0.2s;transition:-webkit-box-shadow 0.2s;-o-transition:box-shadow 0.2s;transition:box-shadow 0.2s;transition:box-shadow 0.2s, -webkit-box-shadow 0.2s;white-space:nowrap}.item-card .inner-container:hover{-webkit-box-shadow:0 2px 6px 0 rgba(0,0,0,0.14);box-shadow:0 2px 6px 0 rgba(0,0,0,0.14)}.item-card .inner-container>*{display:inline-block}.item-card .inner-container .svg-icon.view-icon{height:19px;margin-right:9px;fill:#1ea3e6}.item-card .inner-container .text{padding-top:2px;white-space:normal;width:calc(100% - 30px)}.item-card .inner-container .text .title{font-size:13px;font-weight:600;color:#1ea3e6;margin-bottom:5px;margin-right:74px;line-height:15px;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.item-card .inner-container .text .title em{text-decoration:underline}.item-card .inner-container .text .summary-line{font-size:12px;line-height:16px;color:#bababa;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.item-card .inner-container .text .summary-line em{text-decoration:underline}.item-card .inner-container .text .summary-line:last-child{height:33px}.item-card .inner-container .buttons{position:absolute;top:12px;right:10px;text-align:right}.item-card .inner-container .buttons .button.icon{min-width:0}.item-card .inner-container .buttons>*{display:inline-block}.item-card .inner-container .buttons>*:not(:last-child){margin-right:10px}.item-card .inner-container .buttons>* .svg-icon{fill:#ccc}.item-card .inner-container .buttons>*:hover{background-color:transparent}.item-card .inner-container .buttons>*:hover .svg-icon{fill:#999}.item-card .inner-container .buttons .description-icon{padding:4px 4px 0px 0px}.item-card .inner-container .buttons .description-icon .svg-icon{width:19px;padding-top:2px}.item-card.adders{display:-webkit-box;display:-ms-flexbox;display:flex}.item-card.adders>*{display:inline-block;width:initial;-webkit-box-flex:1;-ms-flex:1;flex:1;overflow:hidden}.item-card.adders>*:not(:last-child){margin-right:2px}.item-card.adders>*:not(:first-child){margin-left:2px}.item-card.empty-placeholder{cursor:auto;font-style:italic;opacity:0.5}.item-card.empty-placeholder .inner-container{-webkit-box-shadow:initial;box-shadow:initial}.item-card.empty-placeholder .inner-container .title{color:#999}.item-card.empty-placeholder .inner-container .svg-icon{opacity:1;fill:#666}.item-card:hover{z-index:1}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(981);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./home-view.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./home-view.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".home-view.no-data .container{position:absolute;top:36%;left:50%;-webkit-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);transform:translate(-50%, -50%);text-align:center}.home-view.no-data .container .title{cursor:default}.home-view.no-data .container .title .icon{display:inline-block;margin-bottom:6px;width:42px;fill:#999}.home-view.no-data .container .title .label{display:inline-block;height:46px;padding-top:13px;font-size:20px;color:#999}.home-view.no-data .container .action{color:#999}.home-view.no-data .container .action a,.home-view.no-data .container .action .link{cursor:pointer;color:#1ea3e6;border-bottom:1px dashed}.home-view .header-bar{position:absolute;top:0;left:0;right:0;height:42px}.home-view .content{position:absolute;top:42px;bottom:0;left:0;right:0;overflow-y:auto;padding-bottom:32px}.home-view .content>*{width:80%;max-width:1200px;margin:0 auto}.home-view .content .search-box{margin-top:24px;margin-bottom:12px;padding-left:5px;padding-right:5px}.home-view .content .search-box .search-icon{width:44px;height:47px;padding-top:14px;padding-left:16px;background-color:white;border-radius:2px 0 0 2px}.home-view .content .search-box .search-icon .svg-icon{width:19px;fill:#bababa}.home-view .content .search-box .clearable-input{height:47px;background-color:white;padding:auto 0;border-radius:0 2px 2px 0}.home-view .content .search-box .clearable-input ::-webkit-input-placeholder{color:#bababa}.home-view .content .search-box .clearable-input :-ms-input-placeholder{color:#bababa}.home-view .content .search-box .clearable-input ::placeholder{color:#bababa}.home-view .content .search-box .clearable-input .clear{top:13px;right:14px}.home-view .content .container .data-cubes .section-title,.home-view .content .container .collections .section-title,.home-view .content .container .favorites .section-title{text-transform:uppercase;color:#a6a6a6;margin-bottom:10px;font-size:15px;padding-left:5px}.home-view .content .container .data-cubes .section-title .svg-icon,.home-view .content .container .collections .section-title .svg-icon,.home-view .content .container .favorites .section-title .svg-icon{height:25px;width:auto;fill:#a8a8a8}.home-view .content .container .data-cubes .actions,.home-view .content .container .collections .actions,.home-view .content .container .favorites .actions{margin-top:-7px;padding-right:5px;display:none}.home-view .content .container .data-cubes .actions>*,.home-view .content .container .collections .actions>*,.home-view .content .container .favorites .actions>*{cursor:pointer}.home-view .content .container .data-cubes .actions>* .svg-icon,.home-view .content .container .collections .actions>* .svg-icon,.home-view .content .container .favorites .actions>* .svg-icon{height:19px;padding:1px 0 0 1px;fill:#1ea3e6}.home-view .content .container .data-cubes .actions>*:hover .svg-icon,.home-view .content .container .collections .actions>*:hover .svg-icon,.home-view .content .container .favorites .actions>*:hover .svg-icon{fill:#1795d3}.home-view .content .container .data-cubes .items .item-card,.home-view .content .container .collections .items .item-card,.home-view .content .container .favorites .items .item-card{width:100%}.home-view .content .container .data-cubes .items .item-card.empty,.home-view .content .container .collections .items .item-card.empty,.home-view .content .container .favorites .items .item-card.empty{height:0;opacity:0;margin:0;padding:0}.home-view .content .container .data-cubes,.home-view .content .container .collections{margin-top:10px}.home-view .content .container .data-cubes .item-card,.home-view .content .container .collections .item-card{height:72px;padding-bottom:1px;padding-left:5px;padding-right:5px}.home-view .content .container .data-cubes .item-card.adder,.home-view .content .container .collections .item-card.adder{height:51px}.home-view .content .container .data-cubes .item-card.adder .inner-container,.home-view .content .container .collections .item-card.adder .inner-container{border-radius:0 0 2px 2px}.home-view .content .container .data-cubes .item-card .inner-container,.home-view .content .container .collections .item-card .inner-container{border-radius:0}.home-view .content .container .data-cubes .item-card:first-child .inner-container,.home-view .content .container .collections .item-card:first-child .inner-container{border-radius:2px 2px 0 0}.home-view .content .container .favorites .items{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.home-view .content .container .favorites .items .item-card{-webkit-box-flex:1;-ms-flex:1;flex:1;-ms-flex-preferred-size:33.3333%;flex-basis:33.3333%;max-width:33.3333%;padding:5px;height:97px}@media only screen and (max-width: 1080px){.home-view .content .container .favorites .items .item-card{-ms-flex-preferred-size:50%;flex-basis:50%;max-width:50%}}.home-view.no-data .container{bottom:initial}.home-view.scrolled .header-bar{-webkit-box-shadow:0 3px 5px -2px rgba(0,0,0,0.3);box-shadow:0 3px 5px -2px rgba(0,0,0,0.3)}\n",""])},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var beltful_1=__webpack_require__(8);var caladan_1=__webpack_require__(10);var classNames=__webpack_require__(4);var immutable_class_1=__webpack_require__(7);var plywood_1=__webpack_require__(14);var React=__webpack_require__(1);var ReactDOM=__webpack_require__(15);var models_1=__webpack_require__(19);var strings_1=__webpack_require__(17);var components_1=__webpack_require__(466);var local_storage_1=__webpack_require__(758);var visualizations_1=__webpack_require__(759);var link_header_bar_1=__webpack_require__(983);__webpack_require__(986);var $maxTime=plywood_1.$(models_1.FilterClause.MAX_TIME_REF_NAME);var LATEST_PRESETS=[{name:strings_1.STRINGS.last5Minutes,selection:$maxTime.timeRange("PT5M",-1)},{name:strings_1.STRINGS.lastHour,selection:$maxTime.timeRange("PT1H",-1)},{name:strings_1.STRINGS.lastDay,selection:$maxTime.timeRange("P1D",-1)},{name:strings_1.STRINGS.lastWeek,selection:$maxTime.timeRange("P1W",-1)}];var PADDING=10;var SMALL_PANEL_WIDTH=200;var MIN_PANEL_WIDTH=240;var MAX_PANEL_WIDTH=400;var LinkView=function(_super){tslib_1.__extends(LinkView,_super);function LinkView(){var _this=_super.call(this)||this;_this.state={linkTile:null,essence:null,menuStage:null,layout:_this.getStoredLayout()};_this.clicker={changeTimezone:function(timezone){var essence=_this.state.essence;essence=essence.changeTimezone(timezone);_this.setState({essence:essence})},changeFilter:function(filter,colors){var essence=_this.state.essence;essence=essence.changeFilter(filter);if(colors)essence=essence.changeColors(colors);_this.setState({essence:essence})},changeColors:function(colors){var essence=_this.state.essence;_this.setState({essence:essence.changeColors(colors)})},changePinnedSortMeasure:function(measure){var essence=_this.state.essence;_this.setState({essence:essence.changePinnedSortMeasure(measure)})},toggleEffectiveMeasure:function(measure){var essence=_this.state.essence;_this.setState({essence:essence.toggleSelectedMeasure(measure)})},changeHighlight:function(highlight){var essence=_this.state.essence;_this.setState({essence:essence.changeHighlight(highlight)})},acceptHighlight:function(){var essence=_this.state.essence;_this.setState({essence:essence.acceptHighlight()})},dropHighlight:function(){var essence=_this.state.essence;_this.setState({essence:essence.dropHighlight()})}};return _this}LinkView.prototype.initFromProps=function(props){var tileId=props.tileId,collection=props.collection;var linkTile=collection.getCollectionTile(tileId)||collection.tiles[0];this.setState({linkTile:linkTile,essence:linkTile.essence})};LinkView.prototype.updateFromProps=function(oldProps,nextProps){if(oldProps.tileId!==nextProps.tileId){this.setState({linkTile:nextProps.collection.getCollectionTile(nextProps.tileId)})}};LinkView.prototype.componentWillReceiveProps=function(nextProps){if(!nextProps.tileId)return;if(!this.props.tileId&&nextProps.tileId){this.initFromProps(nextProps);return}this.updateFromProps(this.props,nextProps)};LinkView.prototype.componentWillMount=function(){this.initFromProps(this.props)};LinkView.prototype.componentDidMount=function(){this.globalResizeListener()};LinkView.prototype.componentWillUpdate=function(nextProps,nextState){var linkTile=this.state.linkTile;if(!nextState.linkTile.equals(linkTile)){window.location.hash="link/"+nextState.linkTile.name}};LinkView.prototype.globalResizeListener=function(){var _a=this.refs,container=_a.container,visualization=_a.visualization;var containerDOM=ReactDOM.findDOMNode(container);var visualizationDOM=ReactDOM.findDOMNode(visualization);if(!containerDOM||!visualizationDOM)return;var deviceSize="large";if(window.innerWidth<=1250)deviceSize="medium";if(window.innerWidth<=1080)deviceSize="small";this.setState({deviceSize:deviceSize,menuStage:beltful_1.Stage.fromClientRect(containerDOM.getBoundingClientRect())})};LinkView.prototype.selectLinkItem=function(linkTile){var essence=this.state.essence;var newEssence=linkTile.essence;if(essence.actualDataCube.getSpecialTimeDimensionObject()){}this.setState({linkTile:linkTile,essence:newEssence})};LinkView.prototype.getStoredLayout=function(){return local_storage_1.LocalStorage.get("link-view-layout")||{linkPanelWidth:240,pinboardWidth:240}};LinkView.prototype.storeLayout=function(layout){local_storage_1.LocalStorage.set("link-view-layout",layout)};LinkView.prototype.onLinkPanelResize=function(value){var layout=this.state.layout;layout.linkPanelWidth=value;this.setState({layout:layout});this.storeLayout(layout)};LinkView.prototype.onPinboardPanelResize=function(value){var layout=this.state.layout;layout.pinboardWidth=value;this.setState({layout:layout});this.storeLayout(layout)};LinkView.prototype.onPanelResizeEnd=function(){this.globalResizeListener()};LinkView.prototype.selectPreset=function(p){};LinkView.prototype.renderPresets=function(){var essence=this.state.essence;var PresetDropdown=caladan_1.Dropdown.specialize();var realTimeSelection=essence.getRealTimeSelection();var selected=immutable_class_1.SimpleArray.find(LATEST_PRESETS,function(p){return p.selection.equals(realTimeSelection)});return React.createElement(PresetDropdown,{items:LATEST_PRESETS,selectedItem:selected,equal:function(a,b){if(a===b)return true;if(!a!==!b)return false;return a.selection===b.selection},renderItem:function(p){return p?p.name:""},onSelect:this.selectPreset.bind(this)})};LinkView.prototype.renderLinkPanel=function(style){var _this=this;var collection=this.props.collection;var linkTile=this.state.linkTile;var groupId=0;var lastGroup=null;var items=[];collection.tiles.forEach(function(li){var group=li.group||"Tiles";if(lastGroup!==group){items.push(React.createElement("div",{className:"link-group-title",key:"group-"+groupId},group));lastGroup=group;groupId++}items.push(React.createElement("div",{className:classNames("link-item",{selected:li===linkTile}),key:"li-"+li.name,onClick:_this.selectLinkItem.bind(_this,li)},li.title))});return React.createElement("div",{className:"link-panel",style:style},React.createElement("div",{className:"link-container"},items))};LinkView.prototype.renderEmpty=function(){return React.createElement("div",{className:"link-view"},React.createElement(caladan_1.GlobalEventListener,{resize:this.globalResizeListener.bind(this)}),React.createElement(caladan_1.HeaderBar,null),React.createElement("div",{className:"container",ref:"container"},React.createElement("div",{className:"center-panel"},React.createElement("div",{className:"center-top-bar"}),React.createElement("div",{className:"center-main"},React.createElement("div",{className:"visualization",ref:"visualization"})))))};LinkView.prototype.render=function(){var clicker=this.clicker;var _a=this.props,timekeeper=_a.timekeeper,controller=_a.controller,collection=_a.collection,user=_a.user,customization=_a.customization,stateful=_a.stateful;var _b=this.state,deviceSize=_b.deviceSize,linkTile=_b.linkTile,essence=_b.essence,layout=_b.layout;if(!linkTile)return this.renderEmpty();var visualization=essence.getVisualizationManifest();var visResolve=essence.getVisResolve();var visElement=null;if(visResolve.proceedWithDimensions()){var visProps={clicker:clicker,timekeeper:timekeeper,essence:essence};visElement=React.createElement(visualizations_1.getVisualizationComponent(visualization),visProps)}var manualFallback=null;if(visResolve.rejectedDimensions()||visResolve.rejectedCombines()){manualFallback=React.createElement(components_1.ManualFallback,{clicker:clicker,essence:essence})}var styles={linkMeasurePanel:{width:layout.linkPanelWidth-2*PADDING},centerPanel:{left:layout.linkPanelWidth,right:layout.pinboardWidth},pinboardPanel:{width:layout.pinboardWidth-2*PADDING}};if(deviceSize==="small"){styles={linkMeasurePanel:{width:SMALL_PANEL_WIDTH-1},centerPanel:{left:SMALL_PANEL_WIDTH,right:SMALL_PANEL_WIDTH},pinboardPanel:{width:SMALL_PANEL_WIDTH-1}}}return React.createElement("div",{className:"link-view"},React.createElement(caladan_1.GlobalEventListener,{resize:this.globalResizeListener.bind(this)}),React.createElement(link_header_bar_1.LinkHeaderBar,{controller:controller,title:collection.title,user:user,onExploreClick:function(){return controller.openDataCube(essence.actualDataCube,essence)},customization:customization,changeTimezone:clicker.changeTimezone,timezone:essence.timezone,stateful:stateful}),React.createElement("div",{className:"container",ref:"container"},this.renderLinkPanel(styles.linkMeasurePanel),deviceSize!=="small"?React.createElement(caladan_1.ResizeHandle,{side:"left",initialValue:layout.linkPanelWidth,onResize:this.onLinkPanelResize.bind(this),onResizeEnd:this.onPanelResizeEnd.bind(this),min:MIN_PANEL_WIDTH,max:MAX_PANEL_WIDTH}):null,React.createElement("div",{className:"center-panel",style:styles.centerPanel},React.createElement("div",{className:"center-top-bar"},React.createElement("div",{className:"link-title"},linkTile.getTitle()),React.createElement("div",{className:"link-description"},linkTile.getDescription()),React.createElement("div",{className:"right-align"},this.renderPresets())),React.createElement("div",{className:"center-main"},React.createElement("div",{className:"visualization",ref:"visualization"},visElement),manualFallback)),deviceSize!=="small"?React.createElement(caladan_1.ResizeHandle,{side:"right",initialValue:layout.pinboardWidth,onResize:this.onPinboardPanelResize.bind(this),onResizeEnd:this.onPanelResizeEnd.bind(this),min:MIN_PANEL_WIDTH,max:MAX_PANEL_WIDTH}):null,React.createElement(components_1.PinboardPanel,{style:styles.pinboardPanel,clicker:clicker,essence:essence,timekeeper:timekeeper})))};return LinkView}(React.Component);exports.LinkView=LinkView},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var tslib_1=__webpack_require__(0);var caladan_1=__webpack_require__(10);var Icons=__webpack_require__(11);var React=__webpack_require__(1);var models_1=__webpack_require__(19);var components_1=__webpack_require__(466);__webpack_require__(984);var LinkHeaderBar=function(_super){tslib_1.__extends(LinkHeaderBar,_super);function LinkHeaderBar(){var _this=_super.call(this)||this;_this.state={};return _this}LinkHeaderBar.prototype.renderUserMenu=function(target){var _a=this.props,user=_a.user,customization=_a.customization,stateful=_a.stateful;var canEdit=user&&user.canAccessSettings()&&stateful&&customization.getSettingsMode()!==models_1.Customization.SETTINGS_MODE_SUPPRESSED;return React.createElement(components_1.UserMenu,{showSettings:canEdit,openOn:target,user:user,customization:customization})};LinkHeaderBar.prototype.render=function(){var _a=this.props,controller=_a.controller,title=_a.title,user=_a.user,onExploreClick=_a.onExploreClick,customization=_a.customization;var leftChildren=[{id:"menu-icon",className:"menu-icon",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.MENU}),onClick:controller.openSideDrawer},{id:"title",className:"title",content:title,onClick:controller.openSideDrawer}];var rightChildren=[{id:"explore",className:"text-button",content:"Explore",tooltip:"Explore",onClick:onExploreClick},{id:"help",className:"icon-button help",tooltip:"Support",content:React.createElement(caladan_1.SvgIcon,{className:"help-icon",svg:Icons.HELP}),onClick:function(){return window.open("https://groups.google.com/forum/#!forum/imply-user-group","_blank")}}].filter(Boolean);rightChildren.push({id:"user-button",className:"icon-button user",content:React.createElement(caladan_1.SvgIcon,{svg:Icons.FULL_PROFILE}),renderMenu:this.renderUserMenu.bind(this),tooltip:"Me"});return React.createElement(caladan_1.HeaderBar,{className:"link-header-bar",style:{background:customization.getEffectiveTheme().mainColor},leftChildren:leftChildren,rightChildren:rightChildren})};return LinkHeaderBar}(React.Component);exports.LinkHeaderBar=LinkHeaderBar},function(module,exports,__webpack_require__){var content=__webpack_require__(985);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../../node_modules/css-loader/index.js!./link-header-bar.css",function(){var newContent=require("!!../../../../../node_modules/css-loader/index.js!./link-header-bar.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".link-header-bar{background:#208b84}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(987);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./link-view.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./link-view.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,".link-view .center-panel .center-top-bar,.link-view .center-panel .center-main .visualization{background:#fff}.link-view .link-header-bar{position:absolute;top:0;left:0;right:0;height:42px}.link-view .container{position:absolute;top:42px;bottom:0;left:0;right:0}.link-view .link-panel{position:absolute;top:10px;bottom:10px;left:10px}@media only screen and (max-width: 1080px){.link-view .link-panel{top:0;bottom:0;left:0;font-size:0.9em}}.link-view .link-panel .link-container{background:#fff;overflow:auto;height:100%}.link-view .link-panel .link-container .link-group-title{padding:0 18px;color:#999;font-size:12px;text-transform:uppercase;pointer-events:none;margin-top:8px;height:25px;line-height:25px}.link-view .link-panel .link-container .link-item{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;height:25px;line-height:25px;padding:0 4px 0 38px;cursor:pointer;overflow:hidden}.link-view .link-panel .link-container .link-item.selected{background:rgba(30,163,230,0.16)}.link-view .link-panel .link-container .link-item:hover:not(.selected){background:rgba(30,163,230,0.12)}.link-view .center-panel{position:absolute;top:10px;bottom:10px;left:240px}@media only screen and (max-width: 1080px){.link-view .center-panel{top:0;bottom:0}}.link-view .center-panel .center-top-bar{position:absolute;top:0;left:0;right:0;height:73px;border-radius:2px;padding:17px 20px;border-bottom:1px solid #eee}.link-view .center-panel .center-top-bar .link-title{white-space:nowrap;overflow-x:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis;font-size:17px;margin-bottom:8px;padding-right:152px}.link-view .center-panel .center-top-bar .link-description{line-height:13px;max-height:26px;overflow:hidden;color:#999;padding-right:152px}.link-view .center-panel .center-top-bar .right-align{position:absolute;min-width:150px;right:18px;top:18px;bottom:18px}.link-view .center-panel .center-main{position:absolute;top:78px;bottom:0;left:0;right:0}@media only screen and (max-width: 1080px){.link-view .center-panel .center-main{position:absolute;top:74px;bottom:0;left:0;right:0}}.link-view .center-panel .center-main .visualization{position:absolute;top:0;bottom:0;left:0;right:0;border-radius:2px}.link-view .center-panel .center-main .visualization .line-chart,.link-view .center-panel .center-main .visualization .table{position:absolute;top:0;bottom:0;left:0;right:0}.link-view .center-panel .center-main .manual-fallback{position:absolute;top:0;bottom:0;left:0;right:0}.link-view .center-panel .center-main .drop-indicator{position:absolute;top:0;bottom:0;left:0;right:0;z-index:9}.link-view .pinboard-panel{position:absolute;top:10px;bottom:10px;right:10px}@media only screen and (max-width: 1080px){.link-view .pinboard-panel{top:0;bottom:0;right:0}}.link-view .pinboard-panel .pinboard-measure-tile:first-child,.link-view .pinboard-panel .dimension-tile:first-child,.link-view .pinboard-panel .placeholder-tile:first-child{border-radius:2px 2px 0 0}.link-view .pinboard-panel .pinboard-measure-tile:last-child,.link-view .pinboard-panel .dimension-tile:last-child,.link-view .pinboard-panel .placeholder-tile:last-child{border-radius:0 0 2px 2px}\n",""])},function(module,exports,__webpack_require__){var content=__webpack_require__(989);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={};options.transform=transform;var update=__webpack_require__(6)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../../../node_modules/css-loader/index.js!./pivot-application.css",function(){var newContent=require("!!../../../../node_modules/css-loader/index.js!./pivot-application.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(5)(undefined);exports.push([module.i,'.pivot-application{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;background:#e1e1e1}.pivot-application .not-implemented{display:none}.pivot-application .home-view,.pivot-application .no-data-view,.pivot-application .cube-view,.pivot-application .cube-edit-view,.pivot-application .link-view{position:absolute;top:0;bottom:0;left:0;right:0}.pivot-application .side-drawer-container{position:absolute;left:0;top:0;bottom:0;z-index:80}.pivot-application .darkout{position:absolute;top:0;bottom:0;left:0;right:0;z-index:20}.pivot-application.darken::after{content:"";position:absolute;background:black;width:100%;height:100%;z-index:100;opacity:0.2;pointer-events:none}\n',""])}]);