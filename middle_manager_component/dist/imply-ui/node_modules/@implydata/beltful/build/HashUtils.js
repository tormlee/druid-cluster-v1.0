"use strict";Object.defineProperty(exports,"__esModule",{value:true});var SHA=require("jssha");var bcrypt=require("bcryptjs");var BCRYPT_SALT_ROUNDS=12;var SHA2_SALT="Don't rub salt in your eyes!";exports.HashUtils={saltedSha2:function(pass,salt){if(salt===void 0){salt=SHA2_SALT}return exports.HashUtils.sha2(salt+pass)},sha2:function(input,format){if(format===void 0){format="B64"}var shaObj=new SHA("SHA-256","TEXT");shaObj.update(input);return shaObj.getHash(format)},bcryptCompareSync:function(pass,hash){return bcrypt.compareSync(pass,hash)},bcryptHashSync:function(pass,saltRounds){if(saltRounds===void 0){saltRounds=BCRYPT_SALT_ROUNDS}return bcrypt.hashSync(pass,saltRounds)},bcryptHash:function(pass,saltRounds){if(saltRounds===void 0){saltRounds=BCRYPT_SALT_ROUNDS}return new Promise(function(resolve,reject){bcrypt.hash(pass,saltRounds,function(err,hash){if(err){reject(err)}else{resolve(hash)}})})},bcryptCompare:function(pass,hash){return new Promise(function(resolve,reject){bcrypt.compare(pass,hash,function(err,success){if(err){reject(err)}else{resolve(success)}})})}};